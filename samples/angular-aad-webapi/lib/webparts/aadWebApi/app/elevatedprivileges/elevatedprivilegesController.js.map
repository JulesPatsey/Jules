{"version":3,"sources":["webparts/aadWebApi/app/elevatedprivileges/elevatedprivilegesController.ts"],"names":[],"mappings":";AAKA;IAYE,sCAAoB,MAAsB,EAAU,IAAyB,EACnE,IAAmB,EAAU,aAA6C;QADhE,WAAM,GAAN,MAAM,CAAgB;QAAU,SAAI,GAAJ,IAAI,CAAqB;QACnE,SAAI,GAAJ,IAAI,CAAe;QAAU,kBAAa,GAAb,aAAa,CAAgC;QAR7E,aAAQ,GAAY,KAAK,CAAC;QAGjC,oBAAoB;QACZ,mBAAc,GAAY,KAAK,CAAC;QAChC,iBAAY,GAAY,KAAK,CAAC;QAIpC,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,SAAS,EAAE,CAAC;QACnB,CAAC;IACH,CAAC;IAEM,6CAAM,GAAb;QACE,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;IAC7B,CAAC;IAEM,8CAAO,GAAd;QACE,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC;IAC9B,CAAC;IAEM,sDAAe,GAAtB;QACE,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,eAAe,CAAC;IACrD,CAAC;IAEM,oDAAa,GAApB;QACE,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,6BAA6B,CAAC,CAAC;IACjE,CAAC;IAEM,kDAAW,GAAlB;QACE,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,4CAA4C,CAAC,CAAC;IAChF,CAAC;IAEM,oDAAa,GAApB;QACE,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,6BAA6B,CAAC,KAAK,IAAI,CAAC;QAChG,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC;IAC7B,CAAC;IAEM,kDAAW,GAAlB;QACE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,4CAA4C,CAAC,KAAK,IAAI,CAAC;QAC7G,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;IAEM,gDAAS,GAAhB;QAAA,iBAMC;QALC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;aACd,IAAI,CAAC,UAAC,MAAW;YAChB,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC;YAC7C,KAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;QAC1B,CAAC,CAAC,CAAC;IACP,CAAC;IAEM,8CAAO,GAAd;QAAA,iBAOC;QANC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;aAChB,IAAI,CAAC,UAAC,MAAW;YAChB,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,yBAAyB,CAAC,CAAC;YAC3C,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YACxB,KAAK,CAAC,gCAAgC,CAAC,CAAC;QAC1C,CAAC,CAAC,CAAC;IACP,CAAC;IACH,mCAAC;AAAD,CAjEA,AAiEC;AAhEe,oCAAO,GAAa,CAAC,QAAQ,EAAE,MAAM,EAAE,eAAe,EAAE,2BAA2B,CAAC,CAAC;AADxF,oEAA4B","file":"webparts/aadWebApi/app/elevatedprivileges/elevatedprivilegesController.js","sourcesContent":["import * as angular from 'angular';\r\nimport adal = require('adal-angular');\r\nimport { IWebAPIServce } from '../webApiService';\r\nimport { IGraphApi } from '../../models/IGraphApi';\r\n\r\nexport class ElevatedPrivilegesController {\r\n  public static $inject: string[] = ['$scope', '$log', 'WebAPIService', 'adalAuthenticationService'];\r\n\r\n  // public variables\r\n  public displayName: string;\r\n  public signedIn: boolean = false;\r\n  public user: IGraphApi;\r\n\r\n  // private variables\r\n  private _hasGraphToken: boolean = false;\r\n  private _hasAPIToken: boolean = false;\r\n\r\n  constructor(private $scope: angular.IScope, private $log: angular.ILogService,\r\n    private $api: IWebAPIServce, private $adalProvider: adal.AdalAuthenticationService) {\r\n    if (this.hasGraphToken()) {\r\n      this.callGraph();\r\n    }\r\n  }\r\n\r\n  public signOn(): void {\r\n    this.$adalProvider.login();\r\n  }\r\n\r\n  public signOut(): void {\r\n    this.$adalProvider.logOut();\r\n  }\r\n\r\n  public isAuthenticated(): boolean {\r\n    return this.$adalProvider.userInfo.isAuthenticated;\r\n  }\r\n\r\n  public getGraphToken(): void {\r\n    this.$adalProvider.acquireToken(\"https://graph.microsoft.com\");\r\n  }\r\n\r\n  public getAPIToken(): void {\r\n    this.$adalProvider.acquireToken('https://dhartman.onmicrosoft.com/PnPWebApp');\r\n  }\r\n\r\n  public hasGraphToken(): boolean {\r\n    this._hasGraphToken = this.$adalProvider.getCachedToken(\"https://graph.microsoft.com\") !== null;\r\n    return this._hasGraphToken;\r\n  }\r\n\r\n  public hasAPIToken(): boolean {\r\n    this._hasAPIToken = this.$adalProvider.getCachedToken('https://dhartman.onmicrosoft.com/PnPWebApp') !== null;\r\n    return this._hasAPIToken;\r\n  }\r\n\r\n  public callGraph(): void {\r\n    this.$api.getMe()\r\n      .then((result: any): void => {\r\n        this.$log.debug(\"success call to graph api\");\r\n        this.user = result.data;\r\n      });\r\n  }\r\n\r\n  public callApi(): void {\r\n    this.$api.getItem()\r\n      .then((result: any): void => {\r\n        this.$log.debug(\"success call to web api\");\r\n        this.$log.debug(result);\r\n        alert('success call to custom web api');\r\n      });\r\n  }\r\n}"],"sourceRoot":"..\\..\\..\\..\\..\\src"}