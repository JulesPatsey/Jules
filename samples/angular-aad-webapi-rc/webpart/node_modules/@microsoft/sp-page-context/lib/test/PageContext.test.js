"use strict";
var chai_1 = require('chai');
var sp_lodash_subset_1 = require('@microsoft/sp-lodash-subset');
var MockPageContextData_1 = require('./MockPageContextData');
var PageContext_1 = require('../PageContext');
describe('PageContext tests', function () {
    var pageContext;
    var pageContextData;
    beforeEach(function () {
        pageContext = new PageContext_1.default(undefined);
        pageContextData = sp_lodash_subset_1.cloneDeep(MockPageContextData_1.default);
    });
    it('Should succeed to initialize a PageContext with valid IPageContextData', function () {
        pageContext.initialize(MockPageContextData_1.default);
        chai_1.assert.isTrue(pageContext.isInitialized);
    });
    it('Should fail to initialize a PageContext with invalid ISPWebData', function () {
        pageContextData.web.title = undefined;
        chai_1.assert.throws(function () { return pageContext.initialize(pageContextData); });
        chai_1.assert.isFalse(pageContext.isInitialized);
    });
    it('Should fail to initialize a PageContext with invalid ICultureInfoData', function () {
        pageContextData.cultureInfo.isRightToLeft = undefined;
        chai_1.assert.throws(function () { return pageContext.initialize(pageContextData); });
        chai_1.assert.isFalse(pageContext.isInitialized);
    });
    it('Should fail to initialize a PageContext with invalid ISPUserData', function () {
        pageContextData.user = undefined;
        chai_1.assert.throws(function () { return pageContext.initialize(pageContextData); });
        chai_1.assert.isFalse(pageContext.isInitialized);
    });
    it('Should succeed to initialize a PageContext with no ISPListData', function () {
        pageContextData.list = undefined;
        pageContext.initialize(pageContextData);
        chai_1.assert.isTrue(pageContext.isInitialized);
    });
    it('Should succeed to initialize a PageContext with no ISPListItemData', function () {
        pageContextData.listItem = undefined;
        pageContext.initialize(pageContextData);
        chai_1.assert.isTrue(pageContext.isInitialized);
    });
    it('Should fail to initialize a PageContext with invalid ISPSite', function () {
        pageContextData.site.serverRelativeUrl = undefined;
        chai_1.assert.throws(function () { return pageContext.initialize(pageContextData); });
        chai_1.assert.isFalse(pageContext.isInitialized);
    });
    it('Should fail to initialize a PageContext with invalid ISPListData', function () {
        pageContextData.list.title = undefined;
        chai_1.assert.throws(function () { return pageContext.initialize(pageContextData); });
        chai_1.assert.isFalse(pageContext.isInitialized);
    });
    it('Should fail to initialize a PageContext with invalid ISPListItemData', function () {
        pageContextData.listItem.id = undefined;
        chai_1.assert.throws(function () { return pageContext.initialize(pageContextData); });
        chai_1.assert.isFalse(pageContext.isInitialized);
    });
});
