{"version":3,"sources":["tasks/CopyTask.ts"],"names":[],"mappings":";;;;;;AAAA,yBAAyB,YAAY,CAAC,CAAA;AAiBtC;;GAEG;AACH;IAA8B,4BAAqB;IAAnD;QAA8B,8BAAqB;QAC1C,eAAU,GAAgB;YAC/B,MAAM,EAAE,EAAE;YACV,aAAa,EAAE,IAAI;SACpB,CAAC;IAkCJ,CAAC;IAhCQ,8BAAW,GAAlB,UACE,IAAe,EACf,gBAA2C;QAG3C,4BAA4B;QAC5B,IAAM,OAAO,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC;QACxC,IAAM,MAAM,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;QAClC,IAAM,KAAK,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;QAChC,IAAA,oBAAiD,EAAzC,kBAAM,EAAE,gCAAa,CAAqB;QAClD,2BAA2B;QAE3B,IAAM,UAAU,GAA6B,EAAE,CAAC;QAEhD;YACE,EAAE,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACpC,IAAM,OAAO,GAAa,MAAM,CAAC,QAAQ,CAAC,CAAC;gBAE3C,OAAO,CAAC,OAAO,CAAC,UAAA,WAAW,IAAI,OAAA,UAAU,CAAC,IAAI,CAC5C,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;qBAClB,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,OAAO,EAAE,CAAC,CAAC;qBACtC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAC7B,EAJ8B,CAI9B,CAAC,CAAC;YACL,CAAC;;QATH,GAAG,CAAC,CAAC,IAAM,QAAQ,IAAI,MAAM,CAAC;;SAU7B;QAED,EAAE,CAAC,CAAC,UAAU,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YAC5B,gBAAgB,EAAE,CAAC;QACrB,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QAC3B,CAAC;IACH,CAAC;IACH,eAAC;AAAD,CAtCA,AAsCC,CAtC6B,mBAAQ,GAsCrC;AAtCY,gBAAQ,WAsCpB,CAAA","file":"tasks/CopyTask.js","sourcesContent":["import { GulpTask } from './GulpTask';\r\nimport gulp = require('gulp');\r\n\r\nexport interface ICopyConfig {\r\n  /**\r\n   * Object of dest: [source] for the copy task.\r\n   */\r\n  copyTo: {\r\n    [destPath: string]: string[];\r\n  };\r\n\r\n  /**\r\n   * Whether to remove or replace relative path for files. True by default.\r\n   */\r\n  shouldFlatten?: boolean;\r\n}\r\n\r\n/**\r\n * This task takes in a map of dest: [sources], and copies items from one place to another.\r\n */\r\nexport class CopyTask extends GulpTask<ICopyConfig> {\r\n  public taskConfig: ICopyConfig = {\r\n    copyTo: {},\r\n    shouldFlatten: true\r\n  };\r\n\r\n  public executeTask(\r\n    gulp: gulp.Gulp,\r\n    completeCallback: (result?: Object) => void\r\n  ): Promise<Object> | NodeJS.ReadWriteStream | void {\r\n\r\n    /* tslint:disable:typedef */\r\n    const flatten = require('gulp-flatten');\r\n    const gulpif = require('gulp-if');\r\n    const merge = require('merge2');\r\n    const { copyTo, shouldFlatten } = this.taskConfig;\r\n    /* tslint:enable:typedef */\r\n\r\n    const allStreams: NodeJS.ReadWriteStream[] = [];\r\n\r\n    for (const copyDest in copyTo) {\r\n      if (copyTo.hasOwnProperty(copyDest)) {\r\n        const sources: string[] = copyTo[copyDest];\r\n\r\n        sources.forEach(sourceMatch => allStreams.push(\r\n          gulp.src(sourceMatch)\r\n            .pipe(gulpif(shouldFlatten, flatten()))\r\n            .pipe(gulp.dest(copyDest))\r\n        ));\r\n      }\r\n    }\r\n\r\n    if (allStreams.length === 0) {\r\n      completeCallback();\r\n    } else {\r\n      return merge(allStreams);\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\src"}