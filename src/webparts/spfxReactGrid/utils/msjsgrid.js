function ULSEWi(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="JsGrid.js";return o;}
Type.registerNamespace("SP");Type.registerNamespace("SP.JsGrid");Type.registerNamespace("SP.JsGrid.Internal");Type.registerNamespace("SP.Internal");Type.registerNamespace("SP.Utilities");SP.JsGrid.Internal.ColumnConfigurationDialog=function(c,o,n,b,k){ULSEWi:;var r=false,a,f,e,i,g,d;function p(h,g){ULSEWi:;function e(){ULSEWi:;var b=[],d;this.InitFromColumnConfigGridData=function(g,i){ULSEWi:;for(var h=a.GetCheckSelectionManager().GetCheckedRecordKeys(),e=0;e<g.length;e++){var c=i.GetCachedRecord(g[e]),f=c.key() in h;d=d||f;b.push({fieldKey:c.key(),width:c.GetDataValue("ColWidth"),isVisible:f})}};this.InitFromCurrent=function(){ULSEWi:;for(var d=c.GetColumnArray(),a=0;a<d.length;a++)b.push({fieldKey:d[a].columnKey,width:d[a].width,isVisible:d[a].isVisible})};this.ApplyToCurrent=function(){ULSEWi:;var d=[];indicCol=c.GetColumnByKey(SP.JsGrid.RecordIndicatorCheckboxColumnKey);indicCol!=null&&d.push(indicCol);for(var a=0;a<b.length;a++){var e=c.GetColumnByKey(b[a].fieldKey);e.isVisible=b[a].isVisible;e.width=b[a].width;d.push(e)}return new SP.JsGrid.ColumnInfoCollection(d)};this.IsValidUpdate=function(){ULSEWi:;return d}}if(a.AnyErrors()){alert(SP.JsGrid.Res.columnConfigurationErrorsInGrid);return false}var d=new e,f=new e;d.InitFromColumnConfigGridData(h,g);if(!d.IsValidUpdate()){alert(SP.JsGrid.Res.invalidColumnConfigurationNoColumns);return false}f.InitFromCurrent();b.commandMgr.Execute({Apply:function(){ULSEWi:;k(d.ApplyToCurrent())},Undo:function(){ULSEWi:;k(f.ApplyToCurrent())}},"Column Configuration Update",SP.JsGrid.CommandManager.CommandType.Explicit);return true}function j(n,c){ULSEWi:;function m(){ULSEWi:;for(var b=new Array(c.view.length),a=0;a<b.length;a++)b[a]=c.view[a];return b}function l(b,e,f){ULSEWi:;for(var c=false,d=0;d<b.length;d++){a[e](b[0].keys[0],b[0].keys[b[0].keys.length-1],f||c);c=true}return c}var k=new SP.Utilities.Set;k.AddArray(a.GetSelectedRecordKeys());for(var d,f,b=0;b<c.view.length;b++)if(d==null&&k.Contains(c.view[b]))d=b;else if(d!=null&&f==null&&!k.Contains(c.view[b]))f=b-1;var e;if(d!=null)if(n&&d>0){e=m();SP.Internal.JS.MoveItemInArray(e,d-1,f==null?e.length-1:f)}else if(!n&&f!=null){e=m();SP.Internal.JS.MoveItemInArray(e,f+1,d)}if(e!=null){var p=a.GetSelectedRowRanges(),o=a.GetSelectedColumnRanges(),j=a.GetSelectedCellRanges(),q=a.GetTopRecordIndex();c.topViewIdx=q;c.view=e;a.SetRowView(c);var g=false;g=l(p,"SelectRowRangeByKey",g);g=l(o,"SelectColumnRangeByKey",g);for(var b=0;b<j.length;b++){var i=j[b].rowRange.keys,h=j[b].colRange.keys;a.SelectCellRangeByKey(i[0],i[i.length-1],h[0],h[h.length-1],g)}}}function m(d){ULSEWi:;d.tableCache=new SP.JsGrid.TableCache;for(var h=c.GetColumnArray(),j=[],i=[],k=new SP.JsGrid.RecordFactory(d.tableViewParams.gridFieldMap,"FieldKey"),g=[],f=[],e=0;e<h.length;e++){var b=h[e],a=b.columnKey;if(a!=SP.JsGrid.RecordIndicatorCheckboxColumnKey){j.push(a);i[a]=k.MakeRecord({FieldKey:a,ColWidth:b.width},{ColName:b.name,ColWidth:b.width.toString()},true);b.isVisible&&g.push(a);!b.isHidable&&f.push(a)}}d.tableCache.AddRecordsToCache(i);d.tableViewParams.checkSelectionCheckedRecordKeys=g;d.tableViewParams.checkSelectionCheckboxDisabledRecordKeys=f;d.tableViewParams.rowViewParams.view=j}function l(a){ULSEWi:;a.columns=new SP.JsGrid.ColumnInfoCollection([new SP.JsGrid.ColumnInfo(SP.JsGrid.Res.columnName,null,"ColName",170),new SP.JsGrid.ColumnInfo(SP.JsGrid.Res.columnWidth,null,"ColWidth",145)]);if(n)a.columns.GetColumnByKey("ColWidth").fnGetCellEditMode=function(a){ULSEWi:;return c.GetColumnByKey(a.key()).isResizable?SP.JsGrid.EditMode.ReadWrite:SP.JsGrid.EditMode.ReadOnly};else a.bEditingEnabled=false;a.gridFieldMap={FieldKey:new SP.JsGrid.GridField("FieldKey",true,false),ColName:new SP.JsGrid.GridField("ColName",false,true),ColWidth:new SP.JsGrid.GridField("ColWidth",true,true)};a.gridFieldMap["ColName"].SetEditMode(SP.JsGrid.EditMode.ReadOnly);a.gridFieldMap["ColName"].SetSingleValuePropType(SP.JsGrid.PropertyType.Utils.GetPropType("String"));var d=SP.JsGrid.Internal.Property.GetPropType("JSNumber"),b=SP.Internal.JS.object(d);b.ID="ColWidthJSNumber";b.BeginValidateNormalizeConvert=function(e,f,g,a,c,h){ULSEWi:;d.BeginValidateNormalizeConvert.apply(this,[e,f,g,a,b,h]);function b(a){ULSEWi:;a.isValid=a.isValid&&a.dataValue>0&&a.dataValue<=1e3;c(a)}};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(b,"JSNumber");a.gridFieldMap["ColWidth"].SetSingleValuePropType(b)}this.GetHeight=function(){ULSEWi:;return 360};this.GetWidth=function(){ULSEWi:;return 600};function h(b){ULSEWi:;try{a.Dispose()}catch(c){}$clearHandlers(f);$clearHandlers(e);$clearHandlers(i);$clearHandlers(g);$clearHandlers(d);b!=null&&b()}this.Close=function(){ULSEWi:;h()};this.Open=function(q,k){ULSEWi:;d=q;d.innerHTML='<div style="position:relative;overflow:auto;text-align:'+b.RTL.left+";padding:10px;height:"+(this.GetHeight()-20)+"px;width:"+(this.GetWidth()-20)+'px;"><table><tr><td><div id="'+b.gridId+'_ccGridParentElement" style="height:280px;width:400px;float:'+b.RTL.right+';"></div></td><td style="height:280px;padding-left:10px;vertical-align:middle;"><input id="'+b.gridId+'_ccUp" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.moveUp+'"><div style="height:15px;"></div><input id="'+b.gridId+'_ccDown" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.moveDown+'"></td></tr><tr style="padding-top:15px;"><td><input id="'+b.gridId+'_ccOK" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.ok+'" style="float:'+b.RTL.right+';"></td><td style="padding-left:10px;"><input id="'+b.gridId+'_ccCancel" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.cancel+'"></td></tr></table></div>';var n=$get(b.gridId+"_ccGridParentElement");f=$get(b.gridId+"_ccUp");e=$get(b.gridId+"_ccDown");f.disabled=e.disabled=!o;i=$get(b.gridId+"_ccOK");g=$get(b.gridId+"_ccCancel");a=new SP.JsGrid.JsGridControl(n,false);var c=new SP.JsGrid.JsGridControl.Parameters;c.name=SP.JsGrid.Res.columnConfigurationName;l(c.tableViewParams);m(c);c.tableViewParams.bEditingEnabled=true;c.tableViewParams.bRecordIndicatorCheckboxesEnabled=true;c.tableViewParams.operationalConstantsFieldKeyMap={};c.tableViewParams.bHidableColumns=false;c.tableViewParams.bSortableColumns=false;c.tableViewParams.bAutoFilterableColumns=false;c.tableViewParams.allowedSelectionTypes=SP.JsGrid.SelectionTypeFlags.SingleRowRange|SP.JsGrid.SelectionTypeFlags.SingleColRange|SP.JsGrid.SelectionTypeFlags.SingleCell;c.tableViewParams.messageOverrides={localizedConversionError:SP.JsGrid.Res.columnConfigurationInvalidColumnWidth};a.Init(c);setTimeout(function(){ULSEWi:;a.Focus()},0);$addHandler(f,"click",function(){ULSEWi:;j(true,c.tableViewParams.rowViewParams)});$addHandler(e,"click",function(){ULSEWi:;j(false,c.tableViewParams.rowViewParams)});$addHandler(i,"click",function(){ULSEWi:;if(p(c.tableViewParams.rowViewParams.view,c.tableCache))h(k);else a.Focus()});$addHandler(g,"click",function(){ULSEWi:;h(k)});$addHandler(d,"keydown",function(){ULSEWi:;var b=String.fromCharCode(event.keyCode).toUpperCase(),a=event.ctrlKey;if(a&&b=="Z")c.commandMgr.Undo();else a&&b=="Y"&&c.commandMgr.Redo()})}};SP.JsGrid.Internal.ColumnMenuManager=function(j,c,u,y,d){ULSEWi:;var k=this,h=u||{},f,g,x,a=j.delegateMgr,b=j.jsGridObj,q=false;function z(){ULSEWi:;c=c==null?{}:c;b.AttachEvent(SP.JsGrid.EventType.OnPropertyChanged,n);b.AttachEvent(SP.JsGrid.EventType.OnRecordInserted,o);b.AttachEvent(SP.JsGrid.EventType.OnRecordDeleted,p)}this.Dispose=function(){ULSEWi:;b.DetachEvent(SP.JsGrid.EventType.OnPropertyChanged,n);b.DetachEvent(SP.JsGrid.EventType.OnRecordInserted,o);b.DetachEvent(SP.JsGrid.EventType.OnRecordDeleted,p);q=true};this.SetAutoFilterState=function(a){ULSEWi:;c=a==null?{}:a;this.ClearCache()};this.SeedAutoFilterEntryCache=function(a){ULSEWi:;h=a||{}};this.ClearCache=function(){ULSEWi:;h={}};this.CanExpandMenu=function(b,f,e,c,d){ULSEWi:;return f||d||e&&a.DelegatePresent(SP.JsGrid.DelegateType.Sort)||c&&b.isAutoFilterable&&a.DelegatePresent(SP.JsGrid.DelegateType.GetAutoFilterEntries)&&a.DelegatePresent(SP.JsGrid.DelegateType.AutoFilter)&&a.DelegatePresent(SP.JsGrid.DelegateType.LaunchFilterDialog)||b.columnKey==SP.JsGrid.RecordIndicatorCheckboxColumnKey||a.DelegatePresent(SP.JsGrid.DelegateType.WillAddColumnMenuItems)&&a.Apply(SP.JsGrid.DelegateType.WillAddColumnMenuItems,columnKey)};this.ExpandMenu=function(n,o,A,C,B,z){ULSEWi:;var w=false;function u(){ULSEWi:;w=true;A()}var j=n.columnKey,k,y=SP.Internal.DomElement.GetLocation(b.parentNode);o.left-=y.x;o.top-=y.y;f=new SP.JsGrid.ContextMenu(b.parentNode,b.parentNode.id+"_columnmenuloading");g=k=new SP.JsGrid.ContextMenu(b.parentNode,b.parentNode.id+"_columnmenu");f.EnableCompactMode();g.EnableCompactMode();a.Apply(SP.JsGrid.DelegateType.AddColumnMenuItems,j,e,l);var p=false;if(C&&n.isHidable){i();e(d("HideColumn"),function(){ULSEWi:;b.HideColumn(j)},"/_layouts/Images/jsgrid-hide-column.png");p=true}!p&&i();s();if(B&&a.DelegatePresent(SP.JsGrid.DelegateType.Sort)&&n.isSortable){i();e(d("SortAsc"),function(){ULSEWi:;r(j,false)},"/_layouts/Images/sortaz.gif");e(d("SortDesc"),function(){ULSEWi:;r(j,true)},"/_layouts/Images/sortza.gif")}if(z&&n.isAutoFilterable&&a.DelegatePresent(SP.JsGrid.DelegateType.GetAutoFilterEntries)&&a.DelegatePresent(SP.JsGrid.DelegateType.AutoFilter)&&a.DelegatePresent(SP.JsGrid.DelegateType.LaunchFilterDialog)){i();e(d("ClearFilter"),function(){ULSEWi:;v(j)},"/_layouts/images/"+(j in c?"filteroff.gif":"filteroffdisabled.gif"),null,!(j in c));if(j in h)m(j);else{x=f.InsertMenuItem(d("LoadingMsg"),null,null,null,true);k=f;t(j,function(){ULSEWi:;if(!w&&!q){j in h&&m(j);f.SetOnMouseOut(null);f.Hide();g.Show(o,u)}})}}if(j==SP.JsGrid.RecordIndicatorCheckboxColumnKey){i();e(d("CheckAllRecords"),function(){ULSEWi:;b.GetCheckSelectionManager().CheckAllRecords()},null,null,false,false);e(d("ClearCheckedRecords"),function(){ULSEWi:;b.GetCheckSelectionManager().ClearCheckedRecords()},null,null,false,false)}!k.IsEmpty()&&k.Show(o,u);return !k.IsEmpty()};function s(){ULSEWi:;var a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(f){a="undefined"}var c=a&&SP.UI.ModalDialog.get_childDialog(),b=c&&c.get_url();(b==null||!document.URL.startsWith(b))&&e(d("ConfigureCols"),function(){ULSEWi:;j.paneMgr.ShowColumnConfigurationDialog()},"/_layouts/Images/configcolumns.png")}function m(b){ULSEWi:;function j(a){ULSEWi:;w(b,a.dataValue)}var f=h[b],k=c[b]===""?null:c[b];if(f.length!=0)for(var i=0;i<f.length;i++){var e=f[i];g.InsertMenuItem(e.displayString==null||e.displayString==""?SP.JsGrid.Res.autoFilterBlank:e.displayString,function(a){ULSEWi:;return function(){ULSEWi:;j(a)}}(e),null,null,false,b in c&&y[b].CompareSingleDataEqual(e.dataValue===""?null:e.dataValue,k))}else g.InsertMenuItem(d("FilterMenuItem"),function(){ULSEWi:;a.Apply(SP.JsGrid.DelegateType.LaunchFilterDialog,b)},"/_layouts/images/filter.gif")}function t(i,d){ULSEWi:;for(var f=j.jsGridObj.GetColumns(),e=[],b=0;b<f.length;b++){var g=f[b].columnKey;!(g in h)&&e.push(g)}a.Apply(SP.JsGrid.DelegateType.GetAutoFilterEntries,c,i,e,k,d);function k(a){ULSEWi:;for(var b in a)h[b]=a[b];d()}}function w(e,d){ULSEWi:;var b=SP.Internal.JS.CloneObj(c,false);b[e]=d;a.Apply(SP.JsGrid.DelegateType.AutoFilter,b);k.ClearCache()}function v(d){ULSEWi:;var b=SP.Internal.JS.CloneObj(c,false);delete b[d];a.Apply(SP.JsGrid.DelegateType.AutoFilter,b);k.ClearCache()}function n(a){ULSEWi:;delete h[a.fieldKey]}function o(){ULSEWi:;k.ClearCache()}function p(){ULSEWi:;k.ClearCache()}function e(h,a,e,b,c,d){ULSEWi:;f.InsertMenuItem(h,a,e,b,c,d);g.InsertMenuItem(h,a,e,b,c,d)}function l(){ULSEWi:;f.InsertSeparator();g.InsertSeparator()}function i(){ULSEWi:;!g.IsEmpty()&&l()}function r(c,b){ULSEWi:;a.Apply(SP.JsGrid.DelegateType.Sort,[{columnName:c,isDescending:b}])}z()};SP.JsGrid.CommandManager=function(o){ULSEWi:;var i=0,a=[],e=[],c=0,h=0,d=[],f=SP.JsGrid.CommandManager.CommandType,b,j,g=[];this.IsUndoEnabled=function(){ULSEWi:;return o>0};this.OpenGroup=function(){ULSEWi:;if(b)return;d.push([])};this.CloseGroup=function(f,g,c){ULSEWi:;if(b)return;var a=d.pop();if(a.length==0)return;var e=a.length==1?a[0]:new SP.JsGrid.CommandManager.AggregateCommand(a,c);m(e,f,g)};this.Execute=function(a,c,d){ULSEWi:;if(b){a.Apply();return}n();m(a,c,d);l();j=true;a.Apply();j=false};this.Undo=function(){ULSEWi:;if(i!=0||d.length>0||!c||b||j)return false;l();b=true;var g;do{g=a.pop();g.cmd.Undo();e.push(g)}while(g.type==f.Implicit);c--;h++;b=false;return true};this.Redo=function(){ULSEWi:;if(i!=0||d.length!=0||!h||b||j)return false;l();b=true;var g;do{g=e.pop();g.cmd.Apply();a.push(g)}while(g.type==f.Implicit);h--;c++;b=false;return true};this.CanUndo=function(){ULSEWi:;return c>0};this.CanRedo=function(){ULSEWi:;return h>0};this.GetUndoStack=function(){ULSEWi:;return a};this.GetRedoStack=function(){ULSEWi:;return e};this.ClearUndoStack=function(){ULSEWi:;p()};this.ClearRedoStack=function(){ULSEWi:;n()};this.Lock=function(){ULSEWi:;i++};this.Unlock=function(){ULSEWi:;i=Math.max(i-1,0)};this.AddPreExecuteNotifier=function(a){ULSEWi:;g.push(a)};this.RemovePreExecuteNotifier=function(c){ULSEWi:;for(var b=false,a=0;a<g.length;a++)if(g[a]==c){g.splice(a,1);a--;b=true;break}return b};function l(){ULSEWi:;for(var b=[].concat(g),a=0;a<b.length;a++)b[a]()}function p(){ULSEWi:;for(var b=0;b<a.length;b++)k(a[b].cmd,SP.JsGrid.CommandManager.DisposeState.Applied);a=[];c=0}function n(){ULSEWi:;if(e.length!=0){for(var a=e.length-1;a>=0;a--)k(e[a].cmd,SP.JsGrid.CommandManager.DisposeState.Unapplied);e=[];h=0}}function m(e,g,b){ULSEWi:;if(d.length!=0)d[d.length-1].push(e);else if(c!=0||b!=f.Implicit){a.push({cmd:e,name:g,type:b});c+=b!=f.Implicit?1:0;if(a.length>o){if(a[0].type!=f.Implicit)c--;k(a.shift().cmd,SP.JsGrid.CommandManager.DisposeState.Applied);while(a.length&&a[0].type==f.Implicit)k(a.shift().cmd,SP.JsGrid.CommandManager.DisposeState.Applied)}}}function k(a,b){ULSEWi:;a.Dispose!=null&&a.Dispose(b)}};SP.JsGrid.CommandManager.CommandType={Explicit:0,Implicit:1};SP.JsGrid.CommandManager.DisposeState={Applied:0,Unapplied:1};SP.JsGrid.CommandManager.AggregateCommand=function(b,a){ULSEWi:;this.cmdArray=b;this.bReverseOnUndo=a};SP.JsGrid.CommandManager.AggregateCommand.prototype={Apply:function(){ULSEWi:;for(var b=this.cmdArray.length,a=0;a<b;a++)this.cmdArray[a].Apply()},Undo:function(){ULSEWi:;var b=this.cmdArray.length,a;if(this.bReverseOnUndo)for(a=b-1;a>=0;a--)this.cmdArray[a].Undo();else for(a=0;a<b;a++)this.cmdArray[a].Undo()},Dispose:function(c){ULSEWi:;for(var d=this.cmdArray.length,a=0;a<d;a++){var b=this.cmdArray[a];b.Dispose!=null&&b.Dispose(c)}}};SP.JsGrid.DeserializationMode={Full:0,TableView:1,RowView:2,Slice:3,AutoFilter:4};SP.JsGrid.SelectionTypeFlags={NoRows:0,SingleRow:1,SingleRowRange:3,MultipleRowRanges:7,_RowMask:7,NoCols:0,SingleCol:8,SingleColRange:24,MultipleColRanges:56,_ColMask:56,NoCells:0,SingleCell:64,SingleCellRange:192,MultipleCellRanges:448,_CellMask:448};SP.JsGrid.LinkType={FinishFinish:0,FinishStart:1,StartFinish:2,StartStart:3};SP.JsGrid.ClickContext={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3,Gantt:4,Other:5};SP.JsGrid.SelectionType={None:0,CellRange:1,RowRange:2,ColumnRange:3};SP.JsGrid.EventType={OnCellFocusChanged:0,OnRowFocusChanged:1,OnCellEditBegin:2,OnCellEditCompleted:3,OnRightClick:4,OnPropertyChanged:6,OnRecordInserted:7,OnRecordDeleted:8,OnRecordChecked:9,OnCellErrorStateChanged:10,OnEntryRecordAdded:11,OnEntryRecordCommitted:13,OnEntryRecordPropertyChanged:14,OnRowErrorStateChanged:15,OnDoubleClick:16,OnBeforeGridDispose:17,OnSingleCellClick:18,OnInitialChangesForChangeKeyComplete:19,OnVacateChange:20,OnGridErrorStateChanged:21,OnSingleCellKeyDown:22};SP.JsGrid.Internal.EventType={OnRowHeaderStateChanged:0,OnGridDisposing:1,OnChangeKeyCreated:2,OnChangeKeyInitialUpdateFinished:3,OnBeforeRecordInserted:4,OnBeforeRecordDeleted:5};SP.JsGrid.DelegateType={ExpandColumnMenu:1,AddColumnMenuItems:2,Sort:3,Filter:4,InsertRecord:5,DeleteRecords:6,IndentRecords:7,OutdentRecords:8,IsRecordInsertInView:9,ExpandDelayLoadedHierarchyNode:10,AutoFilter:11,ExpandConflictResolution:12,GetAutoFilterEntries:13,LaunchFilterDialog:14,ShowColumnConfigurationDialog:15,GetRecordEditMode:16,GetGridRowStyleId:17,CreateEntryRecord:18,TryInsertEntryRecord:19,WillAddColumnMenuItems:20};SP.JsGrid.Internal.DelegateType={CallAsyncFn:0,GetLocalizedString:1,DoLargeTask:2};SP.JsGrid.Internal.LoadErrorState={};SP.JsGrid.OperationalConstants={HierarchyMain:0,HierarchyOutlineLevel:1,GroupingOutlineLevel:2,HierarchyDescendantCount:3,GroupingDescendantCount:4,GanttDependants:5,GanttBarStyleIds:6,GridRowStyleId:7,RecordEditMode:8};SP.JsGrid.Internal.MinColumnWidth=37;SP.JsGrid.Internal.RowHeaderWidth=25;SP.JsGrid.Internal.SplitterWidth=6;SP.JsGrid.RecordIndicatorCheckboxColumnKey="JsGridRecordIndicatorCheckboxes";SP.JsGrid.NewRowKeyPrefix="NewRowKey";SP.JsGrid.ErrorWidgetId="ErrorWidget";SP.JsGrid.RecordIndicatorControlId="DISP_RECORDINDICATORCHECKBOX";SP.JsGrid.HierarchyControlId="DISP_HIERARCHY";SP.JsGrid.TextDirection={Default:0,RightToLeft:1,LeftToRight:2};SP.JsGrid.PaneId={MainGrid:0,PivotedGrid:1,Gantt:2};SP.JsGrid.PaneLayout={GridOnly:0,GridAndGantt:1,GridAndPivotedGrid:2};SP.JsGrid.EditMode={ReadOnly:0,ReadWrite:1,ReadOnlyDefer:2,ReadWriteDefer:3,Defer:4};SP.JsGrid.GanttDrawBarFlags={LeftLink:1,RightLink:2};SP.JsGrid.GanttBarDateType={Start:0,End:1};SP.JsGrid.ValidationState={Valid:0,Pending:1,Invalid:2};SP.JsGrid.HierarchyMode={None:0,Standard:1,Grouping:2};SP.JsGrid.EditActorWriteType={Both:1,LocalizedOnly:2,DataOnly:3,Either:4};SP.JsGrid.EditActorReadType={Both:1,LocalizedOnly:2,DataOnly:3};SP.JsGrid.EditActorUpdateType={Committed:0,Uncommitted:1};SP.JsGrid.SortMode={Ascending:1,Descending:-1,None:0};SP.JsGrid.RowHeaderStyleId={Transfer:"Transfer",Conflict:"Conflict"};SP.JsGrid.RowHeaderAutoStyleId={Dirty:"Dirty",Error:"Error",NewRow:"NewRow"};SP.JsGrid.RowHeaderStatePriorities={Dirty:10,Transfer:30,CellError:40,Conflict:50,RowError:60,NewRow:90};SP.JsGrid.UpdateSerializeMode={Cancel:0,Default:1,PropDataOnly:2,PropLocalizedOnly:3,PropBoth:4};SP.JsGrid.UpdateTrackingMode={PropData:2,PropLocalized:3,PropBoth:4};SP.JsGrid.PostViewChangeType={Delete:4,Insert:5,Level:6};SP.JsGrid.ContextMenu=function(f,c){ULSEWi:;var b,a,e=0,d=[],g=this;this.GetMenuElement=function(){ULSEWi:;return a};this.EnableCompactMode=function(){ULSEWi:;a.setAttribute("CompactMode","true")};this.IsOpen=function(){ULSEWi:;return MenuHtc_isOpen(a)};this.IsEmpty=function(){ULSEWi:;return e==0};this.InsertMenuItem=function(g,h,k,f,i,j){ULSEWi:;d.push(h);var b=new SP.JsGrid.MenuItem(CAMOpt(a,g,c+"_onclick("+(d.length-1)+");",k,f!=null?f:g));b.Enable(!i);b.Check(j);e++;return b};this.InsertSeparator=function(){ULSEWi:;CAMSep(a)};this.Hide=function(){ULSEWi:;this.IsOpen()&&MenuHtc_hide()};this.SetOnMouseOut=function(b){ULSEWi:;a._onDestroy=function(){ULSEWi:;g.Dispose();b!=null&&b()}};this.Show=function(c,d){ULSEWi:;this.Hide();b.style.top=c.top+"px";b.style.left=c.left+"px";b.style.width=c.width+"px";b.style.height=c.height+"px";OMenu(a,b,false,false,0);NavigateToMenu(a);this.SetOnMouseOut(d)};this.Refresh=function(){ULSEWi:;this.IsOpen()&&OMenu(a,b,true,false,0)};this.Dispose=function(){ULSEWi:;this.Hide();a._onDestroy=null;if(b!=null&&SP.Internal.DomElement.GetParentElement(b)){b.parentNode.removeChild(b);b=null}if(a!=null&&SP.Internal.DomElement.GetParentElement(a)){a.parentNode.removeChild(a);a=null}window[c+"_onclick"]=null};function h(){ULSEWi:;a=CMenu(c);b=document.createElement("div");b.style.cssText="position:absolute;visibility:hidden";f.appendChild(b);window[c+"_onclick"]=function(a){ULSEWi:;setTimeout(d[a],0)}}h()};SP.JsGrid.MenuItem=function(a){ULSEWi:;this.Enable=function(b){ULSEWi:;a.setAttribute("enabled",b)};this.Check=function(b){ULSEWi:;a.setAttribute("checked",b)}};Type.registerNamespace("SP.JsGrid.DisplayControl");SP.JsGrid.DisplayControl=function(){ULSEWi:;function d(c,f,e,b,d){ULSEWi:;if(c==null)return null;var a=(new SP.JsGrid.Image(c,false)).Render(f,e);if(b)a.className=b;a.style.border="0px";return d?a:{elem:a,fnDispose:function(){ULSEWi:;if(a!=null&&a.Dispose!=null){a.Dispose();a=null}}}}function f(d,c,g,f,h){ULSEWi:;if(d==""||d==null||d==SP.JsGrid.EmptyValue||d==SP.JsGrid.InvalidValue)return null;var b=document.createElement("span"),a;if(c.fnClick!=null){a=document.createElement("a");a.style.cssText=h;b.appendChild(a);a.href="#";$addHandler(a,"click",function(a){ULSEWi:;c.fnClick(a)});$addHandler(a,"keydown",function(a){ULSEWi:;if(a.keyCode==Sys.UI.Key.enter){c.fnClick(a);SP.Internal.DomElement.StopEvent(a)}});a.tabIndex=-1}else a=b;SP.Internal.DomElement.SetTextNoBR(a,d);if(c.toolTip!=null)a.title=c.toolTip;if(f)b.className=f;if(g.textDirection!=SP.JsGrid.TextDirection.Default)b.dir=g.textDirection==SP.JsGrid.TextDirection.RightToLeft?"rtl":"ltr";var e=b;if(c.fnClick!=null)e={elem:b,fnDispose:function(){ULSEWi:;$clearHandlers(a);a=b=e=null}};return e}function e(d,e,c){ULSEWi:;var b=document.createElement("div");b.style.cssText="text-align:center";var a=document.createElement("input");a.type="checkbox";a.tabIndex=-1;b.appendChild(a);a.disabled=d;a.checked=e;if(c!=null){$addHandler(a,"mousedown",function(a){ULSEWi:;SP.Internal.DomElement.StopEvent(a)});$addHandler(a,"click",c)}b={elem:b};b.fnDispose=function(){ULSEWi:;b=null;$clearHandlers(a);a=null};return b}function a(e,c,f,b,g,a){ULSEWi:;if(b!=null&&b.bHyperlink)return function(){ULSEWi:;window.open(b.GetAddress(a))};var d=c.fnShouldLinkSingleValue!=null&&c.fnShouldLinkSingleValue(e,f.key,a,g)&&c.fnSingleValueClicked;return d?function(){ULSEWi:;d(e,f.key,a)}:null}function j(e,c,f,a,d){ULSEWi:;var b=c.fnGetSingleValueTooltip==null?null:c.fnGetSingleValueTooltip(e,f.key,d,a);return b==null?a:b}function b(e,d,f,g,b,c){ULSEWi:;var i=j(e,d,f,b,c),h=a(e,d,f,g,b,c);return {toolTip:i,fnClick:h}}function h(k,i,l,h,e,g,j,f){ULSEWi:;var a=b(k,i,l,h,e,g),c=d(j,a.toolTip,a.fnClick,f);return c==null?[]:[c]}function i(l,k,d,j,a,i,m,h,e){ULSEWi:;var g=b(l,k,d,j,a,i),c=f(a,g,d,h,e);return c==null?[]:[c]}function g(p,n,j,m,e,l,o,g,k){ULSEWi:;var a=b(p,n,j,m,e,l),h=d(o,a.toolTip,a.fnClick,g),i=f(e,a,j,g,k),c=[];h!=null&&c.push(h);i!=null&&c.push(i);return c}function c(d,g,k,l,a,p,h,m,o,i){ULSEWi:;var c=[],f=a.GetImageSource?a.GetImageSource(g,d.data):null,j=o.bEnabled?"jsgrid-control-text-rtl":"jsgrid-control-text";if(a.bMultiValue)for(var e=a.LocStrToLocStrArray(d.localized),b=0;b<e.length;b++){var n=b<e.length-1&&m?e[b]+a.separator:e[b];c=c.concat(h(g,k,l,a.singleValuePropType,n,d.data?d.data[b]:null,f?f[b]:null,j,i))}else c=h(g,k,l,a,d.localized,d.data,f,j,i);return c.length==1?c[0]:c.length==0?null:{multipleChildren:c}}return {ImageDisplayControl:{Id:"DISP_IMAGE",Render:function(g,d,b,e,a,f,j,i){ULSEWi:;return c(g,d,b,e,a,f,h,false,i)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},ImageTextDisplayControl:{Id:"DISP_IMAGETEXT",_styleForLinks:null,Render:function(h,d,b,e,a,f,j,i){ULSEWi:;return c(h,d,b,e,a,f,g,true,i,this._styleForLinks)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},TextDisplayControl:{Id:"DISP_TEXT",_styleForLinks:null,Render:function(g,d,b,e,a,f,j,h){ULSEWi:;return c(g,d,b,e,a,f,i,true,h,this._styleForLinks)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},CheckboxDisplayControl:{Id:"DISP_CHECKBOX",Render:function(d,c,f,g,b,h,a){ULSEWi:;return a.IsGroupingRecordKey(c.key())?null:e(false,b.GetBool(d.data),null)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}},RecordIndicatorCheckboxControl:function(f,a,d,b,c){ULSEWi:;this.Id=f+SP.JsGrid.RecordIndicatorControlId;this.Render=function(n,h){ULSEWi:;var f=h.key();function g(){ULSEWi:;a(f)}return d(f)?null:e(b(f),c(f),g)};this.OnKeyDown=function(b,g,c){ULSEWi:;if(b.keyCode==Sys.UI.Key.space||b.charCode==Sys.UI.Key.space){a(c.key());SP.Internal.DomElement.StopEvent(b);return true}return false};this.FocusNext=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)};this.FocusPrevious=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}},HierarchyDisplayControl:function(k,m,c,f,e,i,h){ULSEWi:;var b=SP.JsGrid.Internal.HierarchyManager.NodeType,g=13,l=4,j=4;this.Id=k+SP.JsGrid.HierarchyControlId;this.Render=function(A,o,q,r,y,w,x,s){ULSEWi:;var p=o.key(),k=c(o),z=k.nodeType==b.Expanded?"/_layouts/Images/minus.gif":k.nodeType==b.Collapsed?"/_layouts/Images/plus.gif":null,a=i(q,o,r.key,w,h(q,o,r.key));if(k.nodeType!=b.Leaf){var l=d(k.nodeType==b.Expanded?"/_layouts/Images/minus.gif":"/_layouts/Images/plus.gif",String.format(k.nodeType==b.Expanded?SP.JsGrid.Res.hierarchyExpanded:SP.JsGrid.Res.hierarchyCollapsed,(k.indent+1).toString()),k.nodeType==b.Expanded?t:u,null,true);l.style["margin"+s.Left]=g*k.indent+j+"px";l.width=9;l.height=9;var n=[{elem:l,fnDispose:v}];if(a!=null&&a.multipleChildren!=null)n=n.concat(a.multipleChildren);else a!=null&&n.push(a);return {multipleChildren:n}}else{if(a!=null){var m=a.multipleChildren!=null?a.multipleChildren[0]:a;if(m.elem!=null)m=m.elem;m.style["margin"+s.Left]=g*(k.indent+1)+"px"}return a}function v(){ULSEWi:;l.Dispose!=null&&l.Dispose();l=null;m=null;n=null}function u(){ULSEWi:;f(p)}function t(){ULSEWi:;e(p)}};this.OnKeyDown=function(d,j,g,m,n,i){ULSEWi:;function h(h){ULSEWi:;var a=c(g);if(h&&a.nodeType==b.Collapsed)f(g.key());else!h&&a.nodeType==b.Expanded&&e(g.key());SP.Internal.DomElement.StopEvent(d)}function k(){ULSEWi:;if(i.bMultiValue)return false;var c=d.ctrlKey&&!d.altKey&&!d.shiftKey;if(c&&d.keyCode==Sys.UI.Key.enter){var b=a(g,m,n,i,j.localized,j.data);if(b!=null){b(d);SP.Internal.DomElement.StopEvent(d);return true}}return false}var l=!d.ctrlKey&&d.altKey&&d.shiftKey;if(l)if(d.keyCode==SP.Internal.Key.plus||d.keyCode==SP.Internal.Key.numpad_plus){h(true);return true}else if(d.keyCode==SP.Internal.Key.minus||d.keyCode==SP.Internal.Key.numpad_minus){h(false);return true}return k()};this.FocusNext=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)};this.FocusPrevious=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}}}}();SP.JsGrid.DisplayControl.Type={Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX"};Type.registerNamespace("SP.JsGrid.EditControl");SP.JsGrid.EditControl={ProxyControl:function(a){ULSEWi:;var b=SP.Internal.JS.object(a),g=false,d=false,c=false,e=false;function f(){ULSEWi:;e=true}b.Dispose=function(){ULSEWi:;e=false;a.Dispose.apply(this,arguments)};b.BindToCell=function(){ULSEWi:;d=true;a.BindToCell.apply(this,arguments)};b.Unbind=function(){ULSEWi:;d=false;a.Unbind.apply(this,arguments)};b.OnBeginEdit=function(){ULSEWi:;c=true;a.OnBeginEdit.apply(this,arguments)};b.OnEndEdit=function(){ULSEWi:;c=false;a.OnEndEdit.apply(this,arguments)};f();return b},EditBoxEditControl:function(c,f){ULSEWi:;var n="jsgrid_editbox",a,k=this,l=c.parentNode,d=f!=null,e=false,b;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;function m(){ULSEWi:;if(d)a=f;else{a=document.createElement("input");a.id=n;a.type="text";a.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;";a.className="jsgrid-control-editbox";a.tabIndex=-1;l.appendChild(a)}a.style.direction=c.RTL.ltr}this.Dispose=function(){ULSEWi:;!d&&$clearHandlers(a)};this.Focus=function(e){ULSEWi:;try{if(e==null){a.focus();a.value=a.value}else if(d){c.OnActivateActor();(e.type=="mousedown"||e.type=="keydown"&&e.keyCode==SP.Internal.Key.F2)&&f()}else{a.focus();if(e.type=="mousedown"||e.type=="keydown"&&e.keyCode==SP.Internal.Key.F2)f();else if(SP.JsGrid.Utility.IsChar(e)){a.value=String.fromCharCode(e.charCode);b.SetCurrentValue({localized:a.value})}}}catch(g){}function f(){ULSEWi:;var c=b.originalValue.localized;a.value=c==null||c==SP.JsGrid.EmptyValue?"":c}};this.BindToCell=function(c){ULSEWi:;b=c;i();if(b.field.textDirection!=SP.JsGrid.TextDirection.Default)a.style.direction=b.field.textDirection==SP.JsGrid.TextDirection.RightToLeft?"rtl":"ltr";a.value=""};this.OnBeginEdit=function(c){ULSEWi:;b.Show(a);e=true;g(true);if(c.type=="mousedown"&&!d)setTimeout(function(){ULSEWi:;k.Focus(c)},0);else k.Focus(c)};this.Unbind=function(){ULSEWi:;a.value=""};this.OnEndEdit=function(){ULSEWi:;var c=b.originalValue.localized;c=c==null||c==SP.JsGrid.EmptyValue?"":c;a.value!=c&&b.SetCurrentValue({localized:a.value});g(false);b.Hide(a);e=false};this.OnCellMove=function(){ULSEWi:;i();e&&b.Show(a)};this.OnValueChanged=function(b){ULSEWi:;a.value=b.localized==null||b.localized==SP.JsGrid.EmptyValue?"":b.localized};function g(b){ULSEWi:;if(b){$addHandler(a,"focus",c.OnActivateActor);$addHandler(a,"blur",c.OnDeactivateActor);!d&&$addHandler(a,"keydown",c.OnKeyDown);$addHandler(a,"keyup",j);$addHandler(a,"mousedown",h)}else{$removeHandler(a,"focus",c.OnActivateActor);$removeHandler(a,"blur",c.OnDeactivateActor);!d&&$removeHandler(a,"keydown",c.OnKeyDown);$removeHandler(a,"keyup",j);$removeHandler(a,"mousedown",h)}}function j(){ULSEWi:;b.SetCurrentValue({localized:a.value})}function i(){ULSEWi:;a.style.width=b.cellWidth-8+"px";a.style.height=b.cellHeight-4+"px"}function h(a){ULSEWi:;a.stopPropagation()}m()},ComboBoxEditControl:function(c){ULSEWi:;var p="jsgrid_combobox",b,d,i=this,k="sentinel",g,j,n=c.parentNode,a,t=true,h,l=[],e;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;function x(){ULSEWi:;d=document.createElement("div");d.id=p;d.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;left:0px;background-color:transparent;";d.style.direction=c.RTL.ltr;n.appendChild(d)}this.Dispose=function(){ULSEWi:;n.removeChild(d)};this.BindToCell=function(g){ULSEWi:;a=g;var e=new SP.UI.ComboBox.SPComboInfo;e.set_itemFocusCallback(r);e.set_multipleSelect(a.propType.bMultiValue);e.set_allowMultiEdits(true);e.set_limitToList(a.propType.bMultiValue||a.propType.GetIsLimitedToList!=null&&a.propType.GetIsLimitedToList());e.set_RTL(c.RTL.bEnabled);e.set_getDataCallback(w);e.set_separatorCharacters(a.propType.separator+" ");e.set_columnCount(2);e.set_columnWidths("0px;1px");e.set_expandSpace(a.cellExpandSpace);e.set_listMaxWidth(200);b=SP.UI.ComboBox.ComboBox.createComboBox(p,k,e);e.set_dropdownStateCallback(q);b.add_valueUpdatedEvent(u);b.add_focusEvent(c.OnActivateActor);b.add_blurEvent(c.OnDeactivateActor);m();f(a.originalValue);$addHandler(d,"keydown",o)};this.Unbind=function(){ULSEWi:;i.OnEndEdit();$removeHandler(d,"keydown",o);a.Hide(d);h=false;b.dispose();while(l.length>0)l.shift()();e=null};this.Expand=function(){ULSEWi:;b.openDropdown();b.get_focusElement().focus()};this.Collapse=function(){ULSEWi:;b.closeDropdown()};this.OnBeginEdit=function(a){ULSEWi:;if(a!=null)if(SP.JsGrid.Utility.IsChar(a)){j=true;i.Expand();b.set_displayText(String.fromCharCode(a.charCode))}else if(a.type=="keydown")if(a.keyCode==SP.Internal.Key.F2){i.Expand();b.set_displayText(b.get_displayText())}else if(a.keyCode==SP.Internal.Key.IMEInput){i.Expand();b.set_displayText("")}};this.OnEndEdit=function(){ULSEWi:;b.commit();b.closeDropdown()};this.OnCellMove=function(){ULSEWi:;b.closeDropdown();m()};this.OnValueChanged=function(a){ULSEWi:;f(a)};function m(){ULSEWi:;d.style.width=a.cellWidth+"px";d.style.height=a.cellHeight+"px";b.get_comboInfo().set_listMaxWidth(Math.max(200,a.cellWidth));a.Show(d);b.notifySetLayout()}function o(d){ULSEWi:;if(d.keyCode==Sys.UI.Key.esc){g=true;setTimeout(function(){ULSEWi:;c.OnKeyDown(d);b.set_currentValue(k);f(a.originalValue);g=false},0)}else c.OnKeyDown(d)}function u(){ULSEWi:;if(g)return;var b=s();if(b){a.SetCurrentValue(b);h=true}}function q(b){ULSEWi:;if(g)return;t=!b;c.bLightFocus=!b;if(b)a.NotifyExpandControl();else if(h){a.NotifyEditComplete();h=false}}function r(b,c){ULSEWi:;var a;if(b!=null){a=b.childNodes[b.childNodes.length-1].firstChild;a.style.backgroundColor=a.origBackgroundColor||""}if(c!=null){a=c.childNodes[c.childNodes.length-1].firstChild;var d=a.origBackgroundColor?SP.JsGrid.Internal.Color.HexStringToColor(a.origBackgroundColor):SP.JsGrid.Internal.Color.MakeColor(1,1,1),e=SP.JsGrid.Internal.Color.MakeAlphaColor(.4,.55,.69,.87);a.style.backgroundColor=SP.JsGrid.Internal.Color.ColorToHexString(SP.JsGrid.Internal.Color.RemoveAlphaChannel(SP.JsGrid.Internal.Color.AlphaBlend(e,d)))}}function v(b,d){ULSEWi:;var c={};if(b.HasDataValue(d))c.data=b.GetData(d);if(b.HasLocalizedValue(d))c.localized=b.GetLocalized(d);if(b.propType!=null&&b.propType.GetDisplayValue!=null)c.localized=b.propType.GetDisplayValue(a.record,c.data,c.localized);return c}function w(b){ULSEWi:;e=[];a.propType.GetItems(g);function d(a,b){ULSEWi:;if(a.fnDispose!=null){l.push(a.fnDispose);a=a.elem}b.appendChild(a)}function g(m){ULSEWi:;if(m==null)b(null,null,false,true);else{var i=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(a.propType);if(a.propType.IsComboBoxTextOnly)i=SP.JsGrid.Internal.Property.GetDisplayControl(SP.JsGrid.DisplayControl.Type.Text);else if(i.Id==SP.JsGrid.DisplayControl.Type.Image)i=SP.JsGrid.Internal.Property.GetDisplayControl(SP.JsGrid.DisplayControl.Type.ImageText);for(var s=a.propType.singleValuePropType||a.propType,o=[],q=[],l=0;l<m.length;l++){var k=v(m[l],a.fieldKey),p=document.createElement("div"),g=document.createElement("div");g.style.cssText="white-space:nowrap;padding:4px";p.appendChild(g);var h=i.Render(k,a.record,a.column,a.field,s,{},c.jsGridObj,c.RTL);if(h!=null)if(h.multipleChildren!=null){c.RTL.bEnabled&&h.multipleChildren.reverse();for(var n=0;n<h.multipleChildren.length;n++)d(h.multipleChildren[n],g)}else d(h,g);if(a.propType.GetStyleId!=null){var r=a.propType.GetStyleId(k.data);if(r!=null){SP.JsGrid.Style.ApplyCellStyle(g,c.styleManager.GetCellStyle(r));g.origBackgroundColor=SP.Internal.DomElement.GetComputedStyle(g,"backgroundColor","background-color")}}e.push(k);o.push([l+1,k.localized]);q.push([document.createElement("div"),p])}b(o,q,false,false)}if(!j)f(a.originalValue);else j=false}}function s(){ULSEWi:;var c=b.get_currentValue();if(c==k)return null;if(a.propType.bMultiValue){if(c!=null);for(var i=[],g=[],h=c.split(";#"),f=0;f<h.length;f++){var d=h[f];if(d!=""){i.push(e[d-1].data);g.push(e[d-1].localized)}}return {data:i,localized:g.join(a.propType.separator)}}else if(c==null||c==""){var j=b.get_displayText();return {localized:j}}else{var d=c;return {data:e[d-1].data,localized:e[d-1].localized}}}function f(c){ULSEWi:;if(e==null){b.set_displayText(c.localized==null?"":c.localized);return}var h=[],d=c.data!=SP.JsGrid.EmptyValue,l=a.propType.bMultiValue?a.propType.singleValuePropType:a.propType,f;if(a.propType.bMultiValue){var g=d?c.data:a.propType.LocStrToLocStrArray(c.localized);if(g!=null)for(var i=0;i<g.length;i++)h.push(j(g[i]))}else{var k=j(d?c.data:c.localized);if(k!=null)h.push(k);else f=c.localized}b.set_currentValue(h.join(";#"));f!=null&&b.set_displayText(f);function j(a){ULSEWi:;var b;if(a!=null)b=SP.Internal.JS.FindInArray(e,d?f:c);return b==null?null:b+1;function f(b){ULSEWi:;var c=l.IsDataEqual;return c==null?b.data==a:c(b.data,a)}function c(b){ULSEWi:;return b.localized==a}}}x()},CheckboxEditControl:function(d){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.DataOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.DataOnly;var l=this,j=d.parentNode,b,c,a,g=false,e=null,h=false;function k(){ULSEWi:;d.bLightFocus=true;c=document.createElement("div");c.style.cssText="position:absolute;top:0px;left:0px;visibility:hidden;text-align:center;background-color:#ffffff;";j.appendChild(c);a=document.createElement("input");a.type="checkbox";a.tabIndex=-1;c.appendChild(a);$addHandler(a,"focus",d.OnActivateActor);$addHandler(a,"blur",d.OnDeactivateActor);$addHandler(document.body,"mouseup",function(i){ULSEWi:;if(g&&!h&&e!=null){var d=SP.Internal.DomElement.GetLocation(a),c=SP.Internal.DomElement.GetEventLocation(i);if(SP.Internal.DomElement.PointInDomElem(c.x,c.y,a,d)&&SP.Internal.DomElement.PointInDomElem(e.x,e.y,a,d)){a.checked=!b.propType.GetBool(b.originalValue.data);f()}}h=false});$addHandler(document.body,"mousedown",function(b){ULSEWi:;var a=SP.Internal.DomElement.GetEventLocation(b);e={x:a.x,y:a.y}});$addHandler(c,"mousedown",function(){ULSEWi:;h=true});$addHandler(c,"focus",function(){ULSEWi:;a.focus()})}this.Dispose=function(){ULSEWi:;$clearHandlers(c);$clearHandlers(a);j.removeChild(c)};this.BindToCell=function(c){ULSEWi:;b=c;g=true;i();a.checked=b.propType.GetBool(b.originalValue.data);$addHandler(a,"keydown",d.OnKeyDown);$addHandler(a,"click",f)};this.OnCellMove=function(){ULSEWi:;i()};function i(){ULSEWi:;c.style.width=b.cellWidth+"px";var d=Math.floor((b.cellHeight-a.clientHeight)/2);c.style.padding=d+"px 0px 0px 0px";c.style.height=b.cellHeight-d+"px";b.Show(c)}this.Unbind=function(){ULSEWi:;g=false;$removeHandler(a,"keydown",d.OnKeyDown);$removeHandler(a,"click",f);b.Hide(c)};this.OnEndEdit=function(){};this.OnValueChanged=function(){ULSEWi:;a.checked=b.propType.GetBool(b.originalValue.data)};this.OnKeyDown=function(b){ULSEWi:;if(b.keyCode==Sys.UI.Key.space||b.charCode==Sys.UI.Key.space){a.checked=!a.checked;f();SP.Internal.DomElement.StopEvent(b);return true}return false};this.OnBeginEdit=function(){ULSEWi:;a.focus()};this.OnEndEdit=function(){};function f(){ULSEWi:;b.SetCurrentValue({data:a.checked});b.NotifyEditComplete()}k()}};SP.JsGrid.EditControl.Type={EditBox:"EDIT_EDITBOX",ComboBox:"EDIT_COMBOBOX",Checkbox:"EDIT_CHECKBOX"};Type.registerNamespace("SP.JsGrid.WidgetControl");SP.JsGrid.WidgetControl={DemoWidget:function(d){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;var g=this,e=d.parentNode,b,a,c;function f(){ULSEWi:;a=document.createElement("div");a.id="mainDiv";a.style.cssText="position:absolute; top:0px;left:0px; visibility:hidden; font-size:10; background-color:#ffffff; line-height:100px; border:4px solid:#333333; height:100px; width:200px; overflow-x:hidden;";e.appendChild(a)}this.Dispose=function(){ULSEWi:;$clearHandlers(a);e.removeChild(a)};this.BindToCell=function(d){ULSEWi:;b=d;a.innerText=b.originalValue.localized==SP.JsGrid.EmptyValue?"":b.originalValue.localized;c=a.offsetHeight};this.Unbind=function(){};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error")).Render(SP.JsGrid.Res.openErrorWidget)};this.Collapse=function(){ULSEWi:;a.style.visibility="hidden";b.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;b.NotifyExpandWidget();var e=b.cellRect;a.style.top=(b.cellExpandSpace.bottom>c||b.cellExpandSpace.top<c?e.y+e.height+3:e.y-c-3)+"px";a.style.left=e.x-(d.RTL.bEnabled?a.offsetWidth-e.width:2)+"px";a.style.visibility=""};this.OnValueChanged=function(b){ULSEWi:;a.innerText=b.localized};f()},ErrorWidget:function(e,i){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var g=SP.JsGrid.ErrorWidgetId,k=this,h=e.parentNode,b,a,c,f,d;function j(){ULSEWi:;e.bLightFocus=true;a=document.createElement("div");a.id=g+"_mainDiv";a.style.cssText="z-index:1;visibility:hidden; font-size:10; position:absolute; top:0px;left:0px; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important";h.appendChild(a);c=document.createElement("input");c.id=g+"_focuselem";c.style.cssText="position:fixed;top:0px;left:-10px;height:0px;width:0px;";c.setAttribute("role","presentation");a.appendChild(c);f=document.createElement("span");f.id=g+"_errorSpan";a.appendChild(f)}this.Dispose=function(){ULSEWi:;h.removeChild(a)};this.BindToCell=function(c){ULSEWi:;b=c;$addHandler(a,"keydown",e.OnKeyDown)};this.Unbind=function(){ULSEWi:;$clearHandlers(a)};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error")).Render(SP.JsGrid.Res.openErrorWidget)};this.Collapse=function(){ULSEWi:;a.style.visibility="hidden";b.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;SP.Internal.DomElement.SetText(f,i.GetMessageForCell(b.record.key(),b.fieldKey));d=a.offsetHeight;var g=b.cellRect;a.style.top=(b.cellExpandSpace.bottom>d||b.cellExpandSpace.top<d?g.y+g.height+3:g.y-d-3)+"px";a.style.left=g.x-(e.RTL.bEnabled?a.offsetWidth-g.width:2)+"px";b.NotifyExpandWidget();a.style.visibility="";c.focus()};this.OnValueChanged=function(){};j()},DateWidget:function(h){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;var e=h.parentNode,c,a,d,b,g=200,k=this,f;function l(){ULSEWi:;a=document.createElement("input");a.id="datewidgetinput-"+e.id;a.style.cssText="display:none;position:absolute;top:0px;left:0px";a.onvaluesetfrompicker=j;a.tabIndex=-1;e.appendChild(a);d=document.createElement("div");d.id=a.id+g_strDatePickerImageID;d.style.cssText="position:absolute;background:transparent;visibility:hidden;height:0px;z-index:-1";e.appendChild(d);b=document.createElement("iframe");b.id=a.id+g_strDatePickerFrameID;b.src="/_layouts/images/blank.gif";b.frameBorder="0";b.scrolling="no";b.title=SP.JsGrid.Res.calendarTitle;b.style.cssText="display:none;position:absolute;width:200px;z-index:1";b.tabIndex=-1;e.appendChild(b);if(window.g_strDateTimeControlIDs==null)g_strDateTimeControlIDs=[];g_strDateTimeControlIDs["JsGridDatePicker"]=a.id}this.Dispose=function(){ULSEWi:;a.onvaluesetfrompicker=null;e.removeChild(a);e.removeChild(d);e.removeChild(b)};this.BindToCell=function(a){ULSEWi:;c=a;f=c.originalValue.localized==SP.JsGrid.EmptyValue?"":c.originalValue.localized};this.Unbind=function(){ULSEWi:;f=null};this.Expand=function(){ULSEWi:;var e=c.cellRect;if(e!=null){d.style.width=e.width+"px";d.style.top=(c.cellExpandSpace.bottom>g||c.cellExpandSpace.top<g?e.y+e.height+3:e.y-g-3)+"px";d.style.left=e.x-(h.RTL.bEnabled?d.offsetWidth-e.width:2)+"px";d.style.visibility="";a.value=f!=null?f:"";c.NotifyExpandWidget();clickDatePicker(a.id,i(),a.value);var j=b.resultfunc;b.resultfunc=function(a){ULSEWi:;a==null&&c.NotifyEditComplete(true);k.Collapse();j(a)}}};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/calendar.gif")).Render(SP.JsGrid.Res.openCalendar)};this.Collapse=function(){ULSEWi:;b.style.display="none";c.NotifyCollapseWidget()};this.OnValueChanged=function(a){ULSEWi:;f=a.localized};function j(){ULSEWi:;c.SetCurrentValue({localized:a.value});c.NotifyEditComplete()}function i(){ULSEWi:;return [SP.Utilities.Utility.getLayoutsPageUrl("iframe.aspx?"),"&cal=",_spRegionalSettings.calendarType,"&lcid=",_spRegionalSettings.localeId,"&langid=",_spPageContextInfo.currentLanguage,"&tz=",_spRegionalSettings.timeZoneOffset,"&ww=",_spRegionalSettings.workDays,"&fdow=",_spRegionalSettings.firstDayOfWeek,"&fwoy=",_spRegionalSettings.firstWeekOfYear,"&hj=",_spRegionalSettings.adjustHijriDays,"&swn=",_spRegionalSettings.showWeeks,"&minjday=109207","&maxjday=2666269","&date="].join("")}l()},AddressBookWidget:function(){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var b,f=this,a;function d(){}this.Dispose=function(){};this.BindToCell=function(a){ULSEWi:;_cellContext=a;b=_cellContext.originalValue.localized==SP.JsGrid.EmptyValue?"":_cellContext.originalValue.localized};this.Unbind=function(){};this.Expand=function(){ULSEWi:;_cellContext.NotifyExpandWidget();var e=(_cellContext.propType.bMultiValue?_cellContext.propType.singleValuePropType:_cellContext.propType).GetPeoplePickerUrl,d=e(_cellContext.fieldKey),b="resizable: yes; status: no; scroll: no; help: no; center: yes; dialogWidth: 575px; dialogHeight: 500px;";commonShowModalDialog(d,b,c);a=true};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/addressbook.gif")).Render(SP.JsGrid.Res.openAddressBook)};this.Collapse=function(){};this.OnValueChanged=function(a){ULSEWi:;b=a.localized==SP.JsGrid.EmptyValue?"":a.localized};function c(e){ULSEWi:;a=false;if(e==null)_cellContext.NotifyEditComplete(true);else{for(var h=SP.Internal.DomElement.GetXmlDomObj(e),d=h.documentElement.childNodes,b=[],f=[],c=0;c<d.length;c++){var g=d[c];b.push(g.getAttribute("DisplayText"));f.push("-1;#"+g.getAttribute("Key"))}b.length!=0&&_cellContext.SetCurrentValue({localized:b.join("; "),data:f.join(";#")});_cellContext.NotifyEditComplete()}_cellContext.NotifyCollapseWidget()}d()},HyperlinkWidget:function(f){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var j="HyperlinkWidgetControl",z=this,t=f.parentNode,a,b,e,c,h,i,d,o,m,p,q,n,g,k,l;function A(){ULSEWi:;b=document.createElement("div");b.id="mainDiv";b.style.cssText="z-index:1; visibility:hidden; position:absolute; top:0px;left:0px; width:290px; background-color:white; border:solid 1px #53A9FF; direction:"+f.RTL.ltr+";";t.appendChild(b);m=String.format("{0}_{1}",j,"addressInput");p=String.format("{0}_{1}",j,"verifyButton");o=String.format("{0}_{1}",j,"displayInput");q=String.format("{0}_{1}",j,"okButton");n=String.format("{0}_{1}",j,"cancelButton");var s=String.format('<DIV style="margin:3px 10px 0px 10px; text-align:{0};"><img src="{1}" alt="{2}" title="{2}" id="{3}" tabIndex="-1" style="cursor:pointer;"/></DIV>',f.RTL.Right,"/_layouts/Images/closexon.png",SP.JsGrid.Res.close,n),A=String.format('<a href="javascript:;" id="{0}" title="{1}" style="float:{2};">{1}</a>',p,SP.JsGrid.Res.testHyperlink,f.RTL.Right),a='<DIV style="margin:3px 10px 9px 10px;"><LABEL for={0}>{1}</LABEL>{3}<DIV style="margin-top:3px;"><INPUT id={0} style="width:268px; padding:0px;" maxLength="1024" type="text"></DIV><DIV style="margin-top:3px;">{2}</DIV></DIV>',g=String.format(a,m,SP.JsGrid.Res.hyperlinkAddress,SP.JsGrid.Res.hyperlinkAddressExample,A),k=String.format(a,o,SP.JsGrid.Res.hyperlinkDisplay,SP.JsGrid.Res.hyperlinkDisplayExample,""),z=String.format('<DIV style="padding:3px 10px 3px 10px; background-color: #53A9FF; text-align:{0}"><a href="javascript:;" title="{1}" id="{2}" style="font-weight:bold; color:#F7F7F7">{1}</a></DIV>',f.RTL.Right,SP.JsGrid.Res.ok,q);b.innerHTML=[s,g,k,z].join("");l=b.offsetHeight;c=$get(m);h=$get(p);e=$get(o);i=$get(q);d=$get(n);$addHandler(e,"keyup",w);$addHandler(i,"click",v);$addHandler(d,"click",r);$addHandler(h,"click",u);$addHandler(b,"keydown",y);$addHandler(b,"mousedown",x)}this.Dispose=function(){ULSEWi:;$clearHandlers(e);$clearHandlers(i);$clearHandlers(d);$clearHandlers(h);$clearHandlers(b);t.removeChild(b)};this.BindToCell=function(b){ULSEWi:;a=b;g=a.originalValue.localized!=SP.JsGrid.EmptyValue?a.originalValue.localized:a.propType.GetAddress(a.originalValue.data);k=a.originalValue.data!=SP.JsGrid.EmptyValue?a.propType.GetAddress(a.originalValue.data):a.originalValue.localized};this.Unbind=function(){};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/link.gif")).Render(SP.JsGrid.Res.editHyperlink)};this.Collapse=function(){ULSEWi:;b.style.visibility="hidden";a.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;var d=a.cellRect;b.style.top=(a.cellExpandSpace.bottom>l||a.cellExpandSpace.top<l?d.y+d.height+3:d.y-l-3)+"px";b.style.left=d.x-(f.RTL.bEnabled?b.offsetWidth-d.width:2)+"px";g=a.originalValue.localized!=SP.JsGrid.EmptyValue?a.originalValue.localized:a.propType.GetAddress(a.originalValue.data);k=a.originalValue.data!=SP.JsGrid.EmptyValue?a.propType.GetAddress(a.originalValue.data):a.originalValue.localized;e.value=g;c.value=k;a.NotifyExpandWidget();b.style.visibility="";c.focus();c.value=c.value};this.OnValueChanged=function(b){ULSEWi:;g=b.localized==null||b.localized==SP.JsGrid.EmptyValue?"":b.localized;k=b.data==null||b.data==SP.JsGrid.EmptyValue?g:a.propType.GetAddress(b.data)};function w(){ULSEWi:;s()}function v(){ULSEWi:;s();a.NotifyEditComplete();z.Collapse()}function r(){ULSEWi:;a.NotifyEditComplete(true)}function u(){ULSEWi:;window.open(c.value||"about:blank")}function s(){ULSEWi:;a.SetCurrentValue({localized:e.value,data:{address:c.value,display:e.value}})}function y(a){ULSEWi:;var b=!a.ctrlKey&&!a.altKey&&!a.shiftKey;if(c())SP.Internal.DomElement.StopEvent(a);else a.stopPropagation();function c(){ULSEWi:;switch(a.keyCode){case Sys.UI.Key.esc:r();return true;case Sys.UI.Key.enter:if(a.target==d)r();else if(a.target==h)u();else v();return true;case Sys.UI.Key.tab:if(b){if(a.target==i){d.focus();return true}}else if(a.shiftKey)if(a.target==d){i.focus();return true}else if(a.target==h){d.focus();return true}}return false}}function x(a){ULSEWi:;a.stopPropagation()}A()}};SP.JsGrid.WidgetControl.Type={Demo:"WIDGET_DEMO",Date:"WIDGET_DATE",AddressBook:"WIDGET_ADDRESSBOOK",Hyperlink:"WIDGET_HYPERLINK"};SP.JsGrid.Internal.MVCController=function(a,e,H){ULSEWi:;var b,m,l=this,f,C,Q=this,d=a.versionMgr=new SP.JsGrid.Internal.VersionManager(a,F,J,I,E,O),p=new SP.JsGrid.Internal.CheckSelectionManager(a),A=a.pendingChangeMgr=new SP.JsGrid.Internal.PendingChangesManager(a),M=new SP.JsGrid.Internal.PropertyUpdateManager(a);a.tableCache.fnApplyUpdatesToNewRecord=function(a){ULSEWi:;d.ApplyChangesToRecord(a)};var i=H?L():null,R=a.editUtil=new N,P=false,k,c,g,o,B,h,n,j={},q={OnPropertiesChanged:function(b,d,c,a){ULSEWi:;l.UpdateProperties(b,d,c,a)},OnNodeExpanded:function(a){ULSEWi:;l.ExpandNode(a)},OnNodeCollapsed:function(a){ULSEWi:;l.CollapseNode(a)},OnFocusedCellChanged:function(a){ULSEWi:;G(a)}};this.GetCurrentDataValue=function(c,e){ULSEWi:;var b=d.GetCurrentValue(c,e);if(b==SP.JsGrid.EmptyValue){var f=a.tableCache.GetCachedRecord(c);b=f!=null?f.GetDataValue(e):null}else b=b.GetData();return b};this.ChangeKeysInVersionMgr=function(b,a){ULSEWi:;d.ChangeKeysOnPropUpdates(b,a)};this.GetEarliestChangeKeyForRecord=function(a){ULSEWi:;return d.GetEarliestPropChangeKeyForRecord(a)};this.GetCurrentLocalizedValue=function(c,e){ULSEWi:;var b=d.GetCurrentValue(c,e);if(b==SP.JsGrid.EmptyValue){var f=a.tableCache.GetCachedRecord(c);b=f!=null?f.GetLocalizedValue(e):null}else b=b.GetLocalized();return b};this.GetPropType=function(e,b){ULSEWi:;var d=a.tableCache.GetCachedRecord(e),c;if(d!=null&&d.GetProp(b)!=null)c=d.GetProp(b).propType;else if(a.entryRecordMgr.IsEntryRecordKey(e)&&a.jsGridParams.tableViewParams.gridFieldMap[b]!=null)c=a.jsGridParams.tableViewParams.gridFieldMap[b].GetPropType();else if(b==SP.JsGrid.RecordIndicatorCheckboxColumnKey)c=SP.JsGrid.Internal.Property.GetPropType("RecordIndicatorCheckBoxBoolean");return c};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;d.ClearAllPropChangesForRecord(a)};this.NotifyDataAvailable=function(){ULSEWi:;a.paneMgr.RefreshAllRows(0)};this.NotifySave=function(){ULSEWi:;i!=null&&i.Clear()};this.ClearChanges=function(){ULSEWi:;a.commandMgr.ClearUndoStack();i!=null&&i.Clear();d!=null&&d.Clear()};this.GetViewEventSinks=function(){ULSEWi:;return q};this.ClearTableView=function(){ULSEWi:;a.entryRecordMgr.NotifyTableViewCleared();a.paneMgr.ClearView()};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForChangeKey(b,c,a)};this.SetTableView=function(b,J,E,v,A,t,H,F,w,m,l,z,q,x,s,j,n,I,G,r,D,h,d,i){ULSEWi:;c=F;g=w;o=J;B=v;k=E;C=A;f=t;y(b,false);p.SetTableView(h,d,i);a.columnMenuMgr!=null&&a.columnMenuMgr.Dispose();a.columnMenuMgr=new SP.JsGrid.Internal.ColumnMenuManager(a,b.autoFilterState,b.autoFilterEntries,k,e);a.paneMgr.SetView(c,o,k,b.topViewIdx,g,H,m,l,z,q,x,s,j,n,I,G,r,D,b.sortState);u(b.sortState,b.filterState,b.autoFilterState)};this.SetRowView=function(b){ULSEWi:;y(b,true);a.columnMenuMgr.SetAutoFilterState(b.autoFilterState);a.columnMenuMgr.SeedAutoFilterEntryCache(b.autoFilterEntries)};function u(e,c,d){ULSEWi:;a.paneMgr.SetSortState(e);var b=new SP.Utilities.Set(d);if(c!=null)b=b.Union(c);a.paneMgr.SetFilterState(b.ToArray())}function y(b,c){ULSEWi:;a.tableCache.SetView(b.view);h=b.hierarchyMode;if(h==SP.JsGrid.HierarchyMode.None)z();else K(h==SP.JsGrid.HierarchyMode.Grouping?b.groupingLevel:null,h==SP.JsGrid.HierarchyMode.Grouping?b.groupingRecordKeyPrefix:null,b.unfilteredHierarchyMgr,b.hierarchyDelayLoadKeys,b.hierarchyState,b.filteredDescCounts);if(c){a.paneMgr.NotifyNewRowStateChanged(true);a.paneMgr.RefreshAllRows(b.topViewIdx);u(b.sortState,b.filterState,b.autoFilterState)}}this.GetHierarchyManager=function(){ULSEWi:;return b};this.GetOutlineLevel=function(a){ULSEWi:;return b.GetOutlineLevel(a)};this.GetDiffTracker=function(){ULSEWi:;return i!=null?i.ExternalAPI:null};this.UpdateProperties=function(f,e,b,d){ULSEWi:;var c;if(b==null){a.commandMgr.OpenGroup();c=this.CreateDataUpdateCmd();b=c.GetChangeKey()}d!=null&&d(b);M.ApplyPropUpdates(f,b);if(c!=null){a.commandMgr.Execute(c,e,SP.JsGrid.CommandManager.CommandType.Explicit);a.commandMgr.CloseGroup(e,SP.JsGrid.CommandManager.CommandType.Explicit,true)}return b};this.InsertHiddenRecord=function(d,c,b){ULSEWi:;if(b!=null&&a.entryRecordMgr.IsEntryRecordKey(b)){alert(e("NoInsertAfterEntryRow"));return null}return x(t(d,false,b,false,false),c)};this.InsertRecordAfter=function(b,c,i,h,d,g,f){ULSEWi:;if(a.entryRecordMgr.IsEntryRecordKey(b)){alert(e("NoInsertAfterEntryRow"));return null}a.tableCache.SeedInsertedRecord(c);return x(t(c.key(),true,b,h,d,g,f),i)};function x(g,c){ULSEWi:;var f;if(g.bIsInView&&h==SP.JsGrid.HierarchyMode.Grouping&&b.GetUnfilteredHierarchyMgr()!=null){alert(e("NoInsertWhenGrouped"));return null}if(c==null){f=l.CreateDataUpdateCmd();c=f.GetChangeKey()}d.AddRowInsertChange(g,c);f!=null&&a.commandMgr.Execute(f,"Insert Record",SP.JsGrid.CommandManager.CommandType.Explicit);return c}this.InsertRecordBefore=function(f,j,i,h){ULSEWi:;var d,e;if(f==null)d=c.RecordIdxToRecordKey(a.tableCache.GetRecordCount()-1);else{var g=c.RecordKeyToRecordIdx(f);e=g==0?null:c.RecordIdxToRecordKey(g-1);if(b!=null&&!b.IsGrouped())d=b.GetAfterKeyFromBeforeKey(f);else d=e}return this.InsertRecordAfter(d,j,i,h,false,e,d!=e)};this.DeleteRecords=function(f,g){ULSEWi:;var h;if(SP.Internal.JS.FindInArray(f,function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)})!=null){alert(e("OpNotSupportedOnEntryRow"));return null}if(r())for(var i=b.GetUnfilteredHierarchyMgr(),c=0;c<f.length;c++){if(b.IsGroupingRecord(f[c])){alert(e("NoDeletingGroupingRow"));return null}if(i!=null&&i.IsKeyPresent(f[c])){alert(e("NoDeletingGroupedHierarchicalRows"));return null}}if(g==null){h=this.CreateDataUpdateCmd();g=h.GetChangeKey()}for(var c=0;c<f.length;c++)d.AddRowDeleteChange(s(f[c]),g);h!=null&&a.commandMgr.Execute(h,"Delete Record",SP.JsGrid.CommandManager.CommandType.Explicit);return g};this.ExpandNode=function(b){ULSEWi:;if(n.Contains(b))a.delegateMgr.Apply(SP.JsGrid.DelegateType.ExpandDelayLoadedHierarchyNode,b);else{var d=c.RecordKeyToRecordIdx(b);a.commandMgr.Execute(v("expand",d),"Expand Node",SP.JsGrid.CommandManager.CommandType.Implicit)}};this.CollapseNode=function(d){ULSEWi:;var b=c.RecordKeyToRecordIdx(d);a.commandMgr.Execute(v("collapse",b),"Collapse Node",SP.JsGrid.CommandManager.CommandType.Implicit)};this.AdjustRecordsIndentLevel=function(c,g,i){ULSEWi:;if(h==SP.JsGrid.HierarchyMode.Grouping){alert(e("NoIndentOutdentWhenGrouped"));return null}if(SP.Internal.JS.FindInArray(c,function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)})!=null){alert(e("OpNotSupportedOnEntryRow"));return null}var k=b.ValidateAndMinimizeKeyList(c);if(k.bLevelZeroFound){alert(e("OutlineLevelChangeNotSupportedOnTopLevel"));return null}c=k.minimizedKeys;for(var f=0;f<c.length;f++){if(g==-1&&!b.CanOutdent(c[f])){alert(e("CannotOutdentFurther"));return null}if(g==1&&!b.CanIndent(c[f]))return null}a.commandMgr.OpenGroup();var l=this.CreateDataUpdateCmd();i=l.GetChangeKey();var j=b!=null&&b.GetUnfilteredHierarchyMgr();if(j!=null&&c.length>1)c=j.GetKeysInOrder(c);for(var f=0;f<c.length;f++){var m=g==1?b.EnsureIndentPreconditionsMet(c[f]):b.EnsureOutdentPreconditionsMet(c[f]);d.AddIndentLevelChange(c[f],g,m,i)}a.commandMgr.Execute(l,null,SP.JsGrid.CommandManager.CommandType.Explicit);a.commandMgr.CloseGroup(g==1?"Indent":"Outdent",SP.JsGrid.CommandManager.CommandType.Explicit,true);return i};this.EnableEditing=function(){ULSEWi:;if(!f){f=true;a.entryRecordMgr.EnsureLastEntryRowExists();a.paneMgr.NotifyNewRowStateChanged();a.paneMgr.NotifyCanEditUpdated();a.ariaMgr.EnableGridEditing(true)}};this.DisableEditing=function(){ULSEWi:;if(f){a.paneMgr.StopEditing(true);a.paneMgr.UnbindEditing(function(){ULSEWi:;a.entryRecordMgr.ClearUncommittedEntryRecords();a.paneMgr.NotifyNewRowStateChanged();a.paneMgr.NotifyCanEditUpdated();a.ariaMgr.EnableGridEditing(false);f=false})}};this.FinalizeEditing=function(b,c){ULSEWi:;if(f){a.paneMgr.StopEditing(false);A.WaitForPendingUpdates(function(){ULSEWi:;if(a.errorMgr.AnyErrors()){c();return}a.entryRecordMgr.TryCommitFirstEntryRecords(function(){ULSEWi:;if(a.entryRecordMgr.AnyUncomittedEntryRecords()){c();return}A.WaitForAllChangeKeysToComplete(b)})})}else b()};this.NotifyHide=function(){ULSEWi:;this.FinalizeEditing(function(){},function(){})};this.MarkPropUpdateInvalid=function(c,e,b,a){ULSEWi:;return d.MarkPropUpdateInvalid(c,e,b,a)};this.GetCurrentChangeKey=function(){ULSEWi:;return d.GetCurrentChangeKey()};this.IsChangeKeyApplied=function(a){ULSEWi:;return d.IsChangeKeyApplied(a)};this.GetChangeKeyForVersion=function(a){ULSEWi:;return d.GetChangeKeyForVersion(a)};this.GetCheckSelectionManager=function(){ULSEWi:;return p!=null?p.ExternalAPI:null};function r(){ULSEWi:;return b!=null&&b.IsGrouped()}function N(){ULSEWi:;this.ValidateAndExpandKeyList=function(a){ULSEWi:;return b&&b.GetUnfilteredHierarchyMgr()&&b.ValidateAndExpandKeyList(a)};this.IsEditingEnabled=function(){ULSEWi:;return f};this.IsNewRowEnabled=function(){ULSEWi:;return C&&f&&!r()};this.GetFieldValueForCopy=function(b,d){ULSEWi:;var c=b.HasLocalizedValue(d)?b.GetLocalizedValue(d):null,a;if(d!=SP.JsGrid.RecordIndicatorCheckboxColumnKey){var f=b.GetProp(d);a=f&&f.propType}else a=SP.JsGrid.Internal.Property.GetPropType("RecordIndicatorCheckBoxBoolean");if(a.GetDisplayValue!=null||a.GetCopyValue!=null){var e=b.HasDataValue(d)?b.GetDataValue(d):null;if(a.GetDisplayValue!=null)c=a.GetDisplayValue(b,e,c);else if(a.GetCopyValue!=null)c=a.GetCopyValue(b,e,c)}return c!=null?c:""};this.CanBindToField=function(c,b,a){ULSEWi:;return this.CanEditField(c,b,a)&&!(a!=null&&a==SP.JsGrid.RecordIndicatorCheckboxColumnKey)};this.CanEditField=function(c,h,d){ULSEWi:;if(!f||c==null)return false;if(!c.bIsNewRow&&g.GetValue(c,SP.JsGrid.OperationalConstants.GroupingOutlineLevel)!=null)return false;if(d!=null&&d==SP.JsGrid.RecordIndicatorCheckboxColumnKey)return true;var e=h!=null&&h.fnGetCellEditMode!=null?h.fnGetCellEditMode(c,d):null;e=e==null?SP.JsGrid.EditMode.Defer:e;var b=c.bIsNewRow?SP.JsGrid.EditMode.ReadWriteDefer:a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.GetRecordEditMode)?a.delegateMgr.Apply(SP.JsGrid.DelegateType.GetRecordEditMode,c):null;b=b==null?g.GetValue(c,SP.JsGrid.OperationalConstants.RecordEditMode):b;b=b==null?SP.JsGrid.EditMode.Defer:b;var j=d!=null&&k[d].GetEditMode()!=null?k[d].GetEditMode():SP.JsGrid.EditMode.Defer,i=Math.min(Math.min(Math.min(b,j),e),B);return i==SP.JsGrid.EditMode.ReadWrite||i==SP.JsGrid.EditMode.ReadWriteDefer||i==SP.JsGrid.EditMode.Defer}}function L(){ULSEWi:;var b=new SP.JsGrid.Internal.DiffTracker(a,function(e,b,a,c){ULSEWi:;return d.GetChange(e,b,a,c)});d.OnSynchronizeChange=function(a){ULSEWi:;return b.NotifySynchronizeToChange(a)};d.OnRollbackChange=function(a){ULSEWi:;return b.NotifyRollbackChange(a)};d.OnVacateChange=function(a){ULSEWi:;return b.NotifyVacateChange(a)};return b}function K(k,j,e,d,f,i){ULSEWi:;z();n=new SP.Utilities.Set;d!=null&&n.AddArray(d);b=new SP.JsGrid.Internal.HierarchyManager(a,c,g,k,j,e,function(a){ULSEWi:;l.ExpandNode(a)},function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)},n,i);f!=null&&b.SetState(f,e);var h=o.GetColumnByKey(g.GetFieldKey(SP.JsGrid.OperationalConstants.HierarchyMain));m=h.fnGetDisplayControlName;if(a.gridControls[SP.JsGrid.HierarchyControlId]==null){a.gridControls[SP.JsGrid.HierarchyControlId]=new SP.JsGrid.DisplayControl.HierarchyDisplayControl(a.gridId,c,function(a){ULSEWi:;return b.GetNodeInfo(a)},q.OnNodeExpanded,q.OnNodeCollapsed,function(d,e,c,f,b){ULSEWi:;return a.paneMgr.GetGridPane().GetContentForCell(d,e,c,f,b)},function(c,b,a){ULSEWi:;return m&&m(b,a)});SP.JsGrid.PropertyType.Utils.RegisterDisplayControl(a.gridControls[SP.JsGrid.HierarchyControlId].Id,a.gridControls[SP.JsGrid.HierarchyControlId],[])}h.fnGetDisplayControlName=function(){ULSEWi:;return a.gridControls[SP.JsGrid.HierarchyControlId].Id};c.SetHierarchyMgrObj(b)}function z(){ULSEWi:;if(b!=null){o.GetColumnByKey(g.GetFieldKey(SP.JsGrid.OperationalConstants.HierarchyMain)).fnGetDisplayControlName=m;c.SetHierarchyMgrObj(null);b=null}}function G(b){ULSEWi:;var c=b.oldRecordKey;b.newRecordKey!=c&&a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowFocusChanged,new SP.JsGrid.EventArgs.RowFocusChanged(b.newRecordKey,b.oldRecordKey));a.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellFocusChanged,b)}this.AttachUndoActionToChangeKey=function(b,c){ULSEWi:;var a=b.GetVersionNumber();if(j[a]==null)j[a]=[];j[a].push(c)};this.CreateDataUpdateCmd=function(e){ULSEWi:;var c=false,b=d.GetNextVersionKey();a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyCreated,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b));b.Reserve();return {Apply:function(){ULSEWi:;a.paneMgr.ClearAllChangeIndications();d.ApplyChangeKey(b);!c&&!e&&a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b));c=true},Undo:function(){ULSEWi:;a.paneMgr.ClearAllChangeIndications();d.UndoChangeKey(b);var c=j[b.GetVersionNumber()];if(c!=null)for(var e=c.length-1;e>=0;e--)c[e]();j[b.GetVersionNumber()]=null},Dispose:function(a){ULSEWi:;a==SP.JsGrid.CommandManager.DisposeState.Unapplied&&d.VacateChange(b);b.Release()},GetChangeKey:function(){ULSEWi:;return b},NotifyInitialUpdateComplete:function(){ULSEWi:;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b))}}};function v(g,d){ULSEWi:;function e(){ULSEWi:;var f=c.RecordIdxToRecordKey(d),g=b.NotifyCollapse(d,f),e=c.RecordIdxToViewIdx(d);a.paneMgr.NotifyChangedRows(e,1);a.paneMgr.NotifyDeleteRows(e+1,g);a.paneMgr.ScrollCellIntoView(e,null);a.cutcopypasteMgr.CancelMode()}function f(){ULSEWi:;var f=c.RecordIdxToRecordKey(d),g=b.NotifyExpand(d,f),e=c.RecordIdxToViewIdx(d);a.paneMgr.NotifyChangedRows(e,1);a.paneMgr.NotifyInsertRows(e+1,g,true);a.paneMgr.ScrollCellIntoView(e,null);a.cutcopypasteMgr.CancelMode()}return g=="collapse"?{Apply:e,Undo:f}:{Apply:f,Undo:e}}function F(d,f,b,j,h,o,l,k,i){ULSEWi:;a.cutcopypasteMgr.CancelMode();var c=null,n=l!=null?l:a.entryRecordMgr.IsEntryRecordKey(d)?a.entryRecordMgr.GetEntryRecord(d):a.tableCache.GetCachedRecord(d);if(b==null)b=new SP.JsGrid.Internal.PropertyUpdate(null,"");var g=new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.EmptyValue,SP.JsGrid.EmptyValue);if(n!=null){var m=true;c=n.GetProp(f);if(c!=null){g.localized=c.HasLocalizedValue()?c.GetLocalized():SP.JsGrid.EmptyValue;g.data=c.HasDataValue()?c.GetData():SP.JsGrid.EmptyValue;if(g.data!=b.data||g.localized!=b.localized)c.Update(b.data,b.localized);else m=false}m&&a.paneMgr.NotifyUpdateProperty(d,f,true,b,h,j)}a.errorMgr.ClearAllErrorsOnCell(d,f);var q=SP.JsGrid.Internal.MakeCellKey(d,f);if(h==SP.JsGrid.ValidationState.Invalid){var p=k!=null?k:b.localized!=SP.JsGrid.EmptyValue?String.format(e("LocalizedConversionError"),b.localized):e("GeneralConversionError");a.errorMgr.SetCellError(d,f,p)}if(!o)if(!a.entryRecordMgr.IsEntryRecordKey(d))a.eventMgr.FireEvent(SP.JsGrid.EventType.OnPropertyChanged,new SP.JsGrid.EventArgs.PropertyChanged(d,f,i==null?g:i,b,c&&c.propType,j,h));else a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,new SP.JsGrid.EventArgs.PropertyChanged(d,f,i==null?g:i,b,c&&c.propType,j,h))}function E(g,i,e){ULSEWi:;a.cutcopypasteMgr.CancelMode();for(var f=i==1?b.NotifyIndent(g,e&&e[0]):b.NotifyOutdent(g),d=0;d<f.length;d++){var h=f[d];a.paneMgr.NotifyChangedRows(c.RecordKeyToViewIdx(h.startingRecordKey),h.count)}}function D(c,b,e){ULSEWi:;var d=false,a=null;if("visualAfterRecordKey" in c){d=true;a=c.visualAfterRecordKey;while(a!=null&&b!=null&&b[a]!=null){a=b[a].visualAfterRecordKey;if(e(a))a=null}}return w(c.afterRecordKey,a,d)}function J(d,j,g,i){ULSEWi:;a.cutcopypasteMgr.CancelMode();if(g(d.recordKey))return null;var e=null;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordInserted,new SP.JsGrid.Internal.EventArgs.RecordInserted(d.recordKey));if(d.bIsInView){var e=D(d,i,g),f;if(b!=null)f=b.NotifyInsertRowAfter(d.afterRecordKey,e,d.recordKey,d.newOutlineLevel);a.tableCache.InsertRecord(e,d.recordKey);if(!d.bDoNotUpdatePaneOnFirstInsert)a.paneMgr.NotifyInsertRows(c.RecordIdxToViewIdx(e),1,d.bUpdateFocusPos,h);else{delete d.bDoNotUpdatePaneOnFirstInsert;h()}}a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordInserted,new SP.JsGrid.EventArgs.RecordInserted(d.recordKey,e,d.afterRecordKey,j));return d;function h(){ULSEWi:;if(f!=null){var b=c.RecordKeyToViewIdx(f);b!=null&&a.paneMgr.NotifyChangedRows(b,1)}}}function I(h,q,p){ULSEWi:;a.cutcopypasteMgr.CancelMode();var o=[],f=[h.recordKey];if(p(h.recordKey))return null;if(b!=null&&b.GetUnfilteredHierarchyMgr()!=null&&h.bIsInView){var i=b.ValidateAndExpandKeyList(f);if(i.bGroupingRowFound){alert(e("NoDeletingGroupingRow"));return null}if(i.bLevelZeroFound){alert(e("DeleteNotSupportedOnTopLevel"));return null}if(!i.bAllChildKeysInView){alert(e("NoDeletingParentWithMissingChildren"));return null}f=i.expandedKeys;f.sort(function(a,b){ULSEWi:;return c.RecordKeyToRecordIdx(b)-c.RecordKeyToRecordIdx(a)})}for(var k=0;k<f.length;k++){var d=f[k],m=d==h.recordKey?h:s(d),j,g=null;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordDeleted,new SP.JsGrid.Internal.EventArgs.RecordDeleted(d));if(m.bIsInView){g=c.RecordKeyToRecordIdx(d);var n=c.RecordIdxToViewIdx(g);if(b!=null){var l=b.GetParentKey(d);j=l&&c.RecordKeyToViewIdx(l);b.NotifyDeleteRow(d,g)}a.tableCache.IsKeyInView(d)&&a.tableCache.DeleteRecord(g);n!=null&&a.paneMgr.NotifyDeleteRows(n,1);j!=null&&a.paneMgr.NotifyChangedRows(j,1)}a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordDeleted,new SP.JsGrid.EventArgs.RecordDeleted(d,g,q));o.push(m)}return o}function s(e){ULSEWi:;var f=a.tableCache.IsKeyInView(e),j=f?c.RecordKeyToRecordIdx(e):null,d=null,i=0,h,g;if(f){d=j==0?null:c.RecordIdxToRecordKey(j-1);if(b!=null&&b.GetUnfilteredHierarchyMgr()!=null){var k=b.GetInsertAfterInfoForDelete(e);g=true;h=d;d=k.insertAfterKey;i=k.outlineLevel}}var l=new SP.JsGrid.Internal.RowUpdate(e,d,i,f,true,false,h,g);return l}function t(j,f,a,i,h,d,e){ULSEWi:;var g=0;if(f&&b!=null&&!b.IsGrouped())g=b.GetInsertAfterInfoForInsert(a,c.RecordIdxToRecordKey(w(a,d,e)));return new SP.JsGrid.Internal.RowUpdate(j,a,g,f,i,h,d,e)}function O(b){ULSEWi:;return a.tableCache.GetCachedRecord(b)}function w(d,h,g){ULSEWi:;var e=!g?d:h,a=e==null?null:c.RecordKeyToRecordIdx(e);if(g&&e!=null&&a==null)a=d==null?null:c.RecordKeyToRecordIdx(d);var f=a==null?0:a+1;if(r())f=b.GetNextNonGroupingIdx(f);return f}};SP.JsGrid.Internal.RowUpdate=function(h,g,f,c,b,a,d,e){ULSEWi:;this.recordKey=h;this.afterRecordKey=g;this.newOutlineLevel=f;if(c)this.bIsInView=c;if(b)this.bUpdateFocusPos=b;if(a)this.bDoNotUpdatePaneOnFirstInsert=a;if(e)this.visualAfterRecordKey=d};SP.JsGrid.Internal.CheckSelectionManager=function(b){ULSEWi:;b.checkSelMgr=this;var a=new SP.Utilities.Set,e,c=new SP.Utilities.Set,d=new SP.Utilities.Set,k=this;function p(){ULSEWi:;e=0;var a=b.gridControls[SP.JsGrid.RecordIndicatorControlId]=new SP.JsGrid.DisplayControl.RecordIndicatorCheckboxControl(b.gridId,m,h,g,k.IsRecordIndicatorCheckboxChecked);SP.JsGrid.PropertyType.Utils.RegisterDisplayControl(a.Id,a,[])}function h(c){ULSEWi:;if(d.Contains(c))return true;var a=b.controller.GetHierarchyManager();return a!=null&&a.IsGroupingRecord(c)}function g(a){ULSEWi:;return c.Contains(a)}function o(b){ULSEWi:;!a.Contains(b)&&j(b)}function n(b){ULSEWi:;a.Contains(b)&&j(b)}function i(c,g){ULSEWi:;b.commandMgr.Execute({Apply:function(){ULSEWi:;d(g)},Undo:function(){ULSEWi:;d(!g)}},"ChangeIndicatorCheckBox",SP.JsGrid.CommandManager.CommandType.Explicit);function d(g){ULSEWi:;if(g){for(var d in c.GetCollection())if(!a.Contains(d)){a.Add(d);++e}}else for(var d in c.GetCollection())if(a.Contains(d)){a.Remove(d);--e}f(null);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordChecked,new SP.JsGrid.EventArgs.RecordChecked(c,g))}}function j(c){ULSEWi:;b.commandMgr.Execute({Apply:d,Undo:d,Dispose:function(){ULSEWi:;d=null}},"ChangeIndicatorCheckBox",SP.JsGrid.CommandManager.CommandType.Explicit);function d(){ULSEWi:;if(h(c)||g(c))return;var d=!k.IsRecordIndicatorCheckboxChecked(c);if(d){a.Add(c);++e}else{a.Remove(c);--e}f(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordChecked,new SP.JsGrid.EventArgs.RecordChecked((new SP.Utilities.Set).AddArray([c]),d))}}function m(d){ULSEWi:;j(d);if(k.IsRecordIndicatorCheckboxChecked(d)){var b=l(SP.JsGrid.RecordIndicatorCheckboxColumnKey);if(b.Contains(d)){for(var c in b)(a.Contains(c)||h(c)||g(c))&&b.Remove(c);i(b,true)}}}function l(f){ULSEWi:;for(var g=b.jsGridObj.GetSelectedRowRanges(),e=b.jsGridObj.GetSelectedColumnRanges(),d=b.jsGridObj.GetSelectedCellRanges(),c=new SP.Utilities.Set,a=0;a<e.length;a++)if(SP.Internal.JS.FindInArray(e[a].keys,function(a){ULSEWi:;return a==f})!=null){c.AddArray(b.tableCache.GetView());break}if(c.IsEmpty()){for(var a=0;a<g.length;a++)c.AddArray(g[a].keys);for(var a=0;a<d.length;a++)SP.Internal.JS.FindInArray(d[a].colRange.keys,function(a){ULSEWi:;return a==f})!=null&&c.AddArray(d[a].rowRange.keys)}return c}function f(a){ULSEWi:;b.paneMgr.NotifyUpdateProperty(a,SP.JsGrid.RecordIndicatorCheckboxColumnKey,false,null)}this.IsRecordIndicatorCheckboxChecked=function(b){ULSEWi:;return a.Contains(b)};this.SetTableView=function(g,f,b){ULSEWi:;d=new SP.Utilities.Set;d.AddArray(g);c=new SP.Utilities.Set;c.AddArray(f);a=new SP.Utilities.Set;a.AddArray(b);e=b.length};this.ExternalAPI={CheckAllRecords:function(){ULSEWi:;for(var f=b.tableCache.GetView(),e=new SP.Utilities.Set,d=0;d<f.length;d++){var c=f[d];!a.Contains(c)&&!h(c)&&!g(c)&&e.Add(c)}i(e,true)},ClearCheckedRecords:function(){ULSEWi:;var b=a.Clone();i(b,false)},EnableRecordCheckbox:function(a){ULSEWi:;if(c.Contains(a)){c.Remove(a);f(a)}},DisableRecordCheckbox:function(a){ULSEWi:;if(!c.Contains(a)){c.Add(a);f(a)}},ShowRecordCheckbox:function(a){ULSEWi:;if(d.Contains(a)){d.Remove(a);f(a)}},HideRecordCheckbox:function(a){ULSEWi:;if(!d.Contains(a)){d.Add(a);f(a)}},CheckRecord:o,UncheckRecord:n,AnyRecordsChecked:function(){ULSEWi:;return !a.IsEmpty()},GetCheckedRecordKeys:function(){ULSEWi:;return a.GetCollection()},GetCheckedRecordCount:function(){ULSEWi:;return e},GetHiddenCheckboxRecordKeys:function(){ULSEWi:;return d.GetCollection()},GetDisabledCheckboxRecordKeys:function(){ULSEWi:;return c.GetCollection()}};p()};SP.JsGrid.Internal.CutCopyPasteManager=function(a,c){ULSEWi:;var m=SP.JsGrid.SelectionType,b,e=new SP.JsGrid.Internal.ClipboardManager,f=this;this.GetLastOperation=function(){ULSEWi:;return b&&{gridPane:b.gridPane,rowRange:b.rowRange,colRange:b.colRange,opType:b.opType}};this.CheckClipboard=function(){ULSEWi:;b!=null&&!g()&&this.CancelMode()};this.IsSelectionCopyable=function(b){ULSEWi:;return a.selectionMgr.GetRowRanges(b).length+a.selectionMgr.GetColumnRanges(b).length+a.selectionMgr.GetCellRanges(b).length==1};this.CancelMode=function(){ULSEWi:;var a=b&&b.gridPane;b=null;a!=null&&a.NotifyCopyOperationUpdated()};this.OnCopy=function(e){ULSEWi:;var b=a.selectionMgr.GetLastSelectionRangeNormalized();if(b==null)return;var d=b.rowRange,g=b.colRange,f=e.GetGridPaneConverter(),c;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return c=f.GetRecordsInvolved(d.begin,d.Size(),function(b){ULSEWi:;c=b;a()})},function(){ULSEWi:;h(e,c,d,g,"copy",false)})};this.OnCut=function(e){ULSEWi:;if(!a.editUtil.IsEditingEnabled()){alert(c("GridNotEditable"));return}var g=a.selectionMgr.GetLastSelectionRangeNormalized();if(g==null)return;var b=g.rowRange,o=g.colRange,i=e.GetGridPaneConverter(),p=a.editUtil.IsNewRowEnabled()&&b.end==i.GetVirtualRowCount()-a.entryRecordMgr.GetEntryRecords().length,n=i.GetRecordKeysInvolved(b.begin,b.Size()),d;if(p){alert(c("OpNotSupportedOnEntryRow"));return}var f=a.selectionMgr.GetLastSelectionType()==m.RowRange&&a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.DeleteRecords);if(f){if(e.Id!=SP.JsGrid.PaneId.MainGrid){alert(c("NoCuttingRowsInPane"));return}var j=a.editUtil.ValidateAndExpandKeyList(n);if(j!=null){if(!j.bAllChildKeysInView){alert(c("NoDeletingParentWithMissingChildren"));return}if(j.expandedKeys.length!=n.length){alert(c("NoCuttingParentWithoutChildren"));return}}}a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return d=i.GetRecordsInvolved(b.begin,b.Size(),function(b){ULSEWi:;d=b;a()})},function(){ULSEWi:;if(f){if(l(d)){alert(c("NoCuttingReadOnlyRows"));return}}else if(k(e,d,b,o)){alert(c("NoCuttingReadOnlyCells"));return}h(e,d,b,o,"cut",f)})};this.OnPaste=function(l){ULSEWi:;if(!a.editUtil.IsEditingEnabled()){alert(c("GridNotEditable"));return}if(!this.IsSelectionCopyable(l)){alert(c("MultipleSelections"));return false}var h=j();if(h==null)return;var e=a.selectionMgr.GetLastSelectionRangeNormalized();if(e==null)return;var m=0,v=0,d;if(b!=null&&b.opType=="cut"&&g()){d={gridPane:b.gridPane,rowRange:b.rowRange,colRange:b.colRange,causesRowDelete:b.bCutCausesRowDelete};if(d.causesRowDelete){m=d.gridPane==l&&d.rowRange.begin<e.rowRange.begin?d.rowRange.Size():0;v=d.rowRange.Size();if(l.Id!=SP.JsGrid.PaneId.MainGrid){alert(c("NoPastingRowsInPane"));return}var D=new SP.Utilities.Range(e.rowRange.begin,e.rowRange.begin+d.rowRange.Size()-1);if(D.Overlaps(d.rowRange)){alert(c("CutPasteRowOverlap"));return}}}var u=e.colRange.Size(),t=e.rowRange.Size(),r=l.GetGridPaneConverter(),n,p=r.GetVirtualRowCount();if(a.editUtil.IsNewRowEnabled()){var w=a.entryRecordMgr.GetEntryRecords().length;n=e.rowRange.begin==p-w;p-=w}if(e.colRange.begin+h.width>r.GetVirtualColumnCount()||!n&&e.rowRange.begin-m+h.height>p-v){alert(c("NoRoomToPaste"));return}var A=u%h.width==0,B=t%h.height==0,F=d==null&&A&&(B||t<h.height)?u:h.width,E=d==null&&B&&(A||u<h.widfth)?t:h.height,k=new SP.Utilities.Range(e.rowRange.begin,e.rowRange.begin+E-1),s=new SP.Utilities.Range(e.colRange.begin,e.colRange.begin+F-1);a.commandMgr.OpenGroup();var o,q;if(d!=null)C(function(){ULSEWi:;x(function(){ULSEWi:;z(y)})});else x(function(){ULSEWi:;z(y)});function C(b){ULSEWi:;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return o=d.gridPane.GetGridPaneConverter().GetRecordsInvolved(d.rowRange.begin,d.rowRange.Size(),function(b){ULSEWi:;o=b;a()})},b)}function x(b){ULSEWi:;if(!n)a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return q=r.GetRecordsInvolved(k.begin,k.Size(),function(b){ULSEWi:;q=b;a()})},b);else b()}function z(b){ULSEWi:;f.CancelMode();if(d!=null)if(d.causesRowDelete){a.jsGridObj.DeleteRecords(SP.Internal.JS.ConvertSetKeysToArray(o));k.begin-=m;k.end-=m}else a.jsGridObj.UpdateProperties(i(d.gridPane,o,d.rowRange,d.colRange),"");l.PutData(h,q,"","TL",k,s,b,n)}function y(b){ULSEWi:;a.selectionMgr.SelectRange(l,k.begin,k.begin+Math.min(b,k.end-k.begin),s.begin,s.end,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true,false);a.commandMgr.CloseGroup(d!=null?"Cut/Paste":"Paste",SP.JsGrid.CommandManager.CommandType.Explicit,true)}};function h(d,m,h,j,o,l){ULSEWi:;if(!f.IsSelectionCopyable(d)){alert(c("MultipleSelections"));return false}for(var n=d.GetData(m,h,j),i=new Array(h.Size()),g=0;g<i.length;g++)i[g]=n.matrix[g].join("\t");f.CancelMode();var k=i.join("\r\n");if(e.SetData(k)){b={clipboardText:k,rowRange:h,colRange:j,selType:a.selectionMgr.GetLastSelectionType(),gridPane:d,opType:o,bCutCausesRowDelete:l};d.NotifyCopyOperationUpdated();return true}else return false}function j(){ULSEWi:;var h=e.GetData();if(h==null||h=="")return null;var a=d(h).split("\n");a.length>1&&a[a.length-1]==""&&a.pop();for(var f=a.length,g,b=0;b<f;b++){a[b]=a[b].split("\t");if(g==null)g=a[b].length;else if(g!=a[b].length){if(b==f-1&&a[b].length==1&&a[b][0]==""){f--;break}break}}if(b!=f){alert(c("ClipboardDataNotSquare"));return null}return {matrix:a,width:g,height:f}}function k(i,h,f,e){ULSEWi:;for(var d=i.GetGridPaneConverter(),c=f.begin;c<=f.end;c++)for(var b=e.begin;b<=e.end;b++){var g=d.IdxToKey(c,b);if(!a.editUtil.CanEditField(h[g.recordKey],d.GetColumnByIdx(b),g.fieldKey))return true}return false}function l(b){ULSEWi:;for(var c in b)if(!a.editUtil.CanEditField(b[c],null,null))return true;return false}function i(h,j,b,a){ULSEWi:;for(var g=h.GetGridPaneConverter(),e=new Array(b.Size()*a.Size()),i=0,c=b.begin;c<=b.end;c++)for(var d=a.begin;d<=a.end;d++){var f=g.IdxToKey(c,d);e[i++]=SP.JsGrid.CreateUnvalidatedPropertyUpdate(f.recordKey,f.fieldKey,"",true)}return e}function d(a){ULSEWi:;return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}function g(){ULSEWi:;var c=false,a=e.GetData();if(b.clipboardText==null)c=a==null;else c=(a&&d(a))==d(b.clipboardText);return c}};SP.JsGrid.Internal.ClipboardManager=function(){ULSEWi:;var a=c(),b;this.SetData=function(c){ULSEWi:;if(window.clipboardData&&window.clipboardData.setData)window.clipboardData.setData(a,c);else if(window.Components){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(g){alert(SP.JsGrid.Res.browserPermissionDenied);return false}var e=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),d=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);d.addDataFlavor(a);var f=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);e.data=c;d.setTransferData(a,e,c.length*2);f.setData(d,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}else{b={};b[a]=c}return true};this.GetData=function(){ULSEWi:;if(window.clipboardData!=null&&window.clipboardData.getData!=null)return window.clipboardData.getData(a);else if(window.Components){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(g){alert(SP.JsGrid.Res.browserPermissionDenied);return null}var f=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),d=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);d.addDataFlavor(a);var c={},e={};f.getData(d,Components.interfaces.nsIClipboard.kGlobalClipboard);d.getTransferData(a,c,e);c=c&&c.value.QueryInterface(Components.interfaces.nsISupportsString);return c&&c.data.substring(0,e.value/2)}else return b&&b[a]};function c(){ULSEWi:;if(Sys.Browser.agent==Sys.Browser.Safari||Sys.Browser.agent==Sys.Browser.AppleWebKit)return "text/plain";else if(Sys.Browser.agent==Sys.Browser.Firefox)return "text/unicode";else return "text"}};SP.JsGrid.Deserializer=function(b,c,i){ULSEWi:;this.recordKeyHash;this.recordKeyOrderChanged;this.columns;this.pivotedColumns;this.gridFieldMap;this.view;this.viewDependentKeys;this.isGanttEnabled;this.isHierarchyEnabled;this.groupingLevel;this.isGrouped;this.isSorted;this.data;this.operationalConstantsFieldKeyMap;this.keyColumnName=i;this.unfilteredHierarchyMgr;this.additionalParams;this.autoFilterState;this.hierarchyState;this.sortState;this.autoFilterEntries;this.ganttInfo;this.cellStyles;this.groupingGridRowStyleIds;this.bAutoFilterableColumns;var a=this;this.InitJsGridParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.Parameters;a.tableViewParams=this.InitJsGridTableViewParams(a.tableViewParams);return a};this.InitJsGridTableViewParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.TableViewParameters;a.operationalConstantsFieldKeyMap=this.operationalConstantsFieldKeyMap;a.gridFieldMap=this.gridFieldMap;a.paneLayout=this.paneLayout;a.keyFieldName=this.keyColumnName;a.bAutoFilterableColumns=this.bAutoFilterableColumns;if(this.columns!=null)a.columns=new SP.JsGrid.ColumnInfoCollection(this.columns);if(this.pivotedColumns!=null){a.pivotedGridParams=new SP.JsGrid.JsGridControl.PivotedGridParameters;a.pivotedGridParams.columns=new SP.JsGrid.ColumnInfoCollection(this.pivotedColumns)}if(this.isGanttEnabled)a.ganttParams=this.InitJsGridGanttParams(a.ganttParams);a.rowViewParams=this.InitJsGridRowViewParams(a.rowViewParams);return a};this.InitJsGridRowViewParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.RowViewParameters;a.hierarchyMode=this.isGrouped?SP.JsGrid.HierarchyMode.Grouping:this.isHierarchyEnabled?SP.JsGrid.HierarchyMode.Standard:SP.JsGrid.HierarchyMode.None;a.groupingLevel=this.groupingLevel;a.groupingRecordKeyPrefix=this.groupingPrefix;a.view=this.view;a.autoFilterState=this.autoFilterState;a.unfilteredHierarchyMgr=this.unfilteredHierarchyMgr;a.hierarchyState=this.hierarchyState;a.sortState=this.sortState;a.autoFilterEntries=this.autoFilterEntries;return a};this.InitJsGridGanttParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.GanttParameters;a.dateRange=[this.ganttInfo.StartDate,this.ganttInfo.FinishDate];a.ganttBarStyles=this.ganttInfo.Styles.barStyles;a.fieldKeyRedrawFilter=this.ganttInfo.Styles.fieldKeyRedrawFilter;return a};this.InitCellStyles=function(a){ULSEWi:;if(this.cellStyles!=null)for(var c in this.cellStyles)a.RegisterCellStyle(c,SP.JsGrid.Style.CreateStyle(SP.JsGrid.Style.Type.Cell,this.cellStyles[c]));if(this.groupingGridRowStyleIds!=null){for(var d=[],b=0;b<this.groupingGridRowStyleIds.length;b++)d.push(a.GetCellStyle(this.groupingGridRowStyleIds[b]));a.groupingStyles=d}};function k(){ULSEWi:;if(c==SP.JsGrid.DeserializationMode.Full)j();else if(c==SP.JsGrid.DeserializationMode.TableView)e();else if(c==SP.JsGrid.DeserializationMode.RowView)g();else if(c==SP.JsGrid.DeserializationMode.Slice)d();else c==SP.JsGrid.DeserializationMode.AutoFilter&&h()}function j(){ULSEWi:;e(b)}function e(){ULSEWi:;var f=b.MultiValueSeparator;b.LookupTableInfo!=null&&c(b.LookupTableInfo);h(b.Fields);e(b.Columns);b.PivotedColumns!=null&&d(b.PivotedColumns);a.paneLayout=b.PaneLayout;a.ganttInfo=b.GanttInfo;a.bAutoFilterableColumns=b.AutoFilterableColumns;g();function h(e){ULSEWi:;a.gridFieldMap={};for(var d=0;d<e.length;d++){var b=e[d],c=new SP.JsGrid.GridField(b.fieldKey,b.hasDataValue,b.hasLocalizedValue,b.textDirection,b.defaultCellStyleId,b.editMode);b.multiValue&&c.SetIsMultiValue(f);c.SetSingleValuePropType(b.propertyTypeId!=null?SP.JsGrid.Internal.Property.GetPropType(b.propertyTypeId):null);a.gridFieldMap[c.key]=c}}function e(e){ULSEWi:;a.columns=[];for(var d=0;d<e.length;d++){var b=e[d],c=new SP.JsGrid.ColumnInfo(b.name,b.imgSrc,b.columnKey,b.width);c.isVisible=b.isVisible;c.isHidable=b.isHidable;c.isResizable=b.isResizable;c.isSortable=b.isSortable;c.isAutoFilterable=b.isAutoFilterable;a.columns.push(c)}}function d(d){ULSEWi:;a.pivotedColumns=[];for(var c=0;c<d.length;c++){var b=d[c],e=new SP.JsGrid.PivotedColumnInfo(b.name,b.imgSrc,b.columnKey,b.fieldKeys,b.width);a.pivotedColumns.push(e)}}function c(b){ULSEWi:;for(var a=0;a<b.length;a++)SP.JsGrid.PropertyType.RegisterNewLookupPropType(b[a].id,b[a].lookup,b[a].showImage&&b[a].showText?SP.JsGrid.DisplayControl.Type.ImageText:b[a].showImage?SP.JsGrid.DisplayControl.Type.Image:SP.JsGrid.DisplayControl.Type.Text,b[a].limitToList)}}function g(){ULSEWi:;a.view=b.ViewInfo;a.autoFilterState=b.AutoFilterState;a.sortState=b.SortState;a.hierarchyState=b.HierarchyState;a.cellStyles=b.CellStyles;a.groupingGridRowStyleIds=b.GroupingGridRowStyleIds;if(b.UnfilteredHierarchy!=null)a.unfilteredHierarchyMgr=new SP.JsGrid.UnfilteredHierarchyManager(b.UnfilteredHierarchy);a.autoFilterEntries=b.AutoFilterEntries;d()}function d(){ULSEWi:;f(b.MetaData);if(b.LocalizedTable!=null&&b.UnlocalizedTable!=null){var e=b.LocalizedTable,d=b.UnlocalizedTable;a.viewDependentKeys=b.ViewDepKeys;a.data={};for(var c=0;c<d.length;c++)a.data[d[c][a.keyColumnName]]={data:d[c],localized:e[c]}}a.additionalParams=b.AdditionalParams}function h(){ULSEWi:;f(b.MetaData);a.autoFilterEntries=b.AutoFilterEntries}function f(b){ULSEWi:;switch(c){case SP.JsGrid.DeserializationMode.Full:case SP.JsGrid.DeserializationMode.TableView:a.isGanttEnabled=b.IsGanttEnabled;a.operationalConstantsFieldKeyMap=b.GridOperationalConstantsFieldKeyMap;a.keyColumnName=b.KeyColumnName;case SP.JsGrid.DeserializationMode.RowView:a.isHierarchyEnabled=b.IsHierarchyEnabled;a.groupingLevel=b.GroupingLevel;a.groupingPrefix=b.GroupingPrefix;a.isGrouped=a.groupingLevel!=0;a.isSorted=b.IsSorted;default:a.recordKeyHash=b.RecordKeyHash;a.recordKeyOrderChanged=b.RecordKeyOrderChanged}}k()};SP.JsGrid.Deserializer.DeserializeFromJson=function(b,a){ULSEWi:;if(a==null)a={};if(!("guid" in a))a["guid"]=function(a){ULSEWi:;return SP.JsGrid.GuidManager.GetIndexForGuid(a)};for(var c in a)b=SP.JsGrid.Deserializer.EvalFunctionCallsInJson(b,c,a[c]);return Sys.Serialization.JavaScriptSerializer.deserialize(b)};SP.JsGrid.Deserializer.EvalFunctionCallsInJson=function(jsonText,prefix,fn){ULSEWi:;var unescapedQuoteRegEx='([^\\\\])\\"',regEx=unescapedQuoteRegEx+Escape(prefix)+"<;>(.+?)"+unescapedQuoteRegEx;return jsonText.replace(eval("/"+regEx+"/g"),function(e,b,c,d){ULSEWi:;var a=fn.apply(null,DeserializeEncodedArray(c+d));return b+(a==null?"":a)});function DeserializeEncodedArray(c){ULSEWi:;for(var b=c.split("<;>"),a=0;a<b.length-1;a++)b[a]=Unescape(b[a]);return b}function Unescape(a){ULSEWi:;return a.replace(/;;/g,";")}function Escape(a){ULSEWi:;return a.replace(/;/g,";;")}};SP.JsGrid.Internal.DiffTracker=function(g,f){ULSEWi:;var a=new k,b={};function k(){ULSEWi:;var a=[];this.AddChange=function(e,d,b){ULSEWi:;var c={changeKey:e,bSynchronized:d};if(b!=null)c.events=b;a.push(c)};this.RemoveChange=function(d){ULSEWi:;var c=b(d);return c!=null?a.splice(c,1):null};this.ContainsKey=function(a){ULSEWi:;return b(a)!=null};this.GetItem=function(d){ULSEWi:;var c=d!=null?b(changeKey):a.length-1;return c!=-1&&c!=null?a[c].changeKey:null};this.AddEvent=function(e,d){ULSEWi:;var c=b(e);if(c!=null){if(a[c].events==null)a[c].events=[];a[c].events.push(d)}};this.RemoveEvent=function(f,e){ULSEWi:;var c=b(f);if(c!=null&&a[c].events!=null)for(var d=0;d<a[c].events.length;d++)if(a[c].events[d]==e){a[c].events.splice(d,1);break}};this.Length=function(){ULSEWi:;return a.length};this.Clear=function(){ULSEWi:;a=[]};this.GetChanges=function(c){ULSEWi:;var e,f;if(c.sliceBeginInfo!=null){e=g(c.sliceBeginInfo);if(e==null&&c.sliceBeginInfo.bCancelQueryIfMissing)return [];else if(e!=null&&!c.sliceBeginInfo.bInclusive)e++}if(c.sliceEndInfo!=null){f=g(c.sliceEndInfo,e==null?null:e+1);if(f==null&&c.sliceEndInfo.bCancelQueryIfMissing)return [];else if(f!=null&&c.sliceEndInfo.bInclusive)f++}return a.slice(e==null?0:e,f==null?a.length:f);function g(a,e){ULSEWi:;var c;if(a.event!=null)c=d(a.event,a.bFindLastOccurence,e);else if(a.changeKey!=null)c=b(a.changeKey,a.bCancelQueryIfMissing);return c}};function b(f,e){ULSEWi:;for(var d=null,c,b=a.length-1;b>=0;b--){c=a[b].changeKey.CompareTo(f);if(c==0){d=b;break}else if(c<0){if(e&&b!=a.length-1)d=b+1;break}}return d}function d(f,h,d){ULSEWi:;for(var e=null,g=d!=null?d:0,b=g;b<a.length;b++)if(c(a[b],f)){e=b;if(!h)break}return e}function c(a,d){ULSEWi:;var c=false;if(a.events!=null)for(var b=0;b<a.events.length;b++)if(a.events[b]==d){c=true;break}return c}}function c(){ULSEWi:;this.sliceBeginInfo=null;this.sliceEndInfo=null;this.recordKeys=null;this.bIncludeInvalidPropUpdates=false}function l(){ULSEWi:;this.event=null;this.bFindLastOccurence=false;this.bInclusive=true;this.bCancelQueryIfMissing=false}function j(){ULSEWi:;this.changeKey=null;this.bInclusive=true;this.bCancelQueryIfMissing=false}this.ExternalAPI={RegisterEvent:function(c,b){ULSEWi:;a.AddEvent(c,b)},UnregisterEvent:function(c,b){ULSEWi:;a.RemoveEvent(c,b)},GetChanges:function(f,g,l,i,j,k,h,e){ULSEWi:;var b=new c;if(f!=null)b.sliceBeginInfo={event:f,bFindLastOccurence:!i,bInclusive:j,bCancelQueryIfMissing:false};if(g!=null)b.sliceEndInfo={event:g,bFindLastOccurence:e,bInclusive:k,bCancelQueryIfMissing:true};return d(a.GetChanges(b),false,null,l,h,e)},GetChangesAsJson:function(b,f,g){ULSEWi:;if(b==null)b=new c;var e=d(a.GetChanges(b),true,f,b.recordKeys,b.bIncludeInvalidPropUpdates,g);return e==null||e.length==0?null:Sys.Serialization.JavaScriptSerializer.serialize(e)},AnyChanges:function(){ULSEWi:;return a.Length()>0},GetUniquePropertyChanges:function(b,e){ULSEWi:;if(b==null)b=new c;return h(e,d(a.GetChanges(b),false,null,b.recordKeys,b.bIncludeInvalidPropUpdates))},ChangeQuery:c,EventSliceInfo:l,ChangeKeySliceInfo:j};this.Clear=function(){ULSEWi:;a.Clear();b={}};this.NotifySynchronizeToChange=function(a){ULSEWi:;e(a,true)};this.NotifyRollbackChange=function(a){ULSEWi:;e(a,false)};this.NotifyVacateChange=function(c){ULSEWi:;if(a.ContainsKey(c))b[c.GetVersionNumber()]=f(c,null,true,false,true)};function e(b,d){ULSEWi:;var c=a.GetItem();if(c!=null&&c==b)c.bWasSynchronized!=d&&a.RemoveChange(b);else a.AddChange(b,d)}function d(p,r,m,n,q,j){ULSEWi:;var e=[];rIdx=0;for(var l=0;l<p.length;l++){e.push(SP.Internal.JS.CloneObj(p[l],false));var k=e[rIdx].changeKey.GetVersionNumber(),c=e[rIdx].updates=k in b?i(b[k],n,j):f(e[rIdx].changeKey,n,!e[rIdx].bSynchronized,j);delete e[rIdx].bSynchronized;delete e[rIdx].events;if(!q&&!j)for(var a=c.length-1;a>=0;a--)if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop&&c[a].validationState!=SP.JsGrid.ValidationState.Valid)c.splice(a,1);else delete c[a].validationState;if(j)for(var a=0;a<c.length;a++)if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete)c[a].type=SP.JsGrid.PostViewChangeType.Delete;else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Insert)c[a].type=SP.JsGrid.PostViewChangeType.Insert;else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Level)c[a].type=SP.JsGrid.PostViewChangeType.Level;if(r){for(var a=0;a<c.length;a++){if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop){var d={};if(c[a].propUpdate.data!=SP.JsGrid.EmptyValue){d.dataValue=SP.Internal.JS.CloneObj(c[a].propUpdate.data,true);d.hasDataValue=true}if(c[a].propUpdate.localized!=SP.JsGrid.EmptyValue){d.localizedValue=c[a].propUpdate.localized;d.hasLocalizedValue=true}c[a].newProp=d;delete c[a].propUpdate}else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete)delete c[a].afterRecordKey;var s=c[a].recordKey,h=m!=null?m(e[rIdx].changeKey,c[a]):SP.JsGrid.UpdateSerializeMode.Default;if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop&&h==SP.JsGrid.UpdateSerializeMode.Default){var o=c[a].fieldKey,t=g.jsGridParams.tableViewParams.gridFieldMap[o];h=SP.JsGrid.Internal.Property.GetUpdateSerializeMode(g.controller.GetPropType(s,o),t)}if(h==SP.JsGrid.UpdateSerializeMode.Cancel){c.splice(a,1);a--;continue}if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop){var d=c[a].newProp;if(h==SP.JsGrid.UpdateSerializeMode.PropDataOnly){delete d.localizedValue;delete d.hasLocalizedValue}if(h==SP.JsGrid.UpdateSerializeMode.PropLocalizedOnly){delete d.dataValue;delete d.hasDataValue}if("dataValue" in d)d.dataValue=d.dataValue!=null?Sys.Serialization.JavaScriptSerializer.serialize(d.dataValue):null;if("localizedValue" in d)d.localizedValue=escape(d.localizedValue)}}e[rIdx].changeNumber=k;delete e[rIdx].changeKey}if(e[rIdx].updates.length==0)e.splice(rIdx,1);else rIdx++}return e}function i(a,d){ULSEWi:;var c;if(d==null)c=a;else{var e=new SP.JsGrid.Internal.Set;e.AddArray(d);c=[];for(var b=0;b<a.length;b++)e.Contains(a[b])&&c.push(a[b])}}function h(e,f){ULSEWi:;for(var h=SP.JsGrid.Internal.VersionManager.ChangeType.Prop,b={},c=0;c<f.length;c++)for(var g=f[c].updates,d=0;d<g.length;d++){var a=g[d];if(a.type==h)if(e==null||e(a.recordKey,a.fieldKey)){if(b[a.recordKey]==null)b[a.recordKey]={};b[a.recordKey][a.fieldKey]=a.propUpdate}}return b}};SP.JsGrid.Internal.EditActorsRegistrationManager=function(c,i,f,d,h){ULSEWi:;var b={},a={};this.RegisterEditControl=function(a){ULSEWi:;!(a in b)&&g(a);return b[a]};this.RegisterWidgetControl=function(b){ULSEWi:;!(b in a)&&e(b);return a[b]};this.GetEditControlAPI=function(a){ULSEWi:;return b[a]};this.GetWidgetControlAPI=function(b){ULSEWi:;return a[b]};this.GetActorAPI=function(c){ULSEWi:;return b[c]||a[c]};this.IsActorWidget=function(b){ULSEWi:;return b in a};this.GetEditAndWidgetControlsAPI=function(g,f,d,e){ULSEWi:;var c={editControlAPI:null,widgetControlsAPI:[]},a=SP.JsGrid.Internal.Property.GetEditAndWidgetControlNamesForProperty(g,f,d,e);c.editControlAPI=this.RegisterEditControl(a.editControlName);for(var b=0;b<a.widgetControlNames.length;b++)c.widgetControlsAPI.push(this.RegisterWidgetControl(a.widgetControlNames[b]));return c};this.Dispose=function(){ULSEWi:;for(var c in b)b[c].actor.Dispose();for(var c in a)a[c].actor.Dispose()};function g(a){ULSEWi:;var d=f(a),g=[d.GetGridContext()],e=c.focusMgr.GetFocusElementForTextInput(a);e!=null&&g.push(e);d.actor=SP.JsGrid.Internal.Property.GetEditControl(a,g);b[a]=d}function e(b){ULSEWi:;var e=d(b),f=[e.GetGridContext()];b==SP.JsGrid.ErrorWidgetId&&f.push(c.errorMgr);e.actor=SP.JsGrid.Internal.Property.GetWidgetControl(b,f);h(b,e.actor);a[b]=e}};SP.JsGrid.Internal.EditManager=function(d,rb,xb){ULSEWi:;var Ab=d.jsGridObj,Bb=d.styleMgr,cb=d.errorMgr,g={Inited:1,Bound:2,Editing:3},j=this,J=d.parentNode,m=g.Inited,h,D,e,s,z,u,l,t,A,L,c,b,a,n,r,f,q,R,o={},i=tb(),E,v,k,w,I,K,y=new nb,p=new SP.JsGrid.Internal.EditActorsRegistrationManager(d,J,eb,db,ib);d.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,X);function U(a){ULSEWi:;this.jsGridObj=d.jsGridObj;this.parentNode=J;this.styleManager=d.styleMgr;this.RTL=d.RTL;this.emptyValue=SP.JsGrid.EmptyValue;this.bLightFocus=false;this.OnKeyDown=function(b){ULSEWi:;j.OnActorKeyDown(b,a)}}function T(a){ULSEWi:;this.propType;this.originalValue;this.record;this.column;this.field;this.fieldKey;this.cellExpandSpace;this.SetCurrentValue=function(b){ULSEWi:;j.SetCurrentValue(a,b)}}function W(c,f,e,d){ULSEWi:;var b=e(),a=d();this.name=c;this.actor=f;this.SetCellInfo=function(){ULSEWi:;zb(a,p.IsActorWidget(c))};this.UpdateOriginalValue=function(b){ULSEWi:;a.originalValue=b};this.IsLightFocus=function(){ULSEWi:;return b.bLightFocus};this.NotifyEditComplete=function(b){ULSEWi:;a.NotifyEditComplete(b)};this.GetGridContext=function(){ULSEWi:;return b};this.GetCellContext=function(){ULSEWi:;return a}}function gb(a){ULSEWi:;return new U(a)}function fb(b){ULSEWi:;var a=new T(b);a.NotifyExpandWidget=function(){ULSEWi:;j.NotifyExpandWidget(b)};a.NotifyCollapseWidget=function(){ULSEWi:;j.NotifyCollapseWidget(b)};a.NotifyEditComplete=function(a){ULSEWi:;if(a)j.NotifyWidgetEditCancel(b);else M(a)};return a}function db(a,b){ULSEWi:;return new W(a,b,function(){ULSEWi:;return gb(a)},function(){ULSEWi:;return fb(a)})}function lb(a){ULSEWi:;var b=new U(a);b.OnActivateActor=function(){ULSEWi:;P(a)};b.OnDeactivateActor=function(){ULSEWi:;N(a)};return b}function kb(b){ULSEWi:;var a=new T(b);a.NotifyExpandControl=function(){ULSEWi:;j.NotifyExpandControl(b)};a.NotifyEditComplete=function(a){ULSEWi:;M(a)};a.Show=function(a){ULSEWi:;a.style.position="absolute";a.style.left=l.x+1+"px";a.style.top=l.y+1+"px";s.ClipElementToTableViewport(a);a.style.visibility="inherit"};a.Hide=function(a){ULSEWi:;if(!d.focusMgr.ChangeTextInputElementToFocusElement())a.style.visibility="hidden"};return a}function eb(a,b){ULSEWi:;return new W(a,b,function(){ULSEWi:;return lb(a)},function(){ULSEWi:;return kb(a)})}function M(a){ULSEWi:;if(j.IsEditing()||y.GetCurrentEndingState()==g.Editing)y.HandleStateTransition(g.Bound,true,null,[a]);else if(j.IsBound()){C();if(!a){d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditBegin,new SP.JsGrid.EventArgs.CellEditBegin(h.key(),e.key));var b=S();d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditCompleted,new SP.JsGrid.EventArgs.CellEditCompleted(h.key(),e.key,b,a))}d.focusMgr.Focus()}n=null}function zb(a,b){ULSEWi:;a.propType=z;a.originalValue=q;a.record=h;a.column=D;a.field=e;a.fieldKey=e.key;a.cellExpandSpace=A;if(!b){a.cellWidth=l.width-2;a.cellHeight=l.height-2;a.cellStyle=L}else a.cellRect=l}function ib(c,b){ULSEWi:;var a=document.createElement("div");a.className="jsgrid-widget-cell";a.appendChild(b.GetIcon());o[c]=a;i.appendChild(a)}function nb(){ULSEWi:;function k(b,a){ULSEWi:;this.fn=b;this.bArgsRequired=a}var K=[[g.Inited,{promote:new k(J,true)}],[g.Bound,{demote:new k(F,false),promote:new k(y,true)}],[g.Editing,{demote:new k(E,false)}]],v=SP.Internal.JS.ConvertTableToMap(K,"0","1"),j=[];function F(){ULSEWi:;for(var d=0;d<a.length;d++)x(a[d].name);i.style.display="none";for(var d=0;d<i.childNodes.length;d++)i.childNodes[d].style.visibility="hidden";w=null;for(var d=0;d<c.length;d++)c[d].actor.Unbind();h=null;D=null;e=null;s=null;c=null;b=null;a=null;z=null;u=null;l=null;A=null;t=null;L=null;n=null;r={};f={};q=null;w=null}function E(c){ULSEWi:;var a;b.actor.OnEndEdit();C();if(!c)a=S();I=false;r={};f={};d.focusMgr.Focus();d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditCompleted,new SP.JsGrid.EventArgs.CellEditCompleted(h.key(),e.key,a,c))}function J(n,g,o,d,j,m,k){ULSEWi:;h=g;D=o;e=j[d];s=n;z=g.GetProp(d)!=null?g.GetProp(d).propType:j[d].GetPropType();q=H();c=p.GetEditAndWidgetControlsAPI(h,D,e.key,z);b=c.editControlAPI;a=c.widgetControlsAPI;Y(g.key(),d);c=[b].concat(a);r={};f={};if(m!=null)u=m.GetTd();if(k!=null)L=k;l=Z();t=O();A=bb(l,t);b.SetCellInfo();b.actor.BindToCell(b.GetCellContext());for(var i in a){a[i].SetCellInfo();a[i].actor.BindToCell(a[i].GetCellContext())}B()}function y(a){ULSEWi:;n=SP.JsGrid.EmptyValue;G(H());d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditBegin,new SP.JsGrid.EventArgs.CellEditBegin(h.key(),e.key));b.actor.OnBeginEdit(a);b.actor.OnKeyDown!=null&&(a.type=="keypress"||a.type=="keydown")&&b.actor.OnKeyDown(a)}var o=[];this.HandleStateTransition=function(a,e,d,g){ULSEWi:;var c=j.length>0?j[0].newState:m;if(e&&c<=a||!e&&c>=a)i(a,d,g);else{for(var f=Math.abs(c-a),b=1;b<=f;b++){var a=c+b*(e?-1:1),l=b==1&&g!=null?g:o,k=d!=null&&f==b?[d]:o;j.unshift({newState:a,args:l,callbacks:k})}j.length==f&&h()}function h(){ULSEWi:;while(j.length>0){var a=j[j.length-1],c=m<a.newState?v[m].promote.fn:v[m].demote.fn;c.apply(null,a.args);m=a.newState;j.pop();for(var b=0;b<a.callbacks.length;b++)a.callbacks[b]()}}function i(d,b,c){ULSEWi:;for(var a=0;a<j.length;a++)if(j[a]==d){b!=null&&j[a].callbacks.push(b);if(c!=null)j[a].args=c;return}b!=null&&b()}};this.GetCurrentEndingState=function(){ULSEWi:;return j.length>0?j[0].newState:m}}function Z(){ULSEWi:;var a=u.parentNode!=null?s.GetTdCoordsRelativeToParentNode(u):null;return a!=null?{x:a.left,y:a.top,width:a.width,height:a.height}:null}function O(){ULSEWi:;return s.GetTableViewportRelativeToParentNode()}function bb(a,b){ULSEWi:;return {top:a.y-b.top,right:b.right-a.x-a.width,bottom:b.bottom-a.y-a.height,left:a.x-b.left}}function S(){ULSEWi:;var d,a=pb(),c=ub();if(a||c){var b;if(a&&c)b=SP.JsGrid.CreateValidatedPropertyUpdate(h.key(),e.key,f.data,f.localized);else b=SP.JsGrid.CreateUnvalidatedPropertyUpdate(h.key(),e.key,a?f.localized:f.data,a);f={};d=rb([b],"User Edit",null,function(a){ULSEWi:;K=a});X();G(H())}else f={};return d}function pb(){ULSEWi:;var a=false;if(q.localized!=SP.JsGrid.EmptyValue&&"localized" in f){var b=q.localized!=null?q.localized:"";a=b!=f.localized}return a}function ub(){ULSEWi:;var a=false;if(q.data!=SP.JsGrid.EmptyValue&&"data" in f)a=!e.CompareSingleDataEqual(f.data,q.data);return a}function X(){ULSEWi:;if(m>=g.Bound){var c=a.length>0&&a[0].name==SP.JsGrid.ErrorWidgetId;if(c&&!cb.CellHasError(h.key(),e.key)){var b=a[0];b.name==k&&x(b.name);b.actor.Unbind();a.splice(0,1);if(B())o[b.name].style.visibility="hidden"}else if(!c)if(Y(h.key(),e.key)){var b=p.GetWidgetControlAPI(SP.JsGrid.ErrorWidgetId);b.SetCellInfo();b.actor.BindToCell(b.GetCellContext());B()}}}function G(c){ULSEWi:;q=c;b.UpdateOriginalValue(c);for(var d in a)a[d].UpdateOriginalValue(c)}function tb(){ULSEWi:;var a=document.createElement("div");a.className="jsgrid-widget-dock";a.style.display="none";J.appendChild(a);E=SP.Internal.DomElement.SetMouseHover(a,wb,hb,vb);$addHandler(a,"click",sb);$addHandler(a,"mousedown",qb);return a}function sb(c){ULSEWi:;if(c.button==Sys.UI.MouseButton.leftButton)for(var d=SP.Internal.DomElement.GetEventLocation(c),b=0;b<a.length;b++){var e=o[a[b].name];if(SP.Internal.DomElement.PointInDomElem(d.x,d.y,e)){SP.Internal.DomElement.StopEvent(c);if(k!=a[b].name)F(a[b].actor);else x(k);break}}}function qb(a){ULSEWi:;a.stopPropagation()}function wb(){ULSEWi:;i.style.borderColor="#768290"}function hb(){ULSEWi:;if(k==null)i.style.borderColor="";for(var b=0;b<a.length;b++){var c=[];if(a[b].name!=k)o[a[b].name].style.backgroundColor=""}v=null}function vb(e){ULSEWi:;for(var c=SP.Internal.DomElement.GetEventLocation(e),b=0;b<a.length;b++){var d=o[a[b].name];if(SP.Internal.DomElement.PointInDomElem(c.x,c.y,d)){if(v!=a[b].name){if(v!=null&&v!=k)o[v].style.backgroundColor="";v=a[b].name;if(a[b].name!=k)d.style.backgroundColor="#C4C9CF"}break}}}function B(){ULSEWi:;if(l!=null&&t!=null){var b=l,h=t;if(a.length>0){for(var f=5,g=20,m=22,c=g*a.length,k=d.RTL.bEnabled?b.x-(c+2)>=h.left:b.x+b.width+f+(c+2)>h.right,p=b.y+Math.floor((b.height-m)/2),n=k?b.x-(c+2+f):b.x+f+b.width,e=0;e<a.length;e++){var j=o[a[e].name];j.style.left=e*g+"px";j.style.visibility=""}i.style.top=p+"px";i.style.left=n+"px";i.style.width=c+"px";i.style.display="block"}else i.style.display="none";return true}else return false}function H(){ULSEWi:;return xb(h,e.key,z)}function Y(c,d){ULSEWi:;var b=false;if(cb.CellHasError(c,d)){a.unshift(p.RegisterWidgetControl(SP.JsGrid.ErrorWidgetId));b=true}return b}function yb(a){ULSEWi:;if(p.IsActorWidget(a.name))return F(a.actor);else return ob(a.actor)}function mb(a){ULSEWi:;R=r;C(a);if(k!=null&&k!=a)o[k].style.backgroundColor="";o[a].style.backgroundColor="#8C8F93";k=w=a}function x(a){ULSEWi:;V(a);p.GetWidgetControlAPI(a).actor.Collapse()}function V(a){ULSEWi:;if(a==k){o[a].style.backgroundColor="";k=null}}function F(a){ULSEWi:;if(a.Expand!=null){a.Expand();return true}return false}function jb(a){ULSEWi:;C(a);w=a}function ob(a){ULSEWi:;if(a.Expand!=null){a.Expand();return true}return false}function C(d){ULSEWi:;for(var c=0;c<a.length;c++)a[c].name!=d&&x(a[c].name);if(b.actor.Collapse!=null)b.name!=d&&b.actor.Collapse()}function Q(a,d,e){ULSEWi:;f={};if("localized" in a&&a.localized!=SP.JsGrid.EmptyValue){r.localized=a.localized;if(d==SP.JsGrid.EditActorUpdateType.Uncommitted)f.localized=a.localized}if("data" in a&&a.data!=SP.JsGrid.EmptyValue){r.data=a.data;if(d==SP.JsGrid.EditActorUpdateType.Uncommitted)f.data=a.data}for(var b=0;b<c.length;b++)e!=c[b].name&&c[b].actor.OnValueChanged(r,d)}function P(a){ULSEWi:;ab(true,a)}function N(a){ULSEWi:;setTimeout(function(){ULSEWi:;ab(false,a)},0)}function ab(a,b){ULSEWi:;if(!a&&n!=null&&b==n)j.StopEditing(false);else if(a)n=b}this.Unbind=function(a){ULSEWi:;y.HandleStateTransition(g.Inited,true,a)};this.StopEditing=function(c){ULSEWi:;var a=p.GetActorAPI(n)||b;a!=null&&a.NotifyEditComplete(c)};this.BindToCell=function(f,i,h,e,a,c,b,d){ULSEWi:;y.HandleStateTransition(g.Bound,false,d,[f,i,h,e,a,c,b])};this.BeginEdit=function(a,b){ULSEWi:;I=a.type=="keypress";y.HandleStateTransition(g.Editing,false,b,[a])};this.IsBoundToCell=function(c,a,b){ULSEWi:;return m>=g.Bound&&s==c&&h.key()==a&&e.key==b};this.IsBound=function(){ULSEWi:;return m>=g.Bound};this.IsEditing=function(){ULSEWi:;return m>=g.Editing};this.NotifyMove=function(i){ULSEWi:;if(i!=null&&i!=s)return;if(m>=g.Bound){var c=s.GetFocusedCell(),f=c&&c.GetTd();if(f!=null&&u!=null&&h.key()==c.GetRecordKey()&&e.key==c.GetFieldKey()){u=f;l=Z();if(l!=null){t=O();A=bb(l,t);b.SetCellInfo();b.actor.OnCellMove();for(var d=0;d<a.length;d++){x(a[d].name);a[d].SetCellInfo()}B()}}else f==null&&u!=null&&j.Unbind()}};this.NotifyUpdateProperty=function(f,d,e,a,c){ULSEWi:;if(this.IsBoundToCell(f,d,e)){var b={};if(a.HasDataValue())b.data=a.data;if(a.HasLocalizedValue())b.localized=a.localized;G(b);(K==null||c!=null&&c.CompareTo(K)!=0)&&Q(b,SP.JsGrid.EditActorUpdateType.Committed,null)}};this.ExpandWidget=function(c){ULSEWi:;var b=SP.Internal.JS.FindInArray(a,function(a){ULSEWi:;return a.name==c});b!=null&&F(a[b].actor)};this.ExpandNextActor=function(){ULSEWi:;function d(e){ULSEWi:;if(c.length==0||c[0].actor.Expand==null&&c.length==1)return null;var d,b=c[0].actor.Expand!=null?0:1;if(w==null)d=c[b];else for(var a=b;a<c.length;a++)if(c[a].name==w){d=e?a==c.length-1?c[b]:c[a+1]:a==b?c[c.length-1]:c[a-1];break}return d}if(m>=g.Bound&&(b.actor.Expand!=null||a.length)){var e=d(true);return yb(e)}return false};this.NotifyExpandWidget=function(a){ULSEWi:;P(a);mb(a)};this.NotifyCollapseWidget=function(a){ULSEWi:;N(a);V(a)};this.NotifyWidgetEditCancel=function(a){ULSEWi:;r=R;n=null;x(a);if(this.IsEditing())b.actor.Focus();else d.focusMgr.Focus()};this.NotifyExpandControl=function(a){ULSEWi:;jb(a)};this.SetCurrentValue=function(a,b){ULSEWi:;Q(b,SP.JsGrid.EditActorUpdateType.Uncommitted,a)};this.OnActorKeyDown=function(a,c){ULSEWi:;if(!i(a))if(m==g.Bound&&c==b.name)j.BeginEdit(a);else{var f=false,e=c==b.name?b:p.GetWidgetControlAPI(c);if(e.actor.OnKeyDown!=null)f=e.actor.OnKeyDown(a);var h=I||e.IsLightFocus();if(!f&&h)if(d.focusMgr.HandleKeyDown(a))n!=null&&n==c&&j.StopEditing(false)}else SP.Internal.DomElement.StopEvent(a);function i(){ULSEWi:;var b=false;if(a.keyCode==Sys.UI.Key.tab||a.keyCode==Sys.UI.Key.enter){j.StopEditing(false);d.focusMgr.HandleKeyDown(a);b=true}else if(a.keyCode==Sys.UI.Key.esc){j.StopEditing(true);b=true}return b}};this.GetCurrentEditControlName=function(){ULSEWi:;return b.name};this.Dispose=function(){ULSEWi:;this.Unbind(function(){ULSEWi:;p.Dispose();E!=null&&E();$clearHandlers(i);i.innerHTML="";i=null})}};SP.JsGrid.Internal.ErrorType={Row:1,Cell:2};SP.JsGrid.Internal.RecordErrorCollection=function(d){ULSEWi:;function c(){ULSEWi:;this._errors=[]}c.prototype={AddError:function(b,a){ULSEWi:;this._errors.unshift({id:b,msg:a})},RemoveError:function(b){ULSEWi:;var a=SP.Internal.JS.FindInArray(this._errors,function(a){ULSEWi:;return b==a.id});if(a!=null){this._errors.splice(a,1);return true}return false},AnyErrors:function(){ULSEWi:;return this._errors.length!=0},GetTopMessage:function(){ULSEWi:;return this._errors.length>0?this._errors[0].msg:null},GetTopId:function(){ULSEWi:;return this._errors.length>0?this._errors[0].id:null},GetMinError:function(c){ULSEWi:;for(var d=null,b=this._errors.length-1;b>=0;b--){var a=this._errors[b];if(c==null||c(a.id))d={message:a.msg,id:a.id}}return d},ContainsError:function(a){ULSEWi:;return SP.Internal.JS.FindInArray(this._errors,function(b){ULSEWi:;return a==b.id})!=null}};var b=new c,a={};this.AddRowError=function(c,a){ULSEWi:;b.AddError(c,a)};this.AddCellError=function(b,e,d){ULSEWi:;if(!(b in a))a[b]=new c;a[b].AddError(e,d)};this.ClearRowError=function(a){ULSEWi:;return b.RemoveError(a)};this.ClearCellError=function(b,c){ULSEWi:;if(b in a&&a[b].RemoveError(c)){if(!a[b].AnyErrors())delete a[b];return true}return false};this.ClearAllErrorsOnCell=function(b){ULSEWi:;if(b in a)delete a[b]};this.ClearAllErrorsOnRow=function(){ULSEWi:;b=new c};this.AnyErrors=function(){ULSEWi:;return b.AnyErrors()||!SP.Internal.JS.IsAssocArrayEmpty(a)};this.AnyErrorsOnCell=function(b){ULSEWi:;return b in a&&a[b].AnyErrors()};this.AnyErrorsOnRow=function(){ULSEWi:;return b.AnyErrors()};this.GetMessageForCell=function(b){ULSEWi:;return b in a?a[b].GetTopMessage(b):null};this.GetMessageForRow=function(){ULSEWi:;return b.GetTopMessage()};this.GetIdForCell=function(b){ULSEWi:;return b in a?a[b].GetTopId():null};this.GetIdForRow=function(){ULSEWi:;return b.GetTopId()};this.GetMinError=function(e){ULSEWi:;var c=b.GetMinError(e!=null?function(a){ULSEWi:;return e(d,null,a)}:null);if(c!=null)c.type=SP.JsGrid.Internal.ErrorType.Row;for(var g in a){var f=a[g].GetMinError(e!=null?function(a){ULSEWi:;return e(d,g,a)}:null);if(f!=null&&(c==null||f.id<c.id)){c=f;c.fieldKey=g;c.type=SP.JsGrid.Internal.ErrorType.Cell}}return c}};SP.JsGrid.Internal.ErrorManager=function(b){ULSEWi:;var e=0,a={},j=null,f=this,c=new SP.Utilities.Set;b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordInserted,h);b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordDeleted,i);this.SetRowError=function(c,d){ULSEWi:;var g=this.AnyErrors();if(a[c]==null)a[c]=new SP.JsGrid.Internal.RecordErrorCollection(c);var f=e++;d=d!=null?d:SP.JsGrid.Res.defaultRowMessage;var h=g&&a[c].AnyErrorsOnRow();a[c].AddRowError(f,d);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,true,true,h,f,d));!g&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true));return f};this.ClearRowError=function(c,e){ULSEWi:;if(a[c]!=null&&a[c].ClearRowError(e)){d(c);var f=c in a&&a[c].AnyErrorsOnRow();b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,false,f,true,e));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false));return true}return false};this.SetCellError=function(c,d,i){ULSEWi:;var h=this.AnyErrors();if(a[c]==null)a[c]=new SP.JsGrid.Internal.RecordErrorCollection(c);var g=a[c].AnyErrorsOnCell(d),f=e++;a[c].AddCellError(d,f,i);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,d,true,true,g,f));!h&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true));return f};this.ClearCellError=function(c,e,f){ULSEWi:;if(a[c]!=null&&a[c].ClearCellError(e,f)){d(c);var g=c in a&&a[c].AnyErrorsOnCell(e);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,e,false,g,true,f));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false));return true}return false};this.ClearAllErrorsOnRow=function(c){ULSEWi:;var e=false;if(c in a){e=true;a[c].ClearAllErrorsOnRow();d(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,false,false,-1));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}return e};this.ClearAllErrorsOnCell=function(c,e){ULSEWi:;var f=false;if(c in a&&a[c].AnyErrorsOnCell(e)){f=true;var g=a[c].GetIdForCell(e);a[c].ClearAllErrorsOnCell(e);d(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,e,false,false,g));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}return f};this.CellHasError=function(b,d){ULSEWi:;return b in a&&!c.Contains(b)&&a[b].AnyErrorsOnCell(d)};this.GetMessageForCell=function(b,d){ULSEWi:;return b in a&&!c.Contains(b)?a[b].GetMessageForCell(d):null};this.GetMessageForRow=function(b){ULSEWi:;return b in a&&!c.Contains(b)?a[b].GetMessageForRow():null};this.AnyErrors=function(){ULSEWi:;var b=false;for(var d in a)if(!c.Contains(d)){b=true;break}return b};this.AnyErrorsInRow=function(b){ULSEWi:;return b in a&&!c.Contains(b)&&a[b].AnyErrors()};this.GetNextError=function(c,b){ULSEWi:;var a=null;if(this.AnyErrors()){if(c!=null&&c<e)a=g(function(d,e,a){ULSEWi:;return a>c&&(b==null||b(d,e,a))});if(a==null)a=g(b)}return a};this.GetNextErrorForRecord=function(g,d,f){ULSEWi:;var b=null;if(d in a&&!c.Contains(d)){if(g!=null&&g<e)b=a[d].GetMinError(function(b,c,a){ULSEWi:;return a>g&&(f==null||f(b,c,a))});if(b==null)b=a[d].GetMinError(f);if(b!=null)b.recordKey=d}return b};this.ChangeKeys=function(b,d){ULSEWi:;if(c.Contains(b)){c.Remove(b);c.Add(d)}if(b in a){a[d]=a[b];delete a[b]}};function g(e){ULSEWi:;var b=null;for(var d in a){var c=a[d].GetMinError(e);if(c!=null&&(b==null||c.id<b.id)){b=c;b.recordKey=d}}return b}function h(d){ULSEWi:;var a=f.AnyErrors();c.Remove(d.recordKey);!a&&f.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true))}function i(d){ULSEWi:;var a=f.AnyErrors();c.Add(d.recordKey);a&&!f.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}function d(b){ULSEWi:;if(!a[b].AnyErrors())delete a[b]}};SP.JsGrid.Internal.ErrorNotificationManager=function(){ULSEWi:;var a=null,b,c,d=null;function e(d){ULSEWi:;if(d.bAnyErrors&&a==null)a=addNotification('<div class="jsgrid-error-notification" style="cursor:hand" onclick="'+(c+"_onclick()")+'" >'+String.format(SP.JsGrid.Res.gridErrorNotification,b.jsGridObj.name)+"</div>",true);else if(!d.bAnyErrors&&a!=null){removeNotification(a);a=null}}return {Init:function(f,a){ULSEWi:;b=a;b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,e);c=f;window[c+"_onclick"]=function(){ULSEWi:;d=b.jsGridObj.ScrollToAndExpandNextError(d)}}}}();SP.JsGrid.GridField=function(f,e,c,d,b,a){ULSEWi:;this.key=f;this.hasDataValue=e;this.hasLocalizedValue=c;this.textDirection=d;this._defaultCellStyleId=b;this._editMode=a==null?SP.JsGrid.EditMode.Defer:a;this._propType=null;this._multiValue=false};SP.JsGrid.GridField.prototype={GetEditMode:function(){ULSEWi:;return this._editMode},SetEditMode:function(a){ULSEWi:;this._editMode=a},GetDefaultCellStyleId:function(){ULSEWi:;return this._defaultCellStyleId},CompareSingleDataEqual:function(a,b){ULSEWi:;var c=this.GetSingleValuePropType().IsDataEqual;return c==null?a==b:c(a,b)},GetPropType:function(){ULSEWi:;return this._propType},GetSingleValuePropType:function(){ULSEWi:;return this._multiValue?this._propType.singleValuePropType:this._propType},GetMultiValuePropType:function(){ULSEWi:;return this._multiValue?this._propType:null},SetSingleValuePropType:function(a){ULSEWi:;if(this._multiValue&&a!=null){var b=new SP.JsGrid.PropertyType.MultiValuePropType(a.ID,this._listSeparator);SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(b,a.ID);this._propType=b}else this._propType=a},SetIsMultiValue:function(a){ULSEWi:;if(!this._multiValue){this._listSeparator=a;this._multiValue=true;this.SetSingleValuePropType(this._propType)}},GetIsMultiValue:function(){ULSEWi:;return this._multiValue}};SP.JsGrid.ColumnInfo=function(d,b,a,c){ULSEWi:;this.name=d;this.imgSrc=b;this.columnKey=a;this.fieldKeys=[a];this.width=c};SP.JsGrid.ColumnInfo.prototype={ColumnType:function(){ULSEWi:;return "column"},isVisible:true,isHidable:true,isResizable:true,isSortable:true,isAutoFilterable:true,fnShouldLinkSingleValue:null,fnSingleValueClicked:null,fnGetCellEditMode:null,fnGetDisplayControlName:null,fnGetEditControlName:null,fnGetWidgetControlNames:null,fnGetCellStyleId:null,fnGetSingleValueTooltip:null};SP.JsGrid.PivotedColumnInfo=function(e,c,a,b,d){ULSEWi:;this.name=e;this.imgSrc=c;this.columnKey=a;this.fieldKeys=b;this.width=d};SP.JsGrid.PivotedColumnInfo.prototype={ColumnType:function(){ULSEWi:;return "pivotedColumn"},isVisible:true,isHidable:false,isResizable:false,isSortable:false,isAutoFilterable:false,fnShouldLinkSingleValue:null,fnSingleValueClicked:null,fnGetCellEditMode:null,fnGetDisplayControlName:null,fnGetEditControlName:null,fnGetWidgetControlNames:null,fnGetCellStyleId:null,fnGetSingleValueTooltip:null};SP.JsGrid.ColumnInfoCollection=function(a){ULSEWi:;var b={};c();this.GetColumnByKey=function(a){ULSEWi:;return b[a]};this.GetColumnArray=function(d){ULSEWi:;var c=[];if(d)for(var b=0;b<a.length;++b)a[b].isVisible&&c.push(a[b]);else c=a;return c};this.GetColumnMap=function(){ULSEWi:;return b};this.InsertColumnAt=function(d,b){ULSEWi:;a.splice(d,0,b);c()};this.RemoveColumn=function(e){ULSEWi:;var f=b[e],d=SP.Internal.JS.FindKey(a,function(a){ULSEWi:;return a==f});d!=null&&a.splice(d,1);c()};this.GetColumnPosition=function(d){ULSEWi:;for(var c=0,b=0;b<a.length;++b)if(a[b].isVisible){if(a[b].columnKey==d)return c;c++}return null};function c(){ULSEWi:;for(var c=0;c<a.length;++c)b[a[c].columnKey]=a[c]}};SP.JsGrid.Internal.FillDownManager=function(k,m){ULSEWi:;var i,d,b,g,a,c,e,f;this.OnMouseDown=function(c,n,k,e,o,j){ULSEWi:;c.preventDefault();i=o;d=j;b=n;g=k;f=SP.Internal.DomElement.GetEventLocation(c);a=document.createElement("div");a.style.cssText="position:absolute;visibility:hidden;overflow:hidden;top:0px;left:0px";a.style.border=SP.JsGrid.Style.MakeBorderString(3,"solid",m.gridPaneStyle.fillRectBorderColor);g.appendChild(a);SP.Internal.DomElement.SetCapture(e,h,l);h(c)};function h(k){ULSEWi:;var h=d.GetLastSelectionRangeNormalized(),j=i.GetRowIdxColIdxFromCoord(k);if(j.rowIdx==null||j.colIdx==null)return;var l=SP.Internal.DomElement.GetEventLocation(k);e=Math.abs(l.x-f.x)>Math.abs(l.y-f.y);var g;if(e){c=new SP.Utilities.Range(Math.min(h.colRange.begin,j.colIdx),Math.max(h.colRange.end,j.colIdx));g=b.GetCellRangeBorderDrawingInfo(h.rowRange,c)}else{c=new SP.Utilities.Range(Math.min(h.rowRange.begin,j.rowIdx),Math.max(h.rowRange.end,j.rowIdx));g=b.GetCellRangeBorderDrawingInfo(c,h.colRange)}if(g==null){a.style.visibility="hidden";return}a.style.left=g.left-1+"px";a.style.top=g.top-1+"px";a.style.width=g.width-2+"px";a.style.height=g.height-2+"px";a.style.visibility="";b.ClipElementToTableViewport(a)}function l(){ULSEWi:;if(c==null)return;var b=j();n(b.repeatOrigin,b.srcRowRange,b.srcColRange,b.destRowRange,b.destColRange,b.trimmedDestRowRange,b.trimmedDestColRange);g.removeChild(a);a=null}function j(){ULSEWi:;var f=d.GetLastSelectionRangeNormalized(),l,n,m,b,a,j,i;if(e){n=b=j=f.rowRange;a=c;var k=f.colRange.begin!=a.begin;l=k?"TR":"TL";var g=f.colRange.Size();m=k?new SP.Utilities.Range(a.end-g+1,a.end):new SP.Utilities.Range(a.begin,a.begin+g-1);i=k?new SP.Utilities.Range(a.begin,a.end-g):new SP.Utilities.Range(a.begin+g,a.end)}else{m=a=i=f.colRange;b=c;var o=f.rowRange.begin!=b.begin;l=o?"BL":"TL";var h=f.rowRange.Size();n=o?new SP.Utilities.Range(b.end-h+1,b.end):new SP.Utilities.Range(b.begin,b.begin+h-1);j=o?new SP.Utilities.Range(b.begin,b.end-h):new SP.Utilities.Range(b.begin+h,b.end)}return {repeatOrigin:l,srcRowRange:n,srcColRange:m,destRowRange:b,destColRange:a,trimmedDestRowRange:j,trimmedDestColRange:i}}function n(l,g,f,a,e,i,h){ULSEWi:;if(g.Size()==a.Size()&&f.Size()==e.Size())return;var j=b.GetGridPaneConverter(),c;k.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(b){ULSEWi:;return c=j.GetRecordsInvolved(a.begin,a.Size(),function(a){ULSEWi:;c=a;b()})},function(){ULSEWi:;var k=b.GetData(c,g,f);b.PutData(k,c,"Fill",l,i,h,j);function j(){ULSEWi:;d.SelectRange(b,a.begin,a.end,e.begin,e.end,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true,false)}})}};SP.JsGrid.Internal.FocusManager=function(k,b,e,o,u,H,c,f,I,G,C){ULSEWi:;var m=this,g={anchor:0,input:1,parentNode:2},j=g.input,x,a,t=e.parentNode,i,A=true,d,p,h,l,v,K=SP.JsGrid.Internal.SelectionManager.SelectOp;this.SetView=function(c,d,a,b){ULSEWi:;p=c;h=d;l=a;v=b;x.NotifyViewChange()};this.Dispose=function(){ULSEWi:;$clearHandlers(i);$removeHandler(a,"focus",y);$removeHandler(a,"keydown",q);$removeHandler(a,"keypress",w);$removeHandler(a,"keyup",z);a=i=null};this.Focus=function(){ULSEWi:;try{f.IsEditing()&&f.StopEditing(false);r();a.focus()}catch(b){}};this.GetFocusElementForTextInput=function(b){ULSEWi:;if(A&&j==g.input&&b==SP.JsGrid.EditControl.Type.EditBox)return a;else return null};this.ChangeTextInputElementToFocusElement=function(){ULSEWi:;if(n()){a.blur();r();return true}return false};this.HandleKeyDown=function(a){ULSEWi:;var w=a.ctrlKey&&!a.altKey&&!a.shiftKey,x=!a.ctrlKey&&a.altKey&&!a.shiftKey,s=!a.ctrlKey&&!a.altKey&&a.shiftKey,y=!a.ctrlKey&&a.altKey&&a.shiftKey,t=a.ctrlKey&&!a.altKey&&a.shiftKey,r=!a.ctrlKey&&!a.altKey&&!a.shiftKey,i=c.GetFocus();if(!u()||i==null)return false;var k=i.gridPane,n=k.GetGridPaneConverter();if(B()){SP.Internal.DomElement.StopEvent(a);return true}if(J())return true;var M=L()||H()||z()||D()||E()||A();if(M){SP.Internal.DomElement.StopEvent(a);return true}F();return false;function F(){ULSEWi:;!f.IsEditing()&&c.IsOneCellSelected(c.GetLastSelectionRangeNormalized())&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnSingleCellKeyDown,new SP.JsGrid.EventArgs.SingleCellKeyDown(a,i.recordKey,i.fieldKey))}function J(){ULSEWi:;if(a.keyCode==SP.Internal.Key.IMEInput)return k.TryBeginEdit(a);return false}function L(){ULSEWi:;if(a.keyCode==Sys.UI.Key.esc){b.cutcopypasteMgr.CancelMode();return true}return false}function H(){ULSEWi:;function h(){ULSEWi:;function h(a){ULSEWi:;var c=a.GetColumn(),d=a.GetRecord(),b=a.GetFieldKey();if(d!=null){var e=d.GetProp(b),f=e==null?v[b].GetPropType():e.propType;return SP.JsGrid.Internal.Property.GetDisplayControlForProperty(f,c.fnGetDisplayControlName&&c.fnGetDisplayControlName(c,d,b))}else return null}k.ScrollCellIntoView(i.rowIdx,i.colIdx);var c=k.GetCellByIdx(i.rowIdx,i.colIdx);if(c!=null){var a=h(c),b=c.GetTd().childNodes;if(b&&a&&a.FocusNext&&a.FocusPrevious){var f=a.FocusNext(b,null);if(f!=null){d={};d.displayControl=a;d.displayControlContent=b;d.DOMElement=f;j==g.input&&$addHandler(e,"keydown",q)}}}}function l(){ULSEWi:;var a=b.tableCache.GetCachedRecord(i.recordKey);if(a!=null&&b.editUtil.CanEditField(a,n.GetColumnByIdx(i.colIdx),i.fieldKey)){var c=SP.JsGrid.CreateUnvalidatedPropertyUpdate(i.recordKey,i.fieldKey,null,true);b.jsGridObj.UpdateProperties([c],"User Edit")}}switch(a.keyCode){case Sys.UI.Key.del:if(r||w){if(b.editUtil.IsEditingEnabled())if(r)l();else b.delegateMgr.Apply(SP.JsGrid.DelegateType.DeleteRecords);else alert(o("GridNotEditable"));return true}break;case SP.Internal.Key.insert:if(r){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.InsertRecord);else alert(o("GridNotEditable"));return true}break;case Sys.UI.Key.down:if(x){k.ScrollCellIntoView(i.rowIdx,i.colIdx);var c=k.GetCellByIdx(i.rowIdx,i.colIdx);c!=null&&c.GetRecord()!=null&&f.IsBound()&&f.ExpandNextActor();return true}break;case Sys.UI.Key.up:if(x){h();return true}break;case Sys.UI.Key.right:if(y){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.IndentRecords);else alert(o("GridNotEditable"));return true}break;case Sys.UI.Key.left:if(y){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.OutdentRecords);else alert(o("GridNotEditable"));return true}break;case SP.Internal.Key.comma:if(t)return k.TryShiftColumnSelectionGroup(i.rowIdx,i.colIdx,-1);break;case SP.Internal.Key.dot:if(t)return k.TryShiftColumnSelectionGroup(i.rowIdx,i.colIdx,1);break;case SP.Internal.Key.back_slash:if(x)return k.ExpandColumnMenu(i.colIdx);else if(t){G();return true}break;case SP.Internal.Key.F2:if(r)return k.TryBeginEdit(a)}return false}function z(){ULSEWi:;function f(c,d){ULSEWi:;switch(a.keyCode){case Sys.UI.Key.enter:if(r){if(c!=null)c++}else if(s){if(c!=null)--c}else return null;break;case Sys.UI.Key.down:if(r||s||w||t){if(a.ctrlKey)c=n.GetVirtualRowCount()-1;else if(c!=null)c++}else return null;break;case Sys.UI.Key.up:if(r||s||w||t){if(a.ctrlKey)c=0;else if(c!=null)c--}else return null;break;case Sys.UI.Key.pageDown:if(r||s){if(c!=null){var e=n.RowIdxToRelRowIdx(c),f=n.GetWholeRowDisplayCapacity()-1;e=e!=f?f:f*2;c=n.RelRowIdxToRowIdx(e)}}else return null;break;case Sys.UI.Key.pageUp:if(r||s){if(c!=null){var e=n.RowIdxToRelRowIdx(c),f=n.GetWholeRowDisplayCapacity()-1;e=e!=0?0:-f;c=n.RelRowIdxToRowIdx(e)}}else return null;break;case Sys.UI.Key.home:if(r||s||w||t){d=0;if(a.ctrlKey)c=0}else return null;break;case Sys.UI.Key.end:if(r||s||w||t){d=n.GetVirtualColumnCount()-1;if(a.ctrlKey)c=n.GetVirtualRowCount()-1}else return null;break;case Sys.UI.Key.right:if(r||s){if(d!=null)d=d+(b.RTL.bEnabled?-1:1)}else return null;break;case Sys.UI.Key.left:if(r||s){if(d!=null)d=d-(b.RTL.bEnabled?-1:1)}else return null;break;case SP.Internal.Key.six:if(t){d=0;c=n.GetVirtualRowCount()-1}else return null;break;default:return null}var g;if(c!=null)c=Math.max(0,Math.min(n.GetVirtualRowCount()-1,c));if(d!=null)d=Math.max(0,Math.min(n.GetVirtualColumnCount()-1,d));return {rowIdx:c,colIdx:d}}function g(c,b){ULSEWi:;if(!a.shiftKey){if(++b==n.GetVirtualColumnCount()){b=0;if(++c==n.GetVirtualRowCount())return null}}else if(--b==-1){b=n.GetVirtualColumnCount()-1;if(--c==-1)return null}return {rowIdx:c,colIdx:b}}if(w||x||s||y||r||t)if(a.keyCode==Sys.UI.Key.tab){var d=g(i.rowIdx,i.colIdx);if(d!=null){c.SetFocusByPos(k,d.rowIdx,d.colIdx);return true}}else if(!a.shiftKey||s&&a.keyCode==Sys.UI.Key.enter){var d=f(i.rowIdx,i.colIdx);if(d!=null){c.SetFocusByPos(k,d.rowIdx,d.colIdx);return true}}else{var e=c.GetLastSelectionEndpoints(),d=f(e.rowIdx2,e.colIdx2);if(d!=null){d.rowIdx!=null&&C(d.rowIdx);d.colIdx!=null&&k.ScrollColumnIntoViewHorizontally(d.colIdx);c.SelectRange(k,e.rowIdx1,d.rowIdx,e.colIdx1,d.colIdx,K.Set,false,false);return true}}return false}function D(){ULSEWi:;var b=h.GetGridPaneConverter();if(a.keyCode==Sys.UI.Key.tab){if(p==SP.JsGrid.PaneLayout.GridAndPivotedGrid)if(r){if(k.Id==SP.JsGrid.PaneId.MainGrid){c.SetFocusByPos(l,0,0);return true}}else if(s&&k.Id==SP.JsGrid.PaneId.PivotedGrid){var e=b.GetVirtualRowCount()-1,d=b.GetVirtualColumnCount()-1;c.SetFocusByPos(h,e,d);return true}k.ShowFocus(false)}else if(a.keyCode==SP.Internal.Key.F6)if(p==SP.JsGrid.PaneLayout.GridAndPivotedGrid)if(k.Id==SP.JsGrid.PaneId.MainGrid){c.SetFocusByPos(l,l.GetGridPaneConverter().GetTopRowIdxForKey(i.recordKey),0);return true}else if(k.Id==SP.JsGrid.PaneId.PivotedGrid){c.SetFocusByPos(h,b.GetTopRowIdxForKey(i.recordKey),0);return true}return false}function B(){ULSEWi:;if(d==null)return false;if(a.target==d.DOMElement&&(a.keyCode==Sys.UI.Key.tab||a.keyCode==SP.Internal.Key.shift)){if(a.keyCode==Sys.UI.Key.tab){if(r)d.DOMElement=d.displayControl.FocusNext(d.displayControlContent,d.DOMElement);else if(s)d.DOMElement=d.displayControl.FocusPrevious(d.displayControlContent,d.DOMElement);d.DOMElement==null&&m.Focus()}return true}m.Focus();return false}function E(){ULSEWi:;var c=b.cutcopypasteMgr;if(a.ctrlKey&&!a.altKey&&!a.shiftKey)switch(String.fromCharCode(a.keyCode).toUpperCase()){case "X":c.OnCut(k);return true;case "C":c.OnCopy(k);return true;case "V":c.OnPaste(k);return true}return false}function A(){ULSEWi:;var c=k.GetCellByIdx(i.rowIdx,i.colIdx);if(c!=null){var b=c.GetRecord();if(b!=null){var e=c.GetColumn(),d=c.GetFieldKey(),h=v[d],j=b.GetProp(d),f=j==null?h.GetPropType():j.propType,g=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(f,e.fnGetDisplayControlName&&e.fnGetDisplayControlName(e,b,d));if(g.OnKeyDown!=null)return g.OnKeyDown(a,I(b,d,f),b,e,h,f)}}return false}};function n(){ULSEWi:;return f.IsEditing()&&m.GetFocusElementForTextInput(f.GetCurrentEditControlName())!=null}function y(){ULSEWi:;if(n())return;if(H()){var b=c.GetFocus();if(b==null){var a=h.GetGridPaneConverter();if(a.GetVirtualRowCount()==0)return;else c.SetFocusByPos(h,a.GetTopRowIdx(),h.GetLeftMostColumnIdx())}else b.gridPane.ShowFocus(true);if(d!=null){d=null;j==g.input&&$removeHandler(e,"keydown",q)}}}function q(a){ULSEWi:;if(n())f.OnActorKeyDown(a,f.GetCurrentEditControlName());else if(f.IsEditing())if(j==g.input){f.StopEditing();m.HandleKeyDown(a)}else return;else m.HandleKeyDown(a)}function w(a){ULSEWi:;if(f.IsEditing())return;var b=c.GetFocus();if(!u()||b==null)return;var e=b.gridPane;function d(){ULSEWi:;if(SP.JsGrid.Utility.IsChar(a)&&!a.altKey&&!a.ctrlKey)e.TryBeginEdit(a)&&!n()&&SP.Internal.DomElement.StopEvent(a)}d()}function z(){ULSEWi:;if(f.IsEditing())return;if(j==g.input)a.value=""}function F(){ULSEWi:;switch(j){case g.anchor:a=D();s(a,a);break;case g.input:a=E();r();s(e,e);break;case g.parentNode:a=B();s(e,e)}}function D(){ULSEWi:;var a=document.createElement("a");a.id=k+"_focusElement";a.href="#";t.insertBefore(a,e);a.appendChild(e);return a}function E(){ULSEWi:;var a=document.createElement("input");a.id=k+"_focusElement";a.className="jsgrid-control-editbox";e.insertBefore(a,e.firstChild);return a}function r(){ULSEWi:;var b=a.style;b.position="fixed";b.top="0px";b.left="-10000px";a.value=""}function B(){ULSEWi:;e.tabIndex=0;return e}function s(b,d){ULSEWi:;var a=document.createElement("a");a.href="#";a.className="ms-skip";a.onclick=function(){ULSEWi:;this.href="#"+k+"_skippedGridContent"};SP.Internal.DomElement.SetText(a,SP.JsGrid.Res.skipGridContent);t.insertBefore(a,b);i=document.createElement("a");i.id=k+"_skippedGridContent";i.href="#";t.insertBefore(i,d.nextSibling);$addHandler(i,"keydown",e);function e(d){ULSEWi:;if(d.shiftKey&&d.keyCode==Sys.UI.Key.tab){var g=c.GetFocus();if(g==null){var b=p==SP.JsGrid.PaneLayout.GridAndPivotedGrid?l:h,a=b.GetGridPaneConverter(),f=a.GetVirtualRowCount()-1,e=a.GetVirtualColumnCount()-1;c.SetFocusByPos(b,f,e)}}}}function L(){ULSEWi:;F();x=b.ariaMgr=new J;$addHandler(a,"focus",y);$addHandler(a,"keydown",q);$addHandler(a,"keypress",w);$addHandler(a,"keyup",z)}function J(){ULSEWi:;var d=this;function f(){ULSEWi:;a.setAttribute("role",b.controller.GetHierarchyManager()==null?"grid":"treegrid");var c=document.createElement("label");c.id=a.id+"_labelFor";c.setAttribute("for",a.id);c.appendChild(document.createTextNode(b.jsGridObj.name));c.style.cssText="display:none;";e.appendChild(c);a.setAttribute("aria-label",b.jsGridObj.name);a.setAttribute("aria-labelledby",a.id+"_labelFor");a.setAttribute("aria-multiselectable","true");j==g.input&&a.setAttribute("aria-owns",k)}this.NotifyViewChange=function(){ULSEWi:;d.EnableGrid(u());d.EnableGridEditing(b.editUtil.IsEditingEnabled())};this.EnableGrid=function(b){ULSEWi:;a.setAttribute("aria-disabled",(!b).toString())};this.EnableGridEditing=function(b){ULSEWi:;a.setAttribute("aria-readonly",(!b).toString())};this.OnFocusCell=function(i,j,g,c,f){ULSEWi:;if(j!=null){var e=j.GetTd();e.removeAttribute("id");e.removeAttribute("aria-describedby");d.SetSelected(e,false);if(g!=null){var n=g.GetTd();n.removeAttribute("id")}}if(c!=null){var e=c.GetTd(),l=String.format("{0}_{1}_{2}_{3}",k,i,c.GetRowIdx(),c.GetColIdx());e.setAttribute("id",l);a.setAttribute("aria-activedescendant",l);d.SetSelected(e,true);var m=c.GetRecord(),o=m!=null&&b.editUtil.CanEditField(m,c.GetColumn(),c.GetFieldKey());e.setAttribute("aria-readonly",(!o).toString());if(f!=null){var n=f.GetTd(),h=String.format("{0}_{1}_{2}",k,i,f.GetColIdx());n.setAttribute("id",h);e.setAttribute("aria-describedby",h)}}else a.removeAttribute("aria-activedescendant")};this.OnInsertTableRow=function(e,a,h){ULSEWi:;e.setAttribute("role","row");if(a==null&&h==-1)return;var g=a!=null&&a!=SP.JsGrid.Internal.LoadErrorState,j=g?a.key():null;if(!g)e.setAttribute("aria-busy",a==null?"true":"error");else if(b.controller.GetHierarchyManager()!=null&&!b.entryRecordMgr.IsEntryRecordKey(j)){var f=b.controller.GetHierarchyManager().GetNodeInfo(a);if(f.nodeType==SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed)e.setAttribute("aria-expanded","false");else f.nodeType==SP.JsGrid.Internal.HierarchyManager.NodeType.Expanded&&e.setAttribute("aria-expanded","true");e.setAttribute("aria-level",(f.indent+1).toString())}var k=c.GetFocusedPane(),i=c.IsRowSelected(k,h);d.SetSelected(e,i)};this.OnInsertRowHeaderCell=function(a){ULSEWi:;a.setAttribute("role","presentation")};this.OnInsertColHeaderCell=function(a){ULSEWi:;a.setAttribute("scope","col");a.setAttribute("role","columnheader")};this.OnInsertGridCell=function(a){ULSEWi:;a.setAttribute("role","gridcell")};this.SetSelected=function(b,a){ULSEWi:;b.setAttribute("aria-selected",a.toString())};f()}L()};SP.JsGrid.Internal.GridPane=function(t,c,Hb,hb,U,d,Z,j,R,Yb,l,Tb,Zb,Rb,K){ULSEWi:;var ic=c.intEventMgr,g=c.styleMgr,ec=c.jsGridObj,T=c.delegateMgr,hc=c.intDelegateMgr,db=c.ariaMgr,kb="#B0B5BA",sb="#B0B5BA",i,k=K.selDragHandle,u=K.selFrames,E=K.focusFrames,A=K.copyFrames,Ub,h,s,C,Y=false,m,ac,gc,z,n,r,j,e,y,b=this,wb,D,X,Q,G,P,H,M,tb,f,a,S,w,B=SP.JsGrid.Internal.SelectionManager.SelectOp,p,F,Ab=false,mb,jb,J,o,Bb,ab={width:-1,height:-1},x={};this.Id=SP.JsGrid.PaneId.MainGrid;this.SetEventSinks=function(a){ULSEWi:;ac=a};this.GetLeftMostColumnIdx=function(){ULSEWi:;return m.GetTopItemIdx()};this.Dispose=function(){ULSEWi:;J!=null&&SP.JsGrid.AsynchronousCellUpdater.FlushJob(J);b.ClearView();$clearHandlers(t);$clearHandlers(i);f.Dispose();a.Dispose();m.Dispose();l.Dispose();S.Dispose();i=k=u=E=A=Ub=h=h.textDiv=s=t=null;Ab=true};this.ClearView=function(){ULSEWi:;q();S.ClearHeaderEvents();a.ClearTable()};this.SetView=function(s,q,f,r,h,p,k,o,n,e,j){ULSEWi:;var b=Math.max(0,l.GetHeight()-fb());i.style.height=b+"px";wb=q;X=h;Q=p;G=k;P=o;H=n;M=e;tb=j;D=r;a.SetPosConverterObj(s);var c=a.InitTable(tb);c!=null&&SP.JsGrid.Style.ApplyCornerHeaderBorderStyle(c.GetTd(),g.columnHeaderStyleCollection.normal,g.rowHeaderStyleCollection.normal);cb(f,true);var d=l.GetWidth();m.Update({physicalViewportSize:d-a.GetRowHeaderWidth(),scrollbarSize:d,topItemIdx:0,bScrollNotifiy:false});eb(b);S.SetupHeaderEvents()};this.GetGridPaneConverter=function(){ULSEWi:;return e};this.ShowFocus=function(a){ULSEWi:;W(!a)};this.OnResize=function(){ULSEWi:;var c={width:l.GetWidth(),height:l.GetHeight()};if(c.width!=ab.width||c.height!=ab.height){a.OptimizeTableColumns();yb();var d=l.GetWidth();m.Update({physicalViewportSize:d-a.GetRowHeaderWidth(),scrollbarSize:d});q();j.NotifyMove(b);ab=c}};this.SetRowHeight=function(b){ULSEWi:;Bb=b;a.SetRowHeight(Bb)};this.GetMinRowHeight=function(){ULSEWi:;return 21};this.SpliceRows=function(b,c,e,f,d){ULSEWi:;a.SpliceRows(b,c,e,f);if(r!=null&&r>=b&&r<=b+c-1)r=null;if(d)bb();else q()};this.SetSortState=function(a){ULSEWi:;f.SetSortState(a)};this.SetFilterState=function(a){ULSEWi:;f.SetFilterState(a)};this.NotifyCanEditUpdated=function(){ULSEWi:;vb();W(false)};this.NotifyCopyOperationUpdated=function(){ULSEWi:;ub()};this.UpdateFocusAfterInsertOrDeleteRows=function(c,e,f){ULSEWi:;var a=d.GetFocusForPane(b);if(a!=null)if(f)a.rowIdx>=c&&d.SetFocusByPos(b,a.rowIdx+e,a.colIdx);else if(a.rowIdx>=c&&a.rowIdx<c+e)d.SetFocusByPos(b,Math.max(c-1,0),a.colIdx);else a.rowIdx>=c+e&&d.SetFocusByPos(b,a.rowIdx-e,a.colIdx)};this.ChangeKeys=function(c,b){ULSEWi:;a.ChangeKeys(c,b)};this.RenderRows=function(b){ULSEWi:;a.RenderRows(b)};this.NotifyChangeIndicatorsClearing=function(){ULSEWi:;for(var d=a.GetAllDataCells(),c=0;c<d.length;c++){var b=d[c];if(b.GetRecord()!=null)Z.IsCellIn(b.GetRecordKey(),b.GetFieldKey())&&I(b,true,false)}};this.Select=function(f,g,c,e,a){ULSEWi:;d.SelectRange(b,f,g,c,e,a?B.Append:B.Set,true,false)};this.SelectByKey=function(c,d,a,b,j){ULSEWi:;var h,i,f,g;if(c!=null&&d!=null){h=a!=null?e.KeyToIdx(c,a).rowIdx:e.GetTopRowIdxForKey(c);i=b!=null?e.KeyToIdx(d,b).rowIdx:e.GetTopRowIdxForKey(d)}if(a!=null&&b!=null){f=e.FieldKeyToColIdx(a);g=e.FieldKeyToColIdx(b)}this.Select(h,i,f,g,j)};this.NotifySelectionUpdating=function(){ULSEWi:;var c={rowRange:new SP.Utilities.Range(a.BeginRowIdx(),a.EndRowIdx()-1),colRange:new SP.Utilities.Range(a.BeginColIdx(),a.EndColIdx()-1)},e=d.GetComponentsWithin(b,c.rowRange,c.colRange);return {visibleRanges:c,clearedCells:e,oldFocus:d.GetFocusForPane(b)}};this.ScrollCellIntoView=function(e,d){ULSEWi:;var c=Hb(e),a=b.ScrollColumnIntoViewHorizontally(d);return c||a};this.GetCellByIdx=function(c,b){ULSEWi:;return a.GetCellByIdx(c,b)};this.NotifySelectionUpdated=function(c,l){ULSEWi:;var e=d.GetFocusForPane(b),o=d.GetComponentsWithin(b,c.visibleRanges.rowRange,c.visibleRanges.colRange);m(c.clearedCells,o,c.oldFocus,e);p();var g=false;if(e&&l)g=b.ScrollCellIntoView(e.rowIdx,e.colIdx);!g&&q();vb();var k,i,j,h;if(c.oldFocus!=null){k=a.GetCellByIdx(c.oldFocus.rowIdx,c.oldFocus.colIdx);i=a.GetColumnHeader(c.oldFocus.colIdx)}if(e!=null){j=a.GetCellByIdx(e.rowIdx,e.colIdx);h=a.GetColumnHeader(e.colIdx)}db.OnFocusCell(this.Id,k,i,j,h);function m(i,h,c,b){ULSEWi:;var d=i.SymmetricDifference(h);if(c!=null){d.Remove(SP.JsGrid.Internal.MakeCellKey(c.rowIdx,c.colIdx));e(c)}if(b!=null){d.Remove(SP.JsGrid.Internal.MakeCellKey(b.rowIdx,b.colIdx));e(b)}for(var j in d.GetCollection()){var f=SP.JsGrid.Internal.CrackCellKey(j),g=a.GetCellByIdx(f.rowIdx,f.colIdx);g!=null&&I(g,false,true)}function e(b){ULSEWi:;var c=a.GetCellByIdx(b.rowIdx,b.colIdx);if(c!=null)I(c,false,true);else L(b.recordKey,b.fieldKey,null,false)}}function p(){ULSEWi:;for(var e=a.GetColumnHeaders(),c=0;c<e.length;c++)f.ApplyHeaderStyle(e[c].GetTd(),v(e[c].GetColIdx(),false),e[c].GetColIdx()==n);e=a.GetRowHeaders();for(var c=0;c<e.length;c++){var g=e[c].GetTd();SP.JsGrid.Style.ApplyRowHeaderStyle(g,v(e[c].GetRowIdx(),true),N,e[c].GetRowIdx()==r);var h=d.IsRowSelected(b,e[c].GetRowIdx());db.SetSelected(g.parentNode,h)}}};this.GetMinHeaderHeight=function(){ULSEWi:;return 31};this.SetHeaderHeight=function(b){ULSEWi:;a.SetHeaderHeight(b)};this.ScrollColumnIntoViewHorizontally=function(b){ULSEWi:;if(b<=a.BeginColIdx())return m.Update({topItemIdx:b});else{var f=a.GetColumnHeader(b),d=f&&f.GetTd(),h=d&&(c.RTL.bEnabled?a.GetTdCoords(d).left<0:a.GetTdCoords(d).right>l.GetWidth());if(!d||h){for(var i=a.GetSelectAllSquare()?a.GetSelectAllSquare().GetTd().offsetWidth:0,g=l.GetWidth()-i-e.GetColumnByIdx(b).width;b>0&&(g-=e.GetColumnByIdx(b-1).width,g>=0);b--);return m.Update({topItemIdx:b})}}return false};this.NotifyUpdateProperty=function(b,c,f,d,g,h){ULSEWi:;f&&Z.AddCell(b,c);var e=a.GetCellByKey(b,c);if(e!=null){d!=null&&g==SP.JsGrid.ValidationState.Valid&&j.NotifyUpdateProperty(this,b,c,d,h);a.RefreshCell(e)}};this.BeginRowIdx=function(){ULSEWi:;return a.BeginRowIdx()};this.BeginColIdx=function(){ULSEWi:;return a.BeginColIdx()};this.ShowColumn=function(a,b){ULSEWi:;e.GetColumnByKey(a)==null&&dc(w.GetColumnByKey(a),b)};this.HideColumn=function(b){ULSEWi:;var a=e.GetColumnByKey(b);a!=null&&bc(a)};this.UpdateColumns=function(a){ULSEWi:;cb(a,false)};this.GetVisibleColumns=function(){ULSEWi:;for(var c=[],a=0;a<e.GetVirtualColumnCount();a++){var b=e.GetColumnByIdx(a);c.push({columnKey:b.columnKey,width:b.width})}return c};this.GetAllColumns=function(){ULSEWi:;return w};this.GetColumns=function(){ULSEWi:;for(var c=[],b=w.GetColumnArray(),a=0;a<b.length;a++)c.push(b[a]);return c};this.GetFocusedCell=function(){ULSEWi:;var c=d.GetFocusForPane(b),e=c&&a.GetCellByIdx(c.rowIdx,c.colIdx);return e!=null&&e.GetCellType()==a.CellType.Cell?e:null};this.GetData=function(j,b,a){ULSEWi:;for(var h=new Array(b.Size()),d=b.begin;d<=b.end;d++){for(var g=new Array(a.Size()),f=a.begin;f<=a.end;f++){var i=e.IdxToKey(d,f);g[f-a.begin]=c.editUtil.GetFieldValueForCopy(j[i.recordKey],i.fieldKey)}h[d-b.begin]=g}return {matrix:h,height:b.Size(),width:a.Size()}};this.PutData=function(j,u,r,d,b,a,s,h){ULSEWi:;var m=new Array(b.Size()*a.Size()),i=j.height,k=j.width,v=-b.begin+(d=="TL"||d=="TR"?0:i-b.Size()%i),t=-a.begin+(d=="TL"||d=="BL"?0:k-a.Size()%k),l=c.controller.CreateDataUpdateCmd(true),n=l.GetChangeKey();c.commandMgr.Execute(l,null,SP.JsGrid.CommandManager.CommandType.Explicit);var g=writeRowIdx=b.begin,w=b.Size()*a.Size(),p=100,f=0;c.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.DoLargeTask,w,p,q,o,SP.JsGrid.AsynchronousTaskManager.Priority.SuperHigh);function q(o,q){ULSEWi:;var p;while(g<=b.end){p=false;for(var l=a.begin;l<=a.end;l++){var d=e.IdxToKey(writeRowIdx,l);if(c.editUtil.CanEditField(h?c.entryRecordMgr.GetEntryRecord(d.recordKey):u[d.recordKey],e.GetColumnByIdx(l),d.fieldKey)){m[f++]=SP.JsGrid.CreateUnvalidatedPropertyUpdate(d.recordKey,d.fieldKey,j.matrix[(g+v)%i][(l+t)%k],true);h&&d.recordKey==c.entryRecordMgr.GetLastEntryKey()&&c.entryRecordMgr.CreateEntryRows(1,false,n);p=true}}if(!h||p)writeRowIdx++;g++;o+=a.Size();if(o>=q)break}return o}function o(){ULSEWi:;f>0&&c.controller.UpdateProperties(m.slice(0,f),r,n);l.NotifyInitialUpdateComplete();s(writeRowIdx-b.begin)}};this.FieldKeyToColumnKey=function(c){ULSEWi:;for(var b=w.GetColumnArray(),a=0;a<b.length;a++)if(SP.Internal.JS.FindInArray(b[a].fieldKeys,function(a){ULSEWi:;return a==c})!=null)return b[a].columnKey;return null};function fc(){ULSEWi:;f=new SP.JsGrid.Internal.HeaderManager(c,g);jb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(L);mb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(Lb);J=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(Sb);Gb();Fb();a=new SP.JsGrid.Internal.TableManager(i,t.id,l,Zb,c,Vb,Ob,j,d,h,Qb,Rb,Wb);e=a.GetGridPaneConverter();S=new Jb(b);function j(){ULSEWi:;lb();if(F==null)F=setTimeout(pb,0)}function d(a){ULSEWi:;f.DisposeHeader(a)}function h(a){ULSEWi:;f.UpdateHeaderHeights(a)}t.style.backgroundColor=g.gridPaneStyle.backgroundColor}function Gb(){ULSEWi:;t.style.verticalAlign="top";i=document.createElement("div");i.style.cssText="overflow:hidden;position:relative;text-align:"+c.RTL.left;t.appendChild(i);C=document.createElement("div");C.style.height=SP.Internal.ScrollBar.GetSystemScrollBarThickness()+"px";t.appendChild(C);m=new SP.JsGrid.Internal.ScrollBar(SP.JsGrid.Internal.ScrollBar.BarType.Horizontal,C,false,{itemSize:100},g.scrollBarStyle,c.RTL.bEnabled);m.SetOnScroll(Mb);hb!=null&&m.SetOnVisibilityChanged(Eb,true)}function fb(){ULSEWi:;return C.style.display=="none"?0:SP.Internal.ScrollBar.GetSystemScrollBarThickness()}function Eb(a){ULSEWi:;C.style.display=a?"":"none";yb();hb(a)}function yb(){ULSEWi:;var a=Math.max(0,l.GetHeight()-fb());i.style.height=a+"px";eb(a)}function Mb(c){ULSEWi:;a.ScrollColumns(c.topIdx);q();j.NotifyMove(b)}function cb(k,h){ULSEWi:;var l=d.GetFocusForPane(b);w=k;var i=w.GetColumnArray();p=[];for(var e=[],g=0;g<i.length;g++){var c=i[g];if(c.isVisible){f.AdjustColumnWidth(c);p.push(c.width);e.push(c)}}m.Update({itemCount:e.length,itemSizes:p});a.SetColumns(e,h);if(!h){V(l);q();j.NotifyMove(b)}}function Xb(b){ULSEWi:;r!=null&&zb();r=b;SP.JsGrid.Style.ApplyRowHeaderStyle(a.GetRowHeader(b).GetTd(),v(b,true),N)}function zb(){ULSEWi:;if(r!=null){var b=r;r=null;var c=a.GetRowHeader(b);c!=null&&SP.JsGrid.Style.ApplyRowHeaderStyle(c.GetTd(),v(b,true),N)}}function xb(b){ULSEWi:;if(n!=b){O();n=b;f.ApplyHeaderStyle(a.GetColumnHeader(b).GetTd(),v(b,false),true)}f.ShowMenuOnColumn(a.GetColumnHeader(b).GetTd())}function O(){ULSEWi:;if(n!=null&&(z==null||n!=z)){var b=n;n=null;var c=a.GetColumnHeader(b);c!=null&&f.ApplyHeaderStyle(c.GetTd(),v(b,false));f.HideMenuOnColumn()}}function Fb(){ULSEWi:;h=document.createElement("table");h.style.cssText="position:absolute; visibility:hidden; table-layout:fixed;z-index:1;padding-"+c.RTL.left+":7px;";i.appendChild(h);h.cellPadding=h.cellSpacing=0;var a=h.insertRow(-1).appendChild(document.createElement("th")),b=g.columnHeaderStyleCollection.normal;a.style.borderLeft=a.style.borderRight=SP.JsGrid.Style.MakeBorderString(1,"solid",b.innerBorderColor);a.style.borderTop=SP.JsGrid.Style.MakeBorderString(1,"solid",b.outerBorderColor);h.textDiv=a.appendChild(document.createElement("div"));h.textDiv.style.cssText="text-overflow:none; overflow:hidden; width:100%; margin-"+c.RTL.left+":-1px;";s=document.createElement("div");s.style.cssText="visibility:hidden; width:3px; background-color:"+g.gridPaneStyle.columnDropIndicatorColor+"; position:absolute";i.appendChild(s)}function Sb(c,d,b){ULSEWi:;for(var a=0;a<b.length;a++)b[a]()}function Lb(f,e,k){ULSEWi:;var b=a.GetCellByKey(f,e);if(b==null||!c.editUtil.IsEditingEnabled())return;if(!c.editUtil.CanEditField(b.GetRecord(),b.GetColumn(),e)&&(o==null||o.rk!=f||o.fk!=e)){var d=SP.JsGrid.Style.MergeCellStyles(k,g.readOnlyCellStyle);if(d.backgroundColor!=null){var h=b.GetTd(),j=SP.Internal.DomElement.GetComputedStyle(h,"backgroundColor","background-color"),i=h.computedBackgroundColor;h.computedBackgroundColor=d.backgroundColor;if(i!=j){L(f,e,b);delete d.backgroundColor}SP.JsGrid.Style.ApplyCellStyle(b.GetTd(),d)}else SP.JsGrid.Style.ApplyCellStyle(b.GetTd(),d)}}function L(l,m,w,x){ULSEWi:;var f,j=w==null?a.GetCellByKey(l,m):w;if(j!=null)f=j.GetTd();var h;if(o!=null&&o.rk==l&&o.fk==m){h=o;o=null}if(f==null||j==null)return;var u=Z.IsCellIn(l,m),i=e.KeyToIdx(l,m),q=d.GetFocusForPane(b),t=i!=null&&d.IsCellSelected(b,i.rowIdx,i.colIdx),v=i!=null&&q!=null&&i.rowIdx==q.rowIdx&&i.colIdx==q.colIdx,r=t&&!v,s=null;if(f.computedBackgroundColor==null&&v&&c.editUtil.IsEditingEnabled()&&!c.editUtil.CanEditField(j.GetRecord(),j.GetColumn(),j.GetFieldKey())){o={rk:l,fk:m,textColor:h!=null?h.textColor:f.style.color,backgroundColor:h!=null?h.backgroudColor:f.style.backgroundColor};f.style.color="#4D4E53";f.style.backgroundColor="#E2E2E2";s=true}else if(h!=null){f.style.color=h.textColor;f.style.backgroundColor=h.backgroundColor}if(!s&&(u||r)){var p=f.computedBackgroundColor,k=SP.JsGrid.Internal.Color.HexStringToColor(p=="transparent"||p==null?g.defaultCellStyle.backgroundColor!=null?g.defaultCellStyle.backgroundColor:SP.JsGrid.Style.GetCellStyleDefaultBackgroundColor():p);if(u&&!x){var n=g.gridPaneStyle.changeHighlightCellBgColor;if(n!=null)k=SP.JsGrid.Internal.Color.AlphaBlend(n,k)}if(r){var n=g.gridPaneStyle.selectedCellBgColor;if(n!=null)k=SP.JsGrid.Internal.Color.AlphaBlend(n,k)}f.style.backgroundColor=SP.JsGrid.Internal.Color.ColorToHexString(SP.JsGrid.Internal.Color.RemoveAlphaChannel(k))}db.SetSelected(f,t);return}function Kb(b,m,d,p){ULSEWi:;var a={};if(p)a=SP.JsGrid.Style.MergeCellStyles(g.defaultCellStyle,a);var h=b==null,f;if(h)f=D[d].GetPropType();else{var n=b.GetProp(d);f=n!=null?n.propType:null}if(f!=null&&f.GetStyleId!=null){var i=f.GetStyleId(h?null:b.GetDataValue(d));if(i!=null)a=SP.JsGrid.Style.MergeCellStyles(g.GetCellStyle(i),a)}if(!h){if(c.jsGridParams.tableViewParams.rowViewParams.hierarchyMode==SP.JsGrid.HierarchyMode.Grouping&&g.groupingStyles!=null&&g.groupingStyles.length>0){var j=c.controller.GetHierarchyManager();if(j.IsGroupingRecord(b.key()))a=SP.JsGrid.Style.MergeCellStyles(g.groupingStyles[j.GetNodeIndentLevel(b)%g.groupingStyles.length],a)}var e=X&&X(b);e=e!=null?e:wb.GetValue(b,SP.JsGrid.OperationalConstants.GridRowStyleId);if(e!=null){var k=g.GetCellStyle(e);if(k!=null)a=SP.JsGrid.Style.MergeCellStyles(k,a)}}var l=D[d].GetDefaultCellStyleId();if(l!=null)a=SP.JsGrid.Style.MergeCellStyles(g.GetCellStyle(l),a);if(m.fnGetCellStyleId!=null&&!h){var o=m.fnGetCellStyleId(b,d,b.HasDataValue(d)?b.GetDataValue(d):null);if(o!=null){var i=g.GetCellStyle(o);if(i!=null)a=SP.JsGrid.Style.MergeCellStyles(i,a)}}return a}function I(b,i,j){ULSEWi:;var h=b.GetRecord(),k=b.GetColumn(),d=b.GetFieldKey(),f=b.GetTd(),e=h!=null?h.recordKey:b.GetRecordKey();if(f.style.backgroundColor!="")f.style.backgroundColor="";var a=Kb(h,k,d,false);if(!SP.Internal.JS.IsAssocArrayEmpty(a)){SP.JsGrid.Style.ApplyCellStyle(f,a);if(o!=null&&o.rk==e&&o.fk==d){o.textColor=a.textColor!=null?a.textColor:g.defaultCellStyle.textColor!=null?g.defaultCellStyle.textColor:"";o.backgroundColor=a.backgroundColor!=null?a.backgroundColor:g.defaultCellStyle.backgroundColor!=null?g.defaultCellStyle.backgroundColor:""}}f.computedBackgroundColor=a.backgroundColor;if(j)L(e,d,b,i);else SP.JsGrid.AsynchronousCellUpdater.RegisterCell(jb,e,d);c.editUtil.IsEditingEnabled()&&SP.JsGrid.AsynchronousCellUpdater.RegisterCell(mb,e,d,a);return a}function bb(){ULSEWi:;var a=d.GetFocusForPane(b);a!=null&&d.SelectRange(b,a.rowIdx,a.rowIdx,a.colIdx,a.colIdx,B.Set,false,false)}function vb(){ULSEWi:;var h=d.GetFocusForPane(b);if(h!=null){var e=a.GetCellByIdx(h.rowIdx,h.colIdx);if(e!=null&&e.GetCellType()==a.CellType.Cell){var f=e.GetRecord(),k=e.GetColumn(),g=e.GetFieldKey();if(j.IsBound()&&(f==null||!j.IsBoundToCell(b,f.key(),g)))j.Unbind(function(){ULSEWi:;i(e,f,k,g)});else i(e,f,k,g)}}function i(f,a,e,d){ULSEWi:;!j.IsBound()&&a!=null&&c.editUtil.CanBindToField(a,e,d)&&j.BindToCell(b,a,e,d,D,f,I(f,false,true))}}this.TryShiftColumnSelectionGroup=function(p,j,l){ULSEWi:;var s=false;if(Q){var q=d.GetRowRanges(b),g=d.GetColumnRanges(b),f=d.GetCellRanges(b),t=q==null||q.length==0,c=g==null||g.length==0,m=f==null||f.length==0;if(t&&(c||m)&&(c||g.length==1)&&(m||f.length==1)){var a=c?f[0].colRange:g[0],h=l>0?a.end+1:a.begin-1;if(h>=0&&h<e.GetVirtualColumnCount()){for(var o=c?SP.JsGrid.SelectionType.CellRange:SP.JsGrid.SelectionType.ColumnRange,k=[nb(p,j,c?f[0]:g[0],o,true,false)],r=a.begin;r<=a.end;r++){var n=h+(l>0?-1:1);k.push(qb(h,n));h=n}var i=l>0?1:-1;a.begin+=i;a.end+=i;j+=i;k.push(nb(p,j,c?f[0]:g[0],o,false,true));U.Execute(new SP.JsGrid.CommandManager.AggregateCommand(k,true),"Column Reorder",SP.JsGrid.CommandManager.CommandType.Explicit);s=true}}}return s};function nb(m,l,a,i,j,k){ULSEWi:;var g,h,c,e;if(i==SP.JsGrid.SelectionType.ColumnRange){c=a.begin;e=a.end}if(i==SP.JsGrid.SelectionType.CellRange){c=a.colRange.begin;e=a.colRange.end;g=a.rowRange.begin;h=a.rowRange.end}function f(){ULSEWi:;d.SetFocusByPos(b,m,l);d.SelectRange(b,g,h,c,e,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true)}return {Apply:!j?f:function(){},Undo:!k?f:function(){}}}function eb(d){ULSEWi:;y={left:1+l.GetLeftOffset(),top:1+a.GetHeaderHeight(),right:1+l.GetLeftOffset()+l.GetWidth(),bottom:1+d};var b=a.GetRowHeaderWidth()?a.GetRowHeaderWidth():0;if(c.RTL.bEnabled)y.right-=b;else y.left+=b}this.GetTdCoordsRelativeToParentNode=function(c){ULSEWi:;var b;if(c.parentNode!=null){b=a.GetTdCoords(c);b.left+=1+l.GetLeftOffset();b.right+=1+l.GetLeftOffset();b.top+=1;b.bottom+=1}return b};this.GetTableViewportRelativeToParentNode=function(){ULSEWi:;return y};this.ClipElementToTableViewport=function(a){ULSEWi:;var e=y.top-a.offsetTop+"px",c=y.right-a.offsetLeft+"px",b=y.bottom-a.offsetTop+"px",d=y.left-a.offsetLeft+"px";a.style.clip=["rect(",e,c,b,d,")"].join(" ")};this.GetCellRangeBorderDrawingInfo=function(e,d){ULSEWi:;var b={},g=a.BeginRowIdx(),i=a.EndRowIdx()-1,f=a.BeginColIdx(),h=a.EndColIdx()-1;b.bBeginsBeforeColumnHeader=e.begin<g;var m=e.begin>i;b.bBeginsBeforeRowHeader=d.begin<f;var n=d.begin>h,r=e.end<g,p=e.end>i,q=d.end<f;if(m||n||r||q)return null;var s=a.GetCellByIdx(Math.max(g,e.begin),c.RTL.bEnabled?Math.min(h,d.end):Math.max(f,d.begin)),o=a.GetCellByIdx(Math.min(i,e.end),c.RTL.bEnabled?Math.max(f,d.begin):Math.min(h,d.end)),k=this.GetTdCoordsRelativeToParentNode(s.GetTd()),j=this.GetTdCoordsRelativeToParentNode(o.GetTd());b.left=k.left;b.top=k.top;b.right=j.right;b.bottom=p?b.top+l.GetHeight()+1:j.bottom;b.width=b.right-b.left-2;b.height=b.bottom-b.top-2;return b};function q(){ULSEWi:;W(false);Pb();ub();a.UpdateErrorFrames()}function W(t){ULSEWi:;function s(){ULSEWi:;k.style.backgroundColor=sb;for(var a in u)u[a].style.borderColor=sb}function m(){ULSEWi:;k.style.visibility="hidden";for(var a in u)u[a].style.visibility="hidden"}if(t){s();return}if(d.GetFocusForPane(b)==null||!e.GetVirtualRowCount()||!e.GetVirtualColumnCount()||!R.IsSelectionCopyable(b)){m();return}var j=d.GetLastSelectionRangeNormalized();if(j==null){m();return}var n=false;if(c.editUtil.IsEditingEnabled()&&d.IsOneCellSelected(j)){var l=a.GetCellByIdx(j.rowRange.begin,j.colRange.begin);if(l!=null&&!c.editUtil.CanEditField(l.GetRecord(),l.GetColumn(),l.GetFieldKey()))n=true}var f=b.GetCellRangeBorderDrawingInfo(j.rowRange,j.colRange);if(f==null){m();return}var p=f.width+2+2,o=f.height+2+2,h={Top:{left:f.left-1,top:f.top-1,width:p,visibility:""},Right:{left:f.right-2,top:f.top-1,height:o,visibility:""},Bottom:{left:f.left-1,top:f.bottom-2,width:p,visibility:""},Left:{left:f.left-1,top:f.top-1,height:o,visibility:""}},r=d.GetLastSelectionType();if(f.bBeginsBeforeRowHeader)h[c.RTL.Left].visibility="hidden";if(f.bBeginsBeforeColumnHeader)h.Top.visibility="hidden";k.style.visibility="hidden";if(c.editUtil.IsEditingEnabled()&&c.jsGridParams.tableViewParams.bFillControlEnabled){k.style.backgroundColor=n?kb:g.gridPaneStyle.selectionRectBorderColor;if(r==SP.JsGrid.SelectionType.RowRange){k.style.visibility="";k.style.top=f.bottom-3+"px";h[c.RTL.Left].height-=5;h.Bottom.width-=9;if(c.RTL.bEnabled)k.style.left=f.right-7+"px";else{k.style.left=f.left+2+"px";h.Bottom.left+=9}}else if(r!=SP.JsGrid.SelectionType.ColumnRange){k.style.visibility="";k.style.top=f.bottom-3+"px";h[c.RTL.Right].height-=5;h.Bottom.width-=5;if(c.RTL.bEnabled){k.style.left=f.left-2+"px";h.Bottom.left+=5}else k.style.left=f.right-3+"px"}}b.ClipElementToTableViewport(k);for(var i in u){u[i].style.visibility=h[i].visibility;delete h[i].visibility;for(var q in h[i])u[i].style[q]=h[i][q]+"px";u[i].style["border"+i]=SP.JsGrid.Style.MakeBorderString(3,"solid",n?kb:g.gridPaneStyle.selectionRectBorderColor);b.ClipElementToTableViewport(u[i])}}function ub(){ULSEWi:;function k(){ULSEWi:;for(var a in A)for(var b in A[a])A[a][b].style.visibility="hidden"}var g=R.GetLastOperation(),a=g!=null&&g.gridPane==b?b.GetCellRangeBorderDrawingInfo(g.rowRange,g.colRange):null;if(a==null){k();return}var j=a.width+2,i=a.height+2,d={Top:{left:a.left,top:a.top,width:j,visibility:""},Right:{left:a.right-2,top:a.top,height:i,visibility:""},Bottom:{left:a.left,top:a.bottom-2,width:j,visibility:""},Left:{left:a.left,top:a.top,height:i,visibility:""}};if(a.bBeginsBeforeRowHeader)d[c.RTL.Left].visibility="hidden";if(a.bBeginsBeforeColumnHeader)d.Top.visibility="hidden";for(var h in A)for(var e in A[h]){for(var f in d[e])A[h][e].style[f]=f=="visibility"?d[e][f]:d[e][f]+"px";b.ClipElementToTableViewport(A[h][e])}}function Pb(){ULSEWi:;function f(){ULSEWi:;for(var a in E)E[a].style.visibility="hidden"}var c=d.GetFocusForPane(b);if(c==null||R.IsSelectionCopyable(b)){f();return}var l=(new SP.Utilities.Range(c.rowIdx,c.rowIdx)).Normalize(),k=(new SP.Utilities.Range(c.colIdx,c.colIdx)).Normalize(),a=b.GetCellRangeBorderDrawingInfo(l,k);if(a==null){f();return}var i=a.width,h=a.height,g={Top:{left:a.left+1,top:a.top+1,width:i},Right:{left:a.right-2,top:a.top+1,height:h},Bottom:{left:a.left+1,top:a.bottom-2,width:i},Left:{left:a.left+1,top:a.top+1,height:h}};for(var e in E){for(var j in g[e])E[e].style[j]=g[e][j]+"px";E[e].style.visibility=""}}function ib(h,c,a){ULSEWi:;a=a!=null?a:e.ColKeyToColIdx(c.columnKey);function f(){ULSEWi:;var e=d.GetFocusForPane(b);Cb(c,a);V(e);q();j.NotifyMove(b)}function g(){ULSEWi:;var e=d.GetFocusForPane(b);Db(c,a);V(e);b.ScrollColumnIntoViewHorizontally(a);q();j.NotifyMove(b)}return h=="hide"?{Apply:f,Undo:g}:{Apply:g,Undo:f}}function V(a){ULSEWi:;if(a!=null)if(e.KeyToIdx(a.recordKey,a.fieldKey)!=null)d.SetFocusByKey(b,a.recordKey,a.fieldKey);else{var c=a.colIdx>=e.GetVirtualColumnCount()?e.GetVirtualColumnCount()-1:a.colIdx;d.Clear();d.SetFocusByPos(b,a.rowIdx,c)}}function Cb(c,b){ULSEWi:;bb();a.RemoveColumns(b,1);p.splice(b,1);m.Update({itemCount:p.length,itemSizes:p});c.isVisible=false}function Db(d,c){ULSEWi:;c<e.GetVirtualColumnCount()&&b.ScrollColumnIntoViewHorizontally(c);bb();f.AdjustColumnWidth(d);a.InsertColumns(c,[d]);p.splice(c,0,d.width);m.Update({itemCount:p.length,itemSizes:p});d.isVisible=true}function Ib(c,b){ULSEWi:;for(var d=w.GetColumnArray(),a=0;a<d.length;a++){if(a>c&&a>b)break;if(!d[a].isVisible){if(a<=c)c++;if(a<=b)b++}}SP.Internal.JS.MoveItemInArray(d,c,b)}function qb(c,a){ULSEWi:;function f(a,f){ULSEWi:;if(a!=f){var c=d.GetFocusForPane(b),h=m.GetTopItemIdx(),g=e.GetColumnByIdx(a);Cb(g,a);Db(g,f);c!=null&&d.SetFocusByKey(b,c.recordKey,c.fieldKey);q();m.Update({topItemIdx:h});Ib(a,f);j.NotifyMove(b)}}return {Apply:function(){ULSEWi:;f(c,a)},Undo:function(){ULSEWi:;f(a,c)}}}function dc(e,c){ULSEWi:;if(c==null)for(var d=0,b=w.GetColumnArray(),a=0;a<b.length;a++){if(b[a]==e){c=a-d;break}if(!b[a].isVisible)d++}U.Execute(ib("show",e,c),"Show Column",SP.JsGrid.CommandManager.CommandType.Implicit)}function bc(a){ULSEWi:;e.GetVirtualColumnCount()!=1&&U.Execute(ib("hide",a,null),"Hide Column",SP.JsGrid.CommandManager.CommandType.Implicit)}function cc(b,a){ULSEWi:;var c=b<a?a-1:a;U.Execute(qb(b,c),"Move Column",SP.JsGrid.CommandManager.CommandType.Explicit)}function ob(a){ULSEWi:;function d(){ULSEWi:;z=null;f.SetColumnMenuCollapsed(a);O();c.focusMgr.Focus()}if(z==null){var b=f.GetColumnMenuElementPosition(a);if(b==null)return false;var g=e.GetColumnByKey(a);z=e.ColKeyToColIdx(a);if(T.DelegatePresent(SP.JsGrid.DelegateType.ExpandColumnMenu)){T.Apply(SP.JsGrid.DelegateType.ExpandColumnMenu,a,b,d);f.SetColumnMenuExpanded(a)}else c.columnMenuMgr.ExpandMenu(g,b,d,P,H,M)&&f.SetColumnMenuExpanded(a);return true}else return false}function Nb(b,a){ULSEWi:;ob(a)&&SP.Internal.DomElement.StopEvent(b)}this.ExpandColumnMenu=function(a){ULSEWi:;if(c.columnMenuMgr.CanExpandMenu(e.GetColumnByIdx(a),P,H,M,G)){b.ScrollColumnIntoViewHorizontally(a);xb(a);return ob(e.ColIdxToColKey(a))}else return false};this.GetColumnConfigurationDialog=function(){ULSEWi:;return new SP.JsGrid.Internal.ColumnConfigurationDialog(w,Q,G,c,function(a){ULSEWi:;cb(a,false)})};this.ShowColumnConfigurationDialog=function(){ULSEWi:;function c(){ULSEWi:;var a=b.GetColumnConfigurationDialog(),c=document.createElement("div");options={};options.title=SP.JsGrid.Res.columnConfigurationName;options.html=c;options.width=a.GetWidth();options.height=a.GetHeight();options.dialogReturnValueCallback=function(){ULSEWi:;a.Close();a=null;Y=false};var d=SP.UI.ModalDialog.showModalDialog(options);a.Open(c,function(){ULSEWi:;d.close(SP.UI.DialogResult.Cancel)})}if(T.DelegatePresent(SP.JsGrid.DelegateType.ShowColumnConfigurationDialog))T.Apply(SP.JsGrid.DelegateType.ShowColumnConfigurationDialog);else if(!Y){var a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(d){a="undefined"}Y=true;EnsureScript("SP.UI.Dialog.js",a,c)}};function Vb(a){ULSEWi:;a!=null&&SP.JsGrid.Style.ApplyRowHeaderStyle(a.GetTd(),a.GetRecord()!=null?v(a.GetRowIdx(),true):g.rowHeaderStyleCollection.normal,N)}function Ob(b,h,g){ULSEWi:;for(var a=0;a<b.length;a++){var e=c.columnMenuMgr.CanExpandMenu(b[a].GetColumn(),P,H,M,G),d=b[a].GetTd();f.CreateTableHeaderCell(b[a].GetColumn(),d,g,Q,G,H,true,e?Nb:null,rb);f.ApplyHeaderStyle(d,v(b[a].GetColIdx(),false))}lb();if(F==null)F=setTimeout(pb,0)}function pb(){ULSEWi:;if(!Ab){var b=a.GetColumnHeader(a.BeginColIdx());b!=null&&f.NotifyColumnHeaderOrderSet(b.GetTd())}F=null}function lb(){ULSEWi:;var b=a.GetColumnHeader(a.BeginColIdx());b!=null&&f.ApplyHeaderStyle(b.GetTd(),v(b.GetColIdx(),false))}function gb(i,d,a,j,g){ULSEWi:;var f=d.GetProp(a),b=f==null?D[a].GetPropType():f.propType,e=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(b,g),h=e.Render(Tb(d,a,b),d,i,D[a],b,j,ec,c.RTL);return {content:h,displayControl:e}}this.GetContentForCell=function(c,d,b,e,a){ULSEWi:;return gb(c,d,b,e,a).content};function Qb(c){ULSEWi:;var f=c.GetRecord(),a,j,l;if(f!=null){var e=c.GetColumn(),d=c.GetFieldKey(),k=e.fnGetDisplayControlName&&e.fnGetDisplayControlName(e,f,d),h=gb(e,f,d,I(c),k);a=h.content;l=h.displayControl}if(a!=null){j=c.GetTd();var b=f.key();if(a.multipleChildren!=null)for(var g=0;g<a.multipleChildren.length;g++)i(a.multipleChildren[g]);else i(a);return true}return false;function i(a){ULSEWi:;if(a.fnDispose!=null){if(x[b]==null)x[b]={};if(x[b][d]==null)x[b][d]=[];x[b][d].push(a.fnDispose);a=a.elem}j.appendChild(a);setTimeout(function(){},0)}}function Wb(a){ULSEWi:;if(a in x){for(var b in x[a])SP.JsGrid.AsynchronousCellUpdater.RegisterCell(J,a,b,x[a][b]);delete x[a]}}this.TryBeginEdit=function(c){ULSEWi:;var a=d.GetFocusForPane(b);if(a==null)return false;b.ScrollCellIntoView(a.rowIdx,a.colIdx);if(j.IsBound()){R.CancelMode();j.BeginEdit(c);return true}return false};function rb(a,b){ULSEWi:;return b?a.previousSibling:a.nextSibling}function N(b,c){ULSEWi:;var a=c?b.parentNode.previousSibling:b.parentNode.nextSibling;return a&&a.firstChild}function v(j,f){ULSEWi:;for(var a=f?g.rowHeaderStyleCollection:g.columnHeaderStyleCollection,e=j==(f?r:n),i=f?[d.GetRowRanges(b),d.GetColumnRanges(b)]:[d.GetColumnRanges(b),d.GetRowRanges(b)],c=0;c<i[0].length;c++)if(i[0][c].Contains(j))return e?a.allSelectedHover:a.allSelected;if(i[1].length!=0)return e?a.partSelectedHover:a.partSelected;for(var h=d.GetCellRanges(b),c=0;c<h.length;c++)if((f?h[c].rowRange:h[c].colRange).Contains(j))return e?a.partSelectedHover:a.partSelected;return e?a.normalHover:a.normal}function Jb(g){ULSEWi:;var o=null,v=null,y=false,A,H,G,r,w=false,b={cellType:null,recordKey:null,fieldKey:null,bPendingClick:false,bPendingDoubleClick:false},u;$addHandler(i,"mousedown",T);$addHandler(i,"mousemove",U);$addHandler(i,"mouseup",V);$addHandler(i,"dblclick",S);$addHandler(k,"mousedown",R);i.oncontextmenu=function(){ULSEWi:;return false};this.SetupHeaderEvents=function(){ULSEWi:;if(!w){r=a.GetColumnHeaderTr();$addHandler(r,"mousedown",N);$addHandler(document.body,"mousemove",D);$addHandler(r,"mouseout",Q)}w=true};this.ClearHeaderEvents=function(){ULSEWi:;if(w){$clearHandlers(r);$removeHandler(document.body,"mousemove",D)}w=false};this.Dispose=function(){ULSEWi:;this.ClearHeaderEvents();$clearHandlers(i);$clearHandlers(k);r=null};function F(i,f){ULSEWi:;var c=f.GetCellType(),h=i.ctrlKey?B.ReplaceLast:B.Set,e=d.GetFocusForPane(g);if(e!=null)if(b.cellType==a.CellType.RowHeader&&(c==a.CellType.RowHeader||c==a.CellType.Cell))d.SelectRange(g,e.rowIdx,f.GetRowIdx(),null,null,h,false,true);else if(b.cellType==a.CellType.ColumnHeader&&(c==a.CellType.ColumnHeader||c==a.CellType.Cell))d.SelectRange(g,null,null,e.colIdx,f.GetColIdx(),h,false,true);else b.cellType==a.CellType.Cell&&c==a.CellType.Cell&&d.SelectRange(g,e.rowIdx,f.GetRowIdx(),e.colIdx,f.GetColIdx(),h,false,true)}function R(b){ULSEWi:;b.button==Sys.UI.MouseButton.leftButton&&d.GetFocusedPane()==g&&Yb.OnMouseDown(b,g,c.parentNode,k,a,d)}function S(c){ULSEWi:;var b=a.GetCellByChildElement(c.target),d=b&&b.GetCellType();d==a.CellType.ColumnHeader&&P();E(c,b,SP.JsGrid.EventType.OnDoubleClick)}function T(e){ULSEWi:;var c=a.GetCellByChildElement(e.target);b={cellType:null,recordKey:null,fieldKey:null,bPendingClick:false,bPendingDoubleClick:false};if(e.button==Sys.UI.MouseButton.leftButton){if(c&&c.GetRowIdx()==null&&!y)return;y=false;f()}else e.button==Sys.UI.MouseButton.rightButton&&E(e,c,SP.JsGrid.EventType.OnRightClick);return;function f(){ULSEWi:;if(c!=null){b.cellType=c.GetCellType();b.recordKey=c.GetRecordKey();b.fieldKey=c.GetFieldKey();var j=d.GetFocusForPane(g);if(b.cellType!=a.CellType.SelectAllSquare){e.preventDefault();u=c;SP.Internal.DomElement.SetCapture(i,M,null)}if(e.shiftKey)F(e,c);else{var h=c.GetRowIdx(),f=c.GetColIdx(),k=e.ctrlKey?B.Append:B.Set;if(b.cellType==a.CellType.RowHeader)d.SelectRange(g,h,h,null,null,k,true,false);else if(b.cellType==a.CellType.ColumnHeader)d.SelectRange(g,null,null,f,f,k,true,false);else b.cellType==a.CellType.Cell&&d.SelectRange(g,h,h,f,f,k,true,false);u=c=a.GetCellByKey(b.recordKey,b.fieldKey);b.bPendingClick=b.bPendingDoubleClick=true}if(b.cellType==a.CellType.Cell&&j!=null&&j.recordKey==b.recordKey&&j.fieldKey==b.fieldKey)g.TryBeginEdit(e)&&e.stopPropagation()}}}function V(f){ULSEWi:;if(b.bPendingClick){var e=a.GetCellByChildElement(f.target);e!=null&&!j.IsEditing()&&d.IsOneCellSelected(d.GetLastSelectionRangeNormalized())&&e.GetCellType()==a.CellType.Cell&&b.recordKey==e.GetRecordKey()&&b.fieldKey==e.GetFieldKey()&&c.eventMgr.FireEvent(SP.JsGrid.EventType.OnSingleCellClick,new SP.JsGrid.EventArgs.SingleCellClick(f,b.recordKey,b.fieldKey));b.bPendingClick=false}}function E(f,d,g){ULSEWi:;var e=d&&d.GetCellType(),k=d&&d.GetRecord(),h=k&&k.key(),i=d&&d.GetFieldKey(),j=e==a.CellType.SelectAllSquare?SP.JsGrid.ClickContext.SelectAllSquare:e==a.CellType.RowHeader?SP.JsGrid.ClickContext.RowHeader:e==a.CellType.ColumnHeader?SP.JsGrid.ClickContext.ColumnHeader:e==a.CellType.Cell?SP.JsGrid.ClickContext.Cell:SP.JsGrid.ClickContext.Other;if(g==SP.JsGrid.EventType.OnRightClick||j!=SP.JsGrid.ClickContext.Cell||b.bPendingDoubleClick&&b.cellType==e&&b.recordKey==h&&b.fieldKey==i){c.eventMgr.FireEvent(g,new SP.JsGrid.EventArgs.Click(f,j,h,i));b.bPendingDoubleClick=false}SP.Internal.DomElement.StopEvent(f)}function M(c){ULSEWi:;var b=a.GetCellByChildElement(c.target);if(b!=null&&(u==null||!u.Equals(b))){F(c,b);u=b}}function U(c){ULSEWi:;var b=a.GetCellByChildElement(c.target);if(b&&b.GetCellType()==a.CellType.RowHeader)Xb(b.GetRowIdx());else zb()}function L(c){ULSEWi:;var a=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"colAction"),b=null;if(a!=null)b=SP.Internal.DomElement.FindAncestorWithProperty(a.elem,"thColumnKey");return {colAction:a!=null?SP.Internal.DomElement.GetCustomAttribute(a.elem,"colAction"):null,thElem:b!=null?b.elem:null}}function N(c){ULSEWi:;if(c.button!=Sys.UI.MouseButton.leftButton)return;j.StopEditing(false);f.HeaderMouseDown(c);var l=SP.Internal.DomElement.GetEventLocation(c);A=l.x;if(z==null){var b=L(c);if(b.colAction=="resize"||b.colAction=="resize-current"){c.preventDefault();var a=b.colAction=="resize"?rb(b.thElem,true):b.thElem;if(a!=null&&a.thColumnKey!=null){SP.Internal.DomElement.SetCapture(r,I,J);o=e.ColKeyToColIdx(a.thColumnKey);H=parseInt(e.GetColumnByKey(a.thColumnKey).width,10);f.SetColumnResizing(a.thColumnKey)}}else if(b.colAction=="move"){c.preventDefault();var a=b.thElem,d=SP.Internal.DomElement.GetLocation(a),m=SP.Internal.DomElement.GetLocation(i),k=SP.Internal.DomElement.GetLocation(t),g=e.GetColumnByKey(a.thColumnKey);G=d.x-k.x;h.style.top=d.y-m.y+"px";h.style.width=a.offsetWidth+1+"px";h.style.height=a.offsetHeight+"px";h.style.backgroundColor=a.style.backgroundColor;SP.Internal.DomElement.SetText(h.textDiv,g.name);SP.Internal.DomElement.SetOpacity(h,.6);h.style.visibility="";s.style.top=h.style.top;s.style.height=h.style.height;s.style.visibility="";SP.Internal.DomElement.SetCapture(r,C,K);v=e.ColKeyToColIdx(a.thColumnKey);f.SetColumnMoving(a.thColumnKey);C(c)}else if(b.colAction=="select")y=true}}function I(i){ULSEWi:;var n=SP.Internal.DomElement.GetLocation(t).x,k=SP.Internal.DomElement.GetEventLocation(i),m=Math.max(n,k.x),h=(m-A)*(c.RTL.bEnabled?-1:1),b=Math.min(Math.max(H+h,SP.JsGrid.Internal.MinColumnWidth),l.GetWidth()-SP.JsGrid.Internal.RowHeaderWidth),d=a.GetColumnHeader(o).GetTd();e.GetColumnByKey(d.thColumnKey).width=b;f.ResizeColumn(d,b);p[o]=b;q();j.NotifyMove(g)}function J(){ULSEWi:;if(o!=null){var b=a.GetColumnHeader(o).GetTd();f.SetColumnResized(b.thColumnKey);a.OptimizeTableColumns();m.Update({itemSizes:p});o=null}}function P(){ULSEWi:;if(n!=null&&n!=z){var c=e.GetColumnByIdx(n);if(c.isResizable){f.SetColumnResizing(c.columnKey);var d=a.GetColumnHeader(n).GetTd(),b=Math.max(f.GetColumnHeaderAutoResizeWidth(d),a.GetColumnAutoResizeWidth(n));if(b!=c.width){c.width=b;f.ResizeColumn(d,b);p[n]=b;q();j.NotifyMove(g);a.OptimizeTableColumns();m.Update({itemSizes:p})}f.SetColumnResized(d.thColumnKey)}}}function C(f){ULSEWi:;var k=SP.Internal.DomElement.GetEventLocation(f),j=k.x-A;h.style.left=G+j+"px";var d=x(f),l=SP.Internal.DomElement.GetLocation(i),e;if(d.insertColIdx==a.EndColIdx()){var b=a.GetColumnHeader(d.insertColIdx-1).GetTd(),g=SP.Internal.DomElement.GetLocation(b);e=g.x+(c.RTL.bEnabled?0:b.offsetWidth)}else{var b=a.GetColumnHeader(d.insertColIdx).GetTd(),g=SP.Internal.DomElement.GetLocation(b);e=g.x+(c.RTL.bEnabled?b.offsetWidth:0)}s.style.left=e-l.x-2+"px";s.style.visibility=""}function K(b){ULSEWi:;h.style.visibility=s.style.visibility="hidden";var c=a.GetColumnHeader(v).GetTd();f.SetColumnMoved(c.thColumnKey);cc(v,x(b).insertColIdx);v=null}function D(b){ULSEWi:;if(o!=null||v!=null)return;var a=x(b,true);if(a.colIdx!=null&&a.bInVertical&&z==null){xb(a.colIdx);f.HeaderMouseMove(b)}else n!=null&&O()}function Q(a){ULSEWi:;var b=x(a);if(!b.bInVertical||b.colIdx==null){f.HeaderMouseOut(a);O()}}function x(w,x){ULSEWi:;var m=SP.Internal.DomElement.GetLocation(i),p=SP.Internal.DomElement.GetEventLocation(w),d=p.x,k=p.y,b=a.GetColumnHeaders(),l=b.length>0&&(k>=m.y&&k<=m.y+b[0].GetTd().offsetHeight),u=l&&k-m.y<f.constEyeBrowHeight,j,e,h,n,q=!u?(f.constResizeWidth+2)*(c.RTL.bEnabled?-1:1):0;if(!x||l&&SP.Internal.DomElement.PointInDomElem(d,k,t)){for(var g=0;g<b.length;g++){e=b[g].GetTd();h=SP.Internal.DomElement.GetLocation(e);if(d>=h.x+(g!=0?q:0)&&d<h.x+e.offsetWidth+(g!=b.length?q:0)){j=b[g].GetColIdx();break}}var r=0;if(e!=null){var v=d-h.x,s=h.x+e.offsetWidth-d;r=s<v?c.RTL.bEnabled?0:1:c.RTL.bEnabled?1:0}var o=SP.Internal.DomElement.GetLocation(b[0].GetTd());n=j!=null?j+r:c.RTL.bEnabled?d>o.x+e.offsetWidth:d<o.x?a.BeginColIdx():a.EndColIdx()}return {colIdx:j,insertColIdx:n,bInVertical:l}}}fc()};SP.JsGrid.Internal.GridPaneConverter=function(h){ULSEWi:;var b,c,a,e,f,d,i=this;this.SetPosConverterObj=function(a){ULSEWi:;b=a};this.SetView=function(a){ULSEWi:;g(a,true)};this.NotifyColumnsChanged=function(a){ULSEWi:;g(a,false)};this.IdxToKey=function(e,d){ULSEWi:;return {recordKey:b.ViewIdxToRecordKey(Math.floor(e/a)),fieldKey:this.IdxToFieldKey(e,d),columnKey:c[d].columnKey}};this.IdxToFieldKey=function(d,b){ULSEWi:;return c[b].fieldKeys[d%a]};this.KeyToIdx=function(h,c){ULSEWi:;var g=f[c];if(g!=null){var i=b.RecordKeyToViewIdx(h)*a+g,d=e[c];if(d!=null)return {rowIdx:i,colIdx:d}}return null};this.GetTopRowIdxForKey=function(c){ULSEWi:;return b.RecordKeyToViewIdx(c)*a};this.GetTopRowIdx=function(){ULSEWi:;return b.GetTopViewIdx()*a};this.RowIdxToViewIdx=function(b){ULSEWi:;return Math.floor(b/a)};this.RowIdxToRelRowIdx=function(c){ULSEWi:;return c-b.GetTopViewIdx()*a};this.RowIdxToRecordKey=function(a){ULSEWi:;return b.ViewIdxToRecordKey(this.RowIdxToViewIdx(a))};this.RelRowIdxToRowIdx=function(c){ULSEWi:;return c+b.GetTopViewIdx()*a};this.ColKeyToColIdx=function(a){ULSEWi:;return d[a]};this.ColIdxToColKey=function(a){ULSEWi:;return c[a].columnKey};this.ColKeyToFieldKeys=function(a){ULSEWi:;return c[d[a]].fieldKeys};this.FieldKeyToColIdx=function(a){ULSEWi:;return e[a]};this.GetWholeRowDisplayCapacity=function(){ULSEWi:;return b.GetWholeRowDisplayCapacity()*a};this.GetRowMultiple=function(){ULSEWi:;return a};this.GetRecordsInvolved=function(c,f,d){ULSEWi:;function g(){ULSEWi:;var a=i.GetRecordsInvolved(c,f,d);a!=null&&d(a)}function j(b){ULSEWi:;for(var c={},a=0;a<b.length;a++)c[b[a].key()]=b[a];return c}var k=(c-c%a)/a,h=Math.ceil((f+c%a)/a),e=b.GetViewRecords(k,h,g);return e.recordSetComplete?j(e.records):null};this.IsRecordOnScreen=function(a){ULSEWi:;return b.IsRecordOnScreen(a)};this.GetRecordKeysInvolved=function(d,h){ULSEWi:;for(var g=(d-d%a)/a,e=Math.ceil((h+d%a)/a),f=new Array(e),c=0;c<e;c++)f[c]=b.ViewIdxToRecordKey(g+c);return f};this.GetVirtualRowCount=function(){ULSEWi:;return (b.GetViewRecordCount()+h.entryRecordMgr.GetEntryRecords().length)*a};this.GetVirtualColumnCount=function(){ULSEWi:;return c.length};this.GetColumnByIdx=function(a){ULSEWi:;return c[a]};this.GetColumnByKey=function(b){ULSEWi:;var a=d[b];return a==null?null:c[a]};function g(h,j){ULSEWi:;c=h;e={};f={};d={};for(var b=0;b<h.length;b++){d[h[b].columnKey]=b;var i=h[b].fieldKeys;if(j)a=i.length;for(var g=0;g<a;g++){e[i[g]]=b;f[i[g]]=g}}}};SP.JsGrid.EmptyValue={};SP.JsGrid.InvalidValue={};SP.JsGrid.GuidManager=function(){ULSEWi:;var a=[],b=[];return {GetIndexForGuid:function(e){ULSEWi:;var d=SP.Internal.JS.LowerBound(a,e,"guid"),c;if(a[d]!=null&&a[d].guid==e)c=a[d].idx;else{c=b.length;b.push({guid:e,idx:c});a.splice(d,0,b[c])}return c},LookupIndexForGuid:function(c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c,"guid"),d=null;if(a[b]!=null&&a[b].guid==c)d=a[b].idx;return d},LookupGuidForIndex:function(a){ULSEWi:;return b[a]!=null?b[a].guid:null}}}();SP.JsGrid.AsynchronousTaskManager=function(){ULSEWi:;var d=[10,75,150,500],a={},e=this,b=0;function c(c,f,i){ULSEWi:;var h=f==null?SP.JsGrid.AsynchronousTaskManager.Priority.High:f,b=i,g=setInterval(function(){ULSEWi:;b in a&&!c(b)&&e.ClearTask(b)},d[h]);b=b!=null?b:g;a[b]={intervalId:g,priority:h,fn:c};return b}this.RegisterTask=function(a,b){ULSEWi:;return c(a,b)};this.SetTaskPriority=function(b,e){ULSEWi:;var d=a[b];this.ClearTask(b);c(d.fn,e,b)};this.GetTaskPriority=function(b){ULSEWi:;return a[b]&&a[b].priority};this.TaskRegistered=function(b){ULSEWi:;return b in a};this.ClearTask=function(c){ULSEWi:;var b=a[c];if(b!=null){clearInterval(b.intervalId);delete a[c]}};this.Stop=function(){ULSEWi:;for(var c in a)clearInterval(a[c].intervalId);b++};this.Resume=function(){ULSEWi:;if(b==1){var e={};for(var d in a)e[d]=a[d];a={};for(var d in e)c(e[d].fn,e[d].priority,d)}b=Math.min(b-1,0)}};SP.JsGrid.AsynchronousTaskManager=new SP.JsGrid.AsynchronousTaskManager;SP.JsGrid.AsynchronousTaskManager.Priority={Low:3,Medium:2,High:1,SuperHigh:0};SP.JsGrid.AsynchronousCellUpdater=function(){ULSEWi:;var b={},c=10,h=0,g=5,f=20,a=SP.JsGrid.AsynchronousTaskManager;function e(c){ULSEWi:;var d=c.cells.length-c.lastCellCount,b=a.GetTaskPriority(c.token)==a.Priority.SuperHigh;if(!b&&d<g){a.SetTaskPriority(c.token,a.Priority.SuperHigh);b=true}else if(b&&d>f){a.SetTaskPriority(c.token,a.Priority.Medium);b=false}return b}function d(h,i){ULSEWi:;var a=b[h],d;if(!i){var g=e(a);d=Math.min(g?c*7:c,a.cells.length)}else d=a.cells.length;for(var l=0,k=false,j=[],f=0;f<d;f++)a.fn.apply(null,a.cells[f]);a.cells.splice(0,d);a.lastCellCount=a.cells.length;return a.cells.length!=0}this.RegisterCell=function(d){ULSEWi:;var c=b[d];if(c.token==null||!a.TaskRegistered(c.token))c.token=a.RegisterTask(c.fnProcess,a.Priority.Medium);c.cells[c.cells.length]=Array.prototype.slice.apply(arguments,[1,arguments.length])};this.ChangeRecordKeys=function(f,e){ULSEWi:;for(var d in b)for(var c=b[d].cells,a=0;a<c.length;a++)if(c[a][0]==f)c[a][0]=e};this.RegisterJob=function(c){ULSEWi:;var a=h++;b[a]={fn:c,cells:[],fnProcess:function(){ULSEWi:;return d(a)},lastCellCount:0};return a};this.FlushJob=function(a){ULSEWi:;a in b&&d(a,true)}};SP.JsGrid.AsynchronousCellUpdater=new SP.JsGrid.AsynchronousCellUpdater;SP.JsGrid.Internal.Color=function(){ULSEWi:;var a={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,A:10,B:11,C:12,D:13,E:14,F:15},b="0123456789ABCDEF";return {MakeColor:function(c,b,a){ULSEWi:;return SP.JsGrid.Internal.Color.MakeAlphaColor(1,c,b,a)},MakeAlphaColor:function(a,d,c,b){ULSEWi:;return {a:a,r:d*a,g:c*a,b:b*a}},RemoveAlphaChannel:function(a){ULSEWi:;return a.a<1?SP.JsGrid.Internal.Color.MakeColor(a.r/a.a,a.g/a.a,a.b/a.a):a},HexStringToColor:function(b){ULSEWi:;function c(b){ULSEWi:;return (a[b.charAt(0)]*16+a[b.charAt(1)])/255}var f;if(b.charAt(0)=="#"){var e=b.toUpperCase();f=SP.JsGrid.Internal.Color.MakeColor(c(e.substr(1,2)),c(e.substr(3,2)),c(e.substr(5,2)))}else if(b.indexOf("rgb(")==0||b.indexOf("RGB(")==0){var d=b.substr(4,b.length-5).split(",");f=SP.JsGrid.Internal.Color.MakeColor(d[0]/255,d[1]/255,d[2]/255)}return f},ColorToHexString:function(c){ULSEWi:;function a(a){ULSEWi:;a=Math.floor(a*255);return b.charAt(Math.floor(a/16))+b.charAt(a%16)}return "#"+a(c.r)+a(c.g)+a(c.b)},AlphaBlend:function(a,b){ULSEWi:;var c=1-a.a;return SP.JsGrid.Internal.Color.MakeAlphaColor(a.a+b.a*c,a.r+c*b.r,a.g+c*b.g,a.b+c*b.b)}}}();SP.Internal.JS={object:function(b){ULSEWi:;function a(){}a.prototype=b;return new a},ConvertTableToMap:function(b,e,c){ULSEWi:;for(var d={},a=0;a<b.length;a++)d[b[a][e]]=c!=null?b[a][c]:b[a];return d},ConvertTableColumnToArray:function(b,d){ULSEWi:;for(var c=[],a=0;a<b.length;a++)c.push(b[a][d]);return c},ConvertSetKeysToArray:function(c){ULSEWi:;var a=[];for(var b in c)a.push(b);return a},ConvertSetDataToArray:function(a){ULSEWi:;var b=[];for(var c in a)b.push(a[c]);return b},ConvertArrayToSet:function(b,d){ULSEWi:;for(var c={},a=0;a<b.length;a++)c[b[a][d]]=b[a];return c},EncodeString:function(a){ULSEWi:;return '"'+a+'"'},MoveItemInArray:function(a,b,d){ULSEWi:;var c=a.splice(b,1);a.splice(d,0,c[0])},GetFirstElement:function(a){ULSEWi:;for(var b in a)return a[b];return undefined},IsAssocArrayEmpty:function(a){ULSEWi:;for(var b in a)return false;return true},GetAssocArraySize:function(b){ULSEWi:;var a=0;for(var c in b)a++;return a},CloneObj:function(a,d){ULSEWi:;if(a==null)return null;if(a.clone!=null&&d)return a.clone();if(a.Clone!=null&&d)return a.Clone();if(a instanceof Array){for(var b=[],e=0;e<a.length;e++)b.push(d?SP.Internal.JS.CloneObj(a[e],true):a[e]);return b}if(a instanceof Date){b=new Date(a.getTime());return b}if(a instanceof Function)return a;if(a instanceof Object){var f=true;for(var c in a)f=f&&!(a[c]instanceof Function);if(f){var b={};for(var c in a)if(!(c in b))b[c]=d?SP.Internal.JS.CloneObj(a[c],true):a[c]}return b}return a},BinarySearch:function(a,d,c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,d,c);return b===a.length||(c?a[b][c]:a[b])!==d?null:b},LowerBound:function(a,c,b){ULSEWi:;return SP.Internal.JS.LowerBoundCompare(a,c,function(d,e){ULSEWi:;var c=b?a[d][b]:a[d];return e>c?1:c>e?-1:0})},LowerBoundCompare:function(d,f,e){ULSEWi:;var c=-1,b=d.length,a;while(b-c>1){a=c+b>>>1;e(a,f)>0?(c=a):(b=a)}return b},UpperBound:function(c,g,e){ULSEWi:;var d=-1,b=c.length,a;while(b-d>1){a=d+b>>>1;var f=e?c[a][e]:c[a];g>=f?(d=a):(b=a)}return b},Compose:function(a,b){ULSEWi:;return function(d){ULSEWi:;var c=b?b(d):d;return a?a(c):c}},FindInArray:function(b,d,e){ULSEWi:;for(var c,a=0;a<b.length;a++)if(d(b[a])){c=a;if(!e)break}return c},Find:function(a,c,d){ULSEWi:;var b=SP.Internal.JS.FindKey(a,c,d);return b==null?null:a[b]},FindKey:function(a,d,e){ULSEWi:;var c=undefined;for(var b in a)if(d(a[b])){c=b;if(!e)break}return c},RoundTo:function(a,c){ULSEWi:;var b=Math.pow(10,c);return a==0?a:Math.round(a*b)/b},_shutUpKeys:null,CoalesceFunctionCalls:function(b,e,c){ULSEWi:;if(this._shutUpKeys==null)this._shutUpKeys=new SP.Utilities.Set;var a=this._shutUpKeys;if(!a.Contains(b)){a.Add(b);setTimeout(d,c==null?0:c)}function d(){ULSEWi:;a.Remove(b);e()}},Flatten2LevelArray:function(a){ULSEWi:;var c=[];for(var b in a)for(var d in a[b])c.push(a[b][d]);return c},TokenizeString:function(a,f){ULSEWi:;var d=[];if(a!=null&&a!=SP.JsGrid.EmtpyValue)for(var c=a.split(f),b=0;b<c.length;b++){var e=c[b].replace(/^\s+|\s+$/g,"");e!=""&&d.push(e)}return d},JoinStrings:function(a,d){ULSEWi:;if(a==null)return null;for(var c=[],b=0;b<a.length;b++)a[b]!=""&&a[b]!=null&&c.push(a[b]);return c.join(d)},ProfilerMark:function(a){ULSEWi:;window.msWriteProfilerMark&&window.msWriteProfilerMark(a)}};SP.JsGrid.EventArgs={CellFocusChanged:function(a,c,b,d){ULSEWi:;return {newRecordKey:a,newFieldKey:c,oldRecordKey:b,oldFieldKey:d}},RowFocusChanged:function(a,b){ULSEWi:;return {newRecordKey:a,oldRecordKey:b}},CellEditBegin:function(a,b){ULSEWi:;return {recordKey:a,fieldKey:b}},CellEditCompleted:function(c,d,b,a){ULSEWi:;return {recordKey:c,fieldKey:d,changeKey:b,bCancelled:a}},Click:function(a,d,b,c){ULSEWi:;return {eventInfo:a,context:d,recordKey:b,fieldKey:c}},PropertyChanged:function(c,d,g,f,e,b,a){ULSEWi:;return {recordKey:c,fieldKey:d,oldProp:g,newProp:f,propType:e,changeKey:b,validationState:a}},RecordInserted:function(d,c,a,b){ULSEWi:;return {recordKey:d,recordIdx:c,afterRecordKey:a,changeKey:b}},RecordDeleted:function(c,b,a){ULSEWi:;return {recordKey:c,recordIdx:b,changeKey:a}},RecordChecked:function(a,b){ULSEWi:;return {recordKeySet:a,bChecked:b}},OnCellErrorStateChanged:function(d,e,c,a,b,f){ULSEWi:;return {recordKey:d,fieldKey:e,bAddingError:c,bCellCurrentlyHasError:a,bCellHadError:b,errorId:f}},OnRowErrorStateChanged:function(d,b,a,c,e,f){ULSEWi:;return {recordKey:d,bAddingError:b,bErrorCurrentlyInRow:a,bRowHadError:c,errorId:e,message:f}},OnEntryRecordAdded:function(a){ULSEWi:;return {recordKey:a}},OnEntryRecordCommitted:function(a,c,b){ULSEWi:;return {originalRecordKey:a,recordKey:c,changeKey:b}},SingleCellClick:function(a,b,c){ULSEWi:;return {eventInfo:a,recordKey:b,fieldKey:c}},PendingChangeKeyInitiallyComplete:function(a){ULSEWi:;return {changeKey:a}},VacateChange:function(a){ULSEWi:;return {changeKey:a}},GridErrorStateChanged:function(a){ULSEWi:;return {bAnyErrors:a}},SingleCellKeyDown:function(a,b,c){ULSEWi:;return {eventInfo:a,recordKey:b,fieldKey:c}}};SP.JsGrid.Internal.EventArgs={OnRowHeaderStateChanged:function(b,a){ULSEWi:;return {recordKey:b,rowHeaderState:a}},ChangeKeyStageUpdated:function(a){ULSEWi:;return {changeKey:a}},RecordInserted:function(a){ULSEWi:;return {recordKey:a}},RecordDeleted:function(a){ULSEWi:;return {recordKey:a}}};SP.JsGrid.Image=function(d,c,a,b){ULSEWi:;this.imgSrc=d;this.bIsClustered=c;this.outerCssNames=a;this.imgCssNames=b};SP.JsGrid.Image.prototype={Render:function(d,b){ULSEWi:;if(this.imgSrc==null)return null;var a=document.createElement("img");a.style.border=0;a.src=this.imgSrc;if(d!=null){a.title=d;a.alt=a.title=d}else a.alt="";if(this.imgCssNames!=null)a.className=this.imgCssNames;if(this.bIsClustered){var c=document.createElement("div");c.className=this.outerCssNames;c.appendChild(a);a=c}if(b!=null){$addHandler(a,"mousedown",b);$addHandler(a,"keydown",function(a){ULSEWi:;if(a.keyCode==Sys.UI.Key.enter){b(a);SP.Internal.DomElement.StopEvent(a)}});a.style.cursor="pointer";a.tabIndex=-1}if(b!=null)a.Dispose=function(){ULSEWi:;$clearHandlers(a);b=null;c=null;a.Dispose=null;a=null};return a}};SP.JsGrid.ApplyServerChangesToGrid=function(i,h,p,u,q,l){ULSEWi:;var g;if(h!=null)for(var j=0;j<h.length;j++){for(var c=h[j],b=[],d=[],m=[],k=0;k<c.updates.length;k++){var a=c.updates[k];if(a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop)b.push(r(a.recordKey,a.fieldKey,a.newProp));else if(a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Insert)m.push(a);else a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete&&d.push(a.recordKey)}t(m);o(b);s(d);n()}function r(c,d,a){ULSEWi:;var b;if(a.hasLocalizedValue&&a.hasDataValue)b=SP.JsGrid.CreateValidatedPropertyUpdate(c,d,a.dataValue,a.localizedValue);else b=SP.JsGrid.CreateUnvalidatedPropertyUpdate(c,d,a.hasDataValue?a.dataValue:a.localizedValue,!a.hasDataValue);return b}function f(){ULSEWi:;var a=g;if(a==null&&!q)if(c.changeNumber!=-1)a=i.GetChangeKeyForVersion(c.changeNumber);return a}function e(a){ULSEWi:;g=a}function n(){ULSEWi:;g=null;optChangeKey=null}function t(b){ULSEWi:;for(var a=0;a<b.length;a++){var c=p(b[a].afterRecordKey,b[a].recordKey,f());e(c)}}function o(){ULSEWi:;if(b.length>0){var a=i.UpdateProperties(b,null,f());l!=null&&l(b,a);e(a)}}function s(){ULSEWi:;if(d.length>0){var a=i.DeleteRecords(d,f());e(a)}}};SP.JsGrid.EventManager=function(){ULSEWi:;var a={};this.FireEvent=function(d,c){ULSEWi:;var b=a[d];if(b!=null)for(var e in b)b[e](c)};this.AttachEvent=function(b,c){ULSEWi:;if(a[b]==null)a[b]=[];a[b].push(c)};this.DetachEvent=function(b,d){ULSEWi:;if(a[b]!=null){var c=SP.Internal.JS.FindInArray(a[b],function(a){ULSEWi:;return a==d});c!=null&&a[b].splice(c,1)}}};SP.JsGrid.DelegateManager=function(){ULSEWi:;var a={};this.SetDelegate=function(b,c){ULSEWi:;if(c!=null)a[b]=c;else delete a[b]};this.DelegatePresent=function(b){ULSEWi:;return b in a};this.GetDelegate=function(b){ULSEWi:;return a[b]};this.Apply=function(){ULSEWi:;var b=a[arguments[0]];if(b!=null)return b.apply(null,Array.prototype.slice.call(arguments,1))}};SP.JsGrid.MakeShapeStyle=function(b,a){ULSEWi:;return {shape:b,color:a}};SP.JsGrid.MakeBarStyle=function(f,e,d,a,b,c){ULSEWi:;return {shape:f,color:e,pattern:d,start:a,end:b,strokeWeight:c}};SP.JsGrid.Internal.EmptyFunction=function(){};SP.JsGrid.Internal.CrackCellKey=function(b){ULSEWi:;var a=b.split(",");return {rowIdx:a[0],colIdx:a[1]}};SP.JsGrid.Internal.MakeCellKey=function(b,a){ULSEWi:;return [b,a].join()};Type.registerNamespace("SP.Internal.DomElement");SP.Internal.DomElement=function(){ULSEWi:;var f=1,a,d,e,k,g;function h(b){ULSEWi:;if(a!=null&&b.button==Sys.UI.MouseButton.leftButton)d!=null&&d(g?b:o(b))}function i(b){ULSEWi:;if(a!=null&&b.button==Sys.UI.MouseButton.leftButton){e!=null&&e(g?b:o(b));l()}}function b(a){ULSEWi:;a.stopPropagation();a.preventDefault()}function o(a){ULSEWi:;return new Sys.UI.DomEvent(a)}function q(f,b,c){ULSEWi:;g=true;a=f;d=b;e=c;$addHandler(document,"mousemove",h);$addHandler(document,"mouseup",i);a.setCapture(true)}function p(j,c,f){ULSEWi:;g=false;a=j;d=c;e=f;k=document.body.style.cursor;document.body.style.cursor=SP.Internal.DomElement.GetComputedStyle(a,"cursor","cursor");document.addEventListener("mousemove",h,true);document.addEventListener("mouseup",i,true);document.addEventListener("mouseover",b,true);document.addEventListener("mouseenter",b,true);document.addEventListener("mouseleave",b,true)}function l(){ULSEWi:;if(a!=null){if(g){a.releaseCapture();$removeHandler(document,"mousemove",h);$removeHandler(document,"mouseup",i)}else{document.body.style.cursor=k;document.removeEventListener("mousemove",h,true);document.removeEventListener("mouseup",i,true);document.removeEventListener("mouseover",b,true);document.removeEventListener("mouseenter",b,true);document.removeEventListener("mouseleave",b,true)}a=null;d=null;e=null;k=null}}function j(){ULSEWi:;if(c.BrowserIsIE){var a,b;if((a=$get("__iezoomtest1"))==null||(b=$get("__iezoomtest2"))==null){a=document.createElement("div");b=document.createElement("div");a.style.cssText="position:absolute;top:0px;left:0px";b.style.cssText="position:absolute;top:0px;left:200px";a.appendChild(b);a.id="__iezoomtest1";b.id="__iezoomtest2";document.body.appendChild(a)}var d=Sys.UI.DomElement.getLocation(a),e=Sys.UI.DomElement.getLocation(b);f=(e.x-d.x)/200;if(f==0)f=1}}function r(a,c){ULSEWi:;var b=a.rawEvent;a.wheelDelta=Math.round(b.wheelDelta!=null?b.wheelDelta/-40:b.detail);c(a)}for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c={PointInDomElem:function(d,e,b,c){ULSEWi:;var a=c==null?SP.Internal.DomElement.GetLocation(b):c;return a.x<=d&&a.x+b.offsetWidth>=d&&a.y<=e&&a.y+b.offsetHeight>=e},ReleaseCapture:l,StopEvent:b,ForceIEZoomFactorRecomputation:j,GetLocation:function(a){ULSEWi:;return SP.Internal.DomElement.AdjustCoordsForIEZoom(Sys.UI.DomElement.getLocation(a))},GetEventLocation:function(a){ULSEWi:;var b=SP.Internal.DomElement.GetScreenOffsets();return SP.Internal.DomElement.AdjustCoordsForIEZoom({x:a.clientX+b.left,y:a.clientY+b.top})},GetNextElement:function(b){ULSEWi:;do var a=b.nextSibling;while(a&&a.nodeType!=1);return a},GetPrevElement:function(b){ULSEWi:;do var a=b.previousSibling;while(a&&a.nodeType!=1);return a},GetFirstChildElement:function(b){ULSEWi:;var a=b.firstChild;while(a&&a.nodeType!=1)a=b.nextSibling;return a},AddMouseWheelHandler:function(a,c){ULSEWi:;var b=function(a){ULSEWi:;r(a,c)};if(a._mouseWheelFnInfo==null)a._mouseWheelFnInfo=[];a._mouseWheelFnInfo.push({usrFn:c,wheelFn:b});$addHandler(a,"mousewheel",b);$addHandler(a,"DOMMouseScroll",b)},RemoveMouseWheelHandler:function(a,c){ULSEWi:;var b=SP.Internal.JS.FindInArray(a._mouseWheelFnInfo,function(a){ULSEWi:;return a.usrFn==c});if(b!=null){$removeHandler(a,"mousewheel",a._mouseWheelFnInfo[b].wheelFn);$removeHandler(a,"DOMMouseScroll",a._mouseWheelFnInfo[b].wheelFn);if(a._mouseWheelFnInfo.length==1)a._mouseWheelFnInfo=null;else a._mouseWheelFnInfo.splice(b,1)}},GetCustomAttribute:function(b,c){ULSEWi:;var a=b.getAttribute!=null?b.getAttribute(c):null;return a==null||a==""?b[c]:a},GetParentElement:function(b){ULSEWi:;var a=b.parentNode;return a&&a.nodeType!=1?null:a},SetOpacity:function(a,b){ULSEWi:;a.style.opacity=b;a.style["-moz-opacity"]=b;a.style.filter="alpha(opacity="+b*100+")"},RemoveOpacity:function(a){ULSEWi:;a.style.opacity="";a.style["-moz-opacity"]=1;a.style.filter=""},ForEachElementChild:function(a,c,d){ULSEWi:;!d&&c(a);for(var b=0;b<a.childNodes.length;b++)SP.Internal.DomElement.ForEachElementChild(a.childNodes[b],c,false)},FindAncestorWithProperty:function(a,b,c){ULSEWi:;return a==null?null:this.GetCustomAttribute(a,b)!==undefined?{elem:a,child:c}:SP.Internal.DomElement.FindAncestorWithProperty(a.parentNode,b,a)},FindFirstAncestorWithAnyPropertyValue:function(a,c,b,d){ULSEWi:;return a==null?null:this.GetCustomAttribute(a,c) in b?{elem:a,child:d}:SP.Internal.DomElement.FindFirstAncestorWithAnyPropertyValue(a.parentNode,c,b,a)},GetChildrenWithCustomAttribute:function(d,c){ULSEWi:;var b={},a=this;a.ForEachElementChild(d,function(e){ULSEWi:;var d=a.GetCustomAttribute(e,c);if(d!=null)b[d]=e});return b},FindChildrenWithProperty:function(e,b){ULSEWi:;var c=[],d=this;function a(g){ULSEWi:;for(var f=0;f<g.childNodes.length;f++){var e=g.childNodes[f];d.GetCustomAttribute(e,b)!=null&&c.push(e);a(e,b)}}a(e);return c},ComputeMaximumSizeForWebPart:function(b,e){ULSEWi:;var d={},a=$get("MSO_ContentTable"),f=SP.Internal.DomElement.GetLocation(b),g=SP.Internal.DomElement.GetLocation(a);if(!e)b.style.display="none";var c=f.y-g.y;d.height=a.offsetHeight-c;c=f.x-g.x;d.width=a.offsetWidth-c;if(!e)b.style.display="block";return d},SetMouseHover:function(a,i,h,g){ULSEWi:;$addHandler(a,"mousemove",d);$addHandler(a,"mouseout",e);var c=true,b=false;function e(){ULSEWi:;b=true;setTimeout(f,0)}function d(a){ULSEWi:;c&&i!=null&&i();g!=null&&g(a);c=b=false}function f(){ULSEWi:;if(!c&&b){h!=null&&h();c=true;b=false}}return function(){ULSEWi:;$removeHandler(a,"mouseout",e);$removeHandler(a,"mousemove",d);e=null;d=null;f=null;a=null}},DashNameFromCamelName:function(a){ULSEWi:;return a.replace(/[A-Z]/g,function(a){ULSEWi:;return "-"+a.toLowerCase()})},CamelNameFromDashName:function(a){ULSEWi:;return a.replace(/-(\w)/g,function(b,a){ULSEWi:;return a.toUpperCase()})},GetXmlDomObj:function(b){ULSEWi:;var a;if(document.implementation&&document.implementation.createDocument)a=document.implementation.createDocument("","",null);else try{var c=document.createElement("xml");document.body.appendChild(c);a=c.XMLDocument;document.body.removeChild(c)}catch(d){a=new ActiveXObject("Microsoft.XMLDOM")}if(b!=null)if("loadXML" in a){a.async=false;a.loadXML(b)}else{parser=new DOMParser;a=parser.parseFromString(b,"text/xml")}return a},BrowserIsIE:Sys.Browser.agent==Sys.Browser.InternetExplorer,BrowserIsIEAndRenderingModeIs7:Sys.Browser.agent==Sys.Browser.InternetExplorer&&(document.documentMode==null||document.documentMode==7),SetTextNoBR:function(a,b){ULSEWi:;a.innerHTML="";a.appendChild(document.createTextNode(b))}},n=[{name:"SetText",selector:function(){ULSEWi:;return document.body.innerText!=null?function(a,b){ULSEWi:;a.innerText=b}:function(a,b){ULSEWi:;a.textContent=b}}},{name:"SetCapture",selector:function(){ULSEWi:;return document.body.setCapture!=null?q:p}},{name:"GetScreenOffsets",selector:function(){ULSEWi:;return "pageYOffset" in window?function(){ULSEWi:;return {top:window.pageYOffset,left:window.pageXOffset}}:function(){ULSEWi:;return {top:document.documentElement.scrollTop,left:document.documentElement.scrollLeft}}}},{name:"GetXmlHttpObj",selector:function(){ULSEWi:;return window.XMLHttpRequest?function(){ULSEWi:;return new XMLHttpRequest}:function(){ULSEWi:;return new ActiveXObject("Microsoft.XMLHTTP")}}},{name:"GetComputedStyle",selector:function(){ULSEWi:;return document.body.currentStyle!=null?function(b,a){ULSEWi:;return b.currentStyle[a]}:function(b,c,a){ULSEWi:;return document.defaultView.getComputedStyle(b,null).getPropertyValue(a)}}},{name:"AdjustCoordsForIEZoom",selector:function(){ULSEWi:;if(c.BrowserIsIE){j();$addHandler(window,"resize",j)}return function(a){ULSEWi:;return {x:Math.round(a.x/f),y:Math.round(a.y/f)}}}},{name:"GetOuterHTML",selector:function(){ULSEWi:;return document.body.outerHTML!=null?function(a){ULSEWi:;return a.outerHTML}:function(c){ULSEWi:;var b=c.ownerDocument,d=c.cloneNode(true),a=b.createElement("div");b.documentElement.appendChild(a);a.appendChild(d);var e=a.innerHTML;b.documentElement.removeChild(a);return e}}}],m=0;m<n.length;m++)s(n[m]);return c;function s(a){ULSEWi:;c[a.name]=function(){ULSEWi:;c[a.name]=a.selector();return c[a.name].apply(c,arguments)}}}();SP.GetSingleStopBreakpoint=function(){ULSEWi:;var a;return function(b){ULSEWi:;if(a==null)a=b!=null?b:1;if(a==1)debugger;if(a>0)--a}};var bpt=SP.GetSingleStopBreakpoint();SP.Internal.Timer=function(){ULSEWi:;this.Reset()};SP.Internal.Timer.prototype={ElapsedMs:function(){ULSEWi:;return (new Date).getTime()-this.start},Reset:function(){ULSEWi:;this.start=(new Date).getTime()},toString:function(f){ULSEWi:;var g=this.ElapsedMs(),e=new Date(g),a=Math.floor(g/3.6e6),b=e.getUTCMinutes(),d=e.getUTCSeconds()+e.getUTCMilliseconds()/1e3;if(f=="M"){b+=a*60;a=0}else if(f=="S"){d+=(a*60+b)*60;a=b=0}var c=[];a&&c.push(a);a+b&&c.push((b<10?"0":"")+b);c.push((d<10?"0":"")+d.toFixed(3));return c.join(":")}};SP.Internal.CallAsyncFn=function(d,a,c,b){ULSEWi:;if(d(function(){ULSEWi:;a!=null&&a();b!=null&&b()}))a();else c!=null&&c()};SP.ElementCover=function(a,e,g){ULSEWi:;var b,c,d,h=this;this.Show=function(){ULSEWi:;$addHandler(a,"resize",f);a.appendChild(b);a.appendChild(d);this.RefreshLayout()};this.Hide=function(){ULSEWi:;$removeHandler(a,"resize",f);a.removeChild(b);a.removeChild(d)};this.Dispose=function(){ULSEWi:;b=c=d=null};this.RefreshLayout=function(){ULSEWi:;d.style.height=b.style.height=Math.max(0,a.offsetHeight-2)+"px";d.style.width=b.style.width=Math.max(0,a.offsetWidth-2)+"px";c.style.left=Math.max((a.offsetWidth-c.offsetWidth)/2,50)+"px";c.style.marginTop=(a.offsetHeight-c.offsetHeight)/2+"px"};function f(){ULSEWi:;h.RefreshLayout()}function i(){ULSEWi:;b=document.createElement("div");b.style.cssText="z-index:5; position:absolute; top:0px; left:0px; background-color:#ffffff;border:1px solid #999999;";SP.Internal.DomElement.SetOpacity(b,.85);if(g!=null)b.id=g;d=document.createElement("div");d.style.cssText="z-index:6; position:absolute; top:0px; left:0px; background-color:transparent;";c=document.createElement("div");c.style.cssText="position:absolute; vertical-align:middle; top:0px; left:0px; padding-left:20px; padding-right:20px; background-color:#ffffff; border:1px solid #EBEEF2; white-space:nowrap;";for(var a=0;a<e.length;a++)c.appendChild(e[a]);d.appendChild(c)}i()};SP.LoadingBanner=function(d,e){ULSEWi:;var g,b,a,c;this.Show=function(d){ULSEWi:;if(d==null){a.alt=a.title="";b.style.display="none"}else{SP.Internal.DomElement.SetText(b,d);a.alt=a.title=d;b.style.display=""}c.Show()};this.Hide=function(){ULSEWi:;c.Hide()};this.UpdateText=function(a){ULSEWi:;SP.Internal.DomElement.SetText(b,a);c.RefreshLayout()};this.Dispose=function(){ULSEWi:;c.Dispose();b=a=d=null};function f(){ULSEWi:;a=document.createElement("img");a.src="/_layouts/Images/progress-circle-24.gif";a.style.cssText="vertical-align:middle;margin:30px 10px 30px 10px";b=document.createElement("span");b.style.cssText="vertical-align:middle; margin:30px 10px 30px 10px; color:black; text-align:center; white-space:nowrap; overflow:hidden";c=new SP.ElementCover(d,[a,b],e)}f()};SP.ErrorBanner=function(c,d){ULSEWi:;var b,a;this.Show=function(c){ULSEWi:;SP.Internal.DomElement.SetText(b,c);a.Show()};this.Hide=function(){ULSEWi:;a.Hide()};this.UpdateText=function(c){ULSEWi:;SP.Internal.DomElement.SetText(b,c);a.RefreshLayout()};this.Dispose=function(){ULSEWi:;a.Dispose();b=c=null};function e(){ULSEWi:;var e=document.createElement("table");b=e.insertRow().insertCell();b.style.cssText="align:middle; vertical-align:middle; color:#AA0000;text-align:center; padding:20px;";a=new SP.ElementCover(c,[e],d)}e()};SP.Internal.Key={shift:16,insert:45,six:54,numpad_plus:107,numpad_minus:109,F2:113,F6:117,plus:Sys.Browser.agent==Sys.Browser.InternetExplorer?187:61,comma:188,minus:Sys.Browser.agent==Sys.Browser.InternetExplorer?189:109,dot:190,back_slash:220,IMEInput:229};SP.JsGrid.Utility={IsChar:function(a){ULSEWi:;return a.type=="keypress"&&(a.rawEvent.which==null||a.rawEvent.which>0&&a.rawEvent.charCode>0)},FocusElementInDOMCollection:function(d,c,g){ULSEWi:;var a=[];function f(a){ULSEWi:;var b;if(a.hasAttribute!=null)b=a.hasAttribute("tabIndex")&&a.getAttribute("tabIndex")==-1;else b=a.tabIndex!=null&&a.tabIndex==-1;return b}function b(e){ULSEWi:;for(var d=0;d<e.length;d++){var c=e[d];f(c)&&a.push(c);b(c.childNodes)}}function e(){ULSEWi:;if(a.length==0)return null;var d;if(c==null)d=a[0];else for(var b=0;b<a.length;b++){if(a[b]!=c)continue;d=g?b==a.length-1?a[0]:a[b+1]:b==0?a[a.length-1]:a[b-1];break}if(d!=null)try{d.focus()}catch(e){}return d}b(d);return e()},CloneObj:function(b,a){ULSEWi:;return SP.Internal.JS.CloneObj(b,a)},GetDocumentDirection:function(){ULSEWi:;return document.documentElement.getAttribute("dir")}};SP.JsGrid.Internal.HeaderManager=function(c,I){ULSEWi:;var p={menu:c.RTL.Left,resize:c.RTL.Right,eyeBrow:"Bottom"},i={Normal:1,Hover:2,Clicked:3},a={},l={},b={},g={},h={},m={},k={},e=null,j=this,f,d,o,n,y,r=15,C=2;this.constEyeBrowHeight=5;this.constResizeWidth=5;J();function F(e,a,d){ULSEWi:;e.style.width=a.move.style.width=d-1+"px";a.eyeBrow.style.width=d-1+"px";var b=d-j.constResizeWidth-j.constResizeWidth;a.content.style.width=b+"px";if(a.sort!=null)a.sort.style[c.RTL.left]=Math.round((b-6)/2)+"px";a.coreContent.style.width=b-C+"px"}function q(b,c){ULSEWi:;var a=parseInt(SP.Internal.DomElement.GetComputedStyle(b,"width","width"));if(!isNaN(a))b.style.width=a+c+"px"}function v(a){ULSEWi:;q(a.content,-r);q(a.coreContent,-r)}function A(a){ULSEWi:;q(a.content,r);q(a.coreContent,r)}function J(){ULSEWi:;var a=I.columnHeaderStyleCollection.normal,e=a.font!=null?"font-family:"+a.font+";":"";y=String.format("text-align:{0};padding-{0}:{1}px;{2}font-size:{3};font-weight:{4};",c.RTL.left,C,e,a.fontSize,a.fontWeight);var b=document.createElement("table");b.style.cssText="position:absolute;visibility:hidden;top:0px;left:0px;width:0px;height:0px;";b.insertRow(-1);var d=document.createElement("th");b.rows[0].appendChild(d);n=document.createElement("div");n.className="jsgrid-header-core-content";n.style.cssText=y;d.appendChild(n);c.parentNode.appendChild(b)}function K(a){ULSEWi:;var b=SP.Internal.DomElement.GetChildrenWithCustomAttribute(a,"colid");b.th=a;return b}this.CreateTableHeaderCell=function(b,g,v,p,t,u,r,i,s){ULSEWi:;var q=u&&b.isSortable,n=t&&b.isResizable,x=I.columnHeaderStyleCollection.normal,f=['<div colid="eyeBrow" class="jsgrid-header-eyebrow" colAction="select" style="border-bottom:1px solid transparent;"></div>','<div colid="move" '+(p?'colAction="move"':"")+' style="position:relative;">'];f.push('<div colid="resize" class="jsgrid-header-expand" style="float:'+c.RTL.left+';"></div>');f.push('<div colid="content" class="jsgrid-header-content" style="float:'+c.RTL.left+';"><div colid="coreContent" class="jsgrid-header-core-content" style="'+y+"cursor:"+(p?"move":"default")+';"></div>');q&&f.push('<div colid="sort" class="clip9x6"><img colid="sortImg" class="jsgridcluster_jsgrid-down-arrow" src="/_layouts/Images/jsgridcluster.png"/></div>');f.push("</div>");i!=null&&f.push('<div colid="menu" class="jsgrid-header-menu" colAction="menu" style="float:'+c.RTL.left+";width:14px;border-"+c.RTL.left+':1px solid transparent;"><div style="padding-'+c.RTL.left+':4px;"><div colid="menuImg" class="clip9x6" ><img class="jsgridcluster_jsgrid-down-arrow"  src="/_layouts/Images/jsgridcluster.png" alt="'+SP.JsGrid.Res.openMenu+'" title="'+SP.JsGrid.Res.openMenu+'"/></div></div></div>');f.push('<div colid="filterState" class="jsgrid-header-filter-state" style="float:'+c.RTL.left+";width:14px;border-"+c.RTL.left+':1px solid transparent;"><div style="padding-'+c.RTL.left+':3px;"><div colid="filterStateImg" class="clip11x11" ><img class="jsgridcluster_jsgrid-header-filter-icon"  src="/_layouts/Images/jsgridcluster.png" title="'+SP.JsGrid.Res.filterIndicator+'"/></div></div></div>');f.push('<div colid="resizeRight" class="jsgrid-header-expand"'+(n?'colAction="resize-current"':"")+'style="float:'+c.RTL.left+";cursor:"+(n?"w-resize":"default")+';"></div>');f.push("</div>");g.innerHTML=f.join("");var d=b.columnKey,h=a[d]=K(g);l[d]={selection:r,move:p,resize:n};q&&D(d,m[d]);i!=null&&$addHandler(h.menu,"click",function(a){ULSEWi:;i(a,d)});if(b.imgSrc!=null){h.coreContent.className="jsgrid-header-core-img-content";h.coreContent.innerHTML='<img style="border:0px; padding-top:2px" src="'+b.imgSrc+'"/>'}else b.name!=null&&SP.Internal.DomElement.SetText(h.coreContent,b.name);if(b.name!=null)g.title=b.name;o=s;j.UpdateHeaderHeights(v);F(g,h,b.width);g.thColumnKey=d;if(e!=null&&e.thColumnKey==d)e=null;g=h=null;d in k&&w(d);return g};function O(d,c){ULSEWi:;var b=a[d.thColumnKey].resize;if(c!=null&&l[c.thColumnKey].resize){b.colAction="resize";b.style.cursor="w-resize"}else if(l[d.thColumnKey].move){b.colAction="move";b.style.cursor="move"}else{b.colAction=null;b.style.cursor="default"}}this.NotifyColumnHeaderOrderSet=function(c){ULSEWi:;var a=c,b=null;while(a!=null){O(a,b);b=a;a=o(a,false)}};this.DisposeHeader=function(c){ULSEWi:;if(f!=null&&f.columnKey==c.thColumnKey)f=null;if(d!=null&&d.key==c.thColumnKey)d=null;var e=a[c.thColumnKey]&&a[c.thColumnKey].menu;e!=null&&$clearHandlers(e);delete a[c.thColumnKey];delete g[c.thColumnKey];delete b[c.thColumnKey];delete l[c.thColumnKey];delete h[c.thColumnKey];c.thColumnKey=null};this.Dispose=function(){ULSEWi:;var b=[];for(var g in a)b.push(a[g].th);for(var c=b.length-1;c>=0;c--){delete m[b[c].thColumnKey];this.DisposeHeader(b[c])}e=a=d=f=h=l=m=j=null};this.ApplyHeaderStyle=function(e,f,n){ULSEWi:;var h=a[e.thColumnKey];if(d!=null&&d.key==e.thColumnKey){d.curStyle=f;return}if(e.headerStyleType!=f.type){b[e.thColumnKey]={};e.style["border"+c.RTL.Right]=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.outerBorderColor);if(f.font!=null)h.coreContent.style.fontFamily=f.font;h.coreContent.style.fontSize=f.fontSize;h.coreContent.style.fontWeight=f.fontWeight;h.coreContent.style.color=f.textColor;e.style.backgroundColor=h.resize.style.backgroundColor=h.content.style.backgroundColor=f.backgroundColor;h.resize.style["border"+c.RTL.Right]=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.backgroundColor);b[e.thColumnKey].eyeBrow={};b[e.thColumnKey].eyeBrow.bg=h.eyeBrow.style.backgroundColor=f.eyeBrowColor;b[e.thColumnKey].eyeBrow.border=h.eyeBrow.style["border"+p.eyeBrow+"Color"]=f.eyeBrowBorderColor;h.move.style.borderBottom=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.outerBorderColor);b[e.thColumnKey].move=h.move.style.backgroundColor=f.backgroundColor;if(h.menu!=null){b[e.thColumnKey].menu={};b[e.thColumnKey].menu.bg=h.menu.style.backgroundColor=f.menuColor;b[e.thColumnKey].menu.border=h.menu.style["border"+p.menu+"Color"]=f.menuBorderColor}else delete b[e.thColumnKey].menu;h.resizeRight.style.backgroundColor=h.menu!=null&&h.menu.style.display=="block"?f.menuColor:f.backgroundColor;g[e.thColumnKey]=f}e.headerStyleType=f.type;e.headerStyleBorderString=SP.JsGrid.Style.MakeBorderString(1,"solid",f.outerBorderColor);var k=o(e,true);if(k!=null)k.style["border"+c.RTL.Right]=m(k,e).headerStyleBorderString;if(l[e.thColumnKey].resize){var i=o(e,false);if(i!=null&&a[i.thColumnKey]!=null){e.style["border"+c.RTL.Right]=m(i,e).headerStyleBorderString;var j=a[i.thColumnKey].resize;if(!n){b[i.thColumnKey].resize={};b[i.thColumnKey].resize=j.style.backgroundColor=j.style["border"+p.resize+"Color"]=g[i.thColumnKey].backgroundColor}else{b[i.thColumnKey].resize={};b[i.thColumnKey].resize.bg=j.style.backgroundColor=g[i.thColumnKey].resizeColor;b[i.thColumnKey].resize.border=j.style["border"+p.resize+"Color"]=g[i.thColumnKey].resizeBorderColor}}}function m(a,b){ULSEWi:;return a.headerStyleType==null?b:b.headerStyleType==null?a:a.headerStyleType>b.headerStyleType?a:b}};this.GetColumnHeaderAutoResizeWidth=function(c){ULSEWi:;var b=a[c.thColumnKey];if(b.coreContent!=null)return c.offsetWidth+Math.max(b.coreContent.scrollWidth-b.coreContent.offsetWidth,0);return c.offsetWidth};this.AdjustColumnWidth=function(a){ULSEWi:;if(a.width==null||a.width<=0){a.width=SP.JsGrid.Internal.MinColumnWidth;if(a.name!=null){SP.Internal.DomElement.SetText(n,a.name);a.width=n.scrollWidth+j.constResizeWidth+j.constResizeWidth}}a.width=Math.max(a.width,SP.JsGrid.Internal.MinColumnWidth)};this.ResizeColumn=function(d,e){ULSEWi:;var c=d.thColumnKey;F(d,a[c],e);if(c in k){var b=a[c];b!=null&&b.filterState!=null&&b.filterState.style.display=="block"&&v(b)}};this.ShowMenuOnColumn=function(b){ULSEWi:;if(e!=b&&b.thColumnKey!=null){var c=a[b.thColumnKey];if(c.menu!=null){this.HideMenuOnColumn();b.thColumnKey in k&&B(b.thColumnKey);c.resizeRight.style.backgroundColor=g[b.thColumnKey].menuColor;c.menu.style.display="block";v(c);e=b}}};this.HideMenuOnColumn=function(){ULSEWi:;if(e!=null&&e.thColumnKey!=null){var c=e.thColumnKey,b=a[c];if(b.menu!=null){b.resizeRight.style.backgroundColor=g[e.thColumnKey].backgroundColor;b.menu.style.display="none";A(b);e=null;c in k&&w(c)}}};this.GetColumnMenuElementPosition=function(e){ULSEWi:;var b=a[e].menu;if(b==null)return null;var d=a[e].resizeRight,f=SP.Internal.DomElement.GetLocation(b),g=SP.Internal.DomElement.GetLocation(d);return {left:Math.min(f.x,g.x),width:b.offsetWidth+d.offsetWidth,top:f.y+(c.RTL.bEnabled?4:0),height:b.offsetHeight}};this.UpdateHeaderHeights=function(c){ULSEWi:;for(var d in a){var b=a[d];b.move.style.height=c-5+"px";if(b.menuImg!=null)b.menuImg.style.marginTop=Math.floor((c-5-6)/2)+"px";if(b.filterStateImg!=null)b.filterStateImg.style.marginTop=Math.floor((c-5-11)/2)+"px";b.coreContent.style.lineHeight=b.coreContent.style.height=c-12+"px"}};function E(b){ULSEWi:;return b in a}function x(c,d){ULSEWi:;var b=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"thColumnKey");if(b!=null&&E(b.thColumnKey)){var a=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"colid");if(a!=null)if(s(b.elem.thColumnKey,a.elem,d))return a.elem}return null}function s(c,f,e){ULSEWi:;var d=SP.Internal.DomElement.GetCustomAttribute(f,"colid");if(SP.Internal.DomElement.GetCustomAttribute(f,"colAction")=="move")return false;else if(d=="resizeRight"){var j=o(a[c].th,false);if(j!=null){d="resize";c=j.thColumnKey}else d="menu"}if(d!=null&&c in b&&d in b[c]&&!(c in h&&d in h[c]))if(d!="eyeBrow"||l[c].selection)if(e==i.Normal)z(c,d,b[c][d].bg,b[c][d].border);else if(e==i.Hover)z(c,d,g[c][d+"HoverColor"],g[c][d+"HoverBorderColor"]);else e==i.Clicked&&z(c,d,g[c].elementClickColor,g[c].elementClickBorderColor);return true}function z(c,b,d,e){ULSEWi:;if(d!=null){a[c][b].style.backgroundColor=d;if(b=="menu")a[c]["resizeRight"].style.backgroundColor=d}if(e!=null)a[c][b].style["border"+p[b]+"Color"]=e}function H(b){ULSEWi:;delete m[b];if(a[b]!=null&&a[b].sortImg!=null)a[b].sortImg.style.display="none"}function G(a,b,c){ULSEWi:;if(a.sortImg!=null){a.sortImg.className=b;a.sortImg.style.display="";a.sortImg.alt=a.sortImg.title=c}}function D(b,c){ULSEWi:;delete m[b];if(c==SP.JsGrid.SortMode.Ascending||c==SP.JsGrid.SortMode.Descending){m[b]=c;var d=a[b];if(d!=null)if(c==SP.JsGrid.SortMode.Ascending)G(d,"jsgridcluster_jsgrid-up-arrow",SP.JsGrid.Res.sortedAsc);else G(d,"jsgridcluster_jsgrid-down-arrow",SP.JsGrid.Res.sortedDesc)}else H(b)}function L(a){ULSEWi:;delete k[a];B(a)}function M(a){ULSEWi:;k[a]=null;w(a)}function B(c){ULSEWi:;var b=a[c];if(b!=null&&b.filterState!=null&&b.filterState.style.display=="block"){b.filterState.style.display="none";A(b)}}function w(c){ULSEWi:;var b=a[c];if(b!=null&&b.filterState!=null&&b.filterState.style.display!="block"&&!(e!=null&&e.thColumnKey==c)){b.filterState.style.display="block";v(b)}}this.SetSortState=function(a){ULSEWi:;for(var c in m)H(c);if(a!=null)for(var b=0;b<a.length;b++)D(a[b].fieldKey,a[b].isDescending?SP.JsGrid.SortMode.Descending:SP.JsGrid.SortMode.Ascending)};this.SetFilterState=function(a){ULSEWi:;for(var c in k)L(c);if(a!=null)for(var b=0;b<a.length;b++)M(a[b])};this.HeaderMouseDown=function(a){ULSEWi:;x(a,i.Clicked)};this.HeaderMouseUp=function(a){ULSEWi:;x(a,i.Normal)};this.HeaderMouseMove=function(b){ULSEWi:;var a=x(b,i.Hover),c=f!=null?f.elem:null;if(c!=a){j.HeaderMouseOut(b);if(c!=a&&a!=null)f={elem:a,columnKey:SP.Internal.DomElement.FindAncestorWithProperty(b.target,"thColumnKey").elem.thColumnKey}}};this.HeaderMouseOut=function(){ULSEWi:;if(f!=null){s(f.columnKey,f.elem,i.Normal);f=null}};this.SetColumnSelected=function(a){ULSEWi:;u(a,"eyebrow")};this.SetColumnUnselected=function(){ULSEWi:;t(columnKey,"eyebrow")};this.SetColumnMenuExpanded=function(a){ULSEWi:;u(a,"menu")};this.SetColumnMenuCollapsed=function(a){ULSEWi:;t(a,"menu")};this.SetColumnMoving=function(a){ULSEWi:;this.HideMenuOnColumn();u(a,"move",true)};this.SetColumnMoved=function(a){ULSEWi:;t(a,"move",true)};this.SetColumnResizing=function(a){ULSEWi:;this.HideMenuOnColumn();u(a,"resize",true)};this.SetColumnResized=function(a){ULSEWi:;t(a,"resize",true)};function P(a){ULSEWi:;if(d!=null);d={};d.key=a}function N(){ULSEWi:;if(d!=null){var b=d;d=null;b.curStyle!=null&&j.ApplyHeaderStyle(a[b.key].th,b.curStyle)}}function u(b,c,d){ULSEWi:;s(b,a[b][c],i.Clicked);if(h[b]==null)h[b]={};h[b][c]="";d&&P(b)}function t(b,c){ULSEWi:;delete h[b][c];if(SP.Internal.JS.IsAssocArrayEmpty(h[b]))delete h[b];d!=null&&d.key==b&&N();E(b)&&s(b,a[b][c],a[b][c]==f?i.Hover:i.Normal)}};SP.JsGrid.Internal.HierarchyManager=function(n,y,l,k,v,B,p,C,D,j){ULSEWi:;var b=[],g=new SP.Utilities.Set,i=0,c,q={},a=B,h=this,f={},z=n.jsGridObj,d=n.tableCache,H=n.commandMgr,G=n.delegateMgr;if(j==null)j={};if(a!=null)c=new w(a);this.GetState=function(g){ULSEWi:;var d=[],c=[],a=[];f(b);return {recordKeys:d,recordIdxs:c,recordDescendantCounts:a};function f(i){ULSEWi:;for(var b=0;b<i.length;b++){f(i[b].collapsedChildren);var j=i[b].recordKey;d.push(g&&!h.IsGroupingRecord(j)?SP.JsGrid.GuidManager.LookupGuidForIndex(j):j);c.push(i[b].recordIdx);a.push(e(j))}}};this.SetState=function(e,f){ULSEWi:;b=[];g=new SP.Utilities.Set;i=0;if(f!=null){a=f;c=new w(a)}if(e!=null){q={};for(var d=0;d<e.recordIdxs.length;d++)q[e.recordKeys[d]]=e.recordDescendantCounts[d];for(var d=0;d<e.recordIdxs.length;d++)this.NotifyCollapse(e.recordIdxs[d],e.recordKeys[d])}};this.GetUnfilteredHierarchyMgr=function(){ULSEWi:;return a};this.GetViewRecords=function(b,c,a){ULSEWi:;return d.GetRecords(E(b,c),a)};this.GetViewRecordCount=function(){ULSEWi:;return d.GetRecordCount()-i};this.SetTableView=function(d,c,b,a){ULSEWi:;y=d;l=c;k=b;v=a;f={}};this.ConvertViewIdxToRecordIdx=function(c){ULSEWi:;var d=SP.Internal.JS.UpperBound(b,c,"viewIdx");if(!d)return c;var a=b[d-1];return a.viewIdx==c?a.recordIdx:a.recordIdx+(c-a.viewIdx)+e(a.recordKey)};this.ConvertRecordIdxToViewIdx=function(c){ULSEWi:;var f=SP.Internal.JS.UpperBound(b,c,"recordIdx");if(!f)return c;var a=b[f-1];if(a.recordIdx==c)return a.viewIdx;else{var d=c-a.recordIdx-e(a.recordKey);return d<=0?null:a.viewIdx+d}};this.IsGroupingRecord=function(a){ULSEWi:;return this.IsGrouped()&&a.constructor==String&&a.indexOf(v)==0};this.GetNodeInfo=function(a){ULSEWi:;return {nodeType:this.GetNodeType(a.key()),indent:this.GetNodeIndentLevel(a)}};this.GetNodeType=function(a){ULSEWi:;if(D.Contains(a))return SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed;else if(z.IsEntryRecordKey(a)||e(a)==0)return SP.JsGrid.Internal.HierarchyManager.NodeType.Leaf;else if(g.Contains(a))return SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed;else return SP.JsGrid.Internal.HierarchyManager.NodeType.Expanded};this.GetNodeIndentLevel=function(a){ULSEWi:;if(z.IsEntryRecordKey(a.key()))return 0;else if(this.IsGrouped()){var b=l.GetValue(a,SP.JsGrid.OperationalConstants.GroupingOutlineLevel);return b==null?k:b}else return u(a)};this.GetInsertAfterInfoForInsert=function(g,e){ULSEWi:;var b=null,c=g;while((c=a.GetParent(c))!=null)if(!m(c))b=null;else if(b==null&&d.IsKeyInView(c))b=c;var f=Math.max(b!=null?a.GetOutlineLevel(b)+1:0,1);return C(e)?f:Math.max(f,a.GetOutlineLevel(e))};this.GetAfterKeyFromBeforeKey=function(b){ULSEWi:;return a.GetPrevNode(b)};this.GetInsertAfterInfoForDelete=function(b){ULSEWi:;return {insertAfterKey:a.GetPrevNode(b),outlineLevel:a.GetOutlineLevel(b)}};this.NotifyCollapse=function(c,d){ULSEWi:;var m=h.ConvertRecordIdxToViewIdx(c),k=e(d);g.Add(d);var a=k,j=0;s(c,k,function(c,b){ULSEWi:;a-=e(b);j++});var f=SP.Internal.JS.LowerBound(b,c,"recordIdx"),l=b.splice(f,j,{recordIdx:c,recordKey:d,viewIdx:m});b[f].collapsedChildren=l;r(f+1,-a,b);i+=a;return a};this.NotifyExpand=function(j,h){ULSEWi:;g.Remove(h);var d=SP.Internal.JS.BinarySearch(b,j,"recordIdx"),a=b[d],c=e(h),k=a.recordIdx-a.viewIdx;for(var l in a.collapsedChildren){var f=e(a.collapsedChildren[l].recordKey);c-=f;k+=f}Array.prototype.splice.apply(b,[d,1].concat(a.collapsedChildren));r(d+a.collapsedChildren.length,c,b);i-=c;return c};this.GetNextNonGroupingIdx=function(a){ULSEWi:;while(this.IsGroupingRecord(d.RecordIdxToKey(a))){if(a==d.GetRecordCount()-1)return a;a++}return a};this.NotifyInsertRowAfter=function(l,j,i,k){ULSEWi:;function h(a){ULSEWi:;if(a!=null)for(var c=0;c<a.length;c++){var b=a[c];b.recordIdx++;b.viewIdx++;h(b.collapsedChildren)}}var d=null;if(a!=null){var g=A(l,k);d=g.parentKey;!m(d)&&p(d);a.Insert(i,g.parentKey,g.previousSiblingKey,false);a.ForEachAncestor(i,false,function(a){ULSEWi:;c.AdjustCount(a,1)})}else if(this.IsGrouped()){var e=o(j);if(f[e]==null)f[e]=0;f[e]++}var n=SP.Internal.JS.LowerBound(b,j,"recordIdx");h(b.slice(n));return d};this.ValidateAndMinimizeKeyList=function(b){ULSEWi:;for(var c=0;c<b.length;c++)if(a.GetParent(b[c])==null)return {bLevelZeroFound:true};return {bLevelZeroFound:false,minimizedKeys:x(b).ToArray()}};this.ValidateAndExpandKeyList=function(b){ULSEWi:;for(var c=0;c<b.length;c++){if(!a.IsKeyPresent(b[c]))return {bGroupingRowFound:true};if(a.GetParent(b[c])==null)return {bLevelZeroFound:true}}function e(g){ULSEWi:;function c(g){ULSEWi:;for(var f=a.GetChildren(g),e=f.length-1;e>=0;e--){if(!d.IsKeyInView(f[e])||!c(f[e]))return false;b.push(f[e])}return true}var e=true,b=[];for(var f in g.GetCollection()){if(!c(f)){e=false;break}b.push(f)}return {bAllChildKeysInView:e,bGroupingRowFound:false,bLevelZeroFound:false,expandedKeys:b}}return e(x(b))};this.CanDelete=function(b){ULSEWi:;return a.GetChildren(b).length==0};this.NotifyDeleteRow=function(e,d){ULSEWi:;function l(a){ULSEWi:;if(a!=null)for(var c=0;c<a.length;c++){var b=a[c];b.recordIdx--;if(!k)b.viewIdx--;l(b.collapsedChildren)}}g.Remove(e);var k=this.ConvertRecordIdxToViewIdx(d)==null;if(k)i--;if(a!=null){var m=a.GetParent(e);a.Delete(e);c.Delete(e);a.ForEachAncestor(m,true,function(a){ULSEWi:;c.AdjustCount(a,-1)})}else if(this.IsGrouped()){var j=o(d);if(f[j]==null)f[j]=0;f[j]--}var h=SP.Internal.JS.LowerBound(b,d,"recordIdx");b[h]!=null&&b[h].recordIdx==d&&b.splice(h,1);l(b.slice(h))};this.CanIndent=function(b){ULSEWi:;return a.GetPrevSibling(b)!=null};this.EnsureIndentPreconditionsMet=function(d){ULSEWi:;var b=a.GetPrevSibling(d);c.GetCount(b)!=0&&!m(b)&&p(b);return null};this.NotifyIndent=function(b,h){ULSEWi:;var g=a.GetPrevSibling(b),j=c.GetCount(b),f=h==null?[]:[].concat(a.GetSiblingSlice(h,false,true));a.Move(b,g,null,true);for(var i=0,e=0;e<f.length;e++){i+=(d.IsKeyInView(f[e])?1:0)+c.GetCount(f[e]);a.Move(f[e],g,null,true)}c.AdjustCount(b,-i);c.AdjustCount(g,1+j);return [{startingRecordKey:g,count:1},{startingRecordKey:b,count:1+t(b)}]};this.CanOutdent=function(c){ULSEWi:;var b=a.GetParent(c);return b!=null&&a.GetParent(b)!=null};this.EnsureOutdentPreconditionsMet=function(b){ULSEWi:;var d=a.GetParent(b),c=a.GetSiblingSlice(b,false,false);c.length!=0&&!m(b)&&p(b);return c.length==0?null:c};this.NotifyOutdent=function(b){ULSEWi:;var g=a.GetParent(b),i=t(b),f=[].concat(a.GetSiblingSlice(b,false,false));a.Move(b,a.GetParent(g),g,false);for(var h=0,e=0;e<f.length;e++){h+=(d.IsKeyInView(f[e])?1:0)+c.GetCount(f[e]);a.Move(f[e],b,null,true)}c.AdjustCount(b,h);c.AdjustCount(g,-1*(1+c.GetCount(b)));return [{startingRecordKey:g,count:1},{startingRecordKey:b,count:1+i}]};this.IsGrouped=function(){ULSEWi:;return k!=0&&k!=null};this.GetOutlineLevel=function(a){ULSEWi:;return u(a)};this.GetParentKey=function(c,b){ULSEWi:;return a!=null?a.GetParent(c):this.IsGrouped()?o(b):null};function o(e){ULSEWi:;var b=null,a=e-1;while(b==null&&a>=0){var c=d.RecordIdxToKey(a);if(h.IsGroupingRecord(c))b=c;a--}return b}function E(d,g){ULSEWi:;for(var e=[],c=h.ConvertViewIdxToRecordIdx(d),b={pos:c,count:1},a,f=d+1;f<d+g;f++){a=h.ConvertViewIdxToRecordIdx(f);if(a==c+1)b.count++;else{e.push(b);b={pos:a,count:1}}c=a}e.push(b);return e}function t(b){ULSEWi:;if(g.Contains(b))return 0;var a=e(b),c=y.RecordKeyToRecordIdx(b);s(c,a,function(c,b){ULSEWi:;a-=e(b)});return a}function s(c,d,f){ULSEWi:;var e=c+d,a=SP.Internal.JS.UpperBound(b,c,"recordIdx");while(a<b.length&&b[a].recordIdx<=e){f(b[a].recordIdx,b[a].recordKey);a++}}function r(d,c,b){ULSEWi:;for(var a=d;a<b.length;a++){b[a].viewIdx+=c;r(0,c,b[a].collapsedChildren)}}function u(b){ULSEWi:;return a!=null?a.GetOutlineLevel(b.key()):l.GetValue(b,SP.JsGrid.OperationalConstants.HierarchyOutlineLevel)}function e(b){ULSEWi:;var e,g=h.IsGrouped();if(a!=null&&!g)e=c.GetCount(b);else if(!g&&b in j)e=j[b];else{var i=d.GetCachedRecord(b);if(i==null)e=q[b];else e=l.GetValue(i,g?SP.JsGrid.OperationalConstants.GroupingDescendantCount:SP.JsGrid.OperationalConstants.HierarchyDescendantCount)||0;if(g&&h.IsGroupingRecord(b)&&b in f)e+=f[b]}return e}function x(f){ULSEWi:;var c=new SP.Utilities.Set,d=new SP.Utilities.Set;c.AddArray(f);for(var e in c.GetCollection()){for(var b=a.GetParent(e);b!=null;b=a.GetParent(b))if(c.Contains(b))break;b==null&&d.Add(e)}return d}function m(a){ULSEWi:;return !g.Contains(a)}function A(c,d){ULSEWi:;var e,f=a.GetOutlineLevel(c);if(d==f+1)e={parentKey:c,previousSiblingKey:null};else{var b=c;while(d!=f){b=a.GetParent(b);d++}e={parentKey:a.GetParent(b),previousSiblingKey:b}}return e}function w(b){ULSEWi:;var e=this,a={};this.Clear=function(){ULSEWi:;a={}};this.Delete=function(b){ULSEWi:;delete a[b]};this.GetCount=function(b){ULSEWi:;c(b);return a[b]||0};this.AdjustCount=function(b,c){ULSEWi:;if(b in a)a[b]+=c};function c(f){ULSEWi:;if(!(f in a)){for(var i=b.GetChildren(f),c=0,g=0;g<i.length;g++){var h=i[g];c+=(d.IsKeyInView(h)?1:0)+e.GetCount(h)}if(c!=0)a[f]=c}}}};SP.JsGrid.Internal.HierarchyManager.NodeType={Leaf:0,Expanded:1,Collapsed:2};SP.JsGrid.UnfilteredHierarchyManager=function(b){ULSEWi:;var a={},d,c=this;g();this.GetUnfilteredHierarchyMap=function(){ULSEWi:;return a};this.GetTopNodeKey=function(){ULSEWi:;return d};this.GetLastNodeKey=function(){ULSEWi:;var c=d;while(true){var b=a[c].childKeys;if(b.length>0)c=b[b.length-1];else break}return c};this.Hydrate=function(b,c){ULSEWi:;a=b;d=c};this.IsKeyPresent=function(b){ULSEWi:;return b in a};this.GetParent=function(b){ULSEWi:;return a[b].parentKey};this.GetChildren=function(b){ULSEWi:;return a[b].childKeys};this.GetSiblingSlice=function(d,c,b){ULSEWi:;var a=e(d);return c?a.siblingKeys.slice(0,a.siblingIdx+(b?1:0)):a.siblingKeys.slice(a.siblingIdx+(b?0:1))};this.GetFirstChild=function(b){ULSEWi:;var a=this.GetChildren(b);return a.length?a[0]:null};this.GetLastChild=function(b){ULSEWi:;var a=this.GetChildren(b);return a.length?a[a.length-1]:null};this.GetNextSibling=function(b){ULSEWi:;var a=e(b);return a.siblingIdx==a.siblingKeys.length-1?null:a.siblingKeys[a.siblingIdx+1]};this.GetPrevSibling=function(b){ULSEWi:;var a=e(b);return a.siblingIdx==0?null:a.siblingKeys[a.siblingIdx-1]};this.GetNextNode=function(a){ULSEWi:;for(var b=this.GetFirstChild(a);b==null&&a!=null;b=this.GetNextSibling(a),a=this.GetParent(a));return b};this.GetPrevNode=function(d){ULSEWi:;var c=this.GetPrevSibling(d);if(c==null)return this.GetParent(d);var b=c,a;while(a=this.GetLastChild(b),a!=null)b=a;return b};this.ForEachAncestor=function(a,b,c){ULSEWi:;if(!b)a=this.GetParent(a);for(;a!=null;a=this.GetParent(a))c(a)};this.ForEachChild=function(d,c){ULSEWi:;for(var b=this.GetChildren(d),a=0;a<b.length;a++)c(b[a])};this.GetAllNodes=function(){ULSEWi:;var b=[];a(d);return b;function a(d){ULSEWi:;b.push(d);c.ForEachChild(d,a)}};this.GetKeysInOrder=function(b){ULSEWi:;var h=b,a,g=0;if(b.length>1){h=[];for(var a=b[0],e=1;e<b.length;e++)k(b[e]);var f=i(a,0);f=[a].concat(f);for(var j=(new SP.Utilities.Set).AddArray(b),e=0;e<f.length;e++)if(j.Contains(f[e])){h.push(f[e]);if(h.length==b.length)break}}return h;function i(f,e){ULSEWi:;var b=c.GetChildren(f),a;if(e+1<g&&b.length>0){a=[];for(var d=0;d<b.length;d++){a.push(b[d]);Array.prototype.splice.apply(a,[a.length,0].concat(i(b[d],e+1)))}}return a||b}function k(b){ULSEWi:;var e=new SP.Utilities.Set,f=0;while(b!=null&&b!=a){e.Add(b);b=c.GetParent(b);f++}if(b!=null)g=Math.max(f,g);else{while(!e.Contains(a)&&a!=null){a=c.GetParent(a);g++}if(a==null)a=d}}};this.GetOutlineLevel=function(d){ULSEWi:;for(var b=a[d],c=0;b.parentKey!=null;c++)b=a[b.parentKey];return c};this.Insert=function(b,e,d,c){ULSEWi:;a[b]={parentKey:null,childKeys:[]};this.Move(b,e,d,c)};this.Delete=function(b){ULSEWi:;f(b);delete a[b]};this.Move=function(d,i,h,g){ULSEWi:;f(d);var c,b;if(h==null){b=this.GetChildren(i);c=g?b.length:0}else{var j=e(h);b=j.siblingKeys;c=j.siblingIdx+(g?0:1)}b.splice(c,0,d);a[d].parentKey=i};function e(b){ULSEWi:;var a=c.GetParent(b),d=a!=null?c.GetChildren(a):[b],e=SP.Internal.JS.FindInArray(d,function(a){ULSEWi:;return a==b});return {siblingKeys:d,siblingIdx:e,parentKey:a}}function f(b){ULSEWi:;if(c.GetParent(b)!=null){var a=e(b);a.siblingKeys.splice(a.siblingIdx,1)}}function g(){ULSEWi:;if(b.length>0){d=b[0].Key;for(var c=0;c<b.length;c++){var g=b[c].Key,f=b[c].Parent,e=f!=null?b[f].Key:null;a[g]={parentKey:e,childKeys:[]};e!=null&&a[e].childKeys.push(g)}}b=null}};SP.JsGrid.Internal.ChangeHighlightManager=function(){ULSEWi:;var a;this.AddCell=function(c,d){ULSEWi:;var e=b(c,d);a.Add(e)};this.Clear=function(){ULSEWi:;a=new SP.Utilities.Set};this.IsCellIn=function(c,d){ULSEWi:;return a.Contains(b(c,d))};function b(a,b){ULSEWi:;return [a,b].join()}this.Clear()};SP.JsGrid.JsGridControl=function(c,t){ULSEWi:;G();c.style.position="relative";var b,d,l,s,x,y,r=0,j,v=false,m=false,e,n=new SP.JsGrid.EventManager,h=new SP.JsGrid.DelegateManager,p=new SP.JsGrid.DelegateManager,q=new SP.LoadingBanner(c,c.id+"_disable_banner"),a={},k,g={Start:0,Finish:1},f=this;this.parentNode=c;c.jsgrid=this;t&&o(false);this.IsInitialized=function(){ULSEWi:;return v};this.Init=function(k){ULSEWi:;var f=k;e=c.jsgridparams=f;c.jsgridtableviewparams=f.tableViewParams;c.jsgridrowviewparams=f.tableViewParams&&f.tableViewParams.rowViewParams;i(g.Start);this.name=f.name!=null?f.name:"";D();j=f.tableCache;l=f.commandMgr;l.IsUndoEnabled()&&l.AddPreExecuteNotifier(A);a.RTL={bEnabled:f.isRTL,left:f.isRTL?"right":"left",Left:f.isRTL?"Right":"Left",right:f.isRTL?"left":"right",Right:f.isRTL?"Left":"Right",ltr:f.isRTL?"rtl":"ltr"};SP.JsGrid.Style.SetRTL(a.RTL);p.SetDelegate(SP.JsGrid.Internal.DelegateType.CallAsyncFn,E);p.SetDelegate(SP.JsGrid.Internal.DelegateType.GetLocalizedString,u);p.SetDelegate(SP.JsGrid.Internal.DelegateType.DoLargeTask,F);a.jsGridObj=this;a.jsGridParams=e;a.gridId=c.id;a.eventMgr=n;a.intEventMgr=new SP.JsGrid.EventManager;a.intDelegateMgr=p;a.commandMgr=f.commandMgr;a.delegateMgr=h;a.styleMgr=f.styleManager;a.tableCache=f.tableCache;a.errorMgr=new SP.JsGrid.Internal.ErrorManager(a);a.rowHeaderStateMgr=new SP.JsGrid.Internal.RowHeaderStateManager(a.intEventMgr);a.rowHeaderStates=new SP.JsGrid.RowHeaderStates(a);a.rowHeaderAutoStates=new SP.JsGrid.AutoRowHeaderStates(f.enabledRowHeaderAutoStates,a);a.entryRecordMgr=new SP.JsGrid.Internal.EntryRecordManager(a);a.parentNode=c;a.gridControls={};var m="{cursor:hand} :link {color:"+a.styleMgr.gridPaneStyle.linkColor+"} :visited {color: "+a.styleMgr.gridPaneStyle.visitedLinkColor+"}";SP.JsGrid.DisplayControl.ImageTextDisplayControl._styleForLinks=m;SP.JsGrid.DisplayControl.TextDisplayControl._styleForLinks=m;f.bNotificationsEnabled&&SP.JsGrid.Internal.ErrorNotificationManager.Init(a.gridId,a);a.controller=d=new SP.JsGrid.Internal.MVCController(a,u,f.bEnableDiffTracking);a.paneMgr=b=new SP.JsGrid.Internal.PaneManager(c.id,a,u,c,f.minHeaderHeight,f.minRowHeight,function(){ULSEWi:;return r==0});b.SetEventSinks(d.GetViewEventSinks());k.tableViewParams!=null&&z(k.tableViewParams);$addHandler(window,"unload",w);v=true;i(g.Finish)};function D(){ULSEWi:;e.fnCreateNewRecords!=null&&h.SetDelegate(SP.JsGrid.DelegateType.CreateRecords,e.fnCreateNewRecords);e.fnExpandColumnMenu!=null&&h.SetDelegate(SP.JsGrid.DelegateType.ExpandColumnMenu,e.fnExpandColumnMenu);e.fnSort!=null&&h.SetDelegate(SP.JsGrid.DelegateType.Sort,e.fnSort)}function w(){ULSEWi:;$removeHandler(window,"unload",w);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnBeforeGridDispose);a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnGridDisposing);q.Dispose();b.Dispose();c.innerHTML="";c=c.jsgrid=c.jsgridparams=c.jsgridtableviewparams=c.jsgridrowviewparams=null;delete f.parentNode;a.parentNode=null;v=m=false;l.RemovePreExecuteNotifier(A)}this.Dispose=w;this.NotifyDataAvailable=function(){ULSEWi:;d.NotifyDataAvailable()};this.NotifySave=function(){ULSEWi:;d.NotifySave()};this.NotifyHide=function(){ULSEWi:;d.NotifyHide()};this.NotifyResize=function(){ULSEWi:;b.NotifyResize()};this.ClearTableView=function(){ULSEWi:;if(m){d.ClearTableView();m=false}};this.HideInitialLoadingBanner=function(){ULSEWi:;if(t){o(true);t=false}};this.ShowInitialGridErrorMsg=function(a){ULSEWi:;this.HideInitialLoadingBanner();errorBanner=new SP.ErrorBanner(c,c.id+"_initial_error_banner");errorBanner.Show(a)};this.ShowGridErrorMsg=function(a){ULSEWi:;this.HideInitialLoadingBanner();errorBanner=new SP.ErrorBanner(c,c.id+"_error_banner");errorBanner.Show(a)};this.LaunchPrintPreview=function(k,m,l,f,g,p,i,h,o,n){ULSEWi:;var d=null;if(f==null)f="test";b.GetRecordMap(function(){ULSEWi:;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return d=j.GetRecords([{pos:0,count:j.GetRecordCount()}],function(b){ULSEWi:;d=b;a()})},function(){ULSEWi:;e.tableViewParams.rowViewParams.view=j.GetView();if(g)SP.JsGrid.FinishLaunchPrintPreview(d.records[0],e,k,m,l,i,h,f,g,p,c.clientWidth-a.paneMgr.GetSplitterPosition()-SP.JsGrid.Internal.SplitterWidth,a.paneMgr.GetGanttZoomLevel(),o,n);else SP.JsGrid.FinishLaunchPrintPreview(d.records[0],e,k,m,l,i,h,f,g,null,0,0,null,null)})})};this.GetAllDataJson=function(c,a){ULSEWi:;b.GetAllDataJson(c,a)};this.SetTableView=function(a){ULSEWi:;e.tableViewParams=c.jsgridtableviewparams=a;c.jsgridrowviewparams=a.rowViewParams;i(g.Start);z(a);i(g.Finish)};function z(b){ULSEWi:;m&&f.ClearTableView();m=true;f.HideInitialLoadingBanner();if(h.DelegatePresent(SP.JsGrid.DelegateType.GetGridRowStyleId))b.fnGetGridRowStyleId=h.GetDelegate(SP.JsGrid.DelegateType.GetGridRowStyleId);k!=null&&n.DetachEvent(SP.JsGrid.EventType.OnRightClick,k);k=b.fnOnRightClick==null?null:function(a){ULSEWi:;b.fnOnRightClick(a.eventInfo,a.context,a.recordKey,a.fieldKey)};k!=null&&n.AttachEvent(SP.JsGrid.EventType.OnRightClick,k);s=new SP.JsGrid.Internal.PositionConverter(j,a);if(b.operationalConstantsFieldKeyMap!=null){x=b.operationalConstantsFieldKeyMap;y=B()}d.SetTableView(b.rowViewParams,b.columns,b.gridFieldMap,b.defaultEditMode,b.bNewRowEnabled,b.bEditingEnabled,b.splitterPos,s,y,b.fnGetGridRowStyleId,b.allowedSelectionTypes,b.bMovableColumns,b.bResizableColumns,b.bHidableColumns,b.bSortableColumns,b.bAutoFilterableColumns,b.bRowHeadersEnabled,b.paneLayout,b.ganttParams,b.pivotedGridParams,b.bRecordIndicatorCheckboxesEnabled,b.checkSelectionCheckboxHiddenRecordKeys,b.checkSelectionCheckboxDisabledRecordKeys,b.checkSelectionCheckedRecordKeys)}this.SetRowView=function(a){ULSEWi:;e.tableViewParams.rowViewParams=c.jsgridrowviewparams=a;i(g.Start);d.SetRowView(a);i(g.Finish)};this.Enable=function(){ULSEWi:;o(true)};this.Disable=function(a){ULSEWi:;o(false,a)};this.EnableEditing=function(){ULSEWi:;d.EnableEditing()};this.DisableEditing=function(){ULSEWi:;d.DisableEditing()};this.FinalizeEditing=function(a,b){ULSEWi:;d.FinalizeEditing(a,b)};this.ShowColumnConfigurationDialog=function(){ULSEWi:;b.ShowColumnConfigurationDialog()};this.GetDiffTracker=function(){ULSEWi:;return d.GetDiffTracker()};this.Focus=function(){ULSEWi:;b.Focus()};this.TryCommitFirstEntryRecords=function(b){ULSEWi:;a.entryRecordMgr.TryCommitFirstEntryRecords(b)};this.ClearUncommittedEntryRecords=function(){ULSEWi:;a.entryRecordMgr.ClearUncommittedEntryRecords()};this.AnyUncomittedEntryRecords=function(){ULSEWi:;return a.entryRecordMgr.AnyUncomittedEntryRecords()};this.GetEntryRecord=function(b){ULSEWi:;return a.entryRecordMgr.GetEntryRecord(b)};this.IsEntryRecordKey=function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)};this.IsCellEditable=function(d,c,a){ULSEWi:;return b.IsCellEditable(d,c,a)};this.AddBuiltInRowHeaderState=function(c,b){ULSEWi:;this.AddRowHeaderState(c,a.rowHeaderStates[b])};this.AddRowHeaderState=function(c,b){ULSEWi:;a.rowHeaderStateMgr.AddRowHeaderState(c,b)};this.RemoveRowHeaderState=function(c,b){ULSEWi:;a.rowHeaderStateMgr.RemoveRowHeaderState(c,b)};this.GetCheckSelectionManager=function(){ULSEWi:;return d.GetCheckSelectionManager()};this.UpdateProperties=function(a,c,b){ULSEWi:;var e=d.UpdateProperties(a,c,b,null);return e};this.InsertRecordAfter=function(a,c,b){ULSEWi:;return d.InsertRecordAfter(a,c,b,true)};this.InsertRecordBefore=function(a,c,b){ULSEWi:;return d.InsertRecordBefore(a,c,b,true)};this.InsertHiddenRecord=function(c,b,a){ULSEWi:;return d.InsertHiddenRecord(c,b,a)};this.DeleteRecords=function(b,a){ULSEWi:;return d.DeleteRecords(b,a)};this.IndentRecords=function(b,a){ULSEWi:;return d.AdjustRecordsIndentLevel(b,1,a)};this.OutdentRecords=function(b,a){ULSEWi:;return d.AdjustRecordsIndentLevel(b,-1,a)};this.AttachEvent=function(a,b){ULSEWi:;n.AttachEvent(a,b)};this.DetachEvent=function(a,b){ULSEWi:;n.DetachEvent(a,b)};this.SetDelegate=function(a,b){ULSEWi:;h.SetDelegate(a,b)};this.GetDelegate=function(a){ULSEWi:;return h.GetDelegate(a)};this.RefreshRow=function(a){ULSEWi:;b.NotifyChangedRows(s.RecordKeyToViewIdx(a),1)};this.RefreshAllRows=function(a){ULSEWi:;b.RefreshAllRows(a)};this.ClearChanges=function(){ULSEWi:;d.ClearChanges()};this.GetGanttZoomLevel=function(){ULSEWi:;return b.GetGanttZoomLevel()};this.SetGanttZoomLevel=function(a){ULSEWi:;b.SetGanttZoomLevel(a)};this.ScrollGanttToDate=function(a){ULSEWi:;b.ScrollGanttToDate(a)};this.ScrollCellIntoView=function(d,c,a){ULSEWi:;b.ScrollCellIntoView(d,c,a)};this.GetTopRecordIndex=function(){ULSEWi:;return s.GetTopViewIdx()};this.GetTopRowIndex=function(a){ULSEWi:;return b.GetTopRowIndex(a)};this.GetLeftColumnIndex=function(a){ULSEWi:;return b.GetLeftColumnIndex(a)};this.GetOutlineLevel=function(a){ULSEWi:;return d.GetOutlineLevel(a)};this.ShowColumn=function(a,c){ULSEWi:;b.ShowColumn(a,c)};this.HideColumn=function(a){ULSEWi:;b.HideColumn(a)};this.UpdateColumns=function(a){ULSEWi:;b.UpdateColumns(a)};this.GetColumns=function(a){ULSEWi:;return b.GetColumns(a)};this.GetSplitterPosition=function(){ULSEWi:;return b.GetSplitterPosition()};this.SetSplitterPosition=function(a){ULSEWi:;b.SetSplitterPosition(a)};this.AnyErrors=function(){ULSEWi:;return a.errorMgr.AnyErrors()};this.AnyErrorsInRecord=function(b){ULSEWi:;return a.errorMgr.AnyErrorsInRow(b)};this.SetCellError=function(c,d,b){ULSEWi:;return a.errorMgr.SetCellError(c,d,b)};this.SetRowError=function(c,b){ULSEWi:;return a.errorMgr.SetRowError(c,b)};this.ClearCellError=function(b,c,d){ULSEWi:;a.errorMgr.ClearCellError(b,c,d)};this.ClearRowError=function(b,c){ULSEWi:;a.errorMgr.ClearRowError(b,c)};this.ClearAllErrorsOnRow=function(b){ULSEWi:;return a.errorMgr.ClearAllErrorsOnRow(b)};this.GetRowErrorMessage=function(b){ULSEWi:;return a.errorMgr.GetMessageForRow(b)};this.GetCellErrorMessage=function(b,c){ULSEWi:;return a.errorMgr.GetMessageForCell(b,c)};this.ScrollToAndExpandNextError=function(c,b){ULSEWi:;return a.paneMgr.ScrollToAndExpandNextError(c,null,b)};this.ScrollToAndExpandNextErrorOnRecord=function(d,b,c){ULSEWi:;return a.paneMgr.ScrollToAndExpandNextError(d,b,c)};this.GetFocusedItem=function(){ULSEWi:;return b.GetFocusedItemInfo()};this.JumpToEntryRecord=function(){ULSEWi:;b.JumpToEntryRecord()};this.SelectRowRange=function(d,e,c,a){ULSEWi:;b.Select(d,e,null,null,c,a)};this.SelectColumnRange=function(d,e,c,a){ULSEWi:;b.Select(null,null,d,e,c,a)};this.SelectCellRange=function(f,g,d,e,c,a){ULSEWi:;b.Select(f,g,d,e,c,a)};this.SelectRowRangeByKey=function(d,e,c,a){ULSEWi:;b.SelectByKey(d,e,null,null,c,a)};this.SelectColumnRangeByKey=function(d,e,c,a){ULSEWi:;b.SelectByKey(null,null,d,e,c,a)};this.SelectCellRangeByKey=function(a,c,f,g,e,d){ULSEWi:;b.SelectByKey(a,c,f,g,e,d)};this.GetSelectedRowRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.RowRange)};this.GetSelectedColumnRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.ColumnRange)};this.GetSelectedCellRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.CellRange)};this.GetSelectedRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,null)};this.MarkPropUpdateInvalid=function(c,e,b,a){ULSEWi:;return d.MarkPropUpdateInvalid(c,e,b,a)};this.GetCurrentChangeKey=function(){ULSEWi:;return d.GetCurrentChangeKey()};this.GetChangeKeyForVersion=function(a){ULSEWi:;return d.GetChangeKeyForVersion(a)};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForChangeKey(b,c,a)};this.GetHierarchyState=function(b){ULSEWi:;var a=d.GetHierarchyManager();return a&&a.GetState(b)};this.IsGroupingRecordKey=function(b){ULSEWi:;var a=d.GetHierarchyManager();return a&&a.IsGroupingRecord(b)};this.GetSelectedRecordKeys=function(a){ULSEWi:;return C(a)};this.CutToClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnCut(b)};this.CopyToClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnCopy(b)};this.PasteFromClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnPaste(b)};this.GetUndoManager=function(){ULSEWi:;return l};this.GetVisibleRecordCount=function(){ULSEWi:;return a.paneMgr.GetVisibleRecordCount()};this.GetRecordIndicatorCheckBoxColumnIndex=function(){ULSEWi:;return a.paneMgr.GetRecordIndicatorCheckBoxColumnIndex()};function A(){ULSEWi:;a.paneMgr.StopEditing(false)}function C(g){ULSEWi:;var d=f.GetSelectedRowRanges(),h=f.GetSelectedColumnRanges(),c=f.GetSelectedCellRanges(),b;if(h.length!=0)b=j.GetView();else if(g){b=[];for(var a=0;a<d.length;a++)b=b.concat(d[a].keys);for(var a=0;a<c.length;a++)b=b.concat(c[a].rowRange.keys)}else{for(var e=new SP.Utilities.Set,a=0;a<d.length;a++)e.AddArray(d[a].keys);for(var a=0;a<c.length;a++)e.AddArray(c[a].rowRange.keys);b=e.ToArray()}return b}function G(){ULSEWi:;if(!SP.JsGrid.JsGridControl._bStaticInit){SP.JsGrid.Internal.Property=new SP.JsGrid.Internal.Property;SP.JsGrid.JsGridControl._bStaticInit=true}}function B(){ULSEWi:;function a(a){ULSEWi:;return x[a]}return {GetFieldKey:a,GetProp:function(d,c){ULSEWi:;var b=a(c);return {fieldKey:b,prop:d.GetProp(b)}},GetValue:function(c,b){ULSEWi:;return c.GetDataValue(a(b))}}}function E(b,a){ULSEWi:;return SP.Internal.CallAsyncFn(b,a,function(){ULSEWi:;f.Disable()},function(){ULSEWi:;f.Enable()})}function F(c,b,d,e,g){ULSEWi:;var a=0;if(c>b){f.Disable();SP.JsGrid.AsynchronousTaskManager.RegisterTask(h,g)}else{d(0,c);e()}function h(){ULSEWi:;var g=(Math.floor(a/b)+1)*b;a=d(a,g);if(a<c)return true;else{f.Enable();e();return false}}}function u(a){ULSEWi:;a=a.charAt(0).toLowerCase()+a.substr(1);var b=e.tableViewParams.messageOverrides;return b&&b[a]||SP.JsGrid.Res[a]}function i(a){ULSEWi:;if(c.fireEvent)switch(a){case g.Start:c.fireEvent("onbeforeupdate");break;case g.Finish:c.fireEvent("onafterupdate")}}function o(b,c){ULSEWi:;if(b&&r==1)q.Hide();else if(!b){var d=c==null?SP.JsGrid.Res.loadingMsg:c;if(r==0)q.Show(d);else q.UpdateText(d)}r-=b?1:-1;a.ariaMgr!=null&&a.ariaMgr.EnableGrid(b)}};SP.JsGrid.JsGridControl.Parameters=function(){ULSEWi:;this.tableCache=null;this.name=null;this.bNotificationsEnabled=false;this.styleManager=SP.JsGrid.Style.MakeJsGridStyleManager();this.minHeaderHeight=0;this.minRowHeight=0;this.commandMgr=new SP.JsGrid.CommandManager(100);this.enabledRowHeaderAutoStates=(new SP.Utilities.Set).AddArray([SP.JsGrid.RowHeaderAutoStyleId.Error,SP.JsGrid.RowHeaderAutoStyleId.NewRow]);this.bEnableDiffTracking=false;this.isRTL=SP.JsGrid.Utility.GetDocumentDirection()=="rtl";this.tableViewParams=new SP.JsGrid.JsGridControl.TableViewParameters};SP.JsGrid.JsGridControl.TableViewParameters=function(){ULSEWi:;this.keyFieldName=null;this.columns=null;this.gridFieldMap=null;this.messageOverrides=null;this.operationalConstantsFieldKeyMap=null;this.defaultEditMode=SP.JsGrid.EditMode.ReadWriteDefer;this.allowedSelectionTypes=SP.JsGrid.SelectionTypeFlags.MultipleCellRanges|SP.JsGrid.SelectionTypeFlags.MultipleRowRanges|SP.JsGrid.SelectionTypeFlags.MultipleColRanges;this.bMovableColumns=true;this.bResizableColumns=true;this.bHidableColumns=true;this.bSortableColumns=true;this.bAutoFilterableColumns=true;this.bRowHeadersEnabled=true;this.bRecordIndicatorCheckboxesEnabled=false;this.bFillControlEnabled=true;this.checkSelectionCheckboxHiddenRecordKeys=[];this.checkSelectionCheckboxDisabledRecordKeys=[];this.checkSelectionCheckedRecordKeys=[];this.bEditingEnabled=false;this.bNewRowEnabled=false;this.splitterPos=400;this.paneLayout=SP.JsGrid.PaneLayout.GridOnly;this.ganttParams=null;this.pivotedGridParams=null;this.rowViewParams=new SP.JsGrid.JsGridControl.RowViewParameters};SP.JsGrid.JsGridControl.RowViewParameters=function(){ULSEWi:;this.view=null;this.topViewIdx=0;this.hierarchyMode=SP.JsGrid.HierarchyMode.None;this.groupingLevel=null;this.groupingRecordKeyPrefix;this.autoFilterState=null;this.unfilteredHierarchyMgr=null;this.hierarchyDelayLoadKeys=null;this.hierarchyState=null;this.sortState=null;this.filterState=null;this.autoFilterEntries=null;this.filteredDescCounts=null};SP.JsGrid.JsGridControl.PivotedGridParameters=function(){ULSEWi:;this.columns=null};SP.JsGrid.JsGridControl.GanttParameters=function(){ULSEWi:;this.dateRange=null;this.ganttBarStyles=null;this.ganttZoomLevel=3;this.fnRenderGanttRow=null;this.fnGetGanttBarDate=null;this.fnGetGanttBarStyleIds=null;this.fnGetPredecessors=null;this.workDayStart=_spRegionalSettings.workDayStart;this.workDayEnd=_spRegionalSettings.workDayEnd;this.fieldKeyRedrawFilter=null};SP.JsGrid.Internal.EntryRecordManager=function(a){ULSEWi:;var x="NewRowKey",t=this,i=new SP.Utilities.Set,b=[],c={},z=new SP.Utilities.Set,C,h=false,d=false,A=0,e=false,j=null,l=false,f=[];function v(){ULSEWi:;return x+A++}function q(e,d){ULSEWi:;var c=d==null?a.delegateMgr.Apply(SP.JsGrid.DelegateType.CreateEntryRecord):d;if(c.recordKey==null)c.recordKey=v();c.properties[a.jsGridParams.tableViewParams.keyFieldName].dataValue=c.recordKey;b.push(c);i.Add(c.key());c.bIsNewRow=true;a.paneMgr.NotifyCreateEntryRow(b.length-1,e);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordAdded,new SP.JsGrid.EventArgs.OnEntryRecordAdded(c.key()));return c}function p(c){ULSEWi:;var b=a.controller.GetEarliestChangeKeyForRecord(c);return b!=null&&a.controller.IsChangeKeyApplied(b)}function s(e,f){ULSEWi:;a.editUtil.IsNewRowEnabled()&&!f&&a.paneMgr.NotifyRemoveEntryRow(e);var g=b[e],d=g.key();b.splice(e,1);i.Remove(d);delete c[d];a.controller.ClearAllPropChangesForRecord(d);return d}function w(){ULSEWi:;var a=null;if(b.length>1)a=s(b.length-1);return a}function m(c){ULSEWi:;l=true;a.paneMgr.StopEditing(true);a.paneMgr.UnbindEditing(function(){ULSEWi:;while(b.length>0)s(0,c);l=false})}function k(b,c,d){ULSEWi:;var e=q(b,d);a.controller.AttachUndoActionToChangeKey(c,function(){ULSEWi:;var a=w()})}function n(d){ULSEWi:;t.GetLastEntryKey()==d.recordKey&&k(false,d.changeKey);if(d.validationState==SP.JsGrid.ValidationState.Valid){if(c[d.recordKey]==null)c[d.recordKey]=[];c[d.recordKey].push(d);if(d.recordKey==b[0].key()){e=true;if(j!=null){var h=a.errorMgr.ClearRowError(b[0].key(),j);j=null}}}var f=a.paneMgr.GetFocusedItemInfo();(f==null||f.recordKey!=d.recordKey)&&g()}function r(a){ULSEWi:;b.length>0&&a.oldRecordKey==b[0].key()&&g()}function y(c){ULSEWi:;a.commandMgr.Unlock();d=false;e=false;j=a.errorMgr.SetRowError(b[0].key(),c)}function u(e,c,b){ULSEWi:;a.commandMgr.Unlock();d=false;return B(e,c,b)}function B(l,p,o){ULSEWi:;var d=b[0],e=d.key(),q=s(c[e]);delete c[e];i.Remove(e);z.Add(e);if(l!=null&&l!=e){t(e,l);d.recordKey=l;d.properties[a.jsGridParams.tableViewParams.keyFieldName].dataValue=d.recordKey}b.shift();delete d.bIsNewRow;for(var f in p)!(f in q)&&d.AddFieldValue(f,{hasLocalized:true,localized:p[f]});for(var f in o)!(f in q)&&d.AddFieldValue(f,{hasData:true,data:o[f]});var j=a.controller.GetEarliestChangeKeyForRecord(d.key());b.length==0&&k(false,j);var h=a.paneMgr.GetLastRecordKey(),m=null,n=a.jsGridParams.tableViewParams.rowViewParams.unfilteredHierarchyMgr;if(n!=null){var r=n.GetLastNodeKey();if(r!=h){m=h;h=r}}a.controller.InsertRecordAfter(h,d,j,false,true,m,m!=null);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordCommitted,new SP.JsGrid.EventArgs.OnEntryRecordCommitted(e,d.key(),j));a.paneMgr.NotifyChangedRowByKey(d.key());g();return j;function s(c){ULSEWi:;for(var d={},b=0;b<c;b++)if(a.controller.IsChangeKeyApplied(c[b].changeKey))d[c[b].fieldKey]=0;return d}function t(c,b){ULSEWi:;a.paneMgr.ChangeKeys(c,b);a.controller.ChangeKeysInVersionMgr(c,b);SP.JsGrid.AsynchronousCellUpdater.ChangeRecordKeys(c,b);a.rowHeaderStateMgr.ChangeKeys(c,b);a.errorMgr.ChangeKeys(c,b)}}this.TryCommitFirstEntryRecords=function(a){ULSEWi:;a!=null&&f.push(a);g()};function g(){ULSEWi:;var f=false;if(!d&&e&&b.length>0&&b[0].key() in c&&!l)if(p(b[0].key())){f=d=true;a.commandMgr.Lock();setTimeout(function(){ULSEWi:;a.pendingChangeMgr.WaitForPendingUpdates(g)},0)}!f&&!d&&o();function g(){ULSEWi:;if(!a.errorMgr.AnyErrorsInRow(b[0].key()))a.delegateMgr.Apply(SP.JsGrid.DelegateType.TryInsertEntryRecord,b[0],c[b[0].key()],u,y);else{d=false;e=false;a.commandMgr.Unlock();o()}}}function o(){ULSEWi:;if(f.length>0){var a=!t.AnyUncomittedEntryRecords();while(f.length>0)f.shift()(a)}}this.CreateEntryRows=function(c,b,d){ULSEWi:;for(var a=0;a<c;a++)k(!b,d)};this.AnyUncomittedEntryRecords=function(){ULSEWi:;return b.length>1||b.length==1&&p(b[0].key())};this.ClearUncommittedEntryRecords=function(){ULSEWi:;m(false)};this.EnsureLastEntryRowExists=function(){ULSEWi:;if(a.editUtil.IsNewRowEnabled()&&b.length==0){q(false);if(!h){a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,n);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,r);h=true}}};this.NotifyTableViewChangeCompleted=function(){ULSEWi:;e=false;this.EnsureLastEntryRowExists()};this.NotifyTableViewCleared=function(){ULSEWi:;if(b.length>0){m(true);if(h){a.eventMgr.DetachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,n);a.eventMgr.DetachEvent(SP.JsGrid.EventType.OnRowFocusChanged,r);h=false}}};this.GetEntryRecords=function(){ULSEWi:;return b};this.IsEntryRecordKey=function(a){ULSEWi:;return i.Contains(a)};this.GetLastEntryKey=function(){ULSEWi:;return a!=null?b[b.length-1].key():null};this.GetEntryRecordIdx=function(a){ULSEWi:;var c=SP.Internal.JS.FindInArray(b,function(b){ULSEWi:;return a==b.key()});return c};this.GetEntryRecord=function(a){ULSEWi:;return b[this.GetEntryRecordIdx(a)]}};SP.JsGrid.Internal.PaneManager=function(Y,a,P,h,fb,kb,eb){ULSEWi:;var K=SP.Internal.ScrollBar.GetMinScrollBarLength(),zb=K*2+SP.JsGrid.Internal.SplitterWidth+SP.Internal.ScrollBar.GetSystemScrollBarThickness(),yb=SP.Internal.ScrollBar.GetMinScrollBarLength()+SP.Internal.ScrollBar.GetSystemScrollBarThickness(),r,l,q,f,R,b,d=[],k=0,n,s,g,c,i,p,j,u={},t=this,jb=false,H,A,B={height:h.offsetHeight,width:h.offsetWidth},bb=true,x=a.selectionMgr=new SP.JsGrid.Internal.SelectionManager(function(a){ULSEWi:;H.OnFocusedCellChanged!=null?H.OnFocusedCellChanged(a):0}),V=new SP.JsGrid.Internal.ChangeHighlightManager,m=new SP.JsGrid.Internal.EditManager(a,function(b,d,c,a){ULSEWi:;H.OnPropertiesChanged(b,d,c,a)},O),y=a.cutcopypasteMgr=new SP.JsGrid.Internal.CutCopyPasteManager(a,P),mb=new SP.JsGrid.Internal.FillDownManager(a.intDelegateMgr,a.styleMgr),Q=true,e,Bb,z,C,G,v=new SP.JsGrid.SplitterBar(a,K,function(){ULSEWi:;return t.GetSplitterPosition()},N,function(a){ULSEWi:;return t.SetSplitterPosition(a)}),U=false,T=false,F=false,ab=a.focusMgr=new SP.JsGrid.Internal.FocusManager(Y,a,h,P,eb,ib,x,m,O,Z,I);Hb();this.SetEventSinks=function(a){ULSEWi:;H=a};this.Dispose=function(){ULSEWi:;if(g!=null){y.CancelMode();m.StopEditing(true);m.Unbind(function(){ULSEWi:;o(0,d.length,0,0,true);g.each("Dispose");b.Dispose();$removeHandler(h,"mousedown",nb);$removeHandler(window,"focus",hb);$removeHandler(window,"resize",gb);try{typeof SP.UI.Workspace.add_resized=="function"&&SP.UI.Workspace.remove_resized(L)}catch(c){}SP.Internal.DomElement.RemoveMouseWheelHandler(h,lb);if(v!=null){v.Dispose();v=null}a()})}else a();function a(){ULSEWi:;q=loadingBanner=r=l=h=f=null;m.Dispose();ab.Dispose()}};this.ClearView=function(){ULSEWi:;Q=true;a.entryRecordMgr.NotifyTableViewCleared();m.Unbind();x.Clear();y.CancelMode();this.RefreshAllRows(0);g.each("ClearView")};this.NotifyCreateEntryRow=function(f,d){ULSEWi:;if(e!=null){var c=f+e.GetViewRecordCount(),a=e.ViewIdxToRelViewIdx(c);X(1);if(b.GetItemDisplayCapacity()>a)o(0,0,a,1,true);else d&&I(c)}};this.NotifyRemoveEntryRow=function(a){ULSEWi:;e!=null&&this.NotifyDeleteRows(a+e.GetViewRecordCount(),1)};this.GetLastRecordKey=function(){ULSEWi:;return e!=null?e.GetLastRecordKey():null};this.ChangeKeys=function(a,b){ULSEWi:;g.each("ChangeKeys",a,b);if(a in u){u[b]=u[a];delete u[a]}};this.GetVirtualRowCount=function(){ULSEWi:;return c.GetGridPaneConverter().GetVirtualRowCount()};this.GetVisibleRecordCount=function(){ULSEWi:;return Math.min(k-b.GetTopItemIdx(),b.GetItemDisplayCapacity())};this.GetPartialRecordMap=function(d,f){ULSEWi:;var e=c.GetGridPaneConverter(),b;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return b=e.GetRecordsInvolved(d.begin,d.Size(),function(c){ULSEWi:;b=c;a()})},function(){ULSEWi:;f(b)})};this.GetRecordMap=function(d){ULSEWi:;var a=c.GetGridPaneConverter(),b=new SP.Utilities.Range(0,a.GetVirtualRowCount()-1);t.GetPartialRecordMap(b,d)};this.GetGridPaneRowRange=function(){ULSEWi:;return new SP.Utilities.Range(0,c.GetGridPaneConverter().GetVirtualRowCount()-1)};this.GetAllDataJson=function(x,m){ULSEWi:;var e=128;a.jsGridObj.Disable();var n=c.GetGridPaneConverter(),w=new SP.Utilities.Range(0,n.GetVirtualRowCount()-1),v=new SP.Utilities.Range(0,n.GetVirtualColumnCount()-1),j=i!=null?i.GetGridPaneConverter():null,d=i!=null?j.GetRowMultiple():0,u=i!=null?new SP.Utilities.Range(0,j.GetVirtualColumnCount()-1):null;function g(b){ULSEWi:;for(var c=b.GetColumnArray(true),d=[],a=0;a<c.length;++a)d.push(b.GetColumnByKey(c[a].columnKey).name);return d}var b={gridPaneData:null,gridPaneColumns:null,gridPaneStyleData:{cellStyleData:[]},pivotedGridPaneData:null,pivotedGridPaneColumns:null,pivotedGridPaneStyleData:{cellStyleData:[]}},h=[],o=0,p=0,f=[],k=0,l=0,s=c.GetAllColumns(),q=s.GetColumnArray();b.gridPaneColumns=g(s);if(i!=null)b.pivotedGridPaneColumns=g(i.GetAllColumns());function r(g){ULSEWi:;var j=g,n=null;if(g.end-g.begin+1>e){j=new SP.Utilities.Range(g.begin,g.begin+e-1);n=new SP.Utilities.Range(g.begin+e,g.end)}t.GetPartialRecordMap(j,function(g){ULSEWi:;var t=c.GetData(g,j,v);if(m!=null)for(var z in g)for(var E=a.paneMgr.RecordKeyToViewIdx(z),D=g[z],s=0;s<q.length;++s){var C=q[s].columnKey,A=m(D,C);A!=null&&b.gridPaneStyleData.cellStyleData.push({matrixRow:E,matrixColumn:s,styleText:A})}var y=Sys.Serialization.JavaScriptSerializer.serialize(t.matrix);h.push(y.substr(1,y.length-2));o+=t.height;p=t.width;var e=null;if(i!=null){var B=new SP.Utilities.Range(j.begin*d,j.end*d+d-1);e=i.GetData(g,B,u);var w=Sys.Serialization.JavaScriptSerializer.serialize(e.matrix);f.push(w.substr(1,w.length-2));k+=e.height;l=e.width}if(n!=null)setTimeout(function(){ULSEWi:;r(n)},0);else setTimeout(function(){ULSEWi:;var c=["{",'"gridPaneData":{"matrix":',"[",h.join(","),"]",',"height":',o,',"width":',p,"},",'"gridPaneColumns":',Sys.Serialization.JavaScriptSerializer.serialize(b.gridPaneColumns),",",'"gridPaneStyleData":',Sys.Serialization.JavaScriptSerializer.serialize(b.gridPaneStyleData),",",'"pivotedGridPaneData":',i!=null?['{"matrix":',"[",f.join(","),"]",',"height":',k,',"width":',l,"}"].join(""):"null",",",'"pivotedGridPaneColumns":',i!=null?Sys.Serialization.JavaScriptSerializer.serialize(b.pivotedGridPaneColumns):"null",",",'"pivotedGridPaneStyleData":',Sys.Serialization.JavaScriptSerializer.serialize(b.pivotedGridPaneStyleData),",",'"pivotedGridPaneRowMultiple":',d,"}"].join("");a.jsGridObj.Enable();setTimeout(function(){ULSEWi:;x(c)},0)},0)})}r(w)};this.SetView=function(n,Y,S,X,k,T,s,M,E,v,D,w,o,u,W,U,N,K,F){ULSEWi:;B={height:h.offsetHeight,width:h.offsetWidth};Q=false;e=n;Bb=k;z=W;G=S;C=T;A=a.editUtil.IsNewRowEnabled();e.SetPaneMgrObj(t);e.SetScrollBarObj(b);x.SetAllowedSelectionTypes(M);y.CancelMode();if(c==null){wb();sb();vb();var d=new ob(r);c=new SP.JsGrid.Internal.GridPane(r,a,I,z==SP.JsGrid.PaneLayout.GridOnly?pb:null,a.commandMgr,x,V,m,y,mb,d,O,P,Z,R);c.paneSize=d;g=[c];g.each=Fb}else f.style.display="none";if(p!=null&&z!=SP.JsGrid.PaneLayout.GridAndGantt||i!=null&&z!=SP.JsGrid.PaneLayout.GridAndPivotedGrid){tb();i=p=j=null;g.splice(1,1)}if(z!=SP.JsGrid.PaneLayout.GridOnly&&j==null){ub();var d=new ob(l);p=i=null;if(z==SP.JsGrid.PaneLayout.GridAndGantt){SP.JsGrid.Internal.GanttPane==null&&alert("Javascript support for Gantt-drawing is not enabled.");p=j=new SP.JsGrid.Internal.GanttPane(l,a,SP.Internal.DomElement.BrowserIsIE?new SP.JsGrid.Internal.VmlGanttDrawImpl(a.RTL.bEnabled):new SP.JsGrid.Internal.SvgGanttDrawImpl(a.RTL.bEnabled),d)}else i=j=new SP.JsGrid.Internal.PivotedGridPane(l,a,I,null,a.commandMgr,x,V,m,y,mb,d,O,P,Z,R);j.paneSize=d;g.push(j)}if(b==null)b=new SP.JsGrid.Internal.ScrollBar(SP.JsGrid.Internal.ScrollBar.BarType.Vertical,q,true,null,a.styleMgr.scrollBarStyle,a.RTL.bEnabled);e.SetScrollBarObj(b);b.Update({topItemIdx:0,bScrollNotifiy:false});db();J(true);c.SetView(n,k,qb(Y,K),G,s,E,v,D,w,o,u,F);p!=null&&p.SetView(n,k,U);i!=null&&i.SetView(n,k,N.columns,G,s,false,false,false,false,false,false,null);db();g.each("SetEventSinks",H);this.RefreshAllRows(X);if(!jb){b.SetOnScroll(Ab);b.SetOnVisibilityChanged(rb,true);$addHandler(h,"mousedown",nb);$addHandler(window,"focus",hb);$addHandler(window,"resize",gb);try{typeof SP.UI.Workspace.add_resized=="function"&&SP.UI.Workspace.add_resized(L)}catch(bb){}SP.Internal.DomElement.AddMouseWheelHandler(h,lb);jb=true}g.each("OnResize");ab.SetView(z,c,i,G,E,v,D,w,o,u,F);a.entryRecordMgr.NotifyTableViewChangeCompleted();f.style.display=""};this.SetFilterState=function(a){ULSEWi:;c.SetFilterState(a)};this.SetSortState=function(a){ULSEWi:;c.SetSortState(a)};this.ShowColumnConfigurationDialog=function(){ULSEWi:;c.ShowColumnConfigurationDialog()};this.RecordKeyToViewIdx=function(a){ULSEWi:;return u[a]};this.RefreshAllRows=function(a){ULSEWi:;T=true;Cb(e.GetViewRecordCount(),a);o(0,d.length,0,this.GetVisibleRecordCount(),true);T=false};this.NotifyNewRowStateChanged=function(b){ULSEWi:;y.CancelMode();var c=A;A=a.editUtil.IsNewRowEnabled();if(c!=A){a.entryRecordMgr.EnsureLastEntryRowExists();!b&&this.RefreshAllRows()}};this.NotifyChangedRowByKey=function(a){ULSEWi:;a in u&&this.NotifyChangedRows(u[a],1)};this.NotifyChangedRows=function(b,c){ULSEWi:;var a=S(b,c);if(a.clippedCount<1)return;o(a.clippedRelViewIdx,a.clippedCount,a.clippedRelViewIdx,a.clippedCount,false)};this.NotifyUpdateProperty=function(f,i,b,e,c,h){ULSEWi:;if(f!=null)g.each("NotifyUpdateProperty",f,i,b,e,c,h);else for(var a=0;a<d.length;a++){var j=d[a];j!=null&&g.each("NotifyUpdateProperty",j.recordKey,i,b,e,c,h)}};this.NotifyInsertRows=function(c,a,f,e){ULSEWi:;m.Unbind(function(){ULSEWi:;F=true;var h=b.GetTopItemIdx(),k=h+(c<h?a:0);X(a,k);F=false;var g=S(c,a);if(g.clippedCount<1){M();return}var m=g.clippedRelViewIdx,i=g.clippedCount,p=b.GetItemDisplayCapacity(),n=p-d.length,j=Math.max(i-n,0),l=d.length-j;o(l,j,m,i,true);f&&t.UpdateFocusAfterInsertOrDeleteRows(c,a-1,true);e!=null&&e()})};this.NotifyDeleteRows=function(c,a){ULSEWi:;m.Unbind(function(){ULSEWi:;var f=S(c,a);F=true;var l=b.GetTopItemIdx(),e=l+Math.max(Math.min(c-l,0),-a);X(-a,e);var g=Math.max(e-b.GetTopItemIdx(),0);e=b.GetTopItemIdx();F=false;if(f.clippedCount<1){M();return}var n=b.GetItemDisplayCapacity(),p=e+n==k+1&&b.PartialRowPresent(),q=d.length!=n,i=f.clippedRelViewIdx,r=Math.max(Math.min(i+f.clippedCount,d.length)-i,0);o(i,r,0,g,true);var m=Math.max(Math.min(f.clippedCount,k-d.length+g),0),j=Math.min(k-(e+d.length),m);o(0,0,d.length,j,true);var h=m-j-g;if(h>0&&!q&&p)h--;o(0,0,0,h,true);t.UpdateFocusAfterInsertOrDeleteRows(c,a,false)})};this.UpdateFocusAfterInsertOrDeleteRows=function(b,c,a){ULSEWi:;g.each("UpdateFocusAfterInsertOrDeleteRows",b,c,a)};this.ScrollCellIntoView=function(c,a,e){ULSEWi:;var d=this.GetPane(e);c!=null&&b.ScrollIntoView(d.GetGridPaneConverter().RowIdxToViewIdx(c));a!=null&&d.ScrollColumnIntoViewHorizontally(a)};this.IsCellEditable=function(f,c,d){ULSEWi:;var b=this.GetPane(d).GetGridPaneConverter(),e=b.GetColumnByIdx(b.FieldKeyToColIdx(c));return a.editUtil.CanEditField(f,e,c)};this.GetGanttZoomLevel=function(){ULSEWi:;return p?p.GetZoomLevel():null};this.SetGanttZoomLevel=function(a){ULSEWi:;p?p.SetZoomLevel(a):null};this.Focus=function(){ULSEWi:;ab.Focus()};this.StopEditing=function(a){ULSEWi:;m.StopEditing(a)};this.UnbindEditing=function(a){ULSEWi:;m.Unbind(a)};this.NotifyResize=function(){ULSEWi:;L()};this.ScrollGanttToDate=function(a){ULSEWi:;p!=null&&p.SetFocusDate(a)};this.GetTopRowIndex=function(a){ULSEWi:;return this.GetPane(a).BeginRowIdx()};this.GetLeftColumnIndex=function(a){ULSEWi:;return this.GetPane(a).BeginColIdx()};this.ShowColumn=function(a,b){ULSEWi:;c.ShowColumn(a,b)};this.HideColumn=function(a){ULSEWi:;c.HideColumn(a)};this.UpdateColumns=function(a){ULSEWi:;c.UpdateColumns(a)};this.GetColumns=function(a){ULSEWi:;return Db(this.GetPane(a).GetColumns(),[SP.JsGrid.RecordIndicatorCheckboxColumnKey])};this.GetRecordIndicatorCheckBoxColumnIndex=function(){ULSEWi:;var a=this.GetPane();return a&&SP.Internal.JS.FindInArray(a.GetColumns(),function(a){ULSEWi:;return a.columnKey==SP.JsGrid.RecordIndicatorCheckboxColumnKey})};this.ScrollToAndExpandNextError=function(l,i,j){ULSEWi:;var b=i==null?a.errorMgr.GetNextError(l,j):a.errorMgr.GetNextErrorForRecord(l,i,j);if(b!=null){var k=e.RecordKeyToViewIdx(b.recordKey),d;if(k!=null){for(var f=0;f<g.length&&d==null;f++){var c=g[f];if(c.Id==SP.JsGrid.PaneId.MainGrid||c.Id==SP.JsGrid.PaneId.PivotedGrid){d=b.type==SP.JsGrid.Internal.ErrorType.Row?0:c.GetGridPaneConverter().FieldKeyToColIdx(b.fieldKey);if(d==null){var h=c.FieldKeyToColumnKey(b.fieldKey);if(h!=null){c.ShowColumn(h,null);d=c.GetGridPaneConverter().FieldKeyToColIdx(b.fieldKey)}}}}t.ScrollCellIntoView(k,d,c.Id);if(b.type==SP.JsGrid.Internal.ErrorType.Cell&&d!=null){x.SetFocusByKey(c,b.recordKey,b.fieldKey);setTimeout(function(){ULSEWi:;m.ExpandWidget(SP.JsGrid.ErrorWidgetId)},0)}return b.id}}return null};function Db(a,d){ULSEWi:;for(var c=0;c<d.length;c++)for(var b=0;b<a.length;b++)if(a[b].columnKey==d[c]){a.splice(b,1);break}return a}this.ClearAllChangeIndications=function(){ULSEWi:;g.each("NotifyChangeIndicatorsClearing");V.Clear()};this.GetFocusedItemInfo=function(){ULSEWi:;var a=x.GetFocus();return a==null?null:{recordKey:a.recordKey,fieldKey:a.fieldKey,paneId:a.gridPane.Id}};this.JumpToEntryRecord=function(){ULSEWi:;if(A){var b=a.entryRecordMgr.GetLastEntryKey(),d=c.GetColumns()[0].columnKey;c.SelectByKey(b,b,d,d,false);t.ScrollCellIntoView(e.RecordKeyToViewIdx(b),0,c.Id)}};this.GetSplitterPosition=function(){ULSEWi:;return j!=null?C:0};this.SetSplitterPosition=function(a){ULSEWi:;cb(a);J()};this.Select=function(e,f,c,d,b,a){ULSEWi:;this.GetPane(a).Select(e,f,c,d,b)};this.SelectByKey=function(a,b,e,f,d,c){ULSEWi:;this.GetPane(c).SelectByKey(a,b,e,f,d)};this.GetOrderedSelections=function(b,a){ULSEWi:;return x.GetOrderedSelections(this.GetPane(b),a)};this.NotifyCanEditUpdated=function(){ULSEWi:;g.each("NotifyCanEditUpdated")};this.GetGridPane=function(){ULSEWi:;return c};this.GetPane=function(a){ULSEWi:;var b=a==SP.JsGrid.PaneId.MainGrid||a==null?c:a==SP.JsGrid.PaneId.PivotedGrid?i:a==SP.JsGrid.PaneId.Gantt?p:null;return b};function cb(a){ULSEWi:;if(j!=null)C=Math.min(Math.max(a,K),N()-SP.Internal.ScrollBar.GetSystemScrollBarThickness()-(j?K+SP.JsGrid.Internal.SplitterWidth:0))}function lb(a){ULSEWi:;b.Update({topItemIdx:b.GetTopItemIdx()+a.wheelDelta});a.stopPropagation();a.preventDefault()}function N(){ULSEWi:;return Math.max(B.width-2,zb)}function w(){ULSEWi:;return Math.max(B.height-2,yb)}function ob(c){ULSEWi:;var b,a;this.SetValues=function(d,c){ULSEWi:;b=d;a=c};this.GetHeight=function(){ULSEWi:;return w()};this.GetWidth=function(){ULSEWi:;return b};this.GetLeftOffset=function(){ULSEWi:;return a};this.Dispose=function(){ULSEWi:;c=null}}function qb(e,h){ULSEWi:;var f=e;if(h){var d=SP.JsGrid.RecordIndicatorCheckboxColumnKey,g=G[d]=new SP.JsGrid.GridField(d,false,false,null,SP.JsGrid.TextDirection.Default,SP.JsGrid.EditMode.ReadOnly),c=SP.Internal.JS.object(SP.JsGrid.Internal.Property.GetPropType("CheckBoxBoolean"));c.ID="RecordIndicatorCheckBoxBoolean";c.GetDisplayValue=function(b){ULSEWi:;return a.checkSelMgr.IsRecordIndicatorCheckboxChecked(b.key())?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(c,"CheckBoxBoolean");g.SetSingleValuePropType(c);var b=new SP.JsGrid.ColumnInfo("",null,d,SP.JsGrid.Internal.MinColumnWidth);b.isResizable=b.isSortable=b.isHidable=b.isAutoFilterable=b.isAutoFilterable=false;b.fnGetDisplayControlName=function(){ULSEWi:;return a.gridControls[SP.JsGrid.RecordIndicatorControlId].Id};f=new SP.JsGrid.ColumnInfoCollection([b].concat(e.GetColumnArray()))}return f}function Hb(){}function I(a){ULSEWi:;return b.ScrollIntoView(a)}function Cb(d,c){ULSEWi:;k=Q?0:d+(A?a.entryRecordMgr.GetEntryRecords().length:0);b.Update({itemCount:k,topItemIdx:c});return k}function X(c,a){ULSEWi:;k+=c;b.Update({itemCount:k,topItemIdx:a});return k}function S(g,h){ULSEWi:;var d=g,f=g+h-1;d=Math.max(0,Math.min(k-1,d));f=Math.max(0,Math.min(k-1,f));var a=e.ViewIdxToRelViewIdx(d),c=e.ViewIdxToRelViewIdx(f);a=Math.max(a,0);c=Math.min(c,b.GetItemDisplayCapacity()-1);return {clippedRelViewIdx:a,clippedCount:c-a+1}}function wb(){ULSEWi:;h.style.position="relative";h.style.direction=a.RTL.ltr;f=document.createElement("div");f.style.cssText="overflow:hidden;top:"+f.style[a.RTL.left]+"1px;width:"+N()+"px;height:"+w()+"px;border:1px solid "+a.styleMgr.timescaleTierStyle.outerBorderColor+";display:none";h.appendChild(f)}function vb(){ULSEWi:;r=document.createElement("div");r.id=Y+"_leftpane";r.gridItem=true;r.style.cssText="background:"+a.styleMgr.gridPaneStyle.backgroundColor+";overflow:hidden;width:484px;float:"+a.RTL.left;f.appendChild(r);q=document.createElement("div");q.gridItem=true;q.style.cssText="float:"+a.RTL.left+";width:"+SP.Internal.ScrollBar.GetSystemScrollBarThickness()+"px;overflow:hidden;";f.appendChild(q)}function ub(){ULSEWi:;if(!v.IsInited()){var b=v.Init(f,w()+2,-1);b.gridItem=true;f.insertBefore(b,q);b=null}else v.Show();l=document.createElement("div");l.gridItem=true;l.style.cssText="overflow:hidden;float:"+a.RTL.left;l.id=Y+"_rightpane";f.insertBefore(l,q)}function sb(){ULSEWi:;var e,d={},c={},b={},g="position:absolute; visibility:hidden; top:0px; left:0px; width:0px; height:0px;";e=document.createElement("div");e.style.cssText=g;e.style.width=e.style.height="5px";a.parentNode.appendChild(e);d.Top=document.createElement("div");d.Right=document.createElement("div");d.Bottom=document.createElement("div");d.Left=document.createElement("div");for(var f in d){var k=d[f];k.style.cssText=g;a.parentNode.appendChild(k)}c.Top=document.createElement("div");c.Right=document.createElement("div");c.Bottom=document.createElement("div");c.Left=document.createElement("div");for(var f in c){var i=c[f];i.style.cssText=g;i.style["border"+f]=SP.JsGrid.Style.MakeBorderString(1,"solid",a.styleMgr.gridPaneStyle.selectionRectBorderColor);a.parentNode.appendChild(i)}b={Back:{},Fore:{}};b.Back.Top=document.createElement("div");b.Back.Right=document.createElement("div");b.Back.Bottom=document.createElement("div");b.Back.Left=document.createElement("div");b.Fore.Top=document.createElement("div");b.Fore.Right=document.createElement("div");b.Fore.Bottom=document.createElement("div");b.Fore.Left=document.createElement("div");for(var f in b){var l=f=="Back"?SP.JsGrid.Style.MakeBorderString(2,"solid",a.styleMgr.gridPaneStyle.copyRectBackBorderColor):SP.JsGrid.Style.MakeBorderString(2,"dashed",a.styleMgr.gridPaneStyle.copyRectForeBorderColor);for(var j in b[f]){var h=b[f][j];h.style.cssText=g;h.style["border"+j]=l;a.parentNode.appendChild(h)}}R={selDragHandle:e,selFrames:d,focusFrames:c,copyFrames:b}}function D(){ULSEWi:;return bb?SP.Internal.ScrollBar.GetSystemScrollBarThickness():0}function E(){ULSEWi:;return q.style.display!="none"?SP.Internal.ScrollBar.GetSystemScrollBarThickness():0}function J(o){ULSEWi:;cb(C);var e=w();f.style.height=e+"px";for(var k=0;k<f.childNodes.length;k++)if(f.childNodes[k].gridItem)f.childNodes[k].style.height=e+"px";b!=null&&b.Update({physicalViewportSize:e-n-D(),scrollbarSize:e});v.IsInited()&&v.SetHeight(e+2);var h=N();f.style.width=h+"px";if(l!=null){var d=C,i=h-(C+SP.JsGrid.Internal.SplitterWidth+E());r.style.width=d+"px";l.style.width=i+"px";if(a.RTL.bEnabled){j.paneSize.SetValues(i,E());c.paneSize.SetValues(d,h-d)}else{c.paneSize.SetValues(d,0);j.paneSize.SetValues(i,h-E()-i)}}else{var d=h-E();r.style.width=d+"px";c.paneSize.SetValues(d,a.RTL.bEnabled?E():0)}!Q&&!o&&g.each("OnResize");m.NotifyMove()}function tb(){ULSEWi:;v.Hide();SP.Internal.DomElement.GetParentElement(l).removeChild(l);l=null}function hb(){ULSEWi:;y.CheckClipboard()}function gb(){ULSEWi:;L()}function L(){ULSEWi:;f.style.display="none";if(!ib()||h.offsetHeight==B.height&&h.offsetWidth==B.width){f.style.display="";return}B={height:h.offsetHeight,width:h.offsetWidth};f.style.display="";SP.Internal.DomElement.ForceIEZoomFactorRecomputation();var d=b.GetItemDisplayCapacity(),c=b.GetTopItemIdx();U=true;J();var a=w();b.SetViewportSize(a-n-D(),true,a-D());U=false;xb(d,c)}function nb(a){ULSEWi:;if(eb()){SP.Internal.DomElement.StopEvent(a);t.Focus()}}function db(){ULSEWi:;var a=n,d=s;n=fb?fb:0;n=Math.max(n,c.GetMinHeaderHeight());if(j){n=Math.max(n,j.GetMinHeaderHeight());j.SetHeaderHeight(n)}c.SetHeaderHeight(n);s=kb?kb:0;s=Math.max(s,c.GetMinRowHeight());if(j){s=Math.max(s,j.GetMinRowHeight());j.SetRowHeight(s)}c.SetRowHeight(s);(a!=n||d!=s)&&b!=null&&b.Update({physicalViewportSize:w()-n-D(),scrollbarSize:w(),itemSize:s})}function rb(a){ULSEWi:;q.style.display=a?"":"none";J()}function pb(a){ULSEWi:;bb=a;b.Update({bOtherScrollMeets:a,physicalViewportSize:w()-n-D()})}function Ab(b,c){ULSEWi:;var a=b.topIdx-c;if(a!=0&&!U&&!T&&!F)a<0?Gb(b.topIdx,-a):Eb(b.topIdx,a)}function Eb(f,h){ULSEWi:;var a=b.GetItemDisplayCapacity(),d=f+a==k+1&&b.PartialRowPresent(),c=Math.min(h,a),g=c-(d?1:0),e=a-c;o(0,c,e,g,false)}function Gb(i,h){ULSEWi:;var a=b.GetItemDisplayCapacity(),e=d.length!=a,c=Math.min(Math.min(h,k),a),g=c-(e?1:0),f=a-c;o(f,g,0,c,false)}function xb(p,n){ULSEWi:;var i=b.GetItemDisplayCapacity(),a=i-p,m=b.GetTopItemIdx();if(a<0){var j=Math.max(d.length-i,0),l=d.length-j;o(l,j,null,0,false)}else if(a>0){var f=n-m;o(null,0,0,f,false);var c=a-f,g=d.length,h=e.RelViewIdxToViewIdx(g);c=Math.min(h+c,k)-h;o(null,0,g,c,false)}}function o(h,c,a,f,k){ULSEWi:;var j=h!=null&&c>0,b=a!=null&&f>0;if(j||b){var i=b&&f>0?e.GetViewRecords(e.RelViewIdxToViewIdx(a),f,W).records:[];j&&d.splice(h,c);b&&Array.prototype.splice.apply(d,[a,0].concat(i));M();g.each("SpliceRows",h,c,a,i,k);m.NotifyMove()}}function Z(){ULSEWi:;W(b.GetTopItemIdx(),d.length,true)}function W(h,k,i,j){ULSEWi:;if(SP.Internal.JS.FindKey(d,function(a){ULSEWi:;return a==null})===undefined)return;var c=b.GetTopItemIdx(),f={};if(!i||c==j){for(var l=new SP.Utilities.Range(h,h+k-1),a=0;a<d.length;a++)if(d[a]==null&&l.Contains(c+a))f[a]=SP.JsGrid.Internal.LoadErrorState}else{for(var m=e.GetViewRecords(c,d.length,function(a,b,d){ULSEWi:;W(a,b,d,c)}).records,a=0;a<d.length;a++)if(d[a]==null)f[a]=d[a]=m[a];d=[].concat(d);M()}g.each("RenderRows",f)}function M(){ULSEWi:;u={};for(var b=e.GetTopViewIdx(),a=0;a<d.length;a++)if(d[a]!=null)u[d[a].key()]=a+b}function Fb(c){ULSEWi:;for(var d=Array.prototype.slice.call(arguments,1),a=0;a<this.length;++a){var b=this[a][c];b&&b.apply(this[a],d)}}function O(a,b,c){ULSEWi:;var d={data:a.HasDataValue(b)?a.GetDataValue(b):SP.JsGrid.EmptyValue,localized:c.GetDisplayValue!=null?c.GetDisplayValue(a,a.HasDataValue(b)?a.GetDataValue(b):null,a.HasLocalizedValue(b)?a.GetLocalizedValue(b):null):a.HasLocalizedValue(b)?a.GetLocalizedValue(b):SP.JsGrid.EmptyValue};return d}function ib(){ULSEWi:;return h.offsetHeight>0&&h.offsetWidth>0}};SP.JsGrid.Internal.PivotedGridPane=function(c,x,g,e,u,q,j,w,m,r,v,n,s,k,f){ULSEWi:;var a=new SP.JsGrid.Internal.GridPane(c,x,h,e,u,q,j,w,m,r,v,n,s,k,f),b=1;c=null;a.Id=SP.JsGrid.PaneId.PivotedGrid;var t=a.SetView;a.SetView=function(l,j,n,k,d,i,f,h,g,c,e,m){ULSEWi:;t.call(a,l,j,n,k,d,i,f,h,g,c,e,m);b=a.GetGridPaneConverter().GetRowMultiple()};var p=a.SpliceRows;a.SpliceRows=function(h,j,i,e,g){ULSEWi:;for(var d=[],c=0;c<e.length;c++)for(var f=0;f<b;f++)d.push(e[c]);p.call(a,h*b,j*b,i*b,d,g)};var o=a.RenderRows;a.RenderRows=function(f){ULSEWi:;var d={};for(var e in f)for(var g=+e*b,c=0;c<b;c++)d[g+c]=f[e];o.call(a,d)};var d=a.UpdateFocusAfterInsertOrDeleteRows;a.UpdateFocusAfterInsertOrDeleteRows=function(e,f,c){ULSEWi:;d.call(a,e*b,f*b,c)};var i=a.GetMinRowHeight;a.GetMinRowHeight=function(){ULSEWi:;return i.call(a)*b};var l=a.SetRowHeight;a.SetRowHeight=function(c){ULSEWi:;l.call(a,c/b)};function h(b){ULSEWi:;g(a.GetGridPaneConverter().RowIdxToViewIdx(b))}return a};SP.JsGrid.Internal.PositionConverter=function(b,c){ULSEWi:;var d,a,e,f=this;this.SetHierarchyMgrObj=function(b){ULSEWi:;a=b};this.SetScrollBarObj=function(a){ULSEWi:;d=a};this.SetPaneMgrObj=function(a){ULSEWi:;e=a};this.GetTopViewIdx=function(){ULSEWi:;return d.GetTopItemIdx()};this.GetWholeRowDisplayCapacity=function(){ULSEWi:;return d.GetWholeItemDisplayCapacity()};this.RecordIdxToRecordKey=function(a){ULSEWi:;var e;if(c.editUtil.IsNewRowEnabled()&&a>=b.GetRecordCount()){var d=c.entryRecordMgr.GetEntryRecords();if(d.length>0)e=d[Math.min(a-b.GetRecordCount(),d.length-1)].key()}else e=b.RecordIdxToKey(a);return e};this.RecordIdxToViewIdx=function(b){ULSEWi:;return a?a.ConvertRecordIdxToViewIdx(b):b};this.ViewIdxToRecordIdx=function(b){ULSEWi:;return a?a.ConvertViewIdxToRecordIdx(b):b};this.ViewIdxToRelViewIdx=function(a){ULSEWi:;return a-d.GetTopItemIdx()};this.RelViewIdxToViewIdx=function(a){ULSEWi:;return a+d.GetTopItemIdx()};this.IsRecordOnScreen=function(a){ULSEWi:;return e.RecordKeyToViewIdx(a)!=null};this.GetLastRecordKey=function(){ULSEWi:;return b.RecordIdxToKey(b.GetRecordCount()-1)};this.RecordKeyToViewIdx=function(d){ULSEWi:;var f=e.RecordKeyToViewIdx(d);if(f!=null)return f;var a;if(c.entryRecordMgr.IsEntryRecordKey(d))a=c.entryRecordMgr.GetEntryRecordIdx(d)+this.GetViewRecordCount();else a=b.KeyToRecordIdx(d);return a==null?null:this.RecordIdxToViewIdx(a)};this.RecordKeyToRelViewIdx=function(b){ULSEWi:;var a=this.RecordKeyToViewIdx(b);return a!=null?this.ViewIdxToRelViewIdx(a):null};this.RecordKeyToRecordIdx=function(a){ULSEWi:;var c=e.RecordKeyToViewIdx(a);return c!=null?this.ViewIdxToRecordIdx(c):b.KeyToRecordIdx(a)};this.ViewIdxToRecordKey=function(a){ULSEWi:;return this.RecordIdxToRecordKey(this.ViewIdxToRecordIdx(a))};this.GetViewRecordCount=function(){ULSEWi:;return a?a.GetViewRecordCount():b.GetRecordCount()};this.GetViewRecords=function(f,e,j){ULSEWi:;var g=0;if(c.editUtil.IsNewRowEnabled())g=Math.min(Math.max(f+e-this.GetViewRecordCount(),0),e);e-=g;var d=e==0?null:a?a.GetViewRecords(f,e,i):b.GetRecords([{pos:f,count:e}],i);if(d==null)d={recordSetComplete:true,records:[]};else d.records=SP.Internal.JS.Flatten2LevelArray(d.records);if(g>0){var h=Math.max(f-this.GetViewRecordCount(),0);d.records=d.records.concat(c.entryRecordMgr.GetEntryRecords().slice(h,h+g))}return d;function i(b,a){ULSEWi:;j(f,e,a)}}};function AdjustPrintPreviewGridDivWidth(c,d,f,e){ULSEWi:;for(var a=0,b=0;b<c.length;++b)if(c[b].isVisible)a+=c[b].width;a+=d?SP.JsGrid.Internal.RowHeaderWidth:0;a+=f?SP.JsGrid.Internal.SplitterWidth+e:0;a+=2;$get("jsgrid_div_element").style.width=a+"px";return a}SP.JsGrid.PrintPreviewGrid=function(){ULSEWi:;var c,a,i,e,j,m=false,d=false,b=null,f,h;this.Init=function(D,p,B,G,E,s,o,y,w,r,q,F,x,z,A,u,t){ULSEWi:;d=F;b=x;f=z;h=A;i=B;function v(f,b){ULSEWi:;var e=new Array(b.length);for(var d in b){var a=f[b[d]],c=j.MakeRecord(a.data,a.localized,m);c.fieldRawDataMap=a.fieldRawDataMap;c.fieldRawLocMap=a.fieldRawLocMap;e[b[d]]=c}return e}SP.JsGrid.Internal.Property.RegisterDefaultPropTypesFromDefaultDisplayControlMap(s,o);fnInitJsGridParams=g(y,[w]);c=D;a=new SP.JsGrid.JsGridControl.Parameters;a.name=String.format(SP.JsGrid.Res.printPreviewName,c.name);a.tableViewParams=p;for(var C in a.tableViewParams.gridFieldMap){var n=a.tableViewParams.gridFieldMap[C];if(n._propType.ID in o||!n._propType.bMultiValue){if(SP.JsGrid.Internal.Property.PropTypeExists(n._propType.ID))n._propType=SP.JsGrid.Internal.Property.GetPropType(n._propType.ID)}else if(n._propType.bMultiValue)n._propType=new SP.JsGrid.PropertyType.MultiValuePropType(n._propType.singleValuePropType.ID,n._propType.separator,!SP.JsGrid.Internal.Property.PropTypeExists(n._propType.singleValuePropType.ID))}fnInitJsGridParams!=null&&typeof fnInitJsGridParams=="function"&&fnInitJsGridParams(a,c);g(r,[a.tableViewParams,q]);g(u,[a.tableViewParams,c,t]);e=new SP.JsGrid.TableCache(null,v);k(G,p.gridFieldMap,E);a.tableCache=e;l();c.Init(a);$addHandler(window.document.body,"mouseup",function(){ULSEWi:;var e=parseInt($get("jsgrid_div_element").clientWidth),g=AdjustPrintPreviewGridDivWidth(c.GetColumns(),a.tableViewParams.bRowHeadersEnabled,d,f);c.NotifyResize();if(d){var b=c.GetSplitterPosition();c.SetSplitterPosition(b+(g-e))}});setTimeout(function(){ULSEWi:;window.print()},0)};function g(d,e){ULSEWi:;if(d==null)return null;for(var b=d.split("."),c=window,a=0;a<b.length;++a)if(a==b.length-1&&b[a] in c&&typeof c[b[a]]=="function")return c[b[a]].apply(null,e);else if(b[a] in c)c=c[b[a]];else break;return null}function k(a,c,b){ULSEWi:;e.Clear();e.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(a),a);j=new SP.JsGrid.RecordFactory(c,b)}function l(){ULSEWi:;a.styleManager.groupingStyles=i;if(d){a.tableViewParams.splitterPos=parseInt($get("jsgrid_div_element").clientWidth,10)-f-SP.JsGrid.Internal.SplitterWidth;a.tableViewParams.ganttParams.ganttZoomLevel=h;if(b!=null){if(b.fnGetGanttBarDate!=null&&b.fnGetGanttBarDate in window)a.tableViewParams.ganttParams.fnGetGanttBarDate=window[b.fnGetGanttBarDate];if(b.fnGetGanttBarStyleIds!=null&&b.fnGetGanttBarStyleIds in window)a.tableViewParams.ganttParams.fnGetGanttBarStyleIds=window[b.fnGetGanttBarStyleIds];if(b.fnRenderGanttRow!=null&&b.fnRenderGanttRow in window)a.tableViewParams.ganttParams.fnRenderGanttRow=window[b.fnRenderGanttRow];if(b.fnGetPredecessors!=null&&b.fnGetPredecessors in window)a.tableViewParams.ganttParams.fnGetPredecessors=window[b.fnGetPredecessors]}}else{a.tableViewParams.ganttParams=null;a.tableViewParams.paneLayout=SP.JsGrid.PaneLayout.GridOnly}a.tableViewParams.bMovableColumns=true;a.tableViewParams.bResizableColumns=true;a.tableViewParams.bEditingEnabled=false;a.tableViewParams.allowedSelectionTypes=0;a.tableViewParams.bNewRowEnabled=false;a.tableViewParams.bSortableColumns=false;a.tableViewParams.bHidableColumns=false;a.tableViewParams.bAutoFilterableColumns=false;a.tableViewParams.bRecordIndicatorCheckboxesEnabled=false}};SP.JsGrid.CreatePrintPreviewBlobFromRecords=function(f){ULSEWi:;for(var g={},c=0;c<f.length;++c){var a=f[c],e={},d={};for(var b in a.properties){e[b]=a.properties[b].dataValue;if(a.properties[b].HasLocalizedValue())d[b]=a.properties[b].localizedValue}g[a.key()]={data:e,localized:d,fieldRawDataMap:a.fieldRawDataMap,fieldRawLocMap:a.fieldRawLocMap}}return g};SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone=function(e){ULSEWi:;var a=new SP.JsGrid.JsGridControl.TableViewParameters,b=Sys.Serialization.JavaScriptSerializer.deserialize(e);a.messageOverrides=b.simpleFields.messageOverrides;a.operationalConstantsFieldKeyMap=b.simpleFields.operationalConstantsFieldKeyMap;a.defaultEditMode=b.simpleFields.defaultEditMode;a.allowedSelectionTypes=b.simpleFields.allowedSelectionTypes;a.bMovableColumns=b.simpleFields.bMovableColumns;a.bResizableColumns=b.simpleFields.bResizableColumns;a.bHidableColumns=b.simpleFields.bHidableColumns;a.bSortableColumns=b.simpleFields.bSortableColumns;a.bAutoFilterableColumns=b.simpleFields.bAutoFilterableColumns;a.bRowHeadersEnabled=b.simpleFields.bRowHeadersEnabled;a.bRecordIndicatorCheckboxesEnabled=b.simpleFields.bRecordIndicatorCheckboxesEnabled;a.checkSelectionCheckboxHiddenRecordKeys=b.simpleFields.checkSelectionCheckboxHiddenRecordKeys;a.checkSelectionCheckboxDisabledRecordKeys=b.simpleFields.checkSelectionCheckboxDisabledRecordKeys;a.checkSelectionCheckedRecordKeys=b.simpleFields.checkSelectionCheckedRecordKeys;a.bEditingEnabled=b.simpleFields.bEditingEnabled;a.bNewRowEnabled=b.simpleFields.bNewRowEnabled;a.hierarchyKey=b.simpleFields.hierarchyKey;a.splitterPos=b.simpleFields.splitterPos;a.paneLayout=b.simpleFields.paneLayout;a.rowViewParams=b.simpleFields.rowViewParams;var c=Sys.Serialization.JavaScriptSerializer.deserialize(b.gridFieldMap);a.gridFieldMap={};for(var d in c)a.gridFieldMap[d]=SP.JsGrid.GridField.CreateFromSerializedClone(c[d]);a.columns=SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone(b.columns);if(b.pivotedGridParams_columns!=null){a.pivotedGridParams=new SP.JsGrid.JsGridControl.PivotedGridParameters;a.pivotedGridParams.columns=SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone(b.pivotedGridParams_columns)}if(b.ganttParams!=null)a.ganttParams=SP.JsGrid.JsGridControl.GanttParameters.CreateFromSerializedClone(b.ganttParams);if(b.unfilteredHierarchyMgr!=null)a.rowViewParams.unfilteredHierarchyMgr=SP.JsGrid.UnfilteredHierarchyManager.CreateFromSerializedClone(b.unfilteredHierarchyMgr);return a};SP.JsGrid.UnfilteredHierarchyManager.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({unfilteredHierMap:a.rowViewParams.unfilteredHierarchyMgr.GetUnfilteredHierarchyMap(),topNodeKey:a.rowViewParams.unfilteredHierarchyMgr.GetTopNodeKey()})};SP.JsGrid.UnfilteredHierarchyManager.CreateFromSerializedClone=function(c){ULSEWi:;var b=new SP.JsGrid.UnfilteredHierarchyManager([]),a=Sys.Serialization.JavaScriptSerializer.deserialize(c);b.Hydrate(a.unfilteredHierMap,a.topNodeKey);return b};SP.JsGrid.JsGridControl.TableViewParameters.GetSerializedClone=function(a){ULSEWi:;var b={};for(var c in a.gridFieldMap)b[c]=SP.JsGrid.GridField.GetSerializedClone(a.gridFieldMap[c]);return Sys.Serialization.JavaScriptSerializer.serialize({simpleFields:{messageOverrides:a.messageOverrides,operationalConstantsFieldKeyMap:a.operationalConstantsFieldKeyMap,defaultEditMode:a.defaultEditMode,allowedSelectionTypes:a.allowedSelectionTypes,bMovableColumns:a.bMovableColumns,bResizableColumns:a.bResizableColumns,bHidableColumns:a.bHidableColumns,bSortableColumns:a.bSortableColumns,bAutoFilterableColumns:a.bAutoFilterableColumns,bRowHeadersEnabled:a.bRowHeadersEnabled,bRecordIndicatorCheckboxesEnabled:a.bRecordIndicatorCheckboxesEnabled,checkSelectionCheckboxHiddenRecordKeys:a.checkSelectionCheckboxHiddenRecordKeys,checkSelectionCheckboxDisabledRecordKeys:a.checkSelectionCheckboxDisabledRecordKeys,checkSelectionCheckedRecordKeys:a.checkSelectionCheckedRecordKeys,bEditingEnabled:a.bEditingEnabled,bNewRowEnabled:a.bNewRowEnabled,hierarchyKey:a.hierarchyKey,splitterPos:a.splitterPos,paneLayout:a.paneLayout,rowViewParams:a.rowViewParams},gridFieldMap:Sys.Serialization.JavaScriptSerializer.serialize(b),columns:SP.JsGrid.ColumnInfoCollection.GetSerializedClone(a.columns),pivotedGridParams_columns:a.pivotedGridParams==null?null:SP.JsGrid.ColumnInfoCollection.GetSerializedClone(a.pivotedGridParams.columns),ganttParams:a.ganttParams==null?null:SP.JsGrid.JsGridControl.GanttParameters.GetSerializedClone(a.ganttParams),unfilteredHierarchyMgr:a.rowViewParams.unfilteredHierarchyMgr==null?null:SP.JsGrid.UnfilteredHierarchyManager.GetSerializedClone(a)})};SP.JsGrid.JsGridControl.GanttParameters.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({dateRange:a.dateRange,ganttBarStyles:a.ganttBarStyles,ganttZoomLevel:a.ganttZoomLevel})};SP.JsGrid.JsGridControl.GanttParameters.CreateFromSerializedClone=function(c){ULSEWi:;var a=new SP.JsGrid.JsGridControl.GanttParameters,b=Sys.Serialization.JavaScriptSerializer.deserialize(c);a.dateRange=b.dateRange;a.ganttBarStyles=b.ganttBarStyles;a.ganttZoomLevel=b.ganttZoomLevel;return a};SP.JsGrid.GridField.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({key:a.key,hasDataValue:a.hasDataValue,hasLocalizedValue:a.hasLocalizedValue,textDirection:a.textDirection,_defaultCellStyleId:a._defaultCellStyleId,_editMode:a._editMode,_propType:a._propType,_multiValue:a._multiValue})};SP.JsGrid.GridField.CreateFromSerializedClone=function(c){ULSEWi:;var a=new SP.JsGrid.GridField,b=Sys.Serialization.JavaScriptSerializer.deserialize(c);a.key=b.key;a.hasDataValue=b.hasDataValue;a.hasLocalizedValue=b.hasLocalizedValue;a.textDirection=b.textDirection;a._defaultCellStyleId=b._defaultCellStyleId;a._editMode=b._editMode;a._multiValue=b._multiValue;a._propType=b._propType;return a};SP.JsGrid.GetSerializedCloneFromColumnInfo=function(a){ULSEWi:;if(a.ColumnType()=="column")return Sys.Serialization.JavaScriptSerializer.serialize({name:a.name,imgSrc:a.imgSrc,columnKey:a.columnKey,fieldKeys:a.fieldKeys,width:a.width,isVisible:a.isVisible,isHidable:a.isHidable,isResizable:a.isResizable,isSortable:a.isSortable,isAutoFilterable:a.isAutoFilterable,pivoted:false});else if(a.ColumnType()=="pivotedColumn")return Sys.Serialization.JavaScriptSerializer.serialize({name:a.name,imgSrc:a.imgSrc,columnKey:a.columnKey,fieldKeys:a.fieldKeys,width:a.width,pivoted:true})};SP.JsGrid.CreateColumnInfoFromSerializedClone=function(c){ULSEWi:;var a=Sys.Serialization.JavaScriptSerializer.deserialize(c),b;if(a.pivoted)b=new SP.JsGrid.PivotedColumnInfo(a.name,a.imgSrc,a.columnKey,a.fieldKeys,a.width);else{b=new SP.JsGrid.ColumnInfo(a.name,a.imgSrc,a.columnKey,a.width);b.isVisible=a.isVisible;b.isHidable=a.isHidable;b.isResizable=a.isResizable;b.isSortable=a.isSortable;b.isAutoFilterable=a.isAutoFilterable}return b};SP.JsGrid.ColumnInfoCollection.GetSerializedClone=function(d){ULSEWi:;for(var c=[],b=d.GetColumnArray(),a=0;a<b.length;++a)c.push(SP.JsGrid.GetSerializedCloneFromColumnInfo(b[a]));return Sys.Serialization.JavaScriptSerializer.serialize(c)};SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone=function(d){ULSEWi:;for(var b=[],c=Sys.Serialization.JavaScriptSerializer.deserialize(d),a=0;a<c.length;++a)b.push(SP.JsGrid.CreateColumnInfoFromSerializedClone(c[a]));return new SP.JsGrid.ColumnInfoCollection(b)};SP.JsGrid.FinishLaunchPrintPreview=function(records,jsGridParams,additionalScriptFiles,beforeInitFnName,beforeInitFnArgsObj,initTableViewParamsFnName,initTableViewParamsFnArgsObj,title,bEnableGantt,optGanttDelegateNames,ganttPaneWidth,ganttZoomLevel,initGanttStylesFnName,initGanttStylesFnArgsObj){ULSEWi:;var newWin,cssLinkScripts=[],AJAXScripts=[],scripts=[],requiredScriptFiles=["scriptresx.ashx","jsgrid.js","sp.datetimeutil.js","jsgrid.gantt.js","init.js"],requiredAJAXFiles=["scriptresource.axd","webresource.axd"],requiredCssFiles=["jsgrid.css","corev4.css","cui.css"];function MatchNodeWithSourceFiles(node,requiredFilesArray,htmlElementArray,attrib){ULSEWi:;var nodeStr=(eval("node."+attrib)).toLowerCase();if(requiredFilesArray!=null)for(var idx=0;idx<requiredFilesArray.length;++idx){var fileName=requiredFilesArray[idx].toLowerCase();if(nodeStr.indexOf(fileName)!=-1||fileName.indexOf(".js")==fileName.length-3&&nodeStr.indexOf(fileName.substr(0,fileName.length-3)+".debug.js")!=-1){htmlElementArray.push(SP.Internal.DomElement.GetOuterHTML(node));return true}}}function CopyRequiredDOMElements(a){ULSEWi:;for(var b=0;b<a.childNodes.length;++b){var c=a.childNodes[b];c.nodeType==1&&CopyRequiredDOMElements(c)}if(a.nodeName=="LINK"){if(MatchNodeWithSourceFiles(a,requiredCssFiles,cssLinkScripts,"href"))return}else if(a.nodeName=="SCRIPT"){if(MatchNodeWithSourceFiles(a,requiredScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(a,additionalScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(a,requiredAJAXFiles,AJAXScripts,"src"))return}}function RenderHTMLElementArray(b){ULSEWi:;for(var a=0;a<b.length;++a)newWin.document.writeln(b[a])}function RenderPrintPreviewDocument(){ULSEWi:;newWin.document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"');newWin.document.writeln('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">');newWin.document.writeln("<html>");newWin.document.writeln("<head>");newWin.document.writeln("<title>"+title+"</title>");RenderHTMLElementArray(cssLinkScripts);RenderHTMLElementArray(AJAXScripts);newWin.document.writeln("</head>");newWin.document.writeln("<body>");newWin.document.writeln('<div id="jsgrid_outer_div_element" style="width:100%; height:100%; overflow-y:auto">');newWin.document.writeln('<div id="jsgrid_div_element" style="width:100%; height:570px" display="block"/>');newWin.document.writeln("</div>");newWin.document.writeln(String.format(["<script>","var _spRegionalSettings={0}","</script>"].join("\n"),Sys.Serialization.JavaScriptSerializer.serialize(_spRegionalSettings)));RenderHTMLElementArray(scripts);newWin.document.writeln(String.format(["<script>","Sys.Application.initialize();","var printPreviewGrid=new SP.JsGrid.PrintPreviewGrid();","Sys.Application.add_init(function()","{{",'    var jsGridDiv=$get("jsgrid_div_element");','    jsGridDiv.style.backgroundColor="white";','    var defaultDisplayControlMap=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{0}"));','    var lookupPropTypeMap=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{8}"));','    var tableViewParams=new SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone(unescape("{1}"));','    var dataBlob=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{2}"));',"    var recordCount={3};",'    jsGridDiv.style.height=(recordCount * 21+50)+"px";',"    AdjustPrintPreviewGridDivWidth(tableViewParams.columns.GetColumnArray(), tableViewParams.bRowHeadersEnabled, {9}, {11});",'    var keyColumnName=unescape("{4}");',"    printPreviewGrid.Init(","        new SP.JsGrid.JsGridControl(jsGridDiv, false),","        tableViewParams,",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{7}")),',"        dataBlob,","        keyColumnName,","        defaultDisplayControlMap,","        lookupPropTypeMap,","        {5},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{6}")),',"        {13},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{14}")),',"        {9},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{10}")),',"        {11},","        {12},","        {16},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{17}"))',"    );","}});",'Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse(unescape("{15}"));',"</script>","</body>","</html>"].join("\n"),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.Internal.Property.GetDefaultDisplayControlMap())),escape(SP.JsGrid.JsGridControl.TableViewParameters.GetSerializedClone(jsGridParams.tableViewParams)),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.CreatePrintPreviewBlobFromRecords(records))),records.length,escape(jsGridParams.tableViewParams.keyFieldName),beforeInitFnName?['"',beforeInitFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(beforeInitFnArgsObj)),escape(Sys.Serialization.JavaScriptSerializer.serialize(jsGridParams.styleManager.groupingStyles)),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.Internal.Property.GetLookupPropTypeMap())),bEnableGantt?"true":"false",escape(Sys.Serialization.JavaScriptSerializer.serialize(optGanttDelegateNames)),ganttPaneWidth,ganttZoomLevel,initTableViewParamsFnName?['"',initTableViewParamsFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(initTableViewParamsFnArgsObj)),escape(Sys.Serialization.JavaScriptSerializer.serialize(Sys.CultureInfo.CurrentCulture)),initGanttStylesFnName?['"',initGanttStylesFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(initGanttStylesFnArgsObj))))}CopyRequiredDOMElements(document);newWin=window.open();newWin.document.clear();newWin.document.open("text/html");RenderPrintPreviewDocument();newWin.document.close()};Type.registerNamespace("SP.JsGrid.PropertyType");SP.JsGrid.PropertyType.String=function(){ULSEWi:;this.ID="String";this.BeginValidateNormalizeConvert=function(d,e,a,c,b){ULSEWi:;a=a!=null&&a.length==0?null:a;b({isValid:true,dataValue:a,normalizedLocValue:a})}};SP.JsGrid.PropertyType.LookupTable=function(a,e,c){ULSEWi:;function b(b){ULSEWi:;if(b==null)return null;return SP.Internal.JS.Find(a,function(a){ULSEWi:;return a.value==b})}function d(b){ULSEWi:;if(b==null)return null;var c=b.toLowerCase();return SP.Internal.JS.Find(a,function(a){ULSEWi:;return a.localString.toLowerCase()==c})}return {ID:e,BeginValidateNormalizeConvert:function(h,i,e,f,g){ULSEWi:;r={};var a=f?d(e):b(e);r.isValid=a!=null||!c;if(a!=null){r.normalizedLocValue=a.localString;r.dataValue=a.value}else r.normalizedLocValue=r.dataValue=e;g(r)},GetItems:function(d){ULSEWi:;for(var c=[],b=0;b<a.length;b++)c.push(SP.JsGrid.Property.MakeProperty(a[b].value,a[b].localString,true,true,this));d(c)},DataToLocalized:function(c){ULSEWi:;var a=b(c);return a?a.localString:SP.JsGrid.EmptyValue},LocalizedToData:function(b){ULSEWi:;var a=d(b);return a?a.value:SP.JsGrid.EmptyValue},GetImageSource:function(d,c){ULSEWi:;var a=b(c);return a!=null?a.imageUrl:null},GetStyleId:function(c){ULSEWi:;var a=b(c);return a!=null?a.styleId:null},GetIsLimitedToList:function(){ULSEWi:;return c},GetSerializableLookupPropType:function(){ULSEWi:;return {items:a,id:e,bLimitToList:c}}}};SP.JsGrid.PropertyType.CheckBoxBoolean=function(){ULSEWi:;this.ID="CheckBoxBoolean";this.BeginValidateNormalizeConvert=function(d,e,a,b,c){ULSEWi:;a=b?a!=""&&a!=SP.JsGrid.Res.checkboxUnchecked:!!a;c({isValid:true,dataValue:a,normalizedLocValue:this.DataToLocalized(a)})};this.DataToLocalized=function(a){ULSEWi:;return a?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};this.GetBool=function(a){ULSEWi:;return a==SP.JsGrid.EmptyValue?false:!!a}};SP.JsGrid.PropertyType.MultiValuePropType=function(d,c,g,h){ULSEWi:;var a=null;function f(){ULSEWi:;a=SP.JsGrid.Internal.Property.GetPropType(d);b.singleValuePropType=a;b.GetImageSource=a.GetImageSource&&function(c,b){ULSEWi:;return e(b,function(b){ULSEWi:;return a.GetImageSource(c,b)})};b.GetItems=a.GetItems;b.GetUpdateTrackingMode=a.GetUpdateTrackingMode;b.GetUpdateSerializeMode=a.GetUpdateSerializeMode;b.DataToLocalized=a.DataToLocalized&&function(c){ULSEWi:;return b.LocStrArrayToLocStr(e(c,function(b){ULSEWi:;return a.DataToLocalized(b)}))};b.LocalizedToData=a.LocalizedToData&&function(c){ULSEWi:;return e(b.LocStrToLocStrArray(c),function(b){ULSEWi:;return a.LocalizedToData(b)})};b.GetDisplayValue=a.GetDisplayValue&&function(h,d,g){ULSEWi:;var f=[];if(d!=null&&d!=SP.JsGrid.EmptyValue&&d!=SP.JsGrid.InvalidValue)for(var i=b.LocStrToLocStrArray(g),e=0;e<d.length;e++)f.push(a.GetDisplayValue(h,d[e],e>=i.length?null:i[e]));else f.push(a.GetDisplayValue(h,d,g));return SP.Internal.JS.JoinStrings(f,c+" ")}}this.ID=d+"_MultiValue";this.bMultiValue=true;this.separator=c;this.singleValuePropType=a;var b=this;!g&&f();this.GetSerializableMultiValuePropType=function(){ULSEWi:;return {singleValuePropTypeID:d,separatorChar:c,bDelayInit:g}};this.InitSingleValuePropType=function(){ULSEWi:;f()};this.BeginValidateNormalizeConvert=function(m,n,d,e,g,o){ULSEWi:;if(e&&d==""||!e&&(d==null||d.length==0)){g({isValid:true,dataValue:[],normalizedLocValue:""});return}if(e)d=this.LocStrToLocStrArray(d);var c,f=0;i();return;function i(){ULSEWi:;a.BeginValidateNormalizeConvert(m,n,d[f],e,l,o)}function l(a){ULSEWi:;k(a);f++;if(f<d.length)i();else g(j())}function k(a){ULSEWi:;if(f==0)c={isValid:a.isValid,dataValue:[a.dataValue],normalizedLocValue:[a.normalizedLocValue]};else{c.isValid=c.isValid&&a.isValid;c.dataValue.push(a.dataValue);c.normalizedLocValue.push(a.normalizedLocValue)}}function j(){ULSEWi:;if(c!=null)if(c.isValid){if(!h)for(var g=a.IsDataEqual,d=c.dataValue,f=0;f<d.length;f++)for(var e=0;e<d.length;e++){if(f==e)continue;(g==null?d[f]==d[e]:g(d[f],d[e]))&&d.splice(e,1)}c.normalizedLocValue=b.LocStrArrayToLocStr(c.normalizedLocValue);return c}else return {isValid:false};return {isValid:true,dataValue:null,normalizedLocValue:null}}};this.LocStrToLocStrArray=function(a){ULSEWi:;if(a&&a.constructor!=String)return [];return SP.Internal.JS.TokenizeString(a,c)};this.LocStrArrayToLocStr=function(a){ULSEWi:;return SP.Internal.JS.JoinStrings(a,c+" ")};function e(a,d){ULSEWi:;if(a==null)return null;for(var c=[],b=0;b<a.length;b++)c.push(d(a[b]));return c}};SP.JsGrid.PropertyType.Hyperlink=function(){ULSEWi:;this.ID="Hyperlink";this.bHyperlink=true;var b='"',a='", "',c=encodeURIComponent(a);this.BeginValidateNormalizeConvert=function(f,g,a,c,e){ULSEWi:;var b=c?d(a):a;e({isValid:b!=null,dataValue:b,normalizedLocValue:this.DataToLocalized(a)})};this.DataToLocalized=function(a){ULSEWi:;return a?a.display:""};this.GetAddress=function(a){ULSEWi:;return a?a.address:""};this.GetCopyValue=function(c,a){ULSEWi:;return e(a)};function e(d){ULSEWi:;var e=d.address.replace(a,c);return d?String.format("{0}{1}{2}{3}{0}",b,e,a,d.display):null}function d(d){ULSEWi:;if(d==null)return null;if(d.length==0)d="";var e=d.indexOf(a);if(e<0||!d.startsWith(b)||!d.endsWith(b))return {address:d,display:d};return {address:d.substring(1,e).replace(c,a),display:d.substring(e+a.length,d.length-1)}}};SP.JsGrid.PropertyType.RegisterNewLookupPropType=function(d,c,a,b){ULSEWi:;var e=new SP.JsGrid.PropertyType.LookupTable(c,d,b);SP.JsGrid.Internal.Property.RegisterPropType(e,a,SP.JsGrid.EditControl.Type.ComboBox,[])};SP.JsGrid.PropertyType.RegisterNewCustomPropType=function(d,b,c,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterPropType(d,b,c,a)};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterDerivedPropType(b,a)};Type.registerNamespace("SP.JsGrid.PropertyType.Utils");SP.JsGrid.PropertyType.Utils.RegisterDisplayControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterDisplayControl(c,b,a)};SP.JsGrid.PropertyType.Utils.RegisterEditControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterEditControl(c,b,a)};SP.JsGrid.PropertyType.Utils.RegisterWidgetControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterWidgetControl(c,b,a)};SP.JsGrid.PropertyType.Utils.UpdateDisplayControlForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateDisplayControlForPropType(b,a)};SP.JsGrid.PropertyType.Utils.UpdateEditControlForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateEditControlForPropType(b,a)};SP.JsGrid.PropertyType.Utils.UpdateWidgetControlsForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateWidgetControlsForPropType(b,a)};SP.JsGrid.PropertyType.Utils.GetPropType=function(a){ULSEWi:;return SP.JsGrid.Internal.Property.GetPropType(a)};SP.JsGrid.Internal.Property=function(){ULSEWi:;var e=this,d=[[new SP.JsGrid.PropertyType.String,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[]],[new SP.JsGrid.PropertyType.CheckBoxBoolean,SP.JsGrid.DisplayControl.Type.Checkbox,SP.JsGrid.EditControl.Type.Checkbox,[]],[new SP.JsGrid.PropertyType.Hyperlink,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[SP.JsGrid.WidgetControl.Type.Hyperlink]]],b=SP.Internal.JS.ConvertTableToMap(d,"0","1"),i=[[SP.JsGrid.DisplayControl.Type.Image,SP.JsGrid.DisplayControl.ImageDisplayControl,["GetImageSource"]],[SP.JsGrid.DisplayControl.Type.ImageText,SP.JsGrid.DisplayControl.ImageTextDisplayControl,["GetImageSource"]],[SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.DisplayControl.TextDisplayControl,[]],[SP.JsGrid.DisplayControl.Type.Checkbox,SP.JsGrid.DisplayControl.CheckboxDisplayControl,["GetBool"]]],f=SP.Internal.JS.ConvertTableToMap(i,"0","1"),o=SP.Internal.JS.ConvertTableToMap(i,"0","2"),l=[[SP.JsGrid.EditControl.Type.EditBox,function(a,b){ULSEWi:;return new SP.JsGrid.EditControl.EditBoxEditControl(a,b)},[]],[SP.JsGrid.EditControl.Type.ComboBox,function(a){ULSEWi:;return new SP.JsGrid.EditControl.ComboBoxEditControl(a)},["GetItems"]],[SP.JsGrid.EditControl.Type.Checkbox,function(a){ULSEWi:;return new SP.JsGrid.EditControl.CheckboxEditControl(a)},["GetBool"]]],j=SP.Internal.JS.ConvertTableToMap(l,"0","1"),r=SP.Internal.JS.ConvertTableToMap(l,"0","2"),k=[[SP.JsGrid.WidgetControl.Type.Date,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.DateWidget(a)},[]],[SP.JsGrid.WidgetControl.Type.AddressBook,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.AddressBookWidget(a)},["GetPeoplePickerUrl"]],[SP.JsGrid.WidgetControl.Type.Hyperlink,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.HyperlinkWidget(a)},["GetAddress"]],[SP.JsGrid.ErrorWidgetId,function(a,b){ULSEWi:;return new SP.JsGrid.WidgetControl.ErrorWidget(a,b)},[]]],h=SP.Internal.JS.ConvertTableToMap(k,"0","1"),p=SP.Internal.JS.ConvertTableToMap(k,"0","2"),a={},c={};this.GetDefaultDisplayControlMap=function(){ULSEWi:;var c={};for(var b in a)c[b]=a[b].display.Id;return c};this.RegisterDefaultPropTypesFromDefaultDisplayControlMap=function(d,b){ULSEWi:;if(b==null)b={};for(var c in d)a[c]==undefined&&m(c,this.GetDisplayControl(d[c]),b)};this.GetLookupPropTypeMap=function(){ULSEWi:;var c={};for(var a in b)if(b[a].GetSerializableLookupPropType!=null)c[a]=b[a].GetSerializableLookupPropType();else if(b[a].bMultiValue&&b[a].singleValuePropType.GetSerializableLookupPropType!=null)c[a]=b[a].GetSerializableMultiValuePropType();return c};this.RegisterDisplayControl=function(a,d,b){ULSEWi:;f[a]=d;o[a]=b;c={}};this.RegisterEditControl=function(a,d,b){ULSEWi:;j[a]=d;r[a]=b;c={}};this.RegisterWidgetControl=function(a,d,b){ULSEWi:;h[a]=d;p[a]=b;c={}};this.GetPropType=function(a){ULSEWi:;return b[a]};this.PropTypeExists=function(a){ULSEWi:;return a in b};this.GetDisplayControl=function(a){ULSEWi:;return f[a]};this.GetEditControl=function(c,a){ULSEWi:;var b=j[c];return b.apply(null,a)};this.GetWidgetControl=function(c,a){ULSEWi:;var b=h[c];return b.apply(null,a)};this.GetUpdateTrackingMode=function(b,a){ULSEWi:;if(b.GetUpdateTrackingMode!=null)return b.GetUpdateTrackingMode();return a.hasDataValue?a.hasLocalizedValue?SP.JsGrid.UpdateTrackingMode.PropBoth:SP.JsGrid.UpdateTrackingMode.PropData:SP.JsGrid.UpdateTrackingMode.PropLocalized};this.GetUpdateSerializeMode=function(a,c){ULSEWi:;if(a&&a.GetUpdateSerializeMode!=null)return a.GetUpdateSerializeMode();var b=a!=null&&c!=null?this.GetUpdateTrackingMode(a,c):SP.JsGrid.UpdateSerializeMode.PropBoth;if(b==SP.JsGrid.UpdateSerializeMode.PropBoth)b=SP.JsGrid.UpdateSerializeMode.PropLocalizedOnly;return b};function m(e,g,f){ULSEWi:;if(e in f){var d=f[e];if(d.singleValuePropTypeID!=null)b[e]=new SP.JsGrid.PropertyType.MultiValuePropType(d.singleValuePropTypeID,d.separatorChar,d.bDelayInit);else b[e]=new SP.JsGrid.PropertyType.LookupTable(d.items,d.id,d.bLimitToList)}delete c[e];a[e]={display:g,editControlName:"",widgetControlNames:[]}}this.RegisterPropType=function(d,b,c,a){ULSEWi:;a=a==null?[]:a;g(d,this.GetDisplayControl(b),c,a)};this.RegisterDerivedPropType=function(d,c){ULSEWi:;var b=a[c];g(d,b.display,b.editControlName,b.widgetControlNames)};function g(d,g,f,e){ULSEWi:;b[d.ID]=d;delete c[d.ID];var h=a[d.ID]={display:g,editControlName:f,widgetControlNames:e}}this.UpdateDisplayControlForPropType=function(c,b){ULSEWi:;a[c].display=this.GetDisplayControl(b)};this.UpdateEditControlForPropType=function(c,b){ULSEWi:;a[c].editControlName=b};this.UpdateWidgetControlsForPropType=function(c,b){ULSEWi:;a[c].widgetControlNames=b};this.GetDisplayControlForProperty=function(c,b){ULSEWi:;if(b!=null)return this.GetDisplayControl(b);return a[c.ID].display};this.GetEditAndWidgetControlNamesForProperty=function(g,b,e,f){ULSEWi:;var d,c,i;if(b.fnGetEditControlName!=null&&(i=b.fnGetEditControlName(g,e))!=null)d=i;else d=a[f.ID].editControlName;var h;if(b.fnGetWidgetControlNames!=null&&(h=b.fnGetWidgetControlNames(g,e))!=null)c=h;else c=[].concat(a[f.ID].widgetControlNames);return {editControlName:d,widgetControlNames:c}};function t(){ULSEWi:;for(var b in d){var a=d[b];e.RegisterPropType(a[0],a[1],a[2],a[3])}n();q()}function s(b,a){ULSEWi:;this.ID=b;this.BeginValidateNormalizeConvert=function(g,h,c,e,f){ULSEWi:;var d={},b=e?Date.parseLocale(c)||Date.parseInvariant(c)||Date.parse(c):c.getTime!=null?c:new Date(+c);b=b!=null?new Date(b):null;d.isValid=b!=null&&!isNaN(b.getTime());d.dataValue=d.isValid?b:null;d.normalizedLocValue=d.isValid?b.localeFormat(a):null;f(d)}}function q(){ULSEWi:;e.RegisterPropType(new s("JSDateTime",Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortDatePattern),SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[SP.JsGrid.WidgetControl.Type.Date])}function n(){ULSEWi:;var c={BeginValidateNormalizeConvert:function(i,j,a,e,g){ULSEWi:;var c=this;function f(a){ULSEWi:;a=c.PreParse!=null?c.PreParse(a):a;var b=Number.parseLocale(a);return c.PostParse!=null?c.PostParse(b):b}function h(){ULSEWi:;return a.format!=null?a:Number.parseInvariant(a+"")}var b=e?f(a):h(a),d=b.localeFormat(this.FormatString);g({isValid:!isNaN(b),dataValue:this.ProcessData!=null?ProcessData(b):b,normalizedLocValue:this.ProcessLocalized!=null?this.ProcessLocalized(b,d):d})},CompareTo:function(a,b){ULSEWi:;return a-b}},b=[{ID:"JSNumber",FormatString:"D"}];for(var d in b){var a=SP.Internal.JS.object(b[d]);a.BeginValidateNormalizeConvert=c.BeginValidateNormalizeConvert;a.CompareTo=c.CompareTo;e.RegisterPropType(a,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[])}}t()};SP.JsGrid.RecordFactory=function(a,d,b){ULSEWi:;this.gridFieldMap=a;this.MakeRecord=function(e,h,k){ULSEWi:;var g=new c;g.recordKey=e[d];for(var f in a){var i=a[f],j=SP.JsGrid.Property.MakePropertyFromGridField(i,e[f],h[f],b!=null&&!i.GetIsMultiValue()?b(g.recordKey,i.key,e):null);if(j!=null){g.properties[f]=j;if(!k){delete e[f];delete h[f]}}}g.fieldRawDataMap=e!=null?e:{};g.fieldRawLocMap=h!=null?h:{};return g};var c=function(){ULSEWi:;this.properties={}};c.prototype={key:function(){ULSEWi:;return this.recordKey},GetDataValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].GetData():this.fieldRawDataMap[a]},GetLocalizedValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].GetLocalized():this.fieldRawLocMap[a]},HasDataValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].HasDataValue():a in this.fieldRawDataMap},HasLocalizedValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].HasLocalizedValue():a in this.fieldRawLocMap},GetProp:function(a){ULSEWi:;return this.properties[a]},SetProp:function(a,b){ULSEWi:;this.properties[a]=b},AddFieldValue:function(b,a){ULSEWi:;if(a.isProp)this.properties[b]=a.prop;else if(b in this.properties)this.properties[b].Update(a.hasData?a.data:SP.JsGrid.EmptyValue,a.hasLocalized?a.localized:SP.JsGrid.EmptyValue);else{if(a.hasLocalized)this.fieldRawLocMap[b]=a.localized;if(a.hasData)this.fieldRawDataMap[b]=a.data}},RemoveFieldValue:function(a){ULSEWi:;delete this.properties[a];delete this.fieldRawLocMap[a];delete this.fieldRawDataMap[a]}}};SP.JsGrid.Property=function(){ULSEWi:;PropertyBase=function(b,a,c){ULSEWi:;if(c!=null)this.propType=c;if(b!=null)this.dataValue=b;if(a!=null)this.localizedValue=a};LocalizedProperty=function(b,a){ULSEWi:;this.localizedValue=b;if(a!=null)this.propType=a};DataProperty=function(b,a){ULSEWi:;this.dataValue=b;if(a!=null)this.propType=a};PropertyBase.prototype={HasLocalizedValue:function(){ULSEWi:;return true},HasDataValue:function(){ULSEWi:;return true},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,true,true,this.propType)},Update:function(a,b){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.dataValue=a!=SP.JsGrid.InvalidValue?SP.Internal.JS.CloneObj(a):a;if(b!=SP.JsGrid.EmptyValue)this.localizedValue=b},GetLocalized:function(){ULSEWi:;return this.localizedValue},GetData:function(){ULSEWi:;return this.dataValue}};DataProperty.prototype={HasLocalizedValue:function(){ULSEWi:;return this.propType.DataToLocalized!=null},HasDataValue:function(){ULSEWi:;return true},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,true,false,this.propType)},Update:function(a){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.dataValue=a!=SP.JsGrid.InvalidValue?SP.Internal.JS.CloneObj(a):a},GetLocalized:function(){ULSEWi:;return this.dataValue!=SP.JsGrid.InvalidValue?this.propType.DataToLocalized(this.dataValue):""},GetData:function(){ULSEWi:;return this.dataValue}};LocalizedProperty.prototype={HasLocalizedValue:function(){ULSEWi:;return true},HasDataValue:function(){ULSEWi:;return this.propType.LocalizedToData!=null},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,false,true,this.propType)},Update:function(b,a){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.localizedValue=a},GetLocalized:function(){ULSEWi:;return this.localizedValue},GetData:function(){ULSEWi:;return this.localizedValue!=SP.JsGrid.InvalidValue?this.propType.LocalizedToData(this.localizedValue):null}};return {MakeProperty:function(d,b,c,e,a){ULSEWi:;if(c&&e)return new PropertyBase(d,b,a);if(c)return new DataProperty(d,a);return new LocalizedProperty(b,a)},MakePropertyFromGridField:function(a,f,e,b){ULSEWi:;var d=null,c=b!=null?b:a.GetPropType();if(c!=null)d=SP.JsGrid.Property.MakeProperty(f,e,a.hasDataValue,a.hasLocalizedValue,c);return d}}}();SP.JsGrid.Internal.PropertyUpdate=function(b,a){ULSEWi:;this.data=b;this.localized=a};SP.JsGrid.Internal.PropertyUpdate.prototype={HasDataValue:function(){ULSEWi:;return this.data!=SP.JsGrid.EmptyValue},HasLocalizedValue:function(){ULSEWi:;return this.localized!=SP.JsGrid.EmptyValue}};SP.JsGrid.CreateUnvalidatedPropertyUpdate=function(b,c,d,a){ULSEWi:;return new SP.JsGrid.UnvalidatedPropertyUpdate(b,c,d,a)};SP.JsGrid.CreateValidatedPropertyUpdate=function(c,d,b,a){ULSEWi:;return new SP.JsGrid.ValidatedPropertyUpdate(c,d,b,a)};SP.JsGrid.UnvalidatedPropertyUpdate=function(b,c,d,a){ULSEWi:;this.recordKey=b;this.fieldKey=c;this.newValue=d;this.newValueIsLocalized=a};SP.JsGrid.UnvalidatedPropertyUpdate.prototype={validated:false};SP.JsGrid.ValidatedPropertyUpdate=function(c,d,b,a){ULSEWi:;this.recordKey=c;this.fieldKey=d;this.newDataValue=b;this.newLocalizedValue=a};SP.JsGrid.ValidatedPropertyUpdate.prototype={validated:true};SP.JsGrid.Internal.PropertyUpdateManager=function(a){ULSEWi:;this.ApplyPropUpdates=function(c,d){ULSEWi:;for(var a=0;a<c.length;a++)b(c[a],d)};function b(b,d){ULSEWi:;if(b.validated)c(new SP.JsGrid.Internal.PropertyUpdate(b.newDataValue,b.newLocalizedValue),SP.JsGrid.ValidationState.Valid);else{var h=a.controller.GetPropType(b.recordKey,b.fieldKey);if(b.newValueIsLocalized)b.newValue=b.newValue==null?"":b.newValue.replace(/^\s+|\s+$/g,"");var g=true,f=false;h.BeginValidateNormalizeConvert(b.recordKey,b.fieldKey,b.newValue,b.newValueIsLocalized,e,i);if(g){a.pendingChangeMgr.IncrementPendingChangeCount(d);f=true;c(b.newValueIsLocalized?new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.InvalidValue,b.newValue):new SP.JsGrid.Internal.PropertyUpdate(b.newValue,SP.JsGrid.InvalidValue),SP.JsGrid.ValidationState.Pending)}}function e(e){ULSEWi:;g=false;if(e.isValid)c(new SP.JsGrid.Internal.PropertyUpdate(e.dataValue,e.normalizedLocValue),SP.JsGrid.ValidationState.Valid);else c(b.newValueIsLocalized?new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.InvalidValue,b.newValue):new SP.JsGrid.Internal.PropertyUpdate(b.newValue,SP.JsGrid.InvalidValue),SP.JsGrid.ValidationState.Invalid,e.errorMsg);f&&a.pendingChangeMgr.DecrementPendingChangeCount(d)}function i(){ULSEWi:;var a={isValid:false,errorMsg:SP.JsGrid.Res.vncfailed};e(a)}function c(c,e,f){ULSEWi:;if(b.fieldKey!=SP.JsGrid.RecordIndicatorCheckboxColumnKey)a.versionMgr.AddPropChange(b.recordKey,b.fieldKey,d,c,e,f);else if(c.data)a.checkSelMgr.ExternalAPI.CheckRecord(b.recordKey);else a.checkSelMgr.ExternalAPI.UncheckRecord(b.recordKey)}}};SP.JsGrid.Internal.PendingChangesManager=function(b){ULSEWi:;var i=0,g=0,d={},e=[],c=[],a={},f={};b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnChangeKeyCreated,o);b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,m);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,l);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordCommitted,n);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnVacateChange,p);function p(c){ULSEWi:;var b=c.changeKey.GetVersionNumber();delete d[b];delete a[b]}function l(a){ULSEWi:;var b=a.recordKey;if(!(b in f))f[b]=[];f[b].push(a.changeKey);j(a.changeKey)}function n(d){ULSEWi:;var c=d.originalRecordKey;if(c in f)for(var b=f[c],a=0;a<b.length;a++)h(b[a])}function o(b){ULSEWi:;var c=b.changeKey.GetVersionNumber();d[c]=b.changeKey;a[c]=1}function m(a){ULSEWi:;h(a.changeKey)}function h(f){ULSEWi:;var e=f.GetVersionNumber();if(--a[e]==0){delete a[e];i++;setTimeout(function(){ULSEWi:;i--;b.eventMgr.FireEvent(SP.JsGrid.EventType.OnInitialChangesForChangeKeyComplete,new SP.JsGrid.EventArgs.PendingChangeKeyInitiallyComplete(f));delete d[e];if(c.length!=0&&!k()){for(var a=0;a<c.length;a++)c[a]();c=[]}},0)}}function k(){ULSEWi:;var a=false;for(var c in d)if(b.controller.IsChangeKeyApplied(d[c])){a=true;break}return a}function j(c){ULSEWi:;var b=c.GetVersionNumber();if(b in a)a[b]++;else a[b]=1}this.WaitForPendingUpdates=function(a){ULSEWi:;if(a!=null)if(g!=0)e.push(a);else a()};this.WaitForAllChangeKeysToComplete=function(a){ULSEWi:;if(a!=null)if(i!=0||g!=0||k())c.push(a);else a()};this.IncrementPendingChangeCount=function(a){ULSEWi:;g++;j(a)};this.DecrementPendingChangeCount=function(b){ULSEWi:;g--;if(g==0&&e.length!=0){for(var a=0;a<e.length;a++)e[a]();e=[]}h(b)}};SP.JsGrid.Internal.RowHeaderStateManager=function(b){ULSEWi:;var a={};this.AddRowHeaderState=function(d,f){ULSEWi:;var e=null;if(!(d in a))a[d]=[];else e=a[d][0];var c=a[d],g=SP.Internal.JS.LowerBoundCompare(c,f.GetPriority(),function(b,a){ULSEWi:;return a>c[b].GetPriority()});c.splice(g,0,f);(e==null||c[0].GetId()!=e.GetId())&&b.FireEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,new SP.JsGrid.Internal.EventArgs.OnRowHeaderStateChanged(d,c[0]))};this.RemoveRowHeaderState=function(d,f){ULSEWi:;if(d in a){var e=a[d][0];c(a[d],f);if(a[d].length==0)delete a[d];(a[d]==null||e.GetId()!=a[d][0].GetId())&&b.FireEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,new SP.JsGrid.Internal.EventArgs.OnRowHeaderStateChanged(d,a[d]&&a[d][0]))}};this.ChangeKeys=function(b,c){ULSEWi:;if(b in a){a[c]=a[b];delete a[b]}};this.GetRowHeaderState=function(b){ULSEWi:;return b in a?a[b][0]:null};function c(b,c){ULSEWi:;for(var a=0;a<b.length;a++)if(b[a].GetId()==c){b.splice(a,1);break}}};SP.JsGrid.RowHeaderState=function(a,e,c,d,b){ULSEWi:;this.GetId=function(){ULSEWi:;return a};this.GetImg=function(){ULSEWi:;return e};this.GetPriority=function(){ULSEWi:;return c};this.GetOnClick=function(){ULSEWi:;return b};this.GetTooltip=function(){ULSEWi:;return d};this.toString=function(){ULSEWi:;return a}};SP.JsGrid.AutoRowHeaderStates=function(e,a){ULSEWi:;var d=[[SP.JsGrid.RowHeaderAutoStyleId.Dirty,function(d){ULSEWi:;a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellEditBegin,g);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellEditCompleted,e);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,f);var c,b,h=a.rowHeaderStates[SP.JsGrid.RowHeaderAutoStyleId.Dirty];function e(e){ULSEWi:;if(e.bCancelled)b--;b==0&&e.bCancelled&&e.recordKey==c&&a.jsGridObj.RemoveRowHeaderState(c,d)}function g(d){ULSEWi:;if(b==0){c=d.recordKey;a.jsGridObj.AddRowHeaderState(d.recordKey,h)}b++}function f(e){ULSEWi:;b>0&&a.jsGridObj.RemoveRowHeaderState(c,d);b=0;c=e.recordKey}}],[SP.JsGrid.RowHeaderAutoStyleId.Error,function(d){ULSEWi:;var b=document.createElement("span");b.id=d+"mainDiv";b.style.cssText="display:none; font-size:10; position:absolute; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important";document.body.appendChild(b);var f,c=null,e=null,g=d+"RowError",h=new SP.JsGrid.RowHeaderState(d,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error"),SP.JsGrid.RowHeaderStatePriorities.CellError,SP.JsGrid.Res.errorHeaderStateTooltip,function(d,b){ULSEWi:;if(e!=b)c=null;c=a.jsGridObj.ScrollToAndExpandNextErrorOnRecord(c,b);e=b}),j=new SP.JsGrid.RowHeaderState(g,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error"),SP.JsGrid.RowHeaderStatePriorities.RowError,SP.JsGrid.Res.rowErrorToolTip,function(c,d){ULSEWi:;if(b.curRecKey!=d){b.curRecKey=d;b.style.display="";SP.Internal.DomElement.SetText(b,a.jsGridObj.GetRowErrorMessage(d));var e=h(c.target);if(e!=null){var g=SP.Internal.DomElement.GetLocation(e);b.style.left=g.x+"px";b.style.top=g.y+e.offsetHeight+2+"px"}else{b.style.left=c.clientX+5+"px";b.style.top=c.clientY+5+"px"}}f!=null&&clearTimeout(f);f=setTimeout(function(){ULSEWi:;b.curRecKey=null;b.style.display="none"},2500);function h(a){ULSEWi:;while(a!=null&&a.tagName.toUpperCase()!="TD")a=a.parentNode;return a}});a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,i);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,l);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,k);a.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnGridDisposing,function(){ULSEWi:;b.curRecKey=null;b.innerHTML="";b=null});function i(b){ULSEWi:;if(b.bAddingError&&!b.bCellHadError)a.jsGridObj.AddRowHeaderState(b.recordKey,h);else!b.bCellCurrentlyHasError&&a.jsGridObj.RemoveRowHeaderState(b.recordKey,d)}function l(b){ULSEWi:;if(b.bAddingError&&!b.bRowHadError)a.jsGridObj.AddRowHeaderState(b.recordKey,j);else!b.bErrorCurrentlyInRow&&a.jsGridObj.RemoveRowHeaderState(b.recordKey,g)}function k(a){ULSEWi:;if(a.newRecordKey!=e)c=null}}],[SP.JsGrid.RowHeaderAutoStyleId.NewRow,function(c){ULSEWi:;var b=null,d=new SP.JsGrid.RowHeaderState(c,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_newrowheader"),SP.JsGrid.RowHeaderStatePriorities.NewRow,"",null);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordAdded,function(e){ULSEWi:;b!=null&&a.jsGridObj.RemoveRowHeaderState(b,c);a.jsGridObj.AddRowHeaderState(e.recordKey,d);b=e.recordKey})}]],c=SP.Internal.JS.ConvertTableToMap(d,0,1);for(var b in c)if(e.Contains(b))c[b]=new c[b](b);d=null};SP.JsGrid.RowHeaderStates=function(a){ULSEWi:;this[SP.JsGrid.RowHeaderStyleId.Transfer]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderStyleId.Transfer,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_transferheader"),SP.JsGrid.RowHeaderStatePriorities.Transfer,SP.JsGrid.Res.transferHeaderStateTooltip,null);this[SP.JsGrid.RowHeaderStyleId.Conflict]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderStyleId.Conflict,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_conflictheader"),SP.JsGrid.RowHeaderStatePriorities.Conflict,a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.ExpandConflictResolution)?SP.JsGrid.Res.conflictHeaderStateClickTooltip:SP.JsGrid.Res.conflictHeaderStateTooltip,a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.ExpandConflictResolution)?function(b,c){ULSEWi:;a.delegateMgr.Apply(SP.JsGrid.DelegateType.ExpandConflictResolution,b,c)}:null);this[SP.JsGrid.RowHeaderAutoStyleId.Dirty]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderAutoStyleId.Dirty,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_editheader"),SP.JsGrid.RowHeaderStatePriorities.Dirty,SP.JsGrid.Res.editingHeaderStateTooltip,null)};SP.JsGrid.Internal.ScrollBar=function(n,A,W,L,gb,v){ULSEWi:;var q,b=SP.Internal.ScrollBar.GetSystemScrollBarThickness(),u=b-1,e,d=[],a=new S(n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical),cb=this,z,x,i=false,M=true,J=false,N,r,p,m,eb,y=0,l=0,k,g,j,f,t,c=0,s=W;function db(){ULSEWi:;L!=null&&cb.Update(L)}function Z(c){ULSEWi:;var d=false;if(g!=null&&j!=null&&f!=null&&t!=null){var a=s?b:0;q=Math.max(t-a,SP.Internal.ScrollBar.GetMinScrollBarLength()+a);if(e==null){c=true;ab();A.appendChild(e);A.style.position="relative"}if(c){d=true;U();R();X()}}return d}function U(){ULSEWi:;a.SetLength("outerContainer",q+(s?b:0));a.SetLength("innerContainer",q-4)}function F(a){ULSEWi:;return Math.max(0,Math.min(a,m!=null?m:0))}function P(b){ULSEWi:;var a=Math.max(Math.min(b,g-1),0);return a-o(null,a).count}function O(a,f,b,e){ULSEWi:;var d=c;if(c!=a||b){c=a;w(c);z!=null&&(d!=c||b)&&!e&&z(f,d);return true}return false}function Y(a,d,c){ULSEWi:;M=false;var b=P(a);return O(b,new SP.JsGrid.Internal.ScrollBar.PosInfo(b,a,SP.JsGrid.Internal.ScrollBar.UserSetType.Bottom),d,c)}function h(c,d,b){ULSEWi:;M=true;var a=F(c);return O(a,new SP.JsGrid.Internal.ScrollBar.PosInfo(a,o(a),SP.JsGrid.Internal.ScrollBar.UserSetType.Top),d,b)}function I(b){ULSEWi:;if(b==-1){if(!i){k!=null&&k(false);a.UpdateDisplay("bgMiddleBox",false);a.UpdateDisplay("middleBoxDiv",false);y=0;l=0;h(0);i=true}}else if(b>4){if(i){k!=null&&k(true);i=false}y=b;a.UpdateDisplay("bgMiddleBox",true);a.UpdateDisplay("middleBoxDiv",true);a.UpdateMiddleScroll("middleBoxDiv",b);a.UpdateBGDiv("bgMiddleBox",b)}}function G(){ULSEWi:;return Math.max(0,E()-l-y)}function E(){ULSEWi:;return q-2*u-4}function R(){ULSEWi:;r=0;for(var a=0;a<d.length;a++)r+=Math.max(Math.min(f,d[a].size),0);r+=Math.max(g-d.length,0)*j}function o(c,i){ULSEWi:;var b=c!=null?c:i,k=c==null,h=0,e=d.length!=0?SP.Internal.JS.UpperBound(d,b,"pos")-1:-1,a;while(h<f&&b>=0&&b<g){if(a==null&&e!=-1&&e<d.length)a=d[e];h+=a!=null&&b==a.pos?a.size:j;if(a!=null&&b==a.pos){e+=k?-1:1;a=null}b+=k?-1:1}var l=h!=f;return {count:Math.max(Math.abs((c!=null?c:i)-b)-(l?1:0),0),partial:l}}function Q(){ULSEWi:;var a=o(null,g-1);J=a.partial;return Math.max(a.count,1)}function C(){ULSEWi:;return Math.ceil(f/j)}function D(){ULSEWi:;return Math.floor(f/j)}function X(){ULSEWi:;if(f<r){var a=E();p=a-Math.max(Math.ceil(f/r*a),SP.Internal.ScrollBar.GetMinBoxLength());I(a-p);B()}else{I(-1);B(0)}}function H(a){ULSEWi:;if(v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal)a=m-a;return Math.floor(p/m*a)}function T(a){ULSEWi:;if(v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal)a=p-a;return p>0?F(Math.round(a/(p/m))):0}function w(b){ULSEWi:;l=m>0?H(b):0;a.UpdateBGDiv("bgAboveBox",l+1);a.SetTop("middleBoxDiv",l+u);a.UpdateBGDiv("bgBelowBox",G()+1)}function B(a){ULSEWi:;m=a==null?g-Q():a}function K(j,g,f,h){ULSEWi:;var b,i=0,c=h,k=this;function d(){ULSEWi:;b=setTimeout(e,250-200*Math.min(1,i++/4))}function e(){ULSEWi:;g();d();f&&c!=null&&k.MouseMove(c)}this.MouseMove=function(e){ULSEWi:;var f=SP.Internal.DomElement.GetEventLocation(e),g=SP.Internal.DomElement.PointInDomElem(f.x,f.y,a.GetDomElem(j));if(g&&b==null)d();else if(!g&&b!=null){window.clearTimeout(b);b=null}c=e};this.MouseUp=function(){ULSEWi:;window.clearTimeout(b)};e()}function bb(){ULSEWi:;var d=false;$addHandler(e,"mousedown",j);$addHandler(document.body,"mousemove",b);var k={scrollUpArrowDiv:null,middleBoxDiv:null,scrollDownArrowDiv:null,bgBelowBox:null,bgAboveBox:null},l;function g(b){ULSEWi:;if(!i){d=true;a.ActivateArrowDiv("scrollUpArrowDiv","upArrowDiv",true,b);a.ActivateArrowDiv("scrollDownArrowDiv","downArrowDiv",false,b);a.ActivateDiv("middleBoxDiv",b)}}function f(){ULSEWi:;if(d){d=false;a.DeactivateArrowDiv("scrollUpArrowDiv","upArrowDiv",true);a.DeactivateArrowDiv("scrollDownArrowDiv","downArrowDiv",false);a.DeactivateDiv("middleBoxDiv")}}function b(b){ULSEWi:;var a=SP.Internal.DomElement.GetEventLocation(b);if(!SP.Internal.DomElement.PointInDomElem(a.x,a.y,e))f();else{d=false;g(a)}}function j(f){ULSEWi:;if(i)return;var g;if(f.target!=null){var l=SP.Internal.DomElement.FindFirstAncestorWithAnyPropertyValue(f.target,"elemid",k);if(l!=null){var d=SP.Internal.DomElement.GetCustomAttribute(l.elem,"elemid");if(d=="middleBoxDiv"){var j=c;a.MarkMouseDown("middleBoxDiv");a.ActivateDiv("middleBoxDiv");var p=H(c);SP.Internal.DomElement.SetCapture(f.target,function(c){ULSEWi:;var b=n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical?"clientY":"clientX",a=T(p+c[b]-f[b]);if(j!=a){w(a);j=a;x&&h(a)}},function(c){ULSEWi:;h(j);a.RemoveMouseDown("middleBoxDiv");b(c)})}else if(d=="scrollUpArrowDiv"||d=="scrollDownArrowDiv"){a.MarkMouseDown(d);var m=d=="scrollUpArrowDiv";a.ActivateArrowDiv(d,m?"upArrowDiv":"downArrowDiv",m,true);var e=d=="scrollUpArrowDiv";e=v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal?!e:e;g=new K(d,function(){ULSEWi:;h(c+(e?-1:1))});SP.Internal.DomElement.SetCapture(f.target,g.MouseMove,function(c){ULSEWi:;g.MouseUp();a.RemoveMouseDown(d);b(c)})}else{var e=d=="bgAboveBox";e=v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal?!e:e;a.HighlightBGDiv(d);g=new K(d,e?function(){ULSEWi:;Y(c-(o(c).count==0?1:0))}:function(){ULSEWi:;h(c+Math.max(o(c).count,1))},true,f);SP.Internal.DomElement.SetCapture(f.target,g.MouseMove,function(c){ULSEWi:;a.RestoreBGDiv(d);g.MouseUp();b(c)})}}}}return b}this.Dispose=function(){ULSEWi:;$clearHandlers(e);$removeHandler(document.body,"mousemove",N);a.Dispose();e=null;A=null};this.SetOnVisibilityChanged=function(a,b){ULSEWi:;k=a;k!=null&&b!=!i&&k(!i)};this.Update=function(a){ULSEWi:;var e=false,i=a.itemCount!=null&&a.itemCount!=g||a.itemSize!=null&&a.itemSize!=j||a.physicalViewportSize!=null&&a.physicalViewportSize!=f||a.scrollbarSize!=null&&a.scrollbarSize!=t||a.bClearItemSizes&&d.length!=0||a.bOtherScrollMeets!=null&&a.bOtherScrollMeets!=s||a.itemSizes!=null;g=a.itemCount==null?g:a.itemCount;j=a.itemSize==null?j:a.itemSize;s=a.bOtherScrollMeets==null?s:a.bOtherScrollMeets;if(a.bClearItemSizes)d=[];d=a.itemSizes==null?d:V(a.itemSizes,a.bMergeItemSizes);f=a.physicalViewportSize==null?f:a.physicalViewportSize;t=a.scrollbarSize==null?t:a.scrollbarSize;var b=Z(i);if(a.topItemIdx!=null||b)e=h(a.topItemIdx==null?c:a.topItemIdx,b,a.bScrollNotifiy==false);x=a.bUpdateWhileDragging==null?x:a.bUpdateWhileDragging;return e};this.GetItemDisplayCapacity=function(){ULSEWi:;return C()};this.GetWholeItemDisplayCapacity=function(){ULSEWi:;return D()};this.GetTopItemIdx=function(){ULSEWi:;return c};this.Refresh=function(){ULSEWi:;w(c)};this.ScrollIntoView=function(a){ULSEWi:;a=Math.max(0,Math.min(g-1,a));var b=this.GetItemDisplayInfo(a);if(b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Before){h(a);return true}else if(b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.After||b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Partial){h(a+1-D());return true}return false};this.PartialRowPresent=function(){ULSEWi:;return J};this.GetVisibleItemCount=function(){};this.SetOnScroll=function(a){ULSEWi:;z=a};this.SetViewportSize=function(){};this.GetItemDisplayInfo=function(a){ULSEWi:;var b=C();return a<c?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Before:a>c+b-1?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.After:a==c+b-1?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Partial:SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.InView};function V(e,g){ULSEWi:;if(!g)d=[];for(var f in e){var b=parseInt(f,10),c=parseInt(e[f],10);if(!isNaN(b)&&!isNaN(c)){var a=SP.Internal.JS.LowerBound(d,b,"pos");if(a<0||a>=d.length||d[a].pos!=b)d.splice(a,0,{pos:b,size:c});else d[a].size=c}}return d}function ab(){ULSEWi:;var c=['<div elemid="innerContainer" class="inner-scroll-bar" style="'+a.GetLengthAndThicknessCssString(q-4,b-4)+';">'];c.push(a.GenerateBGDivHTML(u-1,"upArrowDiv",true));c.push(a.GenerateBGDivHTML(1+Math.max(l,0),"bgAboveBox"));c.push(a.GenerateBGDivHTML(Math.max(l,0),"bgMiddleBox",false));c.push(a.GenerateBGDivHTML(G()+1,"bgBelowBox"));c.push(a.GenerateBGDivHTML(u-1,"downArrowDiv",true));e=document.createElement("div");e.innerHTML=c.join("");e.elemid="outerContainer";e.className="outer-scroll-bar";var d=n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical;e.style.cssText=(d?"float:right":"")+a.GetLengthAndThicknessCssString(q,b);a.RegisterPrimitives([e].concat(SP.Internal.DomElement.FindChildrenWithProperty(e,"elemid")));a.AppendItem("upArrowDiv",a.GenerateArrowDiv("scrollUpArrowDiv",-2,true));a.AppendItem("bgMiddleBox",a.GenerateMiddleScroll("middleBoxDiv"));a.AppendItem("downArrowDiv",a.GenerateArrowDiv("scrollDownArrowDiv",0,false));N=bb()}function S(c){ULSEWi:;var e={outerBorder:{mouseDown:"#737A83",mouseOver:"#8A8D91",mouseOut:"#B7BABE"},innerBorder:{mouseDown:"#C3C6CA",mouseOver:"#DADBDD",mouseOut:"#F0F1F4"},shade:{mouseDown:"#969BA2",mouseOver:"#CACCD0",mouseOut:"#E8EBEE"},main:{mouseDown:"#868C93",mouseOver:"#B3B6BB",mouseOut:"#DFE3E8"}},a={},m=c?"width":"height",d=c?"height":"width",o=c?"vert-":"horiz-",f=c?"top":"left",h=c?"left":"top",n=c?"clip9x6":"clip6x9",j="jsgridcluster_scrollbar-mouseout-"+(c?"uparrow":"leftarrow"),i="jsgridcluster_scrollbar-mouseout-"+(c?"downarrow":"rightarrow"),l="jsgridcluster_scrollbar-mousein-"+(c?"uparrow":"leftarrow"),k="jsgridcluster_scrollbar-mousein-"+(c?"downarrow":"rightarrow"),p=c?"scrollbar-highlight-vert.png":"scrollbar-highlight-horiz.png";this.Dispose=function(){ULSEWi:;a=null};this.GetThicknessCssString=function(a){ULSEWi:;return m+":"+a+"px;"};this.GetLengthCssString=function(a){ULSEWi:;return d+":"+a+"px;"};this.GetLengthAndThicknessCssString=function(b,a){ULSEWi:;return this.GetLengthCssString(b)+this.GetThicknessCssString(a)};this.GetCssName=function(a,b){ULSEWi:;return o+a+(b?" "+a:"")};this.RegisterPrimitives=function(c){ULSEWi:;for(var b=0;b<c.length;b++){var d=SP.Internal.DomElement.GetCustomAttribute(c[b],"elemid");if(d!=null)a[d]=c[b]}};this.GetLocation=function(b){ULSEWi:;return SP.Internal.DomElement.GetLocation(a[b])};this.GetHeight=function(b){ULSEWi:;return a[b].offsetHeight};this.GetWidth=function(b){ULSEWi:;return a[b].offsetWidth};this.GetDomElem=function(b){ULSEWi:;return a[b]};this.AppendItem=function(b,c){ULSEWi:;a[b].appendChild(c);this.RegisterPrimitives(SP.Internal.DomElement.FindChildrenWithProperty(a[b],"id"))};this.GenerateBGDivHTML=function(c,a,d){ULSEWi:;return ['<div class="'+this.GetCssName("scroll-bar-bg-block")+'" style="'+(d?"position:relative;":"")+this.GetLengthCssString(c)+'" '+g("elemid",a)+">",'<div class="'+this.GetCssName("scroll-bar-background-shade",true)+'" style="'+this.GetLengthAndThicknessCssString(c,Math.ceil((b-4)/2))+'" '+g("elemid",a,"_shade")+"></div>",'<div class="'+this.GetCssName("scroll-bar-background-main",true)+'" style="'+this.GetLengthAndThicknessCssString(c,Math.floor((b-4)/2))+'" '+g("elemid",a,"_main")+"></div></div>"].join("")};function g(c,b,a){ULSEWi:;return b==null?"":c+'="'+b+(a==null?"":a)+'"'}this.GenerateMiddleScroll=function(a){ULSEWi:;var c=document.createElement("div");c.innerHTML=['<div style="position:relative;',this.GetThicknessCssString(b-6),';margin-top:1px;margin-left:1px;">','<div elemid="',a,'_shade" class="',this.GetCssName("scroll-bar-inner-box-shade",true),'" style="',this.GetThicknessCssString(Math.floor((b-6)/2)),';"></div>','<div elemid="',a,'_main" class="',this.GetCssName("scroll-bar-inner-box-main",true),'" style="',this.GetThicknessCssString(Math.ceil((b-6)/2)),';"></div>','<div elemid="',a,'_gripTop" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px"></div>','<div elemid="',a,'_gripMiddle" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px;"></div>','<div elemid="',a,'_gripBottom" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px"></div></div>'].join("");c.elemid=a;c.className=this.GetCssName("scroll-bar-outer-box",true);c.style.cssText=this.GetThicknessCssString(b-4);return c};this.GenerateArrowDiv=function(f,h,g){ULSEWi:;var a=document.createElement("div"),e=(b-4-(c?6:9))/2,d=(b-4-(c?9:6))/2;a.innerHTML=['<div elemid="'+f+'_inner" class="scroll-bar-inner-arrow-cell" style="'+this.GetLengthAndThicknessCssString(b-4,b-4)+'">','<div class="'+n+'" style="margin-top:'+(!c?Math.round(e):g?Math.floor(e):Math.ceil(e))+"px;margin-left:"+(c?Math.round(d):g?Math.floor(d):Math.ceil(d))+'px;"><img elemid="'+f+'_img" src="/_layouts/Images/jsgridcluster.png" class="'+this.GetCssName("scroll-bar-arrow")+" "+(g?j:i)+'"/>',"</div>","</div>"].join("");a.elemid=f;a.className=this.GetCssName("scroll-bar-arrow-cell",true);a.style.cssText=(c?"top:":"left:")+h+"px;"+this.GetLengthAndThicknessCssString(b-2,b-2);return a};this.UpdateBGDiv=function(c,b){ULSEWi:;a[c].style[d]=b+"px";a[c+"_shade"].style[d]=b+"px";a[c+"_main"].style[d]=b+"px"};this.UpdateMiddleScroll=function(b,g){ULSEWi:;a[b].style[d]=g-2+"px";var c=g-4;a[b+"_main"].style[d]=c+"px";a[b+"_shade"].style[d]=c+"px";var e=Math.round(Math.max(c-8,0)/2);a[b+"_gripTop"].style[f]=e+"px";a[b+"_gripMiddle"].style[f]=e+3+"px";a[b+"_gripBottom"].style[f]=e+6+"px"};this.UpdateDisplay=function(b,c){ULSEWi:;a[b].style.display=c?"block":"none"};this.ActivateArrowDiv=function(b,c,e,d){ULSEWi:;a[b+"_img"].className=this.GetCssName("scroll-bar-arrow")+" "+(e?l:k);this.ActivateDiv(b,d,c)};this.DeactivateArrowDiv=function(b,c,d){ULSEWi:;a[b+"_img"].className=this.GetCssName("scroll-bar-arrow")+" "+(d?j:i);this.DeactivateDiv(b,c)};this.MarkMouseDown=function(b){ULSEWi:;a[b].curStateName="mouseDownPending"};this.RemoveMouseDown=function(b){ULSEWi:;a[b].curStateName=""};this.ActivateDiv=function(d,g,f){ULSEWi:;var c=a[d];if(c.curStateName=="mouseDown")return;var b=c.curStateName=="mouseDownPending"?"mouseDown":SP.Internal.DomElement.PointInDomElem(g.x,g.y,c)?"mouseOver":"mouseOut";if(c.curStateName!=b){c.style.borderColor=e["outerBorder"][b];if(d+"_inner" in a)a[d+"_inner"].style.borderColor=e["innerBorder"][b];else a[d].style.backgroundColor=e["innerBorder"][b];a[(f!=null?f:d)+"_shade"].style.backgroundColor=e["shade"][b];a[(f!=null?f:d)+"_main"].style.backgroundColor=e["main"][b];c.curStateName=b}};this.DeactivateDiv=function(b,c){ULSEWi:;a[b].curStateName="";a[b].style.borderColor="";if(b+"_inner" in a)a[b+"_inner"].style.borderColor="";else a[b].style.backgroundColor="";a[(c!=null?c:b)+"_shade"].style.backgroundColor="";a[(c!=null?c:b)+"_main"].style.backgroundColor=""};this.HighlightBGDiv=function(b){ULSEWi:;a[b+"_main"].style.backgroundColor="#DEDFE2";a[b+"_shade"].style.backgroundColor="#DEDFE2"};this.RestoreBGDiv=function(b){ULSEWi:;a[b+"_shade"].style.backgroundColor="";a[b+"_main"].style.backgroundColor=""};this.SetTop=function(b,c){ULSEWi:;a[b].style[f]=c+"px"};this.SetLength=function(b,c){ULSEWi:;a[b].style[d]=c+"px"}}db()};SP.JsGrid.Internal.ScrollBar.PosInfo=function(c,b,a){ULSEWi:;this.topIdx=c;this.bottomIdx=b;this.userSetType=a};SP.JsGrid.Internal.ScrollBar.UserSetType={Bottom:0,Top:1};SP.JsGrid.Internal.ScrollBar.UpdateParams=function(){ULSEWi:;this.itemCount;this.itemSize;this.itemSizes={};this.physicalViewportSize;this.scrollbarSize;this.topItemIdx;this.bClearItemSizes=false;this.bMergeItemSizes=false;this.bUpdateWhileDragging=false};SP.JsGrid.Internal.ScrollBar.BarType={Horizontal:0,Vertical:1};SP.JsGrid.Internal.ScrollBar.RowDisplayInfo={Before:-1,InView:0,Partial:1,After:2};Type.registerNamespace("SP.Internal.ScrollBar");SP.Internal.ScrollBar.GetSystemScrollBarThickness=function(){ULSEWi:;var a=document.createElement("div"),c=document.createElement("div");a.style.cssText="overflow-x:scroll;position:absolute;visibility:hidden";c.style.cssText="height:50px;width:50px";a.appendChild(c);document.body.appendChild(a);var b=Math.max(a.offsetHeight-50,13);document.body.removeChild(a);SP.Internal.ScrollBar.GetSystemScrollBarThickness=function(){ULSEWi:;return b};return b};SP.Internal.ScrollBar.GetMinBoxLength=function(){ULSEWi:;return 12};SP.Internal.ScrollBar.GetMinScrollBarLength=function(){ULSEWi:;return 2*SP.Internal.ScrollBar.GetSystemScrollBarThickness()+SP.Internal.ScrollBar.GetMinBoxLength()+8+2};SP.JsGrid.Internal.SelectionManager=function(s){ULSEWi:;var e,g,c,k,h,i,d,a,m,r,n=this,j,b=SP.JsGrid.SelectionType,f=SP.JsGrid.Internal.SelectionManager.SelectOp;this.SetAllowedSelectionTypes=function(a){ULSEWi:;k=a};this.GetLastSelectionEndpoints=function(){ULSEWi:;return {rowIdx1:h.rowIdx,colIdx1:h.colIdx,rowIdx2:i.rowIdx,colIdx2:i.colIdx}};this.GetLastSelectionRangeNormalized=function(){ULSEWi:;return d==b.None?null:{rowRange:new SP.Utilities.Range(d!=b.ColumnRange?Math.min(h.rowIdx,i.rowIdx):0,d!=b.ColumnRange?Math.max(h.rowIdx,i.rowIdx):a.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1),colRange:new SP.Utilities.Range(d!=b.RowRange?Math.min(h.colIdx,i.colIdx):0,d!=b.RowRange?Math.max(h.colIdx,i.colIdx):a.gridPane.GetGridPaneConverter().GetVirtualColumnCount()-1)}};this.GetFocus=function(){ULSEWi:;return q(null)};this.GetFocusForPane=function(a){ULSEWi:;return q(a)};this.GetFocusedPane=function(){ULSEWi:;return a.gridPane};this.SetFocusByKey=function(b,c,d){ULSEWi:;var a=b.GetGridPaneConverter().KeyToIdx(c,d);a!=null&&this.SetFocusByPos(b,a.rowIdx,a.colIdx)};this.SetFocusByPos=function(c,b,a){ULSEWi:;this.SelectRange(c,b,b,a,a,f.Set,true,false)};this.IsCellSelected=function(h,f,d){ULSEWi:;if(h!=a.gridPane)return false;for(var b=0;b<e.length;b++)if(e[b].Contains(f))return true;for(b=0;b<g.length;b++)if(g[b].Contains(d))return true;for(b=0;b<c.length;b++)if(c[b].rowRange.Contains(f)&&c[b].colRange.Contains(d))return true;return false};this.IsRowSelected=function(c,d){ULSEWi:;if(c!=a.gridPane)return false;for(var b=0;b<e.length;b++)if(e[b].Contains(d))return true;return false};this.IsOneCellSelected=function(a){ULSEWi:;return a!=null&&a.rowRange.begin==a.rowRange.end&&a.colRange.begin==a.colRange.end};this.GetComponentsWithin=function(j,h,f){ULSEWi:;if(j!=a.gridPane)return new SP.Utilities.Set;var i={};function d(b,a){ULSEWi:;if(!b.IsEmpty()&&!a.IsEmpty())for(var d=b.begin;d<=b.end;d++)for(var c=a.begin;c<=a.end;c++)i[SP.JsGrid.Internal.MakeCellKey(d,c)]=1}for(var b=0;b<e.length;b++)d(e[b].Intersect(h),f);for(b=0;b<g.length;b++)d(h,g[b].Intersect(f));for(b=0;b<c.length;b++)d(c[b].rowRange.Intersect(h),c[b].colRange.Intersect(f));return new SP.Utilities.Set(i)};this.SelectRange=function(u,q,t,m,s,r,w,B){ULSEWi:;function z(){ULSEWi:;var d=k&SP.JsGrid.SelectionTypeFlags._RowMask,c=k&SP.JsGrid.SelectionTypeFlags._ColMask,e=k&SP.JsGrid.SelectionTypeFlags._CellMask;do{var a=false;switch(l(q,t,m,s)){case b.RowRange:switch(d){case SP.JsGrid.SelectionTypeFlags.SingleRow:t=q;case SP.JsGrid.SelectionTypeFlags.SingleRowRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoRows:return false}break;case b.ColumnRange:switch(c){case SP.JsGrid.SelectionTypeFlags.SingleCol:s=m;case SP.JsGrid.SelectionTypeFlags.SingleColRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoCols:return false}break;case b.CellRange:switch(e){case SP.JsGrid.SelectionTypeFlags.SingleCell:t=q;s=m;case SP.JsGrid.SelectionTypeFlags.SingleCellRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoCells:if(d!=SP.JsGrid.SelectionTypeFlags.NoRows){m=s=null;a=true}else if(c!=SP.JsGrid.SelectionTypeFlags.NoCols){q=t=null;a=true}else return false}}}while(a);return true}function C(){ULSEWi:;if(l(q,t,m,s)==b.CellRange)if(Math.abs(m-s)+1==u.GetGridPaneConverter().GetVirtualColumnCount())m=s=null;else if(Math.abs(q-t)+1==u.GetGridPaneConverter().GetVirtualRowCount())q=t=null}function E(c,d){ULSEWi:;if(u!=a.gridPane){r=f.Set;a.gridPane=u}if(B){var e=u.GetGridPaneConverter().KeyToIdx(c.recordKey,c.fieldKey);a.rowIdx=e.rowIdx;a.colIdx=e.colIdx}else if(v!=null){a.rowIdx=v.rowIdx;a.colIdx=v.colIdx}else{a.rowIdx=d==b.ColumnRange?u.BeginRowIdx():q;a.colIdx=d==b.RowRange?u.BeginColIdx():m}}function D(a){ULSEWi:;var k=a==b.ColumnRange?null:(new SP.Utilities.Range(q,t)).Normalize(),i=a==b.RowRange?null:(new SP.Utilities.Range(m,s)).Normalize();if(r==f.Set){e=[];g=[];c=[];j=[]}else if(r==f.ReplaceLast){if(d==b.RowRange)e.pop();else if(d==b.ColumnRange)g.pop();else d==b.CellRange&&c.pop();j.pop()}var h;if(a==b.RowRange){h=k;e.push(h)}else if(a==b.ColumnRange){h=i;g.push(h)}else if(a==b.CellRange){h={rowRange:k,colRange:i};c.push(h)}j.push({type:a,range:h});d=a}var v,A=q!=null&&q==t&&m!=null&&m==s&&w&&r==f.Set;if(A)v={rowIdx:q,colIdx:m};if(!z())return false;C();h={rowIdx:q,colIdx:m};i={rowIdx:t,colIdx:s};p(a.gridPane,u);var x=n.GetFocus(),y=l(q,t,m,s);E(x,y);D(y);o(x,w);return true};this.GetRowRanges=function(b){ULSEWi:;return b==a.gridPane?e:[]};this.GetColumnRanges=function(b){ULSEWi:;return b==a.gridPane?g:[]};this.GetCellRanges=function(b){ULSEWi:;return b==a.gridPane?c:[]};this.Clear=function(f){ULSEWi:;var k;if(!f){p(a.gridPane,null);k=n.GetFocus()}e=[];g=[];c=[];j=[];a={};h=i=null;d=b.None;!f&&o(k,false)};this.GetLastSelectionType=function(){ULSEWi:;return d};this.GetOrderedSelections=function(k,h){ULSEWi:;function g(a){ULSEWi:;for(var c=new Array(a.Size()),b=a.begin;b<=a.end;b++)c[b-a.begin]=i.RowIdxToRecordKey(b);return {begin:a.begin,end:a.end,keys:c}}function f(a){ULSEWi:;for(var c=new Array(a.Size()),b=a.begin;b<=a.end;b++)c[b-a.begin]=i.ColIdxToColKey(b);return {begin:a.begin,end:a.end,keys:c}}var e=[];if(k==a.gridPane)for(var i=k.GetGridPaneConverter(),d=0;d<j.length;d++){var l=j[d].type,c=j[d].range;if(h==null||h==l)switch(l){case b.RowRange:e.push(g(c));break;case b.ColumnRange:e.push(f(c));break;case b.CellRange:e.push({rowRange:g(c.rowRange),colRange:f(c.colRange)})}}return e};function p(b,a){ULSEWi:;m=b!=null?b.NotifySelectionUpdating():null;r=a!=null?a!=b?a.NotifySelectionUpdating():m:null}function o(a,c){ULSEWi:;var b=n.GetFocus();a!=null&&a.gridPane.NotifySelectionUpdated(m,c);b!=null&&(a==null||b.gridPane!=a.gridPane)&&b.gridPane.NotifySelectionUpdated(r,c);(a==null&&b!=null||a!=null&&b==null||a!=null&&b!=null&&(a.recordKey!=b.recordKey||a.fieldKey!=b.fieldKey))&&s(new SP.JsGrid.EventArgs.CellFocusChanged(b&&b.recordKey,b&&b.fieldKey,a&&a.recordKey,a&&a.fieldKey))}function l(d,e,a,c){ULSEWi:;return d==null||e==null?b.ColumnRange:a==null||c==null?b.RowRange:b.CellRange}function q(c){ULSEWi:;if(a.gridPane==null||c!=null&&a.gridPane!=c||a.colIdx>=a.gridPane.GetGridPaneConverter().GetVirtualColumnCount())return null;var b=a.gridPane.GetGridPaneConverter().IdxToKey(a.rowIdx,a.colIdx);if(b.recordKey==null||b.fieldKey==null||b.columnKey==null)return null;return {rowIdx:a.rowIdx,colIdx:a.colIdx,recordKey:b.recordKey,fieldKey:b.fieldKey,columnKey:b.columnKey,gridPane:a.gridPane}}this.Clear(true)};SP.JsGrid.Internal.SelectionManager.SelectOp={Set:0,Append:1,ReplaceLast:2};SP.Utilities.Set=function(a){ULSEWi:;this.collection=a!=null?a:{}};SP.Utilities.Set.prototype={IsEmpty:function(){ULSEWi:;for(var a in this.collection)return false;return true},First:function(){ULSEWi:;for(var a in this.collection)return a;return null},GetCollection:function(){ULSEWi:;return this.collection},ToArray:function(){ULSEWi:;return SP.Internal.JS.ConvertSetKeysToArray(this.collection)},AddArray:function(b){ULSEWi:;for(var a=0;a<b.length;a++)this.collection[b[a]]=1;return this},Add:function(a){ULSEWi:;this.collection[a]=1;return a},Remove:function(a){ULSEWi:;var b=this.collection[a];delete this.collection[a];return b},Clear:function(){ULSEWi:;this.collection={};return this},Contains:function(a){ULSEWi:;return a in this.collection},Clone:function(){ULSEWi:;var a={};for(var b in this.collection)a[b]=1;return new SP.Utilities.Set(a)},SymmetricDifference:function(c){ULSEWi:;var b={};for(var a in this.collection)if(!(a in c.collection))b[a]=1;for(a in c.collection)if(!(a in this.collection))b[a]=1;return new SP.Utilities.Set(b)},Difference:function(c){ULSEWi:;var b={};for(var a in this.collection)if(!(a in c.collection))b[a]=1;return new SP.Utilities.Set(b)},Union:function(b){ULSEWi:;var a=this.Clone();for(var c in b.collection)a.collection[c]=1;return a},UnionWith:function(a){ULSEWi:;for(var b in a.collection)this.collection[b]=1},Intersection:function(c){ULSEWi:;var b={};for(var a in this.collection)if(a in c.collection)b[a]=1;return new SP.Utilities.Set(b)}};SP.Utilities.KeyMap=function(){ULSEWi:;this.dictionary={};this.valueKeyMap={}};SP.Utilities.KeyMap.prototype={Add:function(b,a){ULSEWi:;this.dictionary[b]=a;this.valueKeyMap[a]=b},RemoveKey:function(a){ULSEWi:;delete this.valueKeyMap[this.dictionary[a]];delete this.dictionary[a]},RemoveValue:function(a){ULSEWi:;delete this.dictionary[this.valueKeyMap[a]];delete this.valueKeyMap[a]},GetValue:function(a){ULSEWi:;return this.dictionary[a]},GetKey:function(a){ULSEWi:;return this.valueKeyMap[a]},GetDictionary:function(){ULSEWi:;return this.dictionary},Clear:function(){ULSEWi:;this.dictionary={};this.valueKeyMap={}},ContainsKey:function(a){ULSEWi:;return a in this.dictionary},ContainsValue:function(a){ULSEWi:;return a in this.valueKeyMap}};SP.Utilities.Range=function(a,b){ULSEWi:;if(a==null||b==null)this.Clear();else{this.begin=a;this.end=b}};SP.Utilities.Range.prototype={Normalize:function(){ULSEWi:;var a=Math.min(this.begin,this.end),b=Math.max(this.begin,this.end);this.begin=a;this.end=b;return this},Contains:function(a){ULSEWi:;return a>=this.begin&&a<=this.end},IsEmpty:function(){ULSEWi:;return this.begin>this.end},Clear:function(){ULSEWi:;this.begin=0;this.end=-1},Size:function(){ULSEWi:;return Math.max(0,this.end-this.begin+1)},Overlaps:function(a){ULSEWi:;return this.end>=a.begin&&a.end>=this.begin},Intersect:function(a){ULSEWi:;return new SP.Utilities.Range(Math.max(this.begin,a.begin),Math.min(this.end,a.end))}};Type.registerNamespace("SP.JsGrid.SplitterBar");SP.JsGrid.SplitterBar=function(g,m,k,i,o){ULSEWi:;var d={None:0,Hover:1,Drag:2},a,b,c=g.styleMgr.splitterStyleCollection,q,e=d.None,h,p=["<div splitId='innerContainer' style='position:absolute;top:1px;left:1px;width:2px;border:1px solid;'></div>","<div splitId='outerHandle' style='position:absolute;left:0px;height:43px;width:4px;border:1px solid;'>","<div splitId='innerHandle' style='height:41px;width:2px;position:relative;border:1px solid;'>","<div splitId='bitTop' style='position:absolute;top:17px;left:0px;height:1px;width:2px;border-top:1px solid;'></div>","<div splitId='bitMiddle' style='position:absolute;top:20px;left:0px;height:1px;width:2px;border-top:1px solid;'></div>","<div splitId='bitBottom' style='position:absolute;top:23px;left:0px;height:1px;width:2px;border-top:1px solid;'></div></div></div>"].join("");function j(){ULSEWi:;var a;a=document.createElement("div");a.innerHTML=p;a.splitId="outerContainer";a.style.cssText="width:6px;float:"+g.RTL.left+";position:relative;cursor:col-resize;";a.childObjects=SP.Internal.DomElement.GetChildrenWithCustomAttribute(a,"splitId");return a}function l(a,b){ULSEWi:;a.outerContainer.style.height=b+"px";a.innerContainer.style.height=Math.max(b-4,0)+"px";a.outerHandle.style.top=Math.round((b-45)/2)+"px"}function f(a,c,b){ULSEWi:;a.outerContainer.style.backgroundColor=c.outerBorderColor;a.innerContainer.style.borderColor=c.innerBorderColor;a.innerContainer.style.borderLeftColor=c.leftInnerBorderColor;a.innerContainer.style.backgroundColor=c.backgroundColor;a.outerHandle.style.borderColor=b.outerBorderColor;a.innerHandle.style.borderColor=b.innerBorderColor;a.innerHandle.style.borderLeftColor=b.leftInnerBorderColor;a.innerHandle.style.backgroundColor=b.backgroundColor;a.bitTop.style.borderTopColor=b.gripUpperColor;a.bitTop.style.backgroundColor=b.gripLowerColor;a.bitMiddle.style.borderTopColor=b.gripUpperColor;a.bitMiddle.style.backgroundColor=b.gripLowerColor;a.bitBottom.style.borderTopColor=b.gripUpperColor;a.bitBottom.style.backgroundColor=b.gripLowerColor}function n(){ULSEWi:;var h;$addHandler(document.body,"mousemove",j);$addHandler(a,"mousedown",p);function l(a){ULSEWi:;return SP.Internal.DomElement.AdjustCoordsForIEZoom({x:a.screenX,y:a.screenY}).x}function j(g){ULSEWi:;if(e!=d.Drag){var b=SP.Internal.DomElement.GetEventLocation(g);if(SP.Internal.DomElement.PointInDomElem(b.x,b.y,a)){if(e==d.None){f(a.childObjects,c.hover,c.hoverHandle);e=d.Hover}}else if(e==d.Hover){f(a.childObjects,c.normal,c.normalHandle);e=d.None}}}function p(g){ULSEWi:;if(g.button==Sys.UI.MouseButton.leftButton){g.preventDefault();h=l(g);SP.Internal.DomElement.SetCapture(a,n,q);b.style.display="block";e=d.Drag;f(a.childObjects,c.drag,c.dragHandle);SP.Internal.DomElement.SetOpacity(a,.4);n(g)}}function n(e){ULSEWi:;var d=(l(e)-h)*(g.RTL.bEnabled?-1:1),c=k()+d;c=Math.max(c,m);c=Math.min(c,i()-SP.Internal.ScrollBar.GetSystemScrollBarThickness()-a.offsetWidth-m);b.style.left=(g.RTL.bEnabled?i()-a.offsetWidth-c:c+1)+"px"}function q(c){ULSEWi:;b.style.display="none";var f=(l(c)-h)*(g.RTL.bEnabled?-1:1),i=k()+f;o(i);h=null;e=d.None;SP.Internal.DomElement.RemoveOpacity(a);j(c)}return function(){ULSEWi:;$removeHandler(document.body,"mousemove",j);$removeHandler(a,"mousedown",p)}}this.Init=function(g,e,d){ULSEWi:;a=j();a.style.marginTop=d+"px";h=n();b=j();b.style.display="none";b.style.position="absolute";b.style.top=d+1+"px";b.style.zIndex=1;this.SetHeight(e);f(a.childObjects,c.normal,c.normalHandle);f(b.childObjects,c.drag,c.dragHandle);g.appendChild(b);return a};this.Hide=function(){ULSEWi:;a.style.display="none"};this.Show=function(){ULSEWi:;a.style.display="block"};this.IsInited=function(){ULSEWi:;return a!=null};this.Dispose=function(){ULSEWi:;h!=null&&h();if(a!=null)a=a.childObjects=null;if(b!=null)b=b.childObjects=null};this.SetHeight=function(c){ULSEWi:;l(a.childObjects,c);l(b.childObjects,c)}};SP.JsGrid.StaticDataSource=function(c,f){ULSEWi:;var a=this,b,d=false;this.tableCache;this.styleMgr;this.recordFactory;this.bHollowOutBlobs;this.LoadSerializedData=function(h){ULSEWi:;b=new SP.JsGrid.Deserializer(h,SP.JsGrid.DeserializationMode.Full);var g=b.view.length,c=g<750,e=!c&&g>300?300:null;d=e!=null;a.tableCache.Clear();a.tableCache.SetMaxRecordCount(e);a.tableCache.SetConvertAllBlobsToRecords(c);a.tableCache.SetKeepDataInBlobCache(!d);a.tableCache.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(b.data),b.data);a.recordFactory=new SP.JsGrid.RecordFactory(b.gridFieldMap,b.keyColumnName,f);b.InitCellStyles(a.styleMgr)};this.InitJsGridParams=function(c){ULSEWi:;var a=b.InitJsGridParams(c);a.tableCache=this.tableCache;a.styleManager=this.styleMgr;return a};this.InitJsGridTableViewParams=function(a){ULSEWi:;return b.InitJsGridTableViewParams(a)};this.InitJsGridRowViewParams=function(a){ULSEWi:;return b.InitJsGridRowViewParams(a)};this.GetAdditionalParams=function(){ULSEWi:;return b.additionalParams};this.AddColumn=function(a,c){ULSEWi:;this.recordFactory.gridFieldMap[a.key]=a;var d={};for(var b in c){var e=this.recordFactory.MakePropForRecord(a,c[b].data,c[b].localized);if(e!=null)d[b]={isProp:true,prop:e};else d[b]={hasLocalized:a.hasLocalizedValue,hasData:a.hasDataValue,data:c[b].data,localized:c[b].localized}}this.tableCache.AddColumn(a.key,d)};this.RemoveColumn=function(a){ULSEWi:;delete this.recordFactory.gridFieldMap[a];this.tableCache.RemoveColumn(a)};function e(h,b){ULSEWi:;var f=new Array(b.length),g=a.bHollowOutBlobs!=null?!a.bHollowOutBlobs:!d;for(var e in b){var c=h[b[e]];f[b[e]]=a.recordFactory.MakeRecord(c.data,c.localized,g)}return f}function g(){ULSEWi:;a.tableCache=new SP.JsGrid.TableCache(null,e);a.styleMgr=SP.JsGrid.Style.MakeJsGridStyleManager();if(c!=null){a.LoadSerializedData(c);c=null}}g()};SP.JsGrid.Style=function(){ULSEWi:;var i="#FFFFFF",e,d,c={Normal:0,PartSelected:1,AllSelected:2,NormalHover:3,PartSelectedHover:4,AllSelectedHover:5},a={Splitter:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{}},SplitterHandle:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{},gripUpperColor:{jsId:"color",defaultValue:"#A7AAAF"},gripLowerColor:{jsId:"borderRightColor",defaultValue:"#FEFEFE"}},GridPane:{verticalBorderColor:{jsId:"borderRightColor",defaultValue:"#DADCDD"},verticalBorderStyle:{jsId:"borderRightStyle",defaultValue:"solid"},horizontalBorderColor:{jsId:"borderBottomColor",defaultValue:"#DADCDD"},horizontalBorderStyle:{jsId:"borderBottomStyle",defaultValue:"solid"},backgroundColor:{jsId:"backgroundColor",defaultValue:"#F6F6F6"},linkColor:{classId:"link",jsId:"color",defaultValue:"#003399"},visitedLinkColor:{classId:"link",jsId:"backgroundColor",defaultValue:"#003399"},copyRectForeBorderColor:{classId:"selection",jsId:"borderLeftColor",defaultValue:"#333333"},copyRectBackBorderColor:{classId:"selection",jsId:"borderRightColor",defaultValue:"#FFFFFF"},focusRectBorderColor:{classId:"selection",jsId:"borderTopColor",defaultValue:"#333333"},selectionRectBorderColor:{classId:"selection",jsId:"borderBottomColor",defaultValue:"#333333"},selectedCellBgColor:{classId:"selection",jsId:"color",classId:"selection",defaultValue:SP.JsGrid.Internal.Color.MakeAlphaColor(.4,.8,.8,.8),fromCss:j},changeHighlightCellBgColor:{classId:"edit",jsId:"backgroundColor",defaultValue:SP.JsGrid.Internal.Color.MakeAlphaColor(.4,198/255,223/255,255/255),fromCss:j},fillRectBorderColor:{classId:"edit",jsId:"borderColor",defaultValue:"#FFDCA0"},errorRectBorderColor:{classId:"edit",jsId:"borderTopColor",defaultValue:"#FF0000"},columnDropIndicatorColor:{jsId:"borderLeftColor",defaultValue:"#DC9A06"}},Header:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#363636"},backgroundColor:{},outerBorderColor:{jsId:"borderBottomColor"},eyeBrowBorderColor:{jsId:"borderRightColor"},menuColor:{classId:"menuBaseControl",jsId:"borderLeftColor"},eyeBrowColor:{classId:"menuBaseControl",jsId:"borderTopColor"},resizeColor:{classId:"menuBaseControl",jsId:"borderRightColor"},menuBorderColor:{classId:"menuBorderControl",jsId:"borderLeftColor"},eyeBrowBorderColor:{classId:"menuBorderControl",jsId:"borderTopColor"},resizeBorderColor:{classId:"menuBorderControl",jsId:"borderRightColor"},menuHoverColor:{classId:"menuHoverControl",jsId:"borderLeftColor"},eyeBrowHoverColor:{classId:"menuHoverControl",jsId:"borderTopColor"},resizeHoverColor:{classId:"menuHoverControl",jsId:"borderRightColor"},menuHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderLeftColor"},eyeBrowHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderTopColor"},resizeHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderRightColor"},elementClickColor:{classId:"menuClickControl",jsId:"backgroundColor"},elementClickBorderColor:{classId:"menuClickControl",jsId:"borderColor"}},TimescaleTier:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#363636"},backgroundColor:{defaultValue:"#DFE3E8"},verticalBorderColor:{jsId:"borderRightColor",defaultValue:"#C8CCD0"},verticalBorderStyle:{jsId:"borderRightStyle",defaultValue:"solid"},horizontalBorderColor:{jsId:"borderBottomColor",defaultValue:"#C8CCD0"},horizontalBorderStyle:{jsId:"borderBottomStyle",defaultValue:"solid"},outerBorderColor:{jsId:"borderLeftColor",defaultValue:"#B1B5BA"},todayLineColor:{jsId:"borderRightColor",defaultValue:"#F59D56"}},Cell:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},fontStyle:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#131519"},backgroundColor:{defaultValue:i},textAlign:{defaultValue:SP.JsGrid.Utility.GetDocumentDirection()=="rtl"?"right":"left"}}};for(var n in a)for(var l in a[n]){var f=a[n][l],h=f.jsId==null?l:f.jsId;if(h!=""&&(f.cssId==null||f.cssId=="")){f.cssId=SP.Internal.DomElement.DashNameFromCamelName(h);f.jsId=h}}$addHandler(window,"unload",m);function m(){ULSEWi:;$removeHandler(window,"unload",m);e=d=null}function j(b){ULSEWi:;var a=SP.JsGrid.Internal.Color.HexStringToColor(b);if(a!=null)a=new SP.JsGrid.Internal.Color.MakeAlphaColor(.2,a.r,a.g,a.b);return a}function b(a){ULSEWi:;var c={};for(var b in a)c[b]=a[b].defaultValue;return c}function q(){ULSEWi:;return {textColor:"#6C6F72"}}function k(){ULSEWi:;function e(d){ULSEWi:;var c=b(a.Header);c.type=d;return c}var d={normal:e(c.Normal),normalHover:e(c.NormalHover),partSelected:e(c.PartSelected),partSelectedHover:e(c.PartSelectedHover),allSelected:e(c.AllSelected),allSelectedHover:e(c.AllSelectedHover)};d.normal.backgroundColor="#DFE3E8";d.normal.outerBorderColor="#B1B5BA";d.normal.eyeBrowColor="#DFE3E8";d.normal.eyeBrowBorderColor="#C8CCD0";d.normal.resizeColor="#EAEFF3";d.normal.resizeBorderColor="#C5C9CE";d.normal.resizeHoverColor="#FEFEFE";d.normal.resizeHoverBorderColor="#6E7B8A";d.normal.elementClickColor="#FFDC61";d.normal.elementClickBorderColor="#C28A30";d.partSelected.backgroundColor="#FFDC61";d.partSelected.outerBorderColor="#C28A30";d.partSelected.eyeBrowColor="#FFDC61";d.partSelected.eyeBrowBorderColor="#F3AA07";d.partSelected.resizeColor="#FFDC63";d.partSelected.resizeBorderColor="#F3AA07";d.partSelected.resizeHoverColor="#FFE9A3";d.partSelected.resizeHoverBorderColor="#BC8205";d.partSelected.elementClickColor="#FCAF00";d.partSelected.elementClickBorderColor="#CB8C00";d.allSelected.backgroundColor="#CACFD6";d.allSelected.outerBorderColor="#75777A";d.allSelected.eyeBrowColor="#CACFD6";d.allSelected.eyeBrowBorderColor="#8C949D";d.allSelected.resizeColor="#EAEFF3";d.allSelected.resizeBorderColor="#C5C9CE";d.allSelected.resizeHoverColor="#FEFEFE";d.allSelected.resizeHoverBorderColor="#6E7B8A";d.allSelected.elementClickColor="#FFDC61";d.allSelected.elementClickBorderColor="#C28A30";d.normalHover.backgroundColor="#FFEB91";d.normalHover.outerBorderColor="#C28A30";d.normalHover.eyeBrowColor="#FFEB91";d.normalHover.menuColor="#FFEB91";d.normalHover.eyeBrowBorderColor="#F3AA07";d.normalHover.menuBorderColor="#FFD359";d.normalHover.resizeBorderColor="#F3AA07";d.normalHover.eyeBrowHoverColor="#FFF5c8";d.normalHover.resizeColor=d.normalHover.menuHoverColor="#FFF5C8";d.normalHover.eyeBrowHoverBorderColor=d.normalHover.menuHoverBorderColor="#F3AA07";d.normalHover.elementClickColor="#FFDC61";d.normalHover.elementClickBorderColor="#C28A30";d.partSelectedHover=SP.Internal.JS.CloneObj(d.normalHover);d.allSelectedHover=SP.Internal.JS.CloneObj(d.normalHover);return d}function o(){ULSEWi:;var c={normal:b(a.Splitter),normalHandle:b(a.SplitterHandle),hover:b(a.Splitter),hoverHandle:b(a.SplitterHandle),drag:b(a.Splitter),dragHandle:b(a.SplitterHandle)};c.normal.outerBorderColor="#B1B5BA";c.normal.leftInnerBorderColor="#E9EBED";c.normal.innerBorderColor="#E9EBED";c.normal.backgroundColor="#DFE3E8";c.normalHandle.outerBorderColor="#A7AAAF";c.normalHandle.leftInnerBorderColor="#E5E7EB";c.normalHandle.innerBorderColor="#E3E6E8";c.normalHandle.backgroundColor="#DCE0E6";c.normalHandle.gripUpperColor="#A7AAAF";c.normalHandle.gripLowerColor="#FEFEFE";c.hover.outerBorderColor="#B8BCC0";c.hover.leftInnerBorderColor="#F4F5F6";c.hover.innerBorderColor="#EDEFF0";c.hover.backgroundColor="#E8EBEC";c.hoverHandle.outerBorderColor="#8A8D91";c.hoverHandle.leftInnerBorderColor="#C3C6C9";c.hoverHandle.innerBorderColor="#C1C5C8";c.hoverHandle.backgroundColor="#B1B5B9";c.hoverHandle.gripUpperColor="#A7AAAF";c.hoverHandle.gripLowerColor="#FEFEFE";c.drag.outerBorderColor="#797B7F";c.drag.leftInnerBorderColor="#E6E6E8";c.drag.innerBorderColor="#DCDDDF";c.drag.backgroundColor="#D3D4D6";c.dragHandle.outerBorderColor="#5F6164";c.dragHandle.leftInnerBorderColor="#A4A7AA";c.dragHandle.innerBorderColor="#A4A7AA";c.dragHandle.backgroundColor="#8C8F93";c.dragHandle.gripUpperColor="#A7AAAF";c.dragHandle.gripLowerColor="#FEFEFE";return c}function p(a){ULSEWi:;var c={};for(var b in a){var d=a[b].classId==null?"base":a[b].classId;if(!(d in c))c[d]={};c[d][b]=a[b]}return c}function g(d,c,b){ULSEWi:;for(var a in c)b[a]!=null&&SP.JsGrid.Style.CreateStyleFromCss(c[a],b[a],d)}return {Type:a,SetRTL:function(a){ULSEWi:;_rtl=a},MakeJsGridStyleManager:function(){ULSEWi:;var c={};function d(b){ULSEWi:;for(var e=[[b.gridPaneStyle,function(c,a){ULSEWi:;b.UpdateGridPaneStyleFromCss(a)},null,{base:"ms-grid",link:"ms-grid-link",selection:"ms-grid-selection",edit:"ms-grid-edit"}],[b.columnHeaderStyleCollection,b.UpdateHeaderStyleFromCss,null,{normal:{base:"ms-grid-col-header-normal",menuControl:"ms-grid-col-header-normal-control"},normalHover:{base:"ms-grid-col-header-normal-hover",menuControl:"ms-grid-col-header-normal-hover-control"},partSelected:{base:"ms-grid-col-header-part-selected",menuControl:"ms-grid-col-header-part-selected-control"},partSelectedHover:{base:"ms-grid-col-header-part-selected-hover",menuControl:"ms-grid-col-header-part-selected-hover-control"},allSelected:{base:"ms-grid-col-header-all-selected",menuControl:"ms-grid-col-header-all-selected-control"},allSelectedHover:{base:"ms-grid-col-header-all-selected-hover",menuControl:"ms-grid-col-header-all-selected-hover"}}],[b.rowHeaderStyleCollection,b.UpdateHeaderStyleFromCss,null,{normal:{base:"ms-grid-row-header-normal",menuControl:"ms-grid-row-header-normal-control"},normalHover:{base:"ms-grid-row-header-normal-hover",menuControl:"ms-grid-row-header-normal-hover-control"},partSelected:{base:"ms-grid-row-header-part-selected",menuControl:"ms-grid-row-header-part-selected-control"},partSelectedHover:{base:"ms-grid-row-header-part-selected-hover",menuControl:"ms-grid-row-header-part-selected-hover-control"},allSelected:{base:"ms-grid-row-header-all-selected",menuControl:"ms-grid-row-header-all-selected-control"},allSelectedHover:{base:"ms-grid-row-header-all-selected-hover",menuControl:"ms-grid-row-header-all-selected-hover"}}],[b.splitterStyleCollection,b.UpdateSplitterStyleFromCss,null,{normal:{base:"ms-grid-splitter"},normalHandle:{base:"ms-grid-splitter-handle"},hover:{base:"ms-grid-splitter-hover"},hoverHandle:{base:"ms-grid-splitter-handle-hover"},drag:{base:"ms-grid-splitter-drag"},dragHandle:{base:"ms-grid-splitter-handle-drag"}}],[b.defaultCellStyle,a.Cell,"ms-grid-cell"],[b.readOnlyCellStyle,a.Cell,"ms-grid-cell-readonly"],[b.timescaleTierStyle,a.TimescaleTier,"ms-grid-timescale"],[b.groupingStyles,function(c,a){ULSEWi:;b.UpdateGroupStylesFromCss(a)},null,"ms-grid-group"]],d=0;d<e.length;d++){var c=e[d];if(c[2]!=null)SP.JsGrid.Style.CreateStyleFromCss(c[1],c[2],c[0]);else c[1].apply(b,[c[0],c[3]])}return b}return d({gridPaneStyle:b(a.GridPane),columnHeaderStyleCollection:k(),rowHeaderStyleCollection:k(),splitterStyleCollection:o(),defaultCellStyle:b(a.Cell),readOnlyCellStyle:q(),timescaleTierStyle:b(a.TimescaleTier),groupingStyles:[{backgroundColor:"#FFF6C1"},{backgroundColor:"#00ADEE"},{backgroundColor:"#81DEFF"},{backgroundColor:"#ECECEC"},{backgroundColor:"#BFBFBF"},{backgroundColor:"#EC008C"},{backgroundColor:"#FF89CF"},{backgroundColor:"#62CE33"},{backgroundColor:"#ACCC6C"}],RegisterCellStyle:function(b,a){ULSEWi:;c[b]=a},GetCellStyle:function(a){ULSEWi:;return c[a]},UpdateSplitterStyleFromCss:function(c,b){ULSEWi:;g(c,b,a.Splitter)},UpdateHeaderStyleFromCss:function(c,b){ULSEWi:;g(c,b,a.Header)},UpdateGridPaneStyleFromCss:function(b){ULSEWi:;g(this.gridPaneStyle,p(a.GridPane),b)},UpdateGroupStylesFromCss:function(d){ULSEWi:;var b=[],c={},e=1;while(true){c=SP.JsGrid.Style.CreateStyleFromCss(a.Cell,d+e++);if(!SP.Internal.JS.IsAssocArrayEmpty(c))b.push(c);else break}if(b.length>0)this.groupingStyles=b}})},CreateStyleFromCss:function(a,j,g){ULSEWi:;var i=g==null?{}:g;if(d==null){d=document.createElement("div");document.body.appendChild(d);d.style.display="none";e=document.createElement("div");document.body.appendChild(e);e.style.display="none"}e.className=j;for(var b in a){var f=a[b].jsId;if(f!=""){var c=SP.Internal.DomElement.GetComputedStyle(e,f,a[b].cssId);if(c!=SP.Internal.DomElement.GetComputedStyle(d,f,a[b].cssId)){var h=a[b].fromCss!=null?a[b].fromCss(c):c;if(h!=null)i[b]=h}}}return i},CreateStyle:function(d,b){ULSEWi:;var c={};for(var a in d)if(b[a]!=null)c[a]=b[a];return c},MergeCellStyles:function(c,e){ULSEWi:;var d={};for(var b in a.Cell)d[b]=c!=null&&c[b]!=null?c[b]:e[b];return d},ApplyCellStyle:function(c,a){ULSEWi:;var b=c.style;if(a.textColor!=null)b.color=a.textColor;if(a.backgroundColor!=null)b.backgroundColor=a.backgroundColor;if(a.font!=null)b.fontFamily=a.font;if(a.fontSize!=null)b.fontSize=a.fontSize;if(a.fontWeight!=null)b.fontWeight=a.fontWeight;if(a.fontStyle!=null)b.fontStyle=a.fontStyle;if(a.textAlign!=null)b.textAlign=a.textAlign},ApplyRowHeaderStyle:function(a,d,c){ULSEWi:;var b=a.style;if(a.headerStyleType!=d.type){a.headerStyleType=d.type;b.backgroundColor=d.backgroundColor;a.headerStyleBorderString=b.borderBottom=b["border"+_rtl.Right]="1px solid "+d.outerBorderColor;b.borderTop="0px"}var e=c&&c(a,true);if(e!=null){var h=f(e,a);e.style.borderBottom=h.headerStyleBorderString}var g=c&&c(a,false),h=g!=null?f(g,a):a;b.borderBottom=h.headerStyleBorderString;function f(a,b){ULSEWi:;return a.headerStyleType==null?b:b.headerStyleType==null?a:a.headerStyleType>b.headerStyleType?a:b}},ApplyCornerHeaderBorderStyle:function(b,a){ULSEWi:;this.ApplyRowHeaderStyle(b,a,function(){ULSEWi:;return null})},ApplyHeaderInnerBorderStyle:function(c,a,b){ULSEWi:;c.style[a?"borderTop":"border"+_rtl.Left]=b.headerStyleInnerBorderString},ApplyColumnContextMenuStyle:function(a,b){ULSEWi:;a.style.border=SP.JsGrid.Style.MakeBorderString(1,"solid",b.borderColor);a.style.backgroundColor=b.backgroundColor},ApplySplitterStyle:function(a,b){ULSEWi:;a.style.borderLeft=a.style.borderRight=SP.JsGrid.Style.MakeBorderString(1,"solid",b.outerColor);a.style.backgroundColor=b.innerColor},MakeBorderString:function(c,b,a){ULSEWi:;return [c,"px ",b," ",a].join("")},GetCellStyleDefaultBackgroundColor:function(){ULSEWi:;return i}}}();SP.JsGrid.TableCache=function(E,p){ULSEWi:;this.fnApplyUpdatesToNewRecord;var j=300,g=null,n=false,q=false,o=10,t=0,a,c,d,f=[],e,b,r=0,A,h,l=this;v();this.SetDataPageSize=function(a){ULSEWi:;j=a};this.GetDataPageSize=function(){ULSEWi:;return j};this.SetMaxRecordCount=function(a){ULSEWi:;g=a;u(false)};this.GetMaxRecordCount=function(){ULSEWi:;return g};this.SetConvertAllBlobsToRecords=function(a){ULSEWi:;n=a};this.GetConvertAllBlobsToRecords=function(){ULSEWi:;return n};this.SetBackgroundConversionSize=function(a){ULSEWi:;o=a};this.GetBackgroundConversionSize=function(){ULSEWi:;return o};this.SetKeepDataInBlobCache=function(a){ULSEWi:;q=a};this.GetKeepDataInBlobCache=function(){ULSEWi:;return q};function H(b,a){ULSEWi:;return {pos:b,count:a}}this.GetCachedRecord=function(b){ULSEWi:;b in c&&!(b in a)&&this.AddRecordsToCache(p(c[b],[b]));return a[b]};this.GetRecordsByKey=function(a,e){ULSEWi:;var f=c();if(f==null)return false;d(f);return true;function c(){ULSEWi:;for(var d=new Array(a.length),c=0;c<a.length;c++){var e=b.GetPosFromKey(a[c]);if(e==null)return null;d[c]={pos:e,count:1}}return d}function d(d){ULSEWi:;var b=l.GetRecords(d,g);if(b.recordSetComplete){var c=SP.Internal.JS.Flatten2LevelArray(b.records);setTimeout(function(){ULSEWi:;e(a,c,true)},0)}}function g(b,f){ULSEWi:;var b=c();if(f&&b!=null)d(b);else e(a,null,false)}};this.GetRecords=function(e,l){ULSEWi:;var f=[],a=[],h=[];for(var i in e)f[i]=C(e[i],h,a);G(h);if(a.length>0){var m,b,d=true;function j(a){ULSEWi:;d=d&&a;b--;b==0&&setTimeout(function(){ULSEWi:;l(e,d)},0)}var g=x(a,j);b=g.rangesToFillRequest;var c=g.totalRanges;if(c.length>0){var k=r;E(c,function(a){ULSEWi:;y(c,a,k)})}}return {recordSetComplete:a.length==0,records:f}};this.AddRecordsToCache=function(f){ULSEWi:;for(var b in f){var e=f[b];a[b]=e;h!=null&&h.AddRecord(b);t++;this.fnApplyUpdatesToNewRecord!=null&&this.fnApplyUpdatesToNewRecord(e);if((g==null||!q)&&b in c){delete c[b];if(b in d){for(var i in d[b])e.AddFieldKey(fieldKeycolumnCache[b][i]);delete d[b]}}}};this.AddColumn=function(f,e){ULSEWi:;m();for(var b in a)e[b]!=null&&a[b].AddFieldValue(f,e[b]);for(var b in c)if(e[b]!=null){if(d[b]==null)d[b]={};d[b][f]=e[b]}};this.RemoveColumn=function(c){ULSEWi:;m();for(var b in a)a[b].RemoveFieldValue(c);for(var b in d){delete d[b][c];if(SP.Internal.JS.IsAssocArrayEmpty(d[b]))delete d[b]}};this.ClearRecords=function(d){ULSEWi:;for(var b=0;b<d.length;b++){delete a[d[b]];delete c[d[b]]}};this.SetView=function(a){ULSEWi:;k();b.SetViewMap(a)};this.GetView=function(){ULSEWi:;return b.GetKeys(0,b.GetRecordCount())};this.RecordIdxToKey=function(a){ULSEWi:;return b.GetKeyFromPos(a)};this.KeyToRecordIdx=function(a){ULSEWi:;return b.GetPosFromKey(a)};this.UpdateProperty=function(b,a,c){ULSEWi:;b.SetProp(a,c)};this.SeedInsertedRecord=function(b){ULSEWi:;if(!(b.key() in a)){a[b.key()]=b;t++}this.fnApplyUpdatesToNewRecord!=null&&this.fnApplyUpdatesToNewRecord(b)};this.InsertRecord=function(c,a){ULSEWi:;k();b.InsertRecord(c,a)};this.DeleteRecord=function(a){ULSEWi:;k();b.DeleteRecord(a)};this.GetRecordCount=function(){ULSEWi:;return b.GetRecordCount()};this.IsKeyInView=function(a){ULSEWi:;return b.IsKeyPresent(a)};this.AddRawDataToCache=function(b,g){ULSEWi:;var d=false;for(var e in b)if(!(b[e] in a)){c[b[e]]=g;d=true}if(n&&d){f.push(b);A=SP.JsGrid.AsynchronousTaskManager.RegisterTask(w)}};this.Clear=function(){ULSEWi:;v()};var i=0;function w(){ULSEWi:;if(f.length>0){for(var a=[];i<f[0].length&&a.length<o;i++)f[0][i] in c&&a.push(f[0][i]);if(i==f[0].length){i=0;f.shift()}a.length>0&&l.AddRecordsToCache(p(c[a[0]],a))}return f.length>0}function m(){ULSEWi:;k();r++}function k(){ULSEWi:;if(e!=null)for(var b=e.GetAllCallbacks(),a=0;a<b.length;a++)b[a](false);e=new D}function v(){ULSEWi:;a={};c={};d={};m();b=new I;u(true)}function u(a){ULSEWi:;if(h!=null&&g!=null&&!a)h.SetMaxSize(g);else h=g!=null?new B(20,g):null}function C(i,m,n){ULSEWi:;for(var k=i.pos,g=i.count,o=b.GetKeys(k,g),f=new Array(g),d=0;d<g;d++){var e=o[d],l=a[e];h!=null&&h.TouchRecord(e);if(l!=null)f[d]=l;else{f[d]=null;var j=c[e];if(j!=null)m.push({key:e,blob:j,destArray:f,destIdx:d});else n.push({pos:k+d,key:e})}}return f}function G(d){ULSEWi:;var c=[],b;for(var f in d){b=d[f];var e=SP.Internal.JS.Find(c,function(a){ULSEWi:;return a.blob==b.blob});if(e==null){e={blob:b.blob,keys:[]};c.push(e)}e.keys.push(b.key)}for(var f in c)l.AddRecordsToCache(p(c[f].blob,c[f].keys));for(var f in d){b=d[f];b.destArray[b.destIdx]=a[b.key]}}function y(d,b,f){ULSEWi:;if(f==r){if(b!=null)for(var a=0;a<b.length;a++)l.AddRawDataToCache(b[a].keys,b[a].data);for(var a=0;a<d.length;a++){var c=e.FindRangeObject(d[a].pos);if(c!=null){for(var g in c.callbacks)c.callbacks[g](b!=null);e.RemoveRangeObject(c)}}}}function x(d,i){ULSEWi:;for(var h=0,f=[],a=null,c,b=0;b<d.length;b++){c=d[b].pos;a=e.FindRangeObject(c);if(a==null){var g=F(c,.75);for(var b in g)e.AppendRangeObject(g[b]);f=f.concat(g)}}a=null;for(var b=0;b<d.length;b++){c=d[b].pos;if(a==null||!e.IsPosInRange(c,a)){a=e.FindRangeObject(c);h++;if(a.callbacks==null)a.callbacks=[i];else a.callbacks.push(i)}}return {rangesToFillRequest:h,totalRanges:f}}function B(l,m){ULSEWi:;var f,e=[],c={},b=[],d={},r=0,n=10,p=0,g;function o(j){ULSEWi:;var m=0,i,h,f=0,g=0;this.AddToDeleteCount=function(a){ULSEWi:;if(!SP.JsGrid.AsynchronousTaskManager.TaskRegistered(i))i=SP.JsGrid.AsynchronousTaskManager.RegisterTask(l);m=k(f+a)};this.TotalRemaingToDelete=function(){ULSEWi:;return f};this.NotifyGenUpdated=function(){ULSEWi:;ComputePagesToDelete(f)};function k(c){ULSEWi:;h={};f=0;for(var a=0;a<b.length-3&&f<c;a++){f+=d[b[a]];h[b[a]]=null}}function l(){ULSEWi:;for(var k=0;k<n;k++)if(c[e[g]] in h){var b=e[g],i=c[b];delete a[b];if(d[i]==1)delete h[i];j(b);delete c[b];e.splice(g,1);f--}else g=(g+1)%(e.length-1);return f!=0}}function q(){ULSEWi:;function a(){ULSEWi:;var a=h();b.push(a);d[a]=0}g=new o(j);a();a();f=0}function h(){ULSEWi:;return p++}function i(c){ULSEWi:;var b=g.TotalRemaingToDelete(),a=e.length-m-b;a>0&&g.AddToDeleteCount(a+l);e.push(c)}this.AddRecord=function(a){ULSEWi:;if(c[a]==null){f=k(a,f,Math.ceil((b.length-1)/2));i(a)}};this.SetMaxSize=function(a){ULSEWi:;m=a};this.TouchRecord=function(a){ULSEWi:;if(c[a]!=b[b.length-1]){if(c[a]!=null)j(a);else i(a);k(a,b.length-1)}};function k(g,a,e){ULSEWi:;if(d[b[a]]==l){var f=h();a=e!=null?e:a+1;b.splice(a,0,f);d[f]=0}d[b[a]]++;c[g]=b[a];return a}function j(f){ULSEWi:;var a=c[f],g=d[a];if(g==1){for(var e=0;e<b.length;e++)if(b[e]==a)break;delete d[a];b.splice(e,1);c[f]=-1}else d[a]--}q()}function I(){ULSEWi:;var b,a,d=this;this.SetViewMap=function(c){ULSEWi:;b=c;a=null};this.GetKeys=function(d,b){ULSEWi:;for(var c=new Array(b),a=0;a<b;a++)c[a]=this.GetKeyFromPos(d+a);return c};this.InsertRecord=function(d,c){ULSEWi:;b.splice(d,0,c);a=null};this.DeleteRecord=function(c){ULSEWi:;b.splice(c,1);a=null};this.GetRecordCount=function(){ULSEWi:;return b!=null?b.length:0};this.IsKeyPresent=function(b){ULSEWi:;a==null&&c();return b in a};this.GetKeyFromPos=function(a){ULSEWi:;return b[a]};this.GetPosFromKey=function(b){ULSEWi:;a==null&&c();if(b in a)return a[b];return null};function c(){ULSEWi:;a={};for(var c=b.length-1;c>=0;c--)a[b[c]]=c}}function F(m,n){ULSEWi:;var k=500,f=k*.5,e=k*.5,l=m-1,i=m,b=[],d=j*(1-n),h=true,g=true,a,c=true;while(c&&b.length<j){c=false;if(h&&f>0){a=s(l,d,f,-1);f-=a.scanned;l-=a.scanned+1;h=a.shouldContinue;b=b.concat(a.positions);d=j-b.length;c=true}if(g&&e>0){a=s(i,d,e,1);e-=a.scanned;i+=a.scanned+1;g=a.shouldContinue;b=b.concat(a.positions);d=j-b.length;c=true}}return z(b)}function z(a){ULSEWi:;var e=[];a.sort(function(a,b){ULSEWi:;return a-b});for(var f=a.length,d=Number.NEGATIVE_INFINITY,c=null,b=0;b<f;b++){if(a[b]!=d+1){c=H(a[b],1);e.push(c)}else c.count++;d=a[b]}return e}function s(l,h,m,j){ULSEWi:;for(var g={positions:[],shouldContinue:true,scanned:0},d,n=false,k=b.GetRecordCount(),f=0;f<m;f++){d=l+f*j;if(d<0||d>k){g.shouldContinue=false;break}var i=b.GetKeyFromPos(d);if(!(i in a||i in c||e.FindRangeObject(d)!=null)){g.positions.push(d);h--;if(h<=0)break}}g.scanned=f;return g}function D(){ULSEWi:;var a=[];this.FindRangeObject=function(d){ULSEWi:;var e=null,c=b(d);if(c<a.length&&this.IsPosInRange(d,a[c]))e=a[c];return e};this.AppendRangeObject=function(c){ULSEWi:;var d=b(c.pos);a.splice(d,0,c)};this.RemoveRangeObject=function(c){ULSEWi:;var d=b(c.pos);a.splice(d,1)};this.IsPosInRange=function(b,a){ULSEWi:;return c(b,a)==0};this.IsEmpty=function(){ULSEWi:;return a.length==0};this.GetAllCallbacks=function(){ULSEWi:;for(var b=[],c=0;c<a.length;c++)if(a.callbacks!=null)b=b.concat(a.callbacks);return b};function b(b){ULSEWi:;return SP.Internal.JS.LowerBoundCompare(a,b,function(b,d){ULSEWi:;return c(d,a[b])})}function c(b,a){ULSEWi:;return b<a.pos?1:a.pos+a.count<=b?-1:0}}};SP.JsGrid.Internal.TableManager=function(o,hb,P,G,f,fb,Y,ab,U,Z,F,bb,db){ULSEWi:;var l=0,O,k=[],e=[],s,z,i,c,a,g=0,n=[],b={},m={},d=new SP.JsGrid.Internal.GridPaneConverter(f),p=f.ariaMgr,j=this,v=null,y,cb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(q);this.CellType={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3};this.GetGridPaneConverter=function(){ULSEWi:;return d};this.Dispose=function(){ULSEWi:;I();a=o=null};this.SetPosConverterObj=function(a){ULSEWi:;O=a;d.SetPosConverterObj(a)};this.GetHeaderHeight=function(){ULSEWi:;return a.rows[0].offsetHeight};this.SetHeaderHeight=function(b){ULSEWi:;s=b;if(a.rows.length>0){a.rows[0].style.height=s-1+"px";Z(s)}};this.SetRowHeight=function(a){ULSEWi:;z=SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7?a-1:a};this.InitTable=function(j){ULSEWi:;this.ClearTable();g=0;c=j;i=c?1:0;var f=a.insertRow(-1);f.recordKey="__colheaders";p.OnInsertTableRow(f,null,-1);var d;if(c){var b=document.createElement("th"),e=document.createElement("div");b.style.width=e.style.width=SP.JsGrid.Internal.RowHeaderWidth-1+"px";b.style.padding="0px";b.appendChild(e);a.rows[0].appendChild(b);g++;d=new h(0,0);p.OnInsertRowHeaderCell(b)}this.SetHeaderHeight(s);return d};this.SetColumns=function(a,b){ULSEWi:;if(k.length){u(i,r());l=0}k=a;if(b)d.SetView(k);else d.NotifyColumnsChanged(k);this.OptimizeTableColumns()};this.ClearTable=function(){ULSEWi:;e.length>0&&this.SpliceRows(0,e.length,null,0,null);u(i,r());l=0;a.rows.length>0&&a.deleteRow(0)};this.SpliceRows=function(f,g,c,i){ULSEWi:;var h=i.length,d=h>1;d&&o.removeChild(a);if(f!=null&&g!=0){e.splice(f,g);for(var b=g-1;b>=0;b--)L(f+b)}if(c!=null&&h!=0){Array.prototype.splice.apply(e,[c,0].concat(i));for(var b=0;b<h;b++)M(c+b,e[c+b],d)}d&&o.appendChild(a);B()};this.RenderRows=function(b){ULSEWi:;for(var a in b){var c=b[a];a=+a;L(a);e[a]=c;M(a,c)}if(!SP.Internal.JS.IsAssocArrayEmpty(b))e=[].concat(e);B()};this.InsertColumns=function(c,b){ULSEWi:;var a=t(c);Array.prototype.splice.apply(k,[c,0].concat(b));d.NotifyColumnsChanged(k);a>=i&&a<=g&&D(a,b.length);this.OptimizeTableColumns()};this.RefreshCell=function(a){ULSEWi:;var c=a.GetRecordKey(),b=a.GetFieldKey();E(c,b);var d=a.GetTd();d.innerHTML="";F(a);f.errorMgr.CellHasError(c,b)&&q(c,b)};this.RemoveColumns=function(e,b){ULSEWi:;var a=t(e);if(a>=i&&a<g){var c=b;if(a+b>g)c-=a+b-g;u(a,c)}k.splice(e,b);d.NotifyColumnsChanged(k);this.OptimizeTableColumns()};this.ScrollColumns=function(a){ULSEWi:;var c=H(a),d=r(),b=l;if(a>b){u(i,Math.min(d,a-b));l=a}else if(a<b){l=a;D(i,Math.min(c,b-a))}this.OptimizeTableColumns()};this.ChangeKeys=function(c,f){ULSEWi:;if(d.IsRecordOnScreen(c))for(var e=a.rows.length-1;e>=0;e--)if(a.rows[e].recordKey==c){a.rows[e].recordKey=f;break}if(c in b){b[f]=b[c];delete b[c]}if(c in m){m[f]=m[c];delete m[c]}};this.OptimizeTableColumns=function(){ULSEWi:;var c=H(l),b=r(),a=b-c;if(a<0)D(g,-a);else a>0&&u(g-a,a);B()};this.UpdateErrorFrames=function(){ULSEWi:;for(var a in b)for(var c in b[a])q(a,c,true)};this.GetAllDataCells=function(){ULSEWi:;for(var d=[],b=1;b<a.rows.length;b++)for(var c=i;c<g;c++)d.push(new h(b,c));return d};this.GetSelectAllSquare=function(){ULSEWi:;return c?new h(0,0):null};this.GetRowHeaderByKey=function(a){ULSEWi:;var b;if(c&&d.IsRecordOnScreen(a))b=new h(C(d.GetTopRowIdxForKey(a)),0);return b};this.GetRowHeader=function(b){ULSEWi:;if(c){var a=new h(C(b),0,true,false);return a.bIsInvalid?null:a}return null};this.GetRowHeaders=function(){ULSEWi:;var d=[];if(c)for(var b=1;b<a.rows.length;b++)d.push(new h(b,0));return d};this.GetColumnHeader=function(b){ULSEWi:;var a=new h(0,t(b),true,false);return a.bIsInvalid||a.GetColIdx()==null?null:a};this.GetColumnHeaders=function(){ULSEWi:;for(var b=[],a=i;a<g;a++)b.push(new h(0,a));return b};this.GetColumnHeaderTr=function(){ULSEWi:;return a.rows[0]};this.GetRowHeaderWidth=function(){ULSEWi:;return c?SP.JsGrid.Internal.RowHeaderWidth:0};this.GetRowIdxColIdxFromCoord=function(k){ULSEWi:;for(var f=SP.Internal.DomElement.GetEventLocation(k),m,l,e={},j=a.rows,d=1;d<j.length;d++){var h=j[d],b=SP.Internal.DomElement.GetLocation(h);if(f.y>=b.y&&f.y<b.y+h.offsetHeight){e.rowIdx=x(d);e.top=b.y;e.bottom=b.y+h.offsetHeight;break}}for(var i=a.rows[0].cells,d=c?1:0;d<i.length;d++){var g=i[d],b=SP.Internal.DomElement.GetLocation(g);if(f.x>=b.x&&f.x<b.x+g.offsetWidth){e.colIdx=w(d);e.left=b.x;e.right=b.x+g.offsetWidth;break}}return e};this.GetTdCoords=function(c){ULSEWi:;var b={};if(f.RTL.bEnabled){b.left=a.offsetLeft+c.offsetLeft;b.right=a.offsetLeft+c.offsetLeft+c.offsetWidth+1}else{b.left=a.offsetLeft+c.offsetLeft-1;b.right=a.offsetLeft+c.offsetLeft+c.offsetWidth}if(c.previousSibling!=null){if(v==null){var e=a.rows[0].cells,d=e[f.RTL.bEnabled?0:e.length-1],g=d.offsetWidth-(SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7&&!f.RTL.bEnabled?1:0);v=a.offsetWidth-(d.offsetLeft+g)}b.left+=v;b.right+=v}b.top=a.offsetTop+c.offsetTop-1;b.bottom=a.offsetTop+c.offsetTop+c.offsetHeight;b.width=b.right-b.left;b.height=b.bottom-b.top;return b};this.GetCellByKey=function(b,c){ULSEWi:;if(!O.IsRecordOnScreen(b))return null;var a=d.KeyToIdx(b,c);return a&&this.GetCellByIdx(a.rowIdx,a.colIdx)};this.GetCellByIdx=function(c,b){ULSEWi:;var a=new h(C(c),t(b),true,true);return a.bIsInvalid?null:a};this.GetCellByChildElement=function(i){ULSEWi:;function g(a,b){ULSEWi:;return SP.Internal.JS.FindInArray(a.rows,function(a){ULSEWi:;return a==b})}function f(b,d){ULSEWi:;for(var c=null,a=b.cells.length-1;a>=0;a--)if(b.cells[a]==d){c=a;break}return c}var b=SP.Internal.DomElement.FindAncestorWithProperty(i,"recordKey");if(b==null)return null;var e=b.elem,j=b.child,d=g(a,e),c=f(e,j);return d!=null&&c!=null?new h(d,c):null};this.GetRowCount=function(){ULSEWi:;return e.length()};this.GetColumnCount=function(){ULSEWi:;return r()};this.BeginRowIdx=function(){ULSEWi:;return d.RelRowIdxToRowIdx(0)};this.EndRowIdx=function(){ULSEWi:;return this.BeginRowIdx()+e.length};this.BeginColIdx=function(){ULSEWi:;return l};this.EndColIdx=function(){ULSEWi:;return l+r()};this.GetColumnAutoResizeWidth=function(f){ULSEWi:;for(var e=t(f),d=a.rows,b=0,c=0;c<d.length;c++)b=Math.max(b,d[c].cells[e].scrollWidth);return b};function eb(c){ULSEWi:;var a=c.defaultCellStyle,b=c.gridPaneStyle;y=";vertical-align:middle;white-space:nowrap;overflow:hidden;border-"+f.RTL.right+":"+SP.JsGrid.Style.MakeBorderString(1,b.verticalBorderStyle,b.verticalBorderColor)+";border-bottom:"+SP.JsGrid.Style.MakeBorderString(1,b.horizontalBorderStyle,b.horizontalBorderColor)+";color:"+a.textColor+(a.font!=null?";font-family:"+a.font:"")+";font-size:"+a.fontSize+";font-weight:"+a.fontWeight+";font-style:"+a.fontStyle+";text-align:"+a.textAlign}function ib(){ULSEWi:;f.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,X);f.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,S);eb(f.styleMgr);a=document.createElement("table");a.cellPadding=a.cellSpacing=0;a.style.cssText="table-layout:fixed;width:0px;border-collapse:collapse;background-color:"+f.styleMgr.defaultCellStyle.backgroundColor;a.id=hb+"_mainTable";o.appendChild(a)}function X(a){ULSEWi:;if(d.IsRecordOnScreen(a.recordKey))if(a.bCellCurrentlyHasError&&!(a.recordKey in b&&a.fieldKey in b[a.recordKey]))q(a.recordKey,a.fieldKey);else!a.bCellCurrentlyHasError&&E(a.recordKey,a.fieldKey)}function q(a,c,f){ULSEWi:;var d=j.GetCellByKey(a,c);if(d!=null){var e=d.GetTd();if(!(a in b))b[a]={};if(b[a][c]==null)b[a][c]=f?null:T(e);b[a][c]!=null&&R(e,b[a][c])}}function T(e){ULSEWi:;var d="position:absolute; top:0px; left:0px; width:0px; height:0px;",a={};a.Top=document.createElement("div");a.Right=document.createElement("div");a.Bottom=document.createElement("div");a.Left=document.createElement("div");for(var c in a){var b=a[c];b.style.cssText=d;b.style["border"+c]=SP.JsGrid.Style.MakeBorderString(1,"solid",f.styleMgr.gridPaneStyle.errorRectBorderColor);e.appendChild(b)}return a}function R(f,d){ULSEWi:;var a=j.GetTdCoords(f),c={Top:{left:a.left+1,top:a.top+1,width:a.width-2},Right:{left:a.right-2,top:a.top+1,height:a.height-2},Bottom:{left:a.left+1,top:a.bottom-2,width:a.width-2},Left:{left:a.left+1,top:a.top+1,height:a.height-2}};for(var b in d){var g=d[b];for(var e in c[b])g.style[e]=c[b][e]+"px"}}function Q(a){ULSEWi:;var c=b[a];if(c!=null){for(var d in c)K(a,d,false);delete b[a]}}function E(a,c){ULSEWi:;a in b&&c in b[a]&&K(a,c,true)}function K(a,c,f){ULSEWi:;for(var d in b[a][c])if(d!=null){var e=SP.Internal.DomElement.GetParentElement(b[a][c][d]);e!=null&&e.removeChild(b[a][c][d])}delete b[a][c];if(f)if(SP.Internal.JS.IsAssocArrayEmpty(b[a]))delete b[a]}function S(a){ULSEWi:;if(c&&d.IsRecordOnScreen(a.recordKey))if(a.rowHeaderState!=null)J(a.recordKey,a.rowHeaderState);else A(a.recordKey)}function J(a,b){ULSEWi:;m[a]!=null&&A(a);var f=j.GetRowHeaderByKey(a),e=f.GetTd(),d=b.GetOnClick(),c=b.GetImg().Render(b.GetTooltip(),d!=null?function(b){ULSEWi:;d(b,a);b.stopPropagation();b.preventDefault()}:null);e.innerHTML="";e.appendChild(c);m[a]=c}function A(a,b){ULSEWi:;if(a in m){var d=j.GetRowHeaderByKey(a),c=b==null?d.GetTd():b;N(c);c.removeChild(m[a]);delete m[a]}}function r(){ULSEWi:;return g-i}function x(a){ULSEWi:;return d.RelRowIdxToRowIdx(a-1)}function C(a){ULSEWi:;return d.RowIdxToRelRowIdx(a)+1}function w(a){ULSEWi:;return l+a-i}function t(a){ULSEWi:;return a-l+i}function M(v,m,u){ULSEWi:;var t,e=[],k=v+1,j=a.insertRow(k);j.style.height=z+"px";var r=m!=null&&m!=SP.JsGrid.Internal.LoadErrorState,d=r?m.key():null;j.recordKey=r?d.toString():null;p.OnInsertTableRow(j,m,x(k));if(c){var n=j.insertCell(-1);n.style.cssText=y+";padding-"+f.RTL.left+":4px";t=new h(k,0);p.OnInsertRowHeaderCell(n)}for(var b=i;b<g;b++){var n=j.insertCell(-1);n.style.cssText=y;e.push(new h(k,b));p.OnInsertGridCell(n)}fb(t,e);for(var o=false,b=0;b<e.length;b++){o=F(e[b])||o;if(d!=null)if(f.errorMgr.CellHasError(d,e[b].GetFieldKey())){q(d,e[b].GetFieldKey(),u);u&&SP.JsGrid.AsynchronousCellUpdater.RegisterCell(cb,d,e[b].GetFieldKey())}}var s;c&&(s=f.rowHeaderStateMgr.GetRowHeaderState(d))!=null&&J(d,s);if(!o&&SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7){var l=j.cells.length>0?j.cells[0]:null;if(l!=null&&l.innerHTML!=null&&l.innerHTML.length==0)l.innerHTML="&nbsp;"}}function N(c){ULSEWi:;$clearHandlers(c);for(var b=c.childNodes,a=0;a<b.length;a++)N(b[a])}function L(b){ULSEWi:;var d=a.rows[b+1].recordKey;c&&m[d]!=null&&A(d,a.rows[b+1].cells[0]);Q(d);var e=a.rows[b+1];db(e.recordKey);e.recordKey=null;a.deleteRow(b+1)}function H(b){ULSEWi:;for(var e=P.GetWidth(),c=j.GetRowHeaderWidth(),a=b;a<d.GetVirtualColumnCount()&&c<e;a++)c+=k[a].width;return a-b}function gb(){ULSEWi:;for(var b=j.GetRowHeaderWidth(),a=j.BeginColIdx();a<j.EndColIdx();a++)b+=k[a].width;return b}function D(d,m){ULSEWi:;for(var l=[],c=[],j=a.rows[0],b=0;b<m;b++){var i=document.createElement("th");d==j.cells.length?j.appendChild(i):j.insertBefore(i,j.cells[d]);g++;l.push(new h(0,d+b));p.OnInsertColHeaderCell(i);for(var k=0;k<e.length;k++){var n=a.rows[k+1].insertCell(d+b);n.style.cssText=y;c.push(new h(k+1,d+b));p.OnInsertGridCell(i)}}Y(l,c,s);for(var b=0;b<c.length;b++){F(c[b]);f.errorMgr.CellHasError(c[b].GetRecordKey(),c[b].GetFieldKey())&&q(c[b].GetRecordKey(),c[b].GetFieldKey())}}function u(i,m){ULSEWi:;var f=w(i);while(m-->0){for(var j=k[f].fieldKeys,d=e.length;d>=0;d--){var c=a.rows[d],l=c.cells[i];if(c.recordKey in b)for(var h=0;h<j.length;h++)E(c.recordKey,j[h]);d==0&&U(l,f);c.removeChild(l)}f++;g--}ab()}function B(){ULSEWi:;I();for(var d=null,g=[],l=-1,c=0;c<e.length;c++){var h=e[c]==null?1:e[c]==SP.JsGrid.Internal.LoadErrorState?2:0;if(h!=0)if(h!=l){d={type:h,startIdx:c,count:1};g.push(d)}else d.count++;l=h}if(g.length)for(var p=j.GetRowHeaderWidth(),t=f.RTL.bEnabled?Math.max(0,a.offsetLeft+1):p,r=Math.min(gb()-1,P.GetWidth())-p,k='<table cellpadding="0" cellspacing="0" style="height:100%;width:100%"><tr><td style="border:0px;text-align:center">',i="</td></tr></table>",q=k+G("LoadingMsg")+i,u=k+'<a href="#" tabIndex="-1" title="'+G("RecordFetchError")+'">'+G("RecordFetchError")+"</a>"+i,c=0;c<g.length;c++){var d=g[c],b=document.createElement("div");SP.Internal.DomElement.SetOpacity(b,.75);b.style.position="absolute";b.style.top=z*d.startIdx+s+2-o.offsetTop+"px";b.style.left=t+"px";b.style.width=r+"px";b.style.height=z*d.count-1+"px";b.style.zIndex=100;if(d.type==1){b.innerHTML=q;n.push({div:b})}else{b.innerHTML=u;var m=b.firstChild.firstChild.firstChild.firstChild.firstChild;$addHandler(m,"click",function(){ULSEWi:;bb();return false});n.push({div:b,anchor:m})}o.appendChild(b)}}function I(){ULSEWi:;for(var a=0;a<n.length;a++){n[a].anchor&&$clearHandlers(n[a].anchor);o.removeChild(n[a].div)}n=[]}function W(b,c){ULSEWi:;return b>=(c?1:0)&&b<a.rows.length}function V(a,b){ULSEWi:;return a>=(b&&c?1:0)&&a<g}function h(b,a,d,c){ULSEWi:;if(!d||W(b,c)&&V(a,c)){this.tableRowIdx=b;this.tableColIdx=a}else this.bIsInvalid=true}h.prototype={fieldKey:null,GetTr:function(){ULSEWi:;return a.rows[this.tableRowIdx]},GetTd:function(){ULSEWi:;return a.rows[this.tableRowIdx].cells[this.tableColIdx]},GetRecordKey:function(){ULSEWi:;if(this.tableRowIdx==0)return null;var a=e[this.tableRowIdx-1];return a!=null&&a.recordKey!=null?a.recordKey:this.GetTr().recordKey},GetRecord:function(){ULSEWi:;var a=this.tableRowIdx==0?null:e[this.tableRowIdx-1];return a==SP.JsGrid.Internal.LoadErrorState?null:a},GetFieldKey:function(){ULSEWi:;if(this.tableColIdx==0&&c||this.tableRowIdx==0)return null;if(!this.fieldKey)this.fieldKey=d.IdxToFieldKey(x(this.tableRowIdx),w(this.tableColIdx));return this.fieldKey},GetColumn:function(){ULSEWi:;return this.tableColIdx==0&&c?null:k[this.GetColIdx()]},GetColIdx:function(){ULSEWi:;return this.tableColIdx==0&&c?null:w(this.tableColIdx)},GetRowIdx:function(){ULSEWi:;return this.tableRowIdx==0?null:x(this.tableRowIdx)},Equals:function(a){ULSEWi:;return this.tableRowIdx==a.tableRowIdx&&this.tableColIdx==a.tableColIdx},GetCellType:function(){ULSEWi:;return this.tableColIdx==0&&c?this.tableRowIdx==0?j.CellType.SelectAllSquare:j.CellType.RowHeader:this.tableRowIdx==0?j.CellType.ColumnHeader:j.CellType.Cell}};ib()};SP.JsGrid.Internal.VersionManager=function(k,i,t,s,l,y){ULSEWi:;var b=[],c=[{key:new q(0),version:0}],a=0,f=0,x=1,e=new w,d=new v,g=new u;this.ChangeKeysOnPropUpdates=function(b,a){ULSEWi:;d.ChangeKeys(b,a)};this.GetEarliestPropChangeKeyForRecord=function(b){ULSEWi:;var a=d.GetEarliestChangeKeyForRecord(b);if(a!=null)a=this.GetChangeKeyForVersion(a);return a};this.AddPropChange=function(f,g,a,e,b,c){ULSEWi:;h(a,true)&&d.AddPropChange(f,g,a,e,b,c)};this.MarkPropUpdateInvalid=function(e,f,a,c){ULSEWi:;var b=false;if(h(a,true))b=d.MarkPropUpdateInvalid(e,f,a,c);return b};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;d.ClearAllPropChangesForRecord(a)};this.AddRowInsertChange=function(b,a){ULSEWi:;h(a,true)&&e.AddInsertChange(b,a)};this.AddRowDeleteChange=function(b,a){ULSEWi:;h(a,true)&&e.AddDeleteChange(b,a)};this.AddIndentLevelChange=function(d,c,b,a){ULSEWi:;h(a,true)&&g.AddLevelChange(d,c,b,a)};this.ApplyChangesToRecord=function(a){ULSEWi:;d.ApplyChangesToRecord(a)};this.ApplyChangeKey=function(b){ULSEWi:;this.OnSynchronizeChange!=null&&this.OnSynchronizeChange(b);e.ApplyAllRowInsertChanges(b);g.ApplyAllLevelChanges(b);d.SynchronizeToChange(b);e.ApplyAllRowDeleteChanges(b);a=b.GetVersionNumber()};this.UndoChangeKey=function(b){ULSEWi:;this.OnRollbackChange!=null&&this.OnRollbackChange(b);var c=r(b.GetVersionNumber());a=c.GetVersionNumber();e.UndoAllRowDeleteChanges(b);g.UndoAllLevelChanges(b);d.RollBackChange(b);e.UndoAllRowInsertChanges(b)};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForVersion(b,c,a.GetVersionNumber())};this.OnSynchronizeChange;this.OnRollbackChange;this.OnVacateChange;this.GetChange=function(j,a,b,h){ULSEWi:;var c=j.GetVersionNumber(),k=e.GetChange(c,a,b,h),l=g.GetChange(c,a,b),f=k.concat(l);if(!h)f=f.concat(d.GetChange(c,a,b));return f.sort(i);function i(a,b){ULSEWi:;return a.type-b.type}};this.GetCurrentVersion=function(){ULSEWi:;return a};this.GetCurrentChangeKey=function(){ULSEWi:;return o(a)};this.IsChangeKeyApplied=function(b){ULSEWi:;return b!=null&&b.GetVersionNumber()<=a};this.GetNextVersionKey=function(){ULSEWi:;var a=new q(x++);c.push({key:a,version:a.GetVersionNumber()});a.Reserve();return a};this.ForceReleaseChanges=function(d,e){ULSEWi:;var a,c=0;j(d.GetVersionNumber()+1,e.GetVersionNumber(),b,function(d,b){ULSEWi:;a=a==null?b:a;c++});b.splice(a,c);m()};this.GetChangeKeyForVersion=function(b){ULSEWi:;var a=o(b);return a!=null&&h(a,true)?a:null};this.Clear=function(){ULSEWi:;b=[];e.Clear();g.Clear();d.Clear()};this.ReleaseChanges=function(a,b){ULSEWi:;j(a.GetVersionNumber()+1,b.GetVersionNumber(),c,function(a){ULSEWi:;a.key.Release()});m()};this.ReserveChanges=function(a,b){ULSEWi:;j(a.GetVersionNumber()+1,b.GetVersionNumber(),c,function(a){ULSEWi:;a.key.Reserve()})};this.VacateChange=function(b){ULSEWi:;var a=b.GetVersionNumber();k.eventMgr.FireEvent(SP.JsGrid.EventType.OnVacateChange,new SP.JsGrid.EventArgs.VacateChange(b));this.OnVacateChange!=null&&this.OnVacateChange(b);d.VacateChange(a);e.VacateChange(a);g.VacateChange(a);n.VacateChange(a);p(a,a)};function p(d,e){ULSEWi:;var b=0,a;j(d,e,c,function(d,c){ULSEWi:;a=a==null?c:a;b++});c.splice(a,b)}function j(c,d,b,g){ULSEWi:;for(var e=c==null?0:SP.Internal.JS.LowerBound(b,c,"version"),f=d==null?b.length-1:SP.Internal.JS.LowerBound(b,d,"version"),a=e;a<=f;a++)b[a]!=null&&g(b[a],a)}function h(a){ULSEWi:;var b=a.GetVersionNumber();return !n.ChangeIsVacated(b)}var n=function(){ULSEWi:;var a=[];function b(c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c),d=a[b]!=null&&a[b]==c?a[b]:null;return {idx:b,item:d}}return {VacateChange:function(c){ULSEWi:;var d=b(c);a.splice(d.idx,0,c)},AdvanceBaseline:function(d){ULSEWi:;var c=b(d);a.splice(0,c.idx+(c.item!=null?1:0))},ChangeIsVacated:function(c){ULSEWi:;var a=b(c);return a.item!=null}}}();function q(a){ULSEWi:;this.Reserve=function(){ULSEWi:;var c=SP.Internal.JS.LowerBound(b,a,"version");if(b[c]==null||b[c].version!=a)b.splice(c,0,{version:a,count:1});else b[c].count++};this.Release=function(){ULSEWi:;var c=SP.Internal.JS.LowerBound(b,a,"version");if(b[c].count==1){b.splice(c,1);m()}else b[c].count--};this.GetVersionNumber=function(){ULSEWi:;return a};this.CompareTo=function(b){ULSEWi:;return a-b.GetVersionNumber()}}function r(d){ULSEWi:;for(var b=null,a=0;a<c.length&&c[a].version<d;a++)b=c[a];return b&&b.key}function o(a){ULSEWi:;var b=SP.Internal.JS.BinarySearch(c,a,"version");return c[b].key}function m(){ULSEWi:;var c=b.length>0?b[0]-1:a-1;if(c>f){d.AdvanceBaseline(c);e.AdvanceBaseline(c);g.AdvanceBaseline(c);n.AdvanceBaseline(c);p(f,c-1);f=c}}function u(){ULSEWi:;var b;this.Clear=function(){ULSEWi:;d()};this.AddLevelChange=function(h,f,e,g){ULSEWi:;var c=g.GetVersionNumber(),d=b[c];if(d==null)d=b[c]=[];d.push({recordKey:h,levelDelta:f,adoptedChildrenKeys:e});a>=c&&l(h,f,e,g)};this.ApplyAllLevelChanges=function(a){ULSEWi:;c(a,false)};this.UndoAllLevelChanges=function(a){ULSEWi:;c(a,true)};this.GetChange=function(i,e,g){ULSEWi:;var d;if(e!=null){d=new SP.Utilities.Set;d.AddArray(e)}var f=[],a=b[i];if(a!=null)for(var h=SP.JsGrid.Internal.VersionManager.ChangeType.Level,c=0;c<a.length;c++)if(d==null||d.Contains(a[c].recordKey)){var j=a[c].levelDelta*(g?-1:1);f.push({type:h,recordKey:a[c].recordKey,levelDelta:j,adoptedChildrenKeys:a[c].adoptedChildrenKeys})}return f};this.VacateChange=function(a){ULSEWi:;delete b[a]};this.AdvanceBaseline=function(b){ULSEWi:;for(var a=f;a<b;a++)this.VacateChange(a)};function d(){ULSEWi:;b={}}function c(d,e){ULSEWi:;var c=b[d.GetVersionNumber()];if(c!=null)if(e)for(var a=c.length-1;a>=0;a--)l(c[a].recordKey,-c[a].levelDelta,c[a].adoptedChildrenKeys,d);else for(var a=0;a<c.length;a++)l(c[a].recordKey,c[a].levelDelta,null,d)}d()}function w(){ULSEWi:;var c,b;this.Clear=function(){ULSEWi:;l()};this.AddInsertChange=function(b,a){ULSEWi:;g(b,a)};this.AddDeleteChange=function(b,a){ULSEWi:;f(b,a)};this.ApplyAllRowInsertChanges=function(a){ULSEWi:;d(g,c,a,false,false,true)};this.ApplyAllRowDeleteChanges=function(a){ULSEWi:;d(f,b,a,false,false,false)};this.UndoAllRowInsertChanges=function(a){ULSEWi:;d(f,c,a,true,true,false)};this.UndoAllRowDeleteChanges=function(a){ULSEWi:;d(g,b,a,true,true,true)};this.VacateChange=function(d){ULSEWi:;var a=SP.Internal.JS.BinarySearch(c,d,"version");a!=null&&c.splice(a,1);var a=SP.Internal.JS.function ULSEWi(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="JsGrid.js";return o;}
Type.registerNamespace("SP");Type.registerNamespace("SP.JsGrid");Type.registerNamespace("SP.JsGrid.Internal");Type.registerNamespace("SP.Internal");Type.registerNamespace("SP.Utilities");SP.JsGrid.Internal.ColumnConfigurationDialog=function(c,o,n,b,k){ULSEWi:;var r=false,a,f,e,i,g,d;function p(h,g){ULSEWi:;function e(){ULSEWi:;var b=[],d;this.InitFromColumnConfigGridData=function(g,i){ULSEWi:;for(var h=a.GetCheckSelectionManager().GetCheckedRecordKeys(),e=0;e<g.length;e++){var c=i.GetCachedRecord(g[e]),f=c.key() in h;d=d||f;b.push({fieldKey:c.key(),width:c.GetDataValue("ColWidth"),isVisible:f})}};this.InitFromCurrent=function(){ULSEWi:;for(var d=c.GetColumnArray(),a=0;a<d.length;a++)b.push({fieldKey:d[a].columnKey,width:d[a].width,isVisible:d[a].isVisible})};this.ApplyToCurrent=function(){ULSEWi:;var d=[];indicCol=c.GetColumnByKey(SP.JsGrid.RecordIndicatorCheckboxColumnKey);indicCol!=null&&d.push(indicCol);for(var a=0;a<b.length;a++){var e=c.GetColumnByKey(b[a].fieldKey);e.isVisible=b[a].isVisible;e.width=b[a].width;d.push(e)}return new SP.JsGrid.ColumnInfoCollection(d)};this.IsValidUpdate=function(){ULSEWi:;return d}}if(a.AnyErrors()){alert(SP.JsGrid.Res.columnConfigurationErrorsInGrid);return false}var d=new e,f=new e;d.InitFromColumnConfigGridData(h,g);if(!d.IsValidUpdate()){alert(SP.JsGrid.Res.invalidColumnConfigurationNoColumns);return false}f.InitFromCurrent();b.commandMgr.Execute({Apply:function(){ULSEWi:;k(d.ApplyToCurrent())},Undo:function(){ULSEWi:;k(f.ApplyToCurrent())}},"Column Configuration Update",SP.JsGrid.CommandManager.CommandType.Explicit);return true}function j(n,c){ULSEWi:;function m(){ULSEWi:;for(var b=new Array(c.view.length),a=0;a<b.length;a++)b[a]=c.view[a];return b}function l(b,e,f){ULSEWi:;for(var c=false,d=0;d<b.length;d++){a[e](b[0].keys[0],b[0].keys[b[0].keys.length-1],f||c);c=true}return c}var k=new SP.Utilities.Set;k.AddArray(a.GetSelectedRecordKeys());for(var d,f,b=0;b<c.view.length;b++)if(d==null&&k.Contains(c.view[b]))d=b;else if(d!=null&&f==null&&!k.Contains(c.view[b]))f=b-1;var e;if(d!=null)if(n&&d>0){e=m();SP.Internal.JS.MoveItemInArray(e,d-1,f==null?e.length-1:f)}else if(!n&&f!=null){e=m();SP.Internal.JS.MoveItemInArray(e,f+1,d)}if(e!=null){var p=a.GetSelectedRowRanges(),o=a.GetSelectedColumnRanges(),j=a.GetSelectedCellRanges(),q=a.GetTopRecordIndex();c.topViewIdx=q;c.view=e;a.SetRowView(c);var g=false;g=l(p,"SelectRowRangeByKey",g);g=l(o,"SelectColumnRangeByKey",g);for(var b=0;b<j.length;b++){var i=j[b].rowRange.keys,h=j[b].colRange.keys;a.SelectCellRangeByKey(i[0],i[i.length-1],h[0],h[h.length-1],g)}}}function m(d){ULSEWi:;d.tableCache=new SP.JsGrid.TableCache;for(var h=c.GetColumnArray(),j=[],i=[],k=new SP.JsGrid.RecordFactory(d.tableViewParams.gridFieldMap,"FieldKey"),g=[],f=[],e=0;e<h.length;e++){var b=h[e],a=b.columnKey;if(a!=SP.JsGrid.RecordIndicatorCheckboxColumnKey){j.push(a);i[a]=k.MakeRecord({FieldKey:a,ColWidth:b.width},{ColName:b.name,ColWidth:b.width.toString()},true);b.isVisible&&g.push(a);!b.isHidable&&f.push(a)}}d.tableCache.AddRecordsToCache(i);d.tableViewParams.checkSelectionCheckedRecordKeys=g;d.tableViewParams.checkSelectionCheckboxDisabledRecordKeys=f;d.tableViewParams.rowViewParams.view=j}function l(a){ULSEWi:;a.columns=new SP.JsGrid.ColumnInfoCollection([new SP.JsGrid.ColumnInfo(SP.JsGrid.Res.columnName,null,"ColName",170),new SP.JsGrid.ColumnInfo(SP.JsGrid.Res.columnWidth,null,"ColWidth",145)]);if(n)a.columns.GetColumnByKey("ColWidth").fnGetCellEditMode=function(a){ULSEWi:;return c.GetColumnByKey(a.key()).isResizable?SP.JsGrid.EditMode.ReadWrite:SP.JsGrid.EditMode.ReadOnly};else a.bEditingEnabled=false;a.gridFieldMap={FieldKey:new SP.JsGrid.GridField("FieldKey",true,false),ColName:new SP.JsGrid.GridField("ColName",false,true),ColWidth:new SP.JsGrid.GridField("ColWidth",true,true)};a.gridFieldMap["ColName"].SetEditMode(SP.JsGrid.EditMode.ReadOnly);a.gridFieldMap["ColName"].SetSingleValuePropType(SP.JsGrid.PropertyType.Utils.GetPropType("String"));var d=SP.JsGrid.Internal.Property.GetPropType("JSNumber"),b=SP.Internal.JS.object(d);b.ID="ColWidthJSNumber";b.BeginValidateNormalizeConvert=function(e,f,g,a,c,h){ULSEWi:;d.BeginValidateNormalizeConvert.apply(this,[e,f,g,a,b,h]);function b(a){ULSEWi:;a.isValid=a.isValid&&a.dataValue>0&&a.dataValue<=1e3;c(a)}};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(b,"JSNumber");a.gridFieldMap["ColWidth"].SetSingleValuePropType(b)}this.GetHeight=function(){ULSEWi:;return 360};this.GetWidth=function(){ULSEWi:;return 600};function h(b){ULSEWi:;try{a.Dispose()}catch(c){}$clearHandlers(f);$clearHandlers(e);$clearHandlers(i);$clearHandlers(g);$clearHandlers(d);b!=null&&b()}this.Close=function(){ULSEWi:;h()};this.Open=function(q,k){ULSEWi:;d=q;d.innerHTML='<div style="position:relative;overflow:auto;text-align:'+b.RTL.left+";padding:10px;height:"+(this.GetHeight()-20)+"px;width:"+(this.GetWidth()-20)+'px;"><table><tr><td><div id="'+b.gridId+'_ccGridParentElement" style="height:280px;width:400px;float:'+b.RTL.right+';"></div></td><td style="height:280px;padding-left:10px;vertical-align:middle;"><input id="'+b.gridId+'_ccUp" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.moveUp+'"><div style="height:15px;"></div><input id="'+b.gridId+'_ccDown" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.moveDown+'"></td></tr><tr style="padding-top:15px;"><td><input id="'+b.gridId+'_ccOK" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.ok+'" style="float:'+b.RTL.right+';"></td><td style="padding-left:10px;"><input id="'+b.gridId+'_ccCancel" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.cancel+'"></td></tr></table></div>';var n=$get(b.gridId+"_ccGridParentElement");f=$get(b.gridId+"_ccUp");e=$get(b.gridId+"_ccDown");f.disabled=e.disabled=!o;i=$get(b.gridId+"_ccOK");g=$get(b.gridId+"_ccCancel");a=new SP.JsGrid.JsGridControl(n,false);var c=new SP.JsGrid.JsGridControl.Parameters;c.name=SP.JsGrid.Res.columnConfigurationName;l(c.tableViewParams);m(c);c.tableViewParams.bEditingEnabled=true;c.tableViewParams.bRecordIndicatorCheckboxesEnabled=true;c.tableViewParams.operationalConstantsFieldKeyMap={};c.tableViewParams.bHidableColumns=false;c.tableViewParams.bSortableColumns=false;c.tableViewParams.bAutoFilterableColumns=false;c.tableViewParams.allowedSelectionTypes=SP.JsGrid.SelectionTypeFlags.SingleRowRange|SP.JsGrid.SelectionTypeFlags.SingleColRange|SP.JsGrid.SelectionTypeFlags.SingleCell;c.tableViewParams.messageOverrides={localizedConversionError:SP.JsGrid.Res.columnConfigurationInvalidColumnWidth};a.Init(c);setTimeout(function(){ULSEWi:;a.Focus()},0);$addHandler(f,"click",function(){ULSEWi:;j(true,c.tableViewParams.rowViewParams)});$addHandler(e,"click",function(){ULSEWi:;j(false,c.tableViewParams.rowViewParams)});$addHandler(i,"click",function(){ULSEWi:;if(p(c.tableViewParams.rowViewParams.view,c.tableCache))h(k);else a.Focus()});$addHandler(g,"click",function(){ULSEWi:;h(k)});$addHandler(d,"keydown",function(){ULSEWi:;var b=String.fromCharCode(event.keyCode).toUpperCase(),a=event.ctrlKey;if(a&&b=="Z")c.commandMgr.Undo();else a&&b=="Y"&&c.commandMgr.Redo()})}};SP.JsGrid.Internal.ColumnMenuManager=function(j,c,u,y,d){ULSEWi:;var k=this,h=u||{},f,g,x,a=j.delegateMgr,b=j.jsGridObj,q=false;function z(){ULSEWi:;c=c==null?{}:c;b.AttachEvent(SP.JsGrid.EventType.OnPropertyChanged,n);b.AttachEvent(SP.JsGrid.EventType.OnRecordInserted,o);b.AttachEvent(SP.JsGrid.EventType.OnRecordDeleted,p)}this.Dispose=function(){ULSEWi:;b.DetachEvent(SP.JsGrid.EventType.OnPropertyChanged,n);b.DetachEvent(SP.JsGrid.EventType.OnRecordInserted,o);b.DetachEvent(SP.JsGrid.EventType.OnRecordDeleted,p);q=true};this.SetAutoFilterState=function(a){ULSEWi:;c=a==null?{}:a;this.ClearCache()};this.SeedAutoFilterEntryCache=function(a){ULSEWi:;h=a||{}};this.ClearCache=function(){ULSEWi:;h={}};this.CanExpandMenu=function(b,f,e,c,d){ULSEWi:;return f||d||e&&a.DelegatePresent(SP.JsGrid.DelegateType.Sort)||c&&b.isAutoFilterable&&a.DelegatePresent(SP.JsGrid.DelegateType.GetAutoFilterEntries)&&a.DelegatePresent(SP.JsGrid.DelegateType.AutoFilter)&&a.DelegatePresent(SP.JsGrid.DelegateType.LaunchFilterDialog)||b.columnKey==SP.JsGrid.RecordIndicatorCheckboxColumnKey||a.DelegatePresent(SP.JsGrid.DelegateType.WillAddColumnMenuItems)&&a.Apply(SP.JsGrid.DelegateType.WillAddColumnMenuItems,columnKey)};this.ExpandMenu=function(n,o,A,C,B,z){ULSEWi:;var w=false;function u(){ULSEWi:;w=true;A()}var j=n.columnKey,k,y=SP.Internal.DomElement.GetLocation(b.parentNode);o.left-=y.x;o.top-=y.y;f=new SP.JsGrid.ContextMenu(b.parentNode,b.parentNode.id+"_columnmenuloading");g=k=new SP.JsGrid.ContextMenu(b.parentNode,b.parentNode.id+"_columnmenu");f.EnableCompactMode();g.EnableCompactMode();a.Apply(SP.JsGrid.DelegateType.AddColumnMenuItems,j,e,l);var p=false;if(C&&n.isHidable){i();e(d("HideColumn"),function(){ULSEWi:;b.HideColumn(j)},"/_layouts/Images/jsgrid-hide-column.png");p=true}!p&&i();s();if(B&&a.DelegatePresent(SP.JsGrid.DelegateType.Sort)&&n.isSortable){i();e(d("SortAsc"),function(){ULSEWi:;r(j,false)},"/_layouts/Images/sortaz.gif");e(d("SortDesc"),function(){ULSEWi:;r(j,true)},"/_layouts/Images/sortza.gif")}if(z&&n.isAutoFilterable&&a.DelegatePresent(SP.JsGrid.DelegateType.GetAutoFilterEntries)&&a.DelegatePresent(SP.JsGrid.DelegateType.AutoFilter)&&a.DelegatePresent(SP.JsGrid.DelegateType.LaunchFilterDialog)){i();e(d("ClearFilter"),function(){ULSEWi:;v(j)},"/_layouts/images/"+(j in c?"filteroff.gif":"filteroffdisabled.gif"),null,!(j in c));if(j in h)m(j);else{x=f.InsertMenuItem(d("LoadingMsg"),null,null,null,true);k=f;t(j,function(){ULSEWi:;if(!w&&!q){j in h&&m(j);f.SetOnMouseOut(null);f.Hide();g.Show(o,u)}})}}if(j==SP.JsGrid.RecordIndicatorCheckboxColumnKey){i();e(d("CheckAllRecords"),function(){ULSEWi:;b.GetCheckSelectionManager().CheckAllRecords()},null,null,false,false);e(d("ClearCheckedRecords"),function(){ULSEWi:;b.GetCheckSelectionManager().ClearCheckedRecords()},null,null,false,false)}!k.IsEmpty()&&k.Show(o,u);return !k.IsEmpty()};function s(){ULSEWi:;var a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(f){a="undefined"}var c=a&&SP.UI.ModalDialog.get_childDialog(),b=c&&c.get_url();(b==null||!document.URL.startsWith(b))&&e(d("ConfigureCols"),function(){ULSEWi:;j.paneMgr.ShowColumnConfigurationDialog()},"/_layouts/Images/configcolumns.png")}function m(b){ULSEWi:;function j(a){ULSEWi:;w(b,a.dataValue)}var f=h[b],k=c[b]===""?null:c[b];if(f.length!=0)for(var i=0;i<f.length;i++){var e=f[i];g.InsertMenuItem(e.displayString==null||e.displayString==""?SP.JsGrid.Res.autoFilterBlank:e.displayString,function(a){ULSEWi:;return function(){ULSEWi:;j(a)}}(e),null,null,false,b in c&&y[b].CompareSingleDataEqual(e.dataValue===""?null:e.dataValue,k))}else g.InsertMenuItem(d("FilterMenuItem"),function(){ULSEWi:;a.Apply(SP.JsGrid.DelegateType.LaunchFilterDialog,b)},"/_layouts/images/filter.gif")}function t(i,d){ULSEWi:;for(var f=j.jsGridObj.GetColumns(),e=[],b=0;b<f.length;b++){var g=f[b].columnKey;!(g in h)&&e.push(g)}a.Apply(SP.JsGrid.DelegateType.GetAutoFilterEntries,c,i,e,k,d);function k(a){ULSEWi:;for(var b in a)h[b]=a[b];d()}}function w(e,d){ULSEWi:;var b=SP.Internal.JS.CloneObj(c,false);b[e]=d;a.Apply(SP.JsGrid.DelegateType.AutoFilter,b);k.ClearCache()}function v(d){ULSEWi:;var b=SP.Internal.JS.CloneObj(c,false);delete b[d];a.Apply(SP.JsGrid.DelegateType.AutoFilter,b);k.ClearCache()}function n(a){ULSEWi:;delete h[a.fieldKey]}function o(){ULSEWi:;k.ClearCache()}function p(){ULSEWi:;k.ClearCache()}function e(h,a,e,b,c,d){ULSEWi:;f.InsertMenuItem(h,a,e,b,c,d);g.InsertMenuItem(h,a,e,b,c,d)}function l(){ULSEWi:;f.InsertSeparator();g.InsertSeparator()}function i(){ULSEWi:;!g.IsEmpty()&&l()}function r(c,b){ULSEWi:;a.Apply(SP.JsGrid.DelegateType.Sort,[{columnName:c,isDescending:b}])}z()};SP.JsGrid.CommandManager=function(o){ULSEWi:;var i=0,a=[],e=[],c=0,h=0,d=[],f=SP.JsGrid.CommandManager.CommandType,b,j,g=[];this.IsUndoEnabled=function(){ULSEWi:;return o>0};this.OpenGroup=function(){ULSEWi:;if(b)return;d.push([])};this.CloseGroup=function(f,g,c){ULSEWi:;if(b)return;var a=d.pop();if(a.length==0)return;var e=a.length==1?a[0]:new SP.JsGrid.CommandManager.AggregateCommand(a,c);m(e,f,g)};this.Execute=function(a,c,d){ULSEWi:;if(b){a.Apply();return}n();m(a,c,d);l();j=true;a.Apply();j=false};this.Undo=function(){ULSEWi:;if(i!=0||d.length>0||!c||b||j)return false;l();b=true;var g;do{g=a.pop();g.cmd.Undo();e.push(g)}while(g.type==f.Implicit);c--;h++;b=false;return true};this.Redo=function(){ULSEWi:;if(i!=0||d.length!=0||!h||b||j)return false;l();b=true;var g;do{g=e.pop();g.cmd.Apply();a.push(g)}while(g.type==f.Implicit);h--;c++;b=false;return true};this.CanUndo=function(){ULSEWi:;return c>0};this.CanRedo=function(){ULSEWi:;return h>0};this.GetUndoStack=function(){ULSEWi:;return a};this.GetRedoStack=function(){ULSEWi:;return e};this.ClearUndoStack=function(){ULSEWi:;p()};this.ClearRedoStack=function(){ULSEWi:;n()};this.Lock=function(){ULSEWi:;i++};this.Unlock=function(){ULSEWi:;i=Math.max(i-1,0)};this.AddPreExecuteNotifier=function(a){ULSEWi:;g.push(a)};this.RemovePreExecuteNotifier=function(c){ULSEWi:;for(var b=false,a=0;a<g.length;a++)if(g[a]==c){g.splice(a,1);a--;b=true;break}return b};function l(){ULSEWi:;for(var b=[].concat(g),a=0;a<b.length;a++)b[a]()}function p(){ULSEWi:;for(var b=0;b<a.length;b++)k(a[b].cmd,SP.JsGrid.CommandManager.DisposeState.Applied);a=[];c=0}function n(){ULSEWi:;if(e.length!=0){for(var a=e.length-1;a>=0;a--)k(e[a].cmd,SP.JsGrid.CommandManager.DisposeState.Unapplied);e=[];h=0}}function m(e,g,b){ULSEWi:;if(d.length!=0)d[d.length-1].push(e);else if(c!=0||b!=f.Implicit){a.push({cmd:e,name:g,type:b});c+=b!=f.Implicit?1:0;if(a.length>o){if(a[0].type!=f.Implicit)c--;k(a.shift().cmd,SP.JsGrid.CommandManager.DisposeState.Applied);while(a.length&&a[0].type==f.Implicit)k(a.shift().cmd,SP.JsGrid.CommandManager.DisposeState.Applied)}}}function k(a,b){ULSEWi:;a.Dispose!=null&&a.Dispose(b)}};SP.JsGrid.CommandManager.CommandType={Explicit:0,Implicit:1};SP.JsGrid.CommandManager.DisposeState={Applied:0,Unapplied:1};SP.JsGrid.CommandManager.AggregateCommand=function(b,a){ULSEWi:;this.cmdArray=b;this.bReverseOnUndo=a};SP.JsGrid.CommandManager.AggregateCommand.prototype={Apply:function(){ULSEWi:;for(var b=this.cmdArray.length,a=0;a<b;a++)this.cmdArray[a].Apply()},Undo:function(){ULSEWi:;var b=this.cmdArray.length,a;if(this.bReverseOnUndo)for(a=b-1;a>=0;a--)this.cmdArray[a].Undo();else for(a=0;a<b;a++)this.cmdArray[a].Undo()},Dispose:function(c){ULSEWi:;for(var d=this.cmdArray.length,a=0;a<d;a++){var b=this.cmdArray[a];b.Dispose!=null&&b.Dispose(c)}}};SP.JsGrid.DeserializationMode={Full:0,TableView:1,RowView:2,Slice:3,AutoFilter:4};SP.JsGrid.SelectionTypeFlags={NoRows:0,SingleRow:1,SingleRowRange:3,MultipleRowRanges:7,_RowMask:7,NoCols:0,SingleCol:8,SingleColRange:24,MultipleColRanges:56,_ColMask:56,NoCells:0,SingleCell:64,SingleCellRange:192,MultipleCellRanges:448,_CellMask:448};SP.JsGrid.LinkType={FinishFinish:0,FinishStart:1,StartFinish:2,StartStart:3};SP.JsGrid.ClickContext={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3,Gantt:4,Other:5};SP.JsGrid.SelectionType={None:0,CellRange:1,RowRange:2,ColumnRange:3};SP.JsGrid.EventType={OnCellFocusChanged:0,OnRowFocusChanged:1,OnCellEditBegin:2,OnCellEditCompleted:3,OnRightClick:4,OnPropertyChanged:6,OnRecordInserted:7,OnRecordDeleted:8,OnRecordChecked:9,OnCellErrorStateChanged:10,OnEntryRecordAdded:11,OnEntryRecordCommitted:13,OnEntryRecordPropertyChanged:14,OnRowErrorStateChanged:15,OnDoubleClick:16,OnBeforeGridDispose:17,OnSingleCellClick:18,OnInitialChangesForChangeKeyComplete:19,OnVacateChange:20,OnGridErrorStateChanged:21,OnSingleCellKeyDown:22};SP.JsGrid.Internal.EventType={OnRowHeaderStateChanged:0,OnGridDisposing:1,OnChangeKeyCreated:2,OnChangeKeyInitialUpdateFinished:3,OnBeforeRecordInserted:4,OnBeforeRecordDeleted:5};SP.JsGrid.DelegateType={ExpandColumnMenu:1,AddColumnMenuItems:2,Sort:3,Filter:4,InsertRecord:5,DeleteRecords:6,IndentRecords:7,OutdentRecords:8,IsRecordInsertInView:9,ExpandDelayLoadedHierarchyNode:10,AutoFilter:11,ExpandConflictResolution:12,GetAutoFilterEntries:13,LaunchFilterDialog:14,ShowColumnConfigurationDialog:15,GetRecordEditMode:16,GetGridRowStyleId:17,CreateEntryRecord:18,TryInsertEntryRecord:19,WillAddColumnMenuItems:20};SP.JsGrid.Internal.DelegateType={CallAsyncFn:0,GetLocalizedString:1,DoLargeTask:2};SP.JsGrid.Internal.LoadErrorState={};SP.JsGrid.OperationalConstants={HierarchyMain:0,HierarchyOutlineLevel:1,GroupingOutlineLevel:2,HierarchyDescendantCount:3,GroupingDescendantCount:4,GanttDependants:5,GanttBarStyleIds:6,GridRowStyleId:7,RecordEditMode:8};SP.JsGrid.Internal.MinColumnWidth=37;SP.JsGrid.Internal.RowHeaderWidth=25;SP.JsGrid.Internal.SplitterWidth=6;SP.JsGrid.RecordIndicatorCheckboxColumnKey="JsGridRecordIndicatorCheckboxes";SP.JsGrid.NewRowKeyPrefix="NewRowKey";SP.JsGrid.ErrorWidgetId="ErrorWidget";SP.JsGrid.RecordIndicatorControlId="DISP_RECORDINDICATORCHECKBOX";SP.JsGrid.HierarchyControlId="DISP_HIERARCHY";SP.JsGrid.TextDirection={Default:0,RightToLeft:1,LeftToRight:2};SP.JsGrid.PaneId={MainGrid:0,PivotedGrid:1,Gantt:2};SP.JsGrid.PaneLayout={GridOnly:0,GridAndGantt:1,GridAndPivotedGrid:2};SP.JsGrid.EditMode={ReadOnly:0,ReadWrite:1,ReadOnlyDefer:2,ReadWriteDefer:3,Defer:4};SP.JsGrid.GanttDrawBarFlags={LeftLink:1,RightLink:2};SP.JsGrid.GanttBarDateType={Start:0,End:1};SP.JsGrid.ValidationState={Valid:0,Pending:1,Invalid:2};SP.JsGrid.HierarchyMode={None:0,Standard:1,Grouping:2};SP.JsGrid.EditActorWriteType={Both:1,LocalizedOnly:2,DataOnly:3,Either:4};SP.JsGrid.EditActorReadType={Both:1,LocalizedOnly:2,DataOnly:3};SP.JsGrid.EditActorUpdateType={Committed:0,Uncommitted:1};SP.JsGrid.SortMode={Ascending:1,Descending:-1,None:0};SP.JsGrid.RowHeaderStyleId={Transfer:"Transfer",Conflict:"Conflict"};SP.JsGrid.RowHeaderAutoStyleId={Dirty:"Dirty",Error:"Error",NewRow:"NewRow"};SP.JsGrid.RowHeaderStatePriorities={Dirty:10,Transfer:30,CellError:40,Conflict:50,RowError:60,NewRow:90};SP.JsGrid.UpdateSerializeMode={Cancel:0,Default:1,PropDataOnly:2,PropLocalizedOnly:3,PropBoth:4};SP.JsGrid.UpdateTrackingMode={PropData:2,PropLocalized:3,PropBoth:4};SP.JsGrid.PostViewChangeType={Delete:4,Insert:5,Level:6};SP.JsGrid.ContextMenu=function(f,c){ULSEWi:;var b,a,e=0,d=[],g=this;this.GetMenuElement=function(){ULSEWi:;return a};this.EnableCompactMode=function(){ULSEWi:;a.setAttribute("CompactMode","true")};this.IsOpen=function(){ULSEWi:;return MenuHtc_isOpen(a)};this.IsEmpty=function(){ULSEWi:;return e==0};this.InsertMenuItem=function(g,h,k,f,i,j){ULSEWi:;d.push(h);var b=new SP.JsGrid.MenuItem(CAMOpt(a,g,c+"_onclick("+(d.length-1)+");",k,f!=null?f:g));b.Enable(!i);b.Check(j);e++;return b};this.InsertSeparator=function(){ULSEWi:;CAMSep(a)};this.Hide=function(){ULSEWi:;this.IsOpen()&&MenuHtc_hide()};this.SetOnMouseOut=function(b){ULSEWi:;a._onDestroy=function(){ULSEWi:;g.Dispose();b!=null&&b()}};this.Show=function(c,d){ULSEWi:;this.Hide();b.style.top=c.top+"px";b.style.left=c.left+"px";b.style.width=c.width+"px";b.style.height=c.height+"px";OMenu(a,b,false,false,0);NavigateToMenu(a);this.SetOnMouseOut(d)};this.Refresh=function(){ULSEWi:;this.IsOpen()&&OMenu(a,b,true,false,0)};this.Dispose=function(){ULSEWi:;this.Hide();a._onDestroy=null;if(b!=null&&SP.Internal.DomElement.GetParentElement(b)){b.parentNode.removeChild(b);b=null}if(a!=null&&SP.Internal.DomElement.GetParentElement(a)){a.parentNode.removeChild(a);a=null}window[c+"_onclick"]=null};function h(){ULSEWi:;a=CMenu(c);b=document.createElement("div");b.style.cssText="position:absolute;visibility:hidden";f.appendChild(b);window[c+"_onclick"]=function(a){ULSEWi:;setTimeout(d[a],0)}}h()};SP.JsGrid.MenuItem=function(a){ULSEWi:;this.Enable=function(b){ULSEWi:;a.setAttribute("enabled",b)};this.Check=function(b){ULSEWi:;a.setAttribute("checked",b)}};Type.registerNamespace("SP.JsGrid.DisplayControl");SP.JsGrid.DisplayControl=function(){ULSEWi:;function d(c,f,e,b,d){ULSEWi:;if(c==null)return null;var a=(new SP.JsGrid.Image(c,false)).Render(f,e);if(b)a.className=b;a.style.border="0px";return d?a:{elem:a,fnDispose:function(){ULSEWi:;if(a!=null&&a.Dispose!=null){a.Dispose();a=null}}}}function f(d,c,g,f,h){ULSEWi:;if(d==""||d==null||d==SP.JsGrid.EmptyValue||d==SP.JsGrid.InvalidValue)return null;var b=document.createElement("span"),a;if(c.fnClick!=null){a=document.createElement("a");a.style.cssText=h;b.appendChild(a);a.href="#";$addHandler(a,"click",function(a){ULSEWi:;c.fnClick(a)});$addHandler(a,"keydown",function(a){ULSEWi:;if(a.keyCode==Sys.UI.Key.enter){c.fnClick(a);SP.Internal.DomElement.StopEvent(a)}});a.tabIndex=-1}else a=b;SP.Internal.DomElement.SetTextNoBR(a,d);if(c.toolTip!=null)a.title=c.toolTip;if(f)b.className=f;if(g.textDirection!=SP.JsGrid.TextDirection.Default)b.dir=g.textDirection==SP.JsGrid.TextDirection.RightToLeft?"rtl":"ltr";var e=b;if(c.fnClick!=null)e={elem:b,fnDispose:function(){ULSEWi:;$clearHandlers(a);a=b=e=null}};return e}function e(d,e,c){ULSEWi:;var b=document.createElement("div");b.style.cssText="text-align:center";var a=document.createElement("input");a.type="checkbox";a.tabIndex=-1;b.appendChild(a);a.disabled=d;a.checked=e;if(c!=null){$addHandler(a,"mousedown",function(a){ULSEWi:;SP.Internal.DomElement.StopEvent(a)});$addHandler(a,"click",c)}b={elem:b};b.fnDispose=function(){ULSEWi:;b=null;$clearHandlers(a);a=null};return b}function a(e,c,f,b,g,a){ULSEWi:;if(b!=null&&b.bHyperlink)return function(){ULSEWi:;window.open(b.GetAddress(a))};var d=c.fnShouldLinkSingleValue!=null&&c.fnShouldLinkSingleValue(e,f.key,a,g)&&c.fnSingleValueClicked;return d?function(){ULSEWi:;d(e,f.key,a)}:null}function j(e,c,f,a,d){ULSEWi:;var b=c.fnGetSingleValueTooltip==null?null:c.fnGetSingleValueTooltip(e,f.key,d,a);return b==null?a:b}function b(e,d,f,g,b,c){ULSEWi:;var i=j(e,d,f,b,c),h=a(e,d,f,g,b,c);return {toolTip:i,fnClick:h}}function h(k,i,l,h,e,g,j,f){ULSEWi:;var a=b(k,i,l,h,e,g),c=d(j,a.toolTip,a.fnClick,f);return c==null?[]:[c]}function i(l,k,d,j,a,i,m,h,e){ULSEWi:;var g=b(l,k,d,j,a,i),c=f(a,g,d,h,e);return c==null?[]:[c]}function g(p,n,j,m,e,l,o,g,k){ULSEWi:;var a=b(p,n,j,m,e,l),h=d(o,a.toolTip,a.fnClick,g),i=f(e,a,j,g,k),c=[];h!=null&&c.push(h);i!=null&&c.push(i);return c}function c(d,g,k,l,a,p,h,m,o,i){ULSEWi:;var c=[],f=a.GetImageSource?a.GetImageSource(g,d.data):null,j=o.bEnabled?"jsgrid-control-text-rtl":"jsgrid-control-text";if(a.bMultiValue)for(var e=a.LocStrToLocStrArray(d.localized),b=0;b<e.length;b++){var n=b<e.length-1&&m?e[b]+a.separator:e[b];c=c.concat(h(g,k,l,a.singleValuePropType,n,d.data?d.data[b]:null,f?f[b]:null,j,i))}else c=h(g,k,l,a,d.localized,d.data,f,j,i);return c.length==1?c[0]:c.length==0?null:{multipleChildren:c}}return {ImageDisplayControl:{Id:"DISP_IMAGE",Render:function(g,d,b,e,a,f,j,i){ULSEWi:;return c(g,d,b,e,a,f,h,false,i)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},ImageTextDisplayControl:{Id:"DISP_IMAGETEXT",_styleForLinks:null,Render:function(h,d,b,e,a,f,j,i){ULSEWi:;return c(h,d,b,e,a,f,g,true,i,this._styleForLinks)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},TextDisplayControl:{Id:"DISP_TEXT",_styleForLinks:null,Render:function(g,d,b,e,a,f,j,h){ULSEWi:;return c(g,d,b,e,a,f,i,true,h,this._styleForLinks)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},CheckboxDisplayControl:{Id:"DISP_CHECKBOX",Render:function(d,c,f,g,b,h,a){ULSEWi:;return a.IsGroupingRecordKey(c.key())?null:e(false,b.GetBool(d.data),null)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}},RecordIndicatorCheckboxControl:function(f,a,d,b,c){ULSEWi:;this.Id=f+SP.JsGrid.RecordIndicatorControlId;this.Render=function(n,h){ULSEWi:;var f=h.key();function g(){ULSEWi:;a(f)}return d(f)?null:e(b(f),c(f),g)};this.OnKeyDown=function(b,g,c){ULSEWi:;if(b.keyCode==Sys.UI.Key.space||b.charCode==Sys.UI.Key.space){a(c.key());SP.Internal.DomElement.StopEvent(b);return true}return false};this.FocusNext=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)};this.FocusPrevious=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}},HierarchyDisplayControl:function(k,m,c,f,e,i,h){ULSEWi:;var b=SP.JsGrid.Internal.HierarchyManager.NodeType,g=13,l=4,j=4;this.Id=k+SP.JsGrid.HierarchyControlId;this.Render=function(A,o,q,r,y,w,x,s){ULSEWi:;var p=o.key(),k=c(o),z=k.nodeType==b.Expanded?"/_layouts/Images/minus.gif":k.nodeType==b.Collapsed?"/_layouts/Images/plus.gif":null,a=i(q,o,r.key,w,h(q,o,r.key));if(k.nodeType!=b.Leaf){var l=d(k.nodeType==b.Expanded?"/_layouts/Images/minus.gif":"/_layouts/Images/plus.gif",String.format(k.nodeType==b.Expanded?SP.JsGrid.Res.hierarchyExpanded:SP.JsGrid.Res.hierarchyCollapsed,(k.indent+1).toString()),k.nodeType==b.Expanded?t:u,null,true);l.style["margin"+s.Left]=g*k.indent+j+"px";l.width=9;l.height=9;var n=[{elem:l,fnDispose:v}];if(a!=null&&a.multipleChildren!=null)n=n.concat(a.multipleChildren);else a!=null&&n.push(a);return {multipleChildren:n}}else{if(a!=null){var m=a.multipleChildren!=null?a.multipleChildren[0]:a;if(m.elem!=null)m=m.elem;m.style["margin"+s.Left]=g*(k.indent+1)+"px"}return a}function v(){ULSEWi:;l.Dispose!=null&&l.Dispose();l=null;m=null;n=null}function u(){ULSEWi:;f(p)}function t(){ULSEWi:;e(p)}};this.OnKeyDown=function(d,j,g,m,n,i){ULSEWi:;function h(h){ULSEWi:;var a=c(g);if(h&&a.nodeType==b.Collapsed)f(g.key());else!h&&a.nodeType==b.Expanded&&e(g.key());SP.Internal.DomElement.StopEvent(d)}function k(){ULSEWi:;if(i.bMultiValue)return false;var c=d.ctrlKey&&!d.altKey&&!d.shiftKey;if(c&&d.keyCode==Sys.UI.Key.enter){var b=a(g,m,n,i,j.localized,j.data);if(b!=null){b(d);SP.Internal.DomElement.StopEvent(d);return true}}return false}var l=!d.ctrlKey&&d.altKey&&d.shiftKey;if(l)if(d.keyCode==SP.Internal.Key.plus||d.keyCode==SP.Internal.Key.numpad_plus){h(true);return true}else if(d.keyCode==SP.Internal.Key.minus||d.keyCode==SP.Internal.Key.numpad_minus){h(false);return true}return k()};this.FocusNext=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)};this.FocusPrevious=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}}}}();SP.JsGrid.DisplayControl.Type={Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX"};Type.registerNamespace("SP.JsGrid.EditControl");SP.JsGrid.EditControl={ProxyControl:function(a){ULSEWi:;var b=SP.Internal.JS.object(a),g=false,d=false,c=false,e=false;function f(){ULSEWi:;e=true}b.Dispose=function(){ULSEWi:;e=false;a.Dispose.apply(this,arguments)};b.BindToCell=function(){ULSEWi:;d=true;a.BindToCell.apply(this,arguments)};b.Unbind=function(){ULSEWi:;d=false;a.Unbind.apply(this,arguments)};b.OnBeginEdit=function(){ULSEWi:;c=true;a.OnBeginEdit.apply(this,arguments)};b.OnEndEdit=function(){ULSEWi:;c=false;a.OnEndEdit.apply(this,arguments)};f();return b},EditBoxEditControl:function(c,f){ULSEWi:;var n="jsgrid_editbox",a,k=this,l=c.parentNode,d=f!=null,e=false,b;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;function m(){ULSEWi:;if(d)a=f;else{a=document.createElement("input");a.id=n;a.type="text";a.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;";a.className="jsgrid-control-editbox";a.tabIndex=-1;l.appendChild(a)}a.style.direction=c.RTL.ltr}this.Dispose=function(){ULSEWi:;!d&&$clearHandlers(a)};this.Focus=function(e){ULSEWi:;try{if(e==null){a.focus();a.value=a.value}else if(d){c.OnActivateActor();(e.type=="mousedown"||e.type=="keydown"&&e.keyCode==SP.Internal.Key.F2)&&f()}else{a.focus();if(e.type=="mousedown"||e.type=="keydown"&&e.keyCode==SP.Internal.Key.F2)f();else if(SP.JsGrid.Utility.IsChar(e)){a.value=String.fromCharCode(e.charCode);b.SetCurrentValue({localized:a.value})}}}catch(g){}function f(){ULSEWi:;var c=b.originalValue.localized;a.value=c==null||c==SP.JsGrid.EmptyValue?"":c}};this.BindToCell=function(c){ULSEWi:;b=c;i();if(b.field.textDirection!=SP.JsGrid.TextDirection.Default)a.style.direction=b.field.textDirection==SP.JsGrid.TextDirection.RightToLeft?"rtl":"ltr";a.value=""};this.OnBeginEdit=function(c){ULSEWi:;b.Show(a);e=true;g(true);if(c.type=="mousedown"&&!d)setTimeout(function(){ULSEWi:;k.Focus(c)},0);else k.Focus(c)};this.Unbind=function(){ULSEWi:;a.value=""};this.OnEndEdit=function(){ULSEWi:;var c=b.originalValue.localized;c=c==null||c==SP.JsGrid.EmptyValue?"":c;a.value!=c&&b.SetCurrentValue({localized:a.value});g(false);b.Hide(a);e=false};this.OnCellMove=function(){ULSEWi:;i();e&&b.Show(a)};this.OnValueChanged=function(b){ULSEWi:;a.value=b.localized==null||b.localized==SP.JsGrid.EmptyValue?"":b.localized};function g(b){ULSEWi:;if(b){$addHandler(a,"focus",c.OnActivateActor);$addHandler(a,"blur",c.OnDeactivateActor);!d&&$addHandler(a,"keydown",c.OnKeyDown);$addHandler(a,"keyup",j);$addHandler(a,"mousedown",h)}else{$removeHandler(a,"focus",c.OnActivateActor);$removeHandler(a,"blur",c.OnDeactivateActor);!d&&$removeHandler(a,"keydown",c.OnKeyDown);$removeHandler(a,"keyup",j);$removeHandler(a,"mousedown",h)}}function j(){ULSEWi:;b.SetCurrentValue({localized:a.value})}function i(){ULSEWi:;a.style.width=b.cellWidth-8+"px";a.style.height=b.cellHeight-4+"px"}function h(a){ULSEWi:;a.stopPropagation()}m()},ComboBoxEditControl:function(c){ULSEWi:;var p="jsgrid_combobox",b,d,i=this,k="sentinel",g,j,n=c.parentNode,a,t=true,h,l=[],e;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;function x(){ULSEWi:;d=document.createElement("div");d.id=p;d.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;left:0px;background-color:transparent;";d.style.direction=c.RTL.ltr;n.appendChild(d)}this.Dispose=function(){ULSEWi:;n.removeChild(d)};this.BindToCell=function(g){ULSEWi:;a=g;var e=new SP.UI.ComboBox.SPComboInfo;e.set_itemFocusCallback(r);e.set_multipleSelect(a.propType.bMultiValue);e.set_allowMultiEdits(true);e.set_limitToList(a.propType.bMultiValue||a.propType.GetIsLimitedToList!=null&&a.propType.GetIsLimitedToList());e.set_RTL(c.RTL.bEnabled);e.set_getDataCallback(w);e.set_separatorCharacters(a.propType.separator+" ");e.set_columnCount(2);e.set_columnWidths("0px;1px");e.set_expandSpace(a.cellExpandSpace);e.set_listMaxWidth(200);b=SP.UI.ComboBox.ComboBox.createComboBox(p,k,e);e.set_dropdownStateCallback(q);b.add_valueUpdatedEvent(u);b.add_focusEvent(c.OnActivateActor);b.add_blurEvent(c.OnDeactivateActor);m();f(a.originalValue);$addHandler(d,"keydown",o)};this.Unbind=function(){ULSEWi:;i.OnEndEdit();$removeHandler(d,"keydown",o);a.Hide(d);h=false;b.dispose();while(l.length>0)l.shift()();e=null};this.Expand=function(){ULSEWi:;b.openDropdown();b.get_focusElement().focus()};this.Collapse=function(){ULSEWi:;b.closeDropdown()};this.OnBeginEdit=function(a){ULSEWi:;if(a!=null)if(SP.JsGrid.Utility.IsChar(a)){j=true;i.Expand();b.set_displayText(String.fromCharCode(a.charCode))}else if(a.type=="keydown")if(a.keyCode==SP.Internal.Key.F2){i.Expand();b.set_displayText(b.get_displayText())}else if(a.keyCode==SP.Internal.Key.IMEInput){i.Expand();b.set_displayText("")}};this.OnEndEdit=function(){ULSEWi:;b.commit();b.closeDropdown()};this.OnCellMove=function(){ULSEWi:;b.closeDropdown();m()};this.OnValueChanged=function(a){ULSEWi:;f(a)};function m(){ULSEWi:;d.style.width=a.cellWidth+"px";d.style.height=a.cellHeight+"px";b.get_comboInfo().set_listMaxWidth(Math.max(200,a.cellWidth));a.Show(d);b.notifySetLayout()}function o(d){ULSEWi:;if(d.keyCode==Sys.UI.Key.esc){g=true;setTimeout(function(){ULSEWi:;c.OnKeyDown(d);b.set_currentValue(k);f(a.originalValue);g=false},0)}else c.OnKeyDown(d)}function u(){ULSEWi:;if(g)return;var b=s();if(b){a.SetCurrentValue(b);h=true}}function q(b){ULSEWi:;if(g)return;t=!b;c.bLightFocus=!b;if(b)a.NotifyExpandControl();else if(h){a.NotifyEditComplete();h=false}}function r(b,c){ULSEWi:;var a;if(b!=null){a=b.childNodes[b.childNodes.length-1].firstChild;a.style.backgroundColor=a.origBackgroundColor||""}if(c!=null){a=c.childNodes[c.childNodes.length-1].firstChild;var d=a.origBackgroundColor?SP.JsGrid.Internal.Color.HexStringToColor(a.origBackgroundColor):SP.JsGrid.Internal.Color.MakeColor(1,1,1),e=SP.JsGrid.Internal.Color.MakeAlphaColor(.4,.55,.69,.87);a.style.backgroundColor=SP.JsGrid.Internal.Color.ColorToHexString(SP.JsGrid.Internal.Color.RemoveAlphaChannel(SP.JsGrid.Internal.Color.AlphaBlend(e,d)))}}function v(b,d){ULSEWi:;var c={};if(b.HasDataValue(d))c.data=b.GetData(d);if(b.HasLocalizedValue(d))c.localized=b.GetLocalized(d);if(b.propType!=null&&b.propType.GetDisplayValue!=null)c.localized=b.propType.GetDisplayValue(a.record,c.data,c.localized);return c}function w(b){ULSEWi:;e=[];a.propType.GetItems(g);function d(a,b){ULSEWi:;if(a.fnDispose!=null){l.push(a.fnDispose);a=a.elem}b.appendChild(a)}function g(m){ULSEWi:;if(m==null)b(null,null,false,true);else{var i=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(a.propType);if(a.propType.IsComboBoxTextOnly)i=SP.JsGrid.Internal.Property.GetDisplayControl(SP.JsGrid.DisplayControl.Type.Text);else if(i.Id==SP.JsGrid.DisplayControl.Type.Image)i=SP.JsGrid.Internal.Property.GetDisplayControl(SP.JsGrid.DisplayControl.Type.ImageText);for(var s=a.propType.singleValuePropType||a.propType,o=[],q=[],l=0;l<m.length;l++){var k=v(m[l],a.fieldKey),p=document.createElement("div"),g=document.createElement("div");g.style.cssText="white-space:nowrap;padding:4px";p.appendChild(g);var h=i.Render(k,a.record,a.column,a.field,s,{},c.jsGridObj,c.RTL);if(h!=null)if(h.multipleChildren!=null){c.RTL.bEnabled&&h.multipleChildren.reverse();for(var n=0;n<h.multipleChildren.length;n++)d(h.multipleChildren[n],g)}else d(h,g);if(a.propType.GetStyleId!=null){var r=a.propType.GetStyleId(k.data);if(r!=null){SP.JsGrid.Style.ApplyCellStyle(g,c.styleManager.GetCellStyle(r));g.origBackgroundColor=SP.Internal.DomElement.GetComputedStyle(g,"backgroundColor","background-color")}}e.push(k);o.push([l+1,k.localized]);q.push([document.createElement("div"),p])}b(o,q,false,false)}if(!j)f(a.originalValue);else j=false}}function s(){ULSEWi:;var c=b.get_currentValue();if(c==k)return null;if(a.propType.bMultiValue){if(c!=null);for(var i=[],g=[],h=c.split(";#"),f=0;f<h.length;f++){var d=h[f];if(d!=""){i.push(e[d-1].data);g.push(e[d-1].localized)}}return {data:i,localized:g.join(a.propType.separator)}}else if(c==null||c==""){var j=b.get_displayText();return {localized:j}}else{var d=c;return {data:e[d-1].data,localized:e[d-1].localized}}}function f(c){ULSEWi:;if(e==null){b.set_displayText(c.localized==null?"":c.localized);return}var h=[],d=c.data!=SP.JsGrid.EmptyValue,l=a.propType.bMultiValue?a.propType.singleValuePropType:a.propType,f;if(a.propType.bMultiValue){var g=d?c.data:a.propType.LocStrToLocStrArray(c.localized);if(g!=null)for(var i=0;i<g.length;i++)h.push(j(g[i]))}else{var k=j(d?c.data:c.localized);if(k!=null)h.push(k);else f=c.localized}b.set_currentValue(h.join(";#"));f!=null&&b.set_displayText(f);function j(a){ULSEWi:;var b;if(a!=null)b=SP.Internal.JS.FindInArray(e,d?f:c);return b==null?null:b+1;function f(b){ULSEWi:;var c=l.IsDataEqual;return c==null?b.data==a:c(b.data,a)}function c(b){ULSEWi:;return b.localized==a}}}x()},CheckboxEditControl:function(d){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.DataOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.DataOnly;var l=this,j=d.parentNode,b,c,a,g=false,e=null,h=false;function k(){ULSEWi:;d.bLightFocus=true;c=document.createElement("div");c.style.cssText="position:absolute;top:0px;left:0px;visibility:hidden;text-align:center;background-color:#ffffff;";j.appendChild(c);a=document.createElement("input");a.type="checkbox";a.tabIndex=-1;c.appendChild(a);$addHandler(a,"focus",d.OnActivateActor);$addHandler(a,"blur",d.OnDeactivateActor);$addHandler(document.body,"mouseup",function(i){ULSEWi:;if(g&&!h&&e!=null){var d=SP.Internal.DomElement.GetLocation(a),c=SP.Internal.DomElement.GetEventLocation(i);if(SP.Internal.DomElement.PointInDomElem(c.x,c.y,a,d)&&SP.Internal.DomElement.PointInDomElem(e.x,e.y,a,d)){a.checked=!b.propType.GetBool(b.originalValue.data);f()}}h=false});$addHandler(document.body,"mousedown",function(b){ULSEWi:;var a=SP.Internal.DomElement.GetEventLocation(b);e={x:a.x,y:a.y}});$addHandler(c,"mousedown",function(){ULSEWi:;h=true});$addHandler(c,"focus",function(){ULSEWi:;a.focus()})}this.Dispose=function(){ULSEWi:;$clearHandlers(c);$clearHandlers(a);j.removeChild(c)};this.BindToCell=function(c){ULSEWi:;b=c;g=true;i();a.checked=b.propType.GetBool(b.originalValue.data);$addHandler(a,"keydown",d.OnKeyDown);$addHandler(a,"click",f)};this.OnCellMove=function(){ULSEWi:;i()};function i(){ULSEWi:;c.style.width=b.cellWidth+"px";var d=Math.floor((b.cellHeight-a.clientHeight)/2);c.style.padding=d+"px 0px 0px 0px";c.style.height=b.cellHeight-d+"px";b.Show(c)}this.Unbind=function(){ULSEWi:;g=false;$removeHandler(a,"keydown",d.OnKeyDown);$removeHandler(a,"click",f);b.Hide(c)};this.OnEndEdit=function(){};this.OnValueChanged=function(){ULSEWi:;a.checked=b.propType.GetBool(b.originalValue.data)};this.OnKeyDown=function(b){ULSEWi:;if(b.keyCode==Sys.UI.Key.space||b.charCode==Sys.UI.Key.space){a.checked=!a.checked;f();SP.Internal.DomElement.StopEvent(b);return true}return false};this.OnBeginEdit=function(){ULSEWi:;a.focus()};this.OnEndEdit=function(){};function f(){ULSEWi:;b.SetCurrentValue({data:a.checked});b.NotifyEditComplete()}k()}};SP.JsGrid.EditControl.Type={EditBox:"EDIT_EDITBOX",ComboBox:"EDIT_COMBOBOX",Checkbox:"EDIT_CHECKBOX"};Type.registerNamespace("SP.JsGrid.WidgetControl");SP.JsGrid.WidgetControl={DemoWidget:function(d){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;var g=this,e=d.parentNode,b,a,c;function f(){ULSEWi:;a=document.createElement("div");a.id="mainDiv";a.style.cssText="position:absolute; top:0px;left:0px; visibility:hidden; font-size:10; background-color:#ffffff; line-height:100px; border:4px solid:#333333; height:100px; width:200px; overflow-x:hidden;";e.appendChild(a)}this.Dispose=function(){ULSEWi:;$clearHandlers(a);e.removeChild(a)};this.BindToCell=function(d){ULSEWi:;b=d;a.innerText=b.originalValue.localized==SP.JsGrid.EmptyValue?"":b.originalValue.localized;c=a.offsetHeight};this.Unbind=function(){};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error")).Render(SP.JsGrid.Res.openErrorWidget)};this.Collapse=function(){ULSEWi:;a.style.visibility="hidden";b.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;b.NotifyExpandWidget();var e=b.cellRect;a.style.top=(b.cellExpandSpace.bottom>c||b.cellExpandSpace.top<c?e.y+e.height+3:e.y-c-3)+"px";a.style.left=e.x-(d.RTL.bEnabled?a.offsetWidth-e.width:2)+"px";a.style.visibility=""};this.OnValueChanged=function(b){ULSEWi:;a.innerText=b.localized};f()},ErrorWidget:function(e,i){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var g=SP.JsGrid.ErrorWidgetId,k=this,h=e.parentNode,b,a,c,f,d;function j(){ULSEWi:;e.bLightFocus=true;a=document.createElement("div");a.id=g+"_mainDiv";a.style.cssText="z-index:1;visibility:hidden; font-size:10; position:absolute; top:0px;left:0px; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important";h.appendChild(a);c=document.createElement("input");c.id=g+"_focuselem";c.style.cssText="position:fixed;top:0px;left:-10px;height:0px;width:0px;";c.setAttribute("role","presentation");a.appendChild(c);f=document.createElement("span");f.id=g+"_errorSpan";a.appendChild(f)}this.Dispose=function(){ULSEWi:;h.removeChild(a)};this.BindToCell=function(c){ULSEWi:;b=c;$addHandler(a,"keydown",e.OnKeyDown)};this.Unbind=function(){ULSEWi:;$clearHandlers(a)};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error")).Render(SP.JsGrid.Res.openErrorWidget)};this.Collapse=function(){ULSEWi:;a.style.visibility="hidden";b.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;SP.Internal.DomElement.SetText(f,i.GetMessageForCell(b.record.key(),b.fieldKey));d=a.offsetHeight;var g=b.cellRect;a.style.top=(b.cellExpandSpace.bottom>d||b.cellExpandSpace.top<d?g.y+g.height+3:g.y-d-3)+"px";a.style.left=g.x-(e.RTL.bEnabled?a.offsetWidth-g.width:2)+"px";b.NotifyExpandWidget();a.style.visibility="";c.focus()};this.OnValueChanged=function(){};j()},DateWidget:function(h){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;var e=h.parentNode,c,a,d,b,g=200,k=this,f;function l(){ULSEWi:;a=document.createElement("input");a.id="datewidgetinput-"+e.id;a.style.cssText="display:none;position:absolute;top:0px;left:0px";a.onvaluesetfrompicker=j;a.tabIndex=-1;e.appendChild(a);d=document.createElement("div");d.id=a.id+g_strDatePickerImageID;d.style.cssText="position:absolute;background:transparent;visibility:hidden;height:0px;z-index:-1";e.appendChild(d);b=document.createElement("iframe");b.id=a.id+g_strDatePickerFrameID;b.src="/_layouts/images/blank.gif";b.frameBorder="0";b.scrolling="no";b.title=SP.JsGrid.Res.calendarTitle;b.style.cssText="display:none;position:absolute;width:200px;z-index:1";b.tabIndex=-1;e.appendChild(b);if(window.g_strDateTimeControlIDs==null)g_strDateTimeControlIDs=[];g_strDateTimeControlIDs["JsGridDatePicker"]=a.id}this.Dispose=function(){ULSEWi:;a.onvaluesetfrompicker=null;e.removeChild(a);e.removeChild(d);e.removeChild(b)};this.BindToCell=function(a){ULSEWi:;c=a;f=c.originalValue.localized==SP.JsGrid.EmptyValue?"":c.originalValue.localized};this.Unbind=function(){ULSEWi:;f=null};this.Expand=function(){ULSEWi:;var e=c.cellRect;if(e!=null){d.style.width=e.width+"px";d.style.top=(c.cellExpandSpace.bottom>g||c.cellExpandSpace.top<g?e.y+e.height+3:e.y-g-3)+"px";d.style.left=e.x-(h.RTL.bEnabled?d.offsetWidth-e.width:2)+"px";d.style.visibility="";a.value=f!=null?f:"";c.NotifyExpandWidget();clickDatePicker(a.id,i(),a.value);var j=b.resultfunc;b.resultfunc=function(a){ULSEWi:;a==null&&c.NotifyEditComplete(true);k.Collapse();j(a)}}};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/calendar.gif")).Render(SP.JsGrid.Res.openCalendar)};this.Collapse=function(){ULSEWi:;b.style.display="none";c.NotifyCollapseWidget()};this.OnValueChanged=function(a){ULSEWi:;f=a.localized};function j(){ULSEWi:;c.SetCurrentValue({localized:a.value});c.NotifyEditComplete()}function i(){ULSEWi:;return [SP.Utilities.Utility.getLayoutsPageUrl("iframe.aspx?"),"&cal=",_spRegionalSettings.calendarType,"&lcid=",_spRegionalSettings.localeId,"&langid=",_spPageContextInfo.currentLanguage,"&tz=",_spRegionalSettings.timeZoneOffset,"&ww=",_spRegionalSettings.workDays,"&fdow=",_spRegionalSettings.firstDayOfWeek,"&fwoy=",_spRegionalSettings.firstWeekOfYear,"&hj=",_spRegionalSettings.adjustHijriDays,"&swn=",_spRegionalSettings.showWeeks,"&minjday=109207","&maxjday=2666269","&date="].join("")}l()},AddressBookWidget:function(){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var b,f=this,a;function d(){}this.Dispose=function(){};this.BindToCell=function(a){ULSEWi:;_cellContext=a;b=_cellContext.originalValue.localized==SP.JsGrid.EmptyValue?"":_cellContext.originalValue.localized};this.Unbind=function(){};this.Expand=function(){ULSEWi:;_cellContext.NotifyExpandWidget();var e=(_cellContext.propType.bMultiValue?_cellContext.propType.singleValuePropType:_cellContext.propType).GetPeoplePickerUrl,d=e(_cellContext.fieldKey),b="resizable: yes; status: no; scroll: no; help: no; center: yes; dialogWidth: 575px; dialogHeight: 500px;";commonShowModalDialog(d,b,c);a=true};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/addressbook.gif")).Render(SP.JsGrid.Res.openAddressBook)};this.Collapse=function(){};this.OnValueChanged=function(a){ULSEWi:;b=a.localized==SP.JsGrid.EmptyValue?"":a.localized};function c(e){ULSEWi:;a=false;if(e==null)_cellContext.NotifyEditComplete(true);else{for(var h=SP.Internal.DomElement.GetXmlDomObj(e),d=h.documentElement.childNodes,b=[],f=[],c=0;c<d.length;c++){var g=d[c];b.push(g.getAttribute("DisplayText"));f.push("-1;#"+g.getAttribute("Key"))}b.length!=0&&_cellContext.SetCurrentValue({localized:b.join("; "),data:f.join(";#")});_cellContext.NotifyEditComplete()}_cellContext.NotifyCollapseWidget()}d()},HyperlinkWidget:function(f){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var j="HyperlinkWidgetControl",z=this,t=f.parentNode,a,b,e,c,h,i,d,o,m,p,q,n,g,k,l;function A(){ULSEWi:;b=document.createElement("div");b.id="mainDiv";b.style.cssText="z-index:1; visibility:hidden; position:absolute; top:0px;left:0px; width:290px; background-color:white; border:solid 1px #53A9FF; direction:"+f.RTL.ltr+";";t.appendChild(b);m=String.format("{0}_{1}",j,"addressInput");p=String.format("{0}_{1}",j,"verifyButton");o=String.format("{0}_{1}",j,"displayInput");q=String.format("{0}_{1}",j,"okButton");n=String.format("{0}_{1}",j,"cancelButton");var s=String.format('<DIV style="margin:3px 10px 0px 10px; text-align:{0};"><img src="{1}" alt="{2}" title="{2}" id="{3}" tabIndex="-1" style="cursor:pointer;"/></DIV>',f.RTL.Right,"/_layouts/Images/closexon.png",SP.JsGrid.Res.close,n),A=String.format('<a href="javascript:;" id="{0}" title="{1}" style="float:{2};">{1}</a>',p,SP.JsGrid.Res.testHyperlink,f.RTL.Right),a='<DIV style="margin:3px 10px 9px 10px;"><LABEL for={0}>{1}</LABEL>{3}<DIV style="margin-top:3px;"><INPUT id={0} style="width:268px; padding:0px;" maxLength="1024" type="text"></DIV><DIV style="margin-top:3px;">{2}</DIV></DIV>',g=String.format(a,m,SP.JsGrid.Res.hyperlinkAddress,SP.JsGrid.Res.hyperlinkAddressExample,A),k=String.format(a,o,SP.JsGrid.Res.hyperlinkDisplay,SP.JsGrid.Res.hyperlinkDisplayExample,""),z=String.format('<DIV style="padding:3px 10px 3px 10px; background-color: #53A9FF; text-align:{0}"><a href="javascript:;" title="{1}" id="{2}" style="font-weight:bold; color:#F7F7F7">{1}</a></DIV>',f.RTL.Right,SP.JsGrid.Res.ok,q);b.innerHTML=[s,g,k,z].join("");l=b.offsetHeight;c=$get(m);h=$get(p);e=$get(o);i=$get(q);d=$get(n);$addHandler(e,"keyup",w);$addHandler(i,"click",v);$addHandler(d,"click",r);$addHandler(h,"click",u);$addHandler(b,"keydown",y);$addHandler(b,"mousedown",x)}this.Dispose=function(){ULSEWi:;$clearHandlers(e);$clearHandlers(i);$clearHandlers(d);$clearHandlers(h);$clearHandlers(b);t.removeChild(b)};this.BindToCell=function(b){ULSEWi:;a=b;g=a.originalValue.localized!=SP.JsGrid.EmptyValue?a.originalValue.localized:a.propType.GetAddress(a.originalValue.data);k=a.originalValue.data!=SP.JsGrid.EmptyValue?a.propType.GetAddress(a.originalValue.data):a.originalValue.localized};this.Unbind=function(){};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/link.gif")).Render(SP.JsGrid.Res.editHyperlink)};this.Collapse=function(){ULSEWi:;b.style.visibility="hidden";a.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;var d=a.cellRect;b.style.top=(a.cellExpandSpace.bottom>l||a.cellExpandSpace.top<l?d.y+d.height+3:d.y-l-3)+"px";b.style.left=d.x-(f.RTL.bEnabled?b.offsetWidth-d.width:2)+"px";g=a.originalValue.localized!=SP.JsGrid.EmptyValue?a.originalValue.localized:a.propType.GetAddress(a.originalValue.data);k=a.originalValue.data!=SP.JsGrid.EmptyValue?a.propType.GetAddress(a.originalValue.data):a.originalValue.localized;e.value=g;c.value=k;a.NotifyExpandWidget();b.style.visibility="";c.focus();c.value=c.value};this.OnValueChanged=function(b){ULSEWi:;g=b.localized==null||b.localized==SP.JsGrid.EmptyValue?"":b.localized;k=b.data==null||b.data==SP.JsGrid.EmptyValue?g:a.propType.GetAddress(b.data)};function w(){ULSEWi:;s()}function v(){ULSEWi:;s();a.NotifyEditComplete();z.Collapse()}function r(){ULSEWi:;a.NotifyEditComplete(true)}function u(){ULSEWi:;window.open(c.value||"about:blank")}function s(){ULSEWi:;a.SetCurrentValue({localized:e.value,data:{address:c.value,display:e.value}})}function y(a){ULSEWi:;var b=!a.ctrlKey&&!a.altKey&&!a.shiftKey;if(c())SP.Internal.DomElement.StopEvent(a);else a.stopPropagation();function c(){ULSEWi:;switch(a.keyCode){case Sys.UI.Key.esc:r();return true;case Sys.UI.Key.enter:if(a.target==d)r();else if(a.target==h)u();else v();return true;case Sys.UI.Key.tab:if(b){if(a.target==i){d.focus();return true}}else if(a.shiftKey)if(a.target==d){i.focus();return true}else if(a.target==h){d.focus();return true}}return false}}function x(a){ULSEWi:;a.stopPropagation()}A()}};SP.JsGrid.WidgetControl.Type={Demo:"WIDGET_DEMO",Date:"WIDGET_DATE",AddressBook:"WIDGET_ADDRESSBOOK",Hyperlink:"WIDGET_HYPERLINK"};SP.JsGrid.Internal.MVCController=function(a,e,H){ULSEWi:;var b,m,l=this,f,C,Q=this,d=a.versionMgr=new SP.JsGrid.Internal.VersionManager(a,F,J,I,E,O),p=new SP.JsGrid.Internal.CheckSelectionManager(a),A=a.pendingChangeMgr=new SP.JsGrid.Internal.PendingChangesManager(a),M=new SP.JsGrid.Internal.PropertyUpdateManager(a);a.tableCache.fnApplyUpdatesToNewRecord=function(a){ULSEWi:;d.ApplyChangesToRecord(a)};var i=H?L():null,R=a.editUtil=new N,P=false,k,c,g,o,B,h,n,j={},q={OnPropertiesChanged:function(b,d,c,a){ULSEWi:;l.UpdateProperties(b,d,c,a)},OnNodeExpanded:function(a){ULSEWi:;l.ExpandNode(a)},OnNodeCollapsed:function(a){ULSEWi:;l.CollapseNode(a)},OnFocusedCellChanged:function(a){ULSEWi:;G(a)}};this.GetCurrentDataValue=function(c,e){ULSEWi:;var b=d.GetCurrentValue(c,e);if(b==SP.JsGrid.EmptyValue){var f=a.tableCache.GetCachedRecord(c);b=f!=null?f.GetDataValue(e):null}else b=b.GetData();return b};this.ChangeKeysInVersionMgr=function(b,a){ULSEWi:;d.ChangeKeysOnPropUpdates(b,a)};this.GetEarliestChangeKeyForRecord=function(a){ULSEWi:;return d.GetEarliestPropChangeKeyForRecord(a)};this.GetCurrentLocalizedValue=function(c,e){ULSEWi:;var b=d.GetCurrentValue(c,e);if(b==SP.JsGrid.EmptyValue){var f=a.tableCache.GetCachedRecord(c);b=f!=null?f.GetLocalizedValue(e):null}else b=b.GetLocalized();return b};this.GetPropType=function(e,b){ULSEWi:;var d=a.tableCache.GetCachedRecord(e),c;if(d!=null&&d.GetProp(b)!=null)c=d.GetProp(b).propType;else if(a.entryRecordMgr.IsEntryRecordKey(e)&&a.jsGridParams.tableViewParams.gridFieldMap[b]!=null)c=a.jsGridParams.tableViewParams.gridFieldMap[b].GetPropType();else if(b==SP.JsGrid.RecordIndicatorCheckboxColumnKey)c=SP.JsGrid.Internal.Property.GetPropType("RecordIndicatorCheckBoxBoolean");return c};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;d.ClearAllPropChangesForRecord(a)};this.NotifyDataAvailable=function(){ULSEWi:;a.paneMgr.RefreshAllRows(0)};this.NotifySave=function(){ULSEWi:;i!=null&&i.Clear()};this.ClearChanges=function(){ULSEWi:;a.commandMgr.ClearUndoStack();i!=null&&i.Clear();d!=null&&d.Clear()};this.GetViewEventSinks=function(){ULSEWi:;return q};this.ClearTableView=function(){ULSEWi:;a.entryRecordMgr.NotifyTableViewCleared();a.paneMgr.ClearView()};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForChangeKey(b,c,a)};this.SetTableView=function(b,J,E,v,A,t,H,F,w,m,l,z,q,x,s,j,n,I,G,r,D,h,d,i){ULSEWi:;c=F;g=w;o=J;B=v;k=E;C=A;f=t;y(b,false);p.SetTableView(h,d,i);a.columnMenuMgr!=null&&a.columnMenuMgr.Dispose();a.columnMenuMgr=new SP.JsGrid.Internal.ColumnMenuManager(a,b.autoFilterState,b.autoFilterEntries,k,e);a.paneMgr.SetView(c,o,k,b.topViewIdx,g,H,m,l,z,q,x,s,j,n,I,G,r,D,b.sortState);u(b.sortState,b.filterState,b.autoFilterState)};this.SetRowView=function(b){ULSEWi:;y(b,true);a.columnMenuMgr.SetAutoFilterState(b.autoFilterState);a.columnMenuMgr.SeedAutoFilterEntryCache(b.autoFilterEntries)};function u(e,c,d){ULSEWi:;a.paneMgr.SetSortState(e);var b=new SP.Utilities.Set(d);if(c!=null)b=b.Union(c);a.paneMgr.SetFilterState(b.ToArray())}function y(b,c){ULSEWi:;a.tableCache.SetView(b.view);h=b.hierarchyMode;if(h==SP.JsGrid.HierarchyMode.None)z();else K(h==SP.JsGrid.HierarchyMode.Grouping?b.groupingLevel:null,h==SP.JsGrid.HierarchyMode.Grouping?b.groupingRecordKeyPrefix:null,b.unfilteredHierarchyMgr,b.hierarchyDelayLoadKeys,b.hierarchyState,b.filteredDescCounts);if(c){a.paneMgr.NotifyNewRowStateChanged(true);a.paneMgr.RefreshAllRows(b.topViewIdx);u(b.sortState,b.filterState,b.autoFilterState)}}this.GetHierarchyManager=function(){ULSEWi:;return b};this.GetOutlineLevel=function(a){ULSEWi:;return b.GetOutlineLevel(a)};this.GetDiffTracker=function(){ULSEWi:;return i!=null?i.ExternalAPI:null};this.UpdateProperties=function(f,e,b,d){ULSEWi:;var c;if(b==null){a.commandMgr.OpenGroup();c=this.CreateDataUpdateCmd();b=c.GetChangeKey()}d!=null&&d(b);M.ApplyPropUpdates(f,b);if(c!=null){a.commandMgr.Execute(c,e,SP.JsGrid.CommandManager.CommandType.Explicit);a.commandMgr.CloseGroup(e,SP.JsGrid.CommandManager.CommandType.Explicit,true)}return b};this.InsertHiddenRecord=function(d,c,b){ULSEWi:;if(b!=null&&a.entryRecordMgr.IsEntryRecordKey(b)){alert(e("NoInsertAfterEntryRow"));return null}return x(t(d,false,b,false,false),c)};this.InsertRecordAfter=function(b,c,i,h,d,g,f){ULSEWi:;if(a.entryRecordMgr.IsEntryRecordKey(b)){alert(e("NoInsertAfterEntryRow"));return null}a.tableCache.SeedInsertedRecord(c);return x(t(c.key(),true,b,h,d,g,f),i)};function x(g,c){ULSEWi:;var f;if(g.bIsInView&&h==SP.JsGrid.HierarchyMode.Grouping&&b.GetUnfilteredHierarchyMgr()!=null){alert(e("NoInsertWhenGrouped"));return null}if(c==null){f=l.CreateDataUpdateCmd();c=f.GetChangeKey()}d.AddRowInsertChange(g,c);f!=null&&a.commandMgr.Execute(f,"Insert Record",SP.JsGrid.CommandManager.CommandType.Explicit);return c}this.InsertRecordBefore=function(f,j,i,h){ULSEWi:;var d,e;if(f==null)d=c.RecordIdxToRecordKey(a.tableCache.GetRecordCount()-1);else{var g=c.RecordKeyToRecordIdx(f);e=g==0?null:c.RecordIdxToRecordKey(g-1);if(b!=null&&!b.IsGrouped())d=b.GetAfterKeyFromBeforeKey(f);else d=e}return this.InsertRecordAfter(d,j,i,h,false,e,d!=e)};this.DeleteRecords=function(f,g){ULSEWi:;var h;if(SP.Internal.JS.FindInArray(f,function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)})!=null){alert(e("OpNotSupportedOnEntryRow"));return null}if(r())for(var i=b.GetUnfilteredHierarchyMgr(),c=0;c<f.length;c++){if(b.IsGroupingRecord(f[c])){alert(e("NoDeletingGroupingRow"));return null}if(i!=null&&i.IsKeyPresent(f[c])){alert(e("NoDeletingGroupedHierarchicalRows"));return null}}if(g==null){h=this.CreateDataUpdateCmd();g=h.GetChangeKey()}for(var c=0;c<f.length;c++)d.AddRowDeleteChange(s(f[c]),g);h!=null&&a.commandMgr.Execute(h,"Delete Record",SP.JsGrid.CommandManager.CommandType.Explicit);return g};this.ExpandNode=function(b){ULSEWi:;if(n.Contains(b))a.delegateMgr.Apply(SP.JsGrid.DelegateType.ExpandDelayLoadedHierarchyNode,b);else{var d=c.RecordKeyToRecordIdx(b);a.commandMgr.Execute(v("expand",d),"Expand Node",SP.JsGrid.CommandManager.CommandType.Implicit)}};this.CollapseNode=function(d){ULSEWi:;var b=c.RecordKeyToRecordIdx(d);a.commandMgr.Execute(v("collapse",b),"Collapse Node",SP.JsGrid.CommandManager.CommandType.Implicit)};this.AdjustRecordsIndentLevel=function(c,g,i){ULSEWi:;if(h==SP.JsGrid.HierarchyMode.Grouping){alert(e("NoIndentOutdentWhenGrouped"));return null}if(SP.Internal.JS.FindInArray(c,function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)})!=null){alert(e("OpNotSupportedOnEntryRow"));return null}var k=b.ValidateAndMinimizeKeyList(c);if(k.bLevelZeroFound){alert(e("OutlineLevelChangeNotSupportedOnTopLevel"));return null}c=k.minimizedKeys;for(var f=0;f<c.length;f++){if(g==-1&&!b.CanOutdent(c[f])){alert(e("CannotOutdentFurther"));return null}if(g==1&&!b.CanIndent(c[f]))return null}a.commandMgr.OpenGroup();var l=this.CreateDataUpdateCmd();i=l.GetChangeKey();var j=b!=null&&b.GetUnfilteredHierarchyMgr();if(j!=null&&c.length>1)c=j.GetKeysInOrder(c);for(var f=0;f<c.length;f++){var m=g==1?b.EnsureIndentPreconditionsMet(c[f]):b.EnsureOutdentPreconditionsMet(c[f]);d.AddIndentLevelChange(c[f],g,m,i)}a.commandMgr.Execute(l,null,SP.JsGrid.CommandManager.CommandType.Explicit);a.commandMgr.CloseGroup(g==1?"Indent":"Outdent",SP.JsGrid.CommandManager.CommandType.Explicit,true);return i};this.EnableEditing=function(){ULSEWi:;if(!f){f=true;a.entryRecordMgr.EnsureLastEntryRowExists();a.paneMgr.NotifyNewRowStateChanged();a.paneMgr.NotifyCanEditUpdated();a.ariaMgr.EnableGridEditing(true)}};this.DisableEditing=function(){ULSEWi:;if(f){a.paneMgr.StopEditing(true);a.paneMgr.UnbindEditing(function(){ULSEWi:;a.entryRecordMgr.ClearUncommittedEntryRecords();a.paneMgr.NotifyNewRowStateChanged();a.paneMgr.NotifyCanEditUpdated();a.ariaMgr.EnableGridEditing(false);f=false})}};this.FinalizeEditing=function(b,c){ULSEWi:;if(f){a.paneMgr.StopEditing(false);A.WaitForPendingUpdates(function(){ULSEWi:;if(a.errorMgr.AnyErrors()){c();return}a.entryRecordMgr.TryCommitFirstEntryRecords(function(){ULSEWi:;if(a.entryRecordMgr.AnyUncomittedEntryRecords()){c();return}A.WaitForAllChangeKeysToComplete(b)})})}else b()};this.NotifyHide=function(){ULSEWi:;this.FinalizeEditing(function(){},function(){})};this.MarkPropUpdateInvalid=function(c,e,b,a){ULSEWi:;return d.MarkPropUpdateInvalid(c,e,b,a)};this.GetCurrentChangeKey=function(){ULSEWi:;return d.GetCurrentChangeKey()};this.IsChangeKeyApplied=function(a){ULSEWi:;return d.IsChangeKeyApplied(a)};this.GetChangeKeyForVersion=function(a){ULSEWi:;return d.GetChangeKeyForVersion(a)};this.GetCheckSelectionManager=function(){ULSEWi:;return p!=null?p.ExternalAPI:null};function r(){ULSEWi:;return b!=null&&b.IsGrouped()}function N(){ULSEWi:;this.ValidateAndExpandKeyList=function(a){ULSEWi:;return b&&b.GetUnfilteredHierarchyMgr()&&b.ValidateAndExpandKeyList(a)};this.IsEditingEnabled=function(){ULSEWi:;return f};this.IsNewRowEnabled=function(){ULSEWi:;return C&&f&&!r()};this.GetFieldValueForCopy=function(b,d){ULSEWi:;var c=b.HasLocalizedValue(d)?b.GetLocalizedValue(d):null,a;if(d!=SP.JsGrid.RecordIndicatorCheckboxColumnKey){var f=b.GetProp(d);a=f&&f.propType}else a=SP.JsGrid.Internal.Property.GetPropType("RecordIndicatorCheckBoxBoolean");if(a.GetDisplayValue!=null||a.GetCopyValue!=null){var e=b.HasDataValue(d)?b.GetDataValue(d):null;if(a.GetDisplayValue!=null)c=a.GetDisplayValue(b,e,c);else if(a.GetCopyValue!=null)c=a.GetCopyValue(b,e,c)}return c!=null?c:""};this.CanBindToField=function(c,b,a){ULSEWi:;return this.CanEditField(c,b,a)&&!(a!=null&&a==SP.JsGrid.RecordIndicatorCheckboxColumnKey)};this.CanEditField=function(c,h,d){ULSEWi:;if(!f||c==null)return false;if(!c.bIsNewRow&&g.GetValue(c,SP.JsGrid.OperationalConstants.GroupingOutlineLevel)!=null)return false;if(d!=null&&d==SP.JsGrid.RecordIndicatorCheckboxColumnKey)return true;var e=h!=null&&h.fnGetCellEditMode!=null?h.fnGetCellEditMode(c,d):null;e=e==null?SP.JsGrid.EditMode.Defer:e;var b=c.bIsNewRow?SP.JsGrid.EditMode.ReadWriteDefer:a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.GetRecordEditMode)?a.delegateMgr.Apply(SP.JsGrid.DelegateType.GetRecordEditMode,c):null;b=b==null?g.GetValue(c,SP.JsGrid.OperationalConstants.RecordEditMode):b;b=b==null?SP.JsGrid.EditMode.Defer:b;var j=d!=null&&k[d].GetEditMode()!=null?k[d].GetEditMode():SP.JsGrid.EditMode.Defer,i=Math.min(Math.min(Math.min(b,j),e),B);return i==SP.JsGrid.EditMode.ReadWrite||i==SP.JsGrid.EditMode.ReadWriteDefer||i==SP.JsGrid.EditMode.Defer}}function L(){ULSEWi:;var b=new SP.JsGrid.Internal.DiffTracker(a,function(e,b,a,c){ULSEWi:;return d.GetChange(e,b,a,c)});d.OnSynchronizeChange=function(a){ULSEWi:;return b.NotifySynchronizeToChange(a)};d.OnRollbackChange=function(a){ULSEWi:;return b.NotifyRollbackChange(a)};d.OnVacateChange=function(a){ULSEWi:;return b.NotifyVacateChange(a)};return b}function K(k,j,e,d,f,i){ULSEWi:;z();n=new SP.Utilities.Set;d!=null&&n.AddArray(d);b=new SP.JsGrid.Internal.HierarchyManager(a,c,g,k,j,e,function(a){ULSEWi:;l.ExpandNode(a)},function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)},n,i);f!=null&&b.SetState(f,e);var h=o.GetColumnByKey(g.GetFieldKey(SP.JsGrid.OperationalConstants.HierarchyMain));m=h.fnGetDisplayControlName;if(a.gridControls[SP.JsGrid.HierarchyControlId]==null){a.gridControls[SP.JsGrid.HierarchyControlId]=new SP.JsGrid.DisplayControl.HierarchyDisplayControl(a.gridId,c,function(a){ULSEWi:;return b.GetNodeInfo(a)},q.OnNodeExpanded,q.OnNodeCollapsed,function(d,e,c,f,b){ULSEWi:;return a.paneMgr.GetGridPane().GetContentForCell(d,e,c,f,b)},function(c,b,a){ULSEWi:;return m&&m(b,a)});SP.JsGrid.PropertyType.Utils.RegisterDisplayControl(a.gridControls[SP.JsGrid.HierarchyControlId].Id,a.gridControls[SP.JsGrid.HierarchyControlId],[])}h.fnGetDisplayControlName=function(){ULSEWi:;return a.gridControls[SP.JsGrid.HierarchyControlId].Id};c.SetHierarchyMgrObj(b)}function z(){ULSEWi:;if(b!=null){o.GetColumnByKey(g.GetFieldKey(SP.JsGrid.OperationalConstants.HierarchyMain)).fnGetDisplayControlName=m;c.SetHierarchyMgrObj(null);b=null}}function G(b){ULSEWi:;var c=b.oldRecordKey;b.newRecordKey!=c&&a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowFocusChanged,new SP.JsGrid.EventArgs.RowFocusChanged(b.newRecordKey,b.oldRecordKey));a.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellFocusChanged,b)}this.AttachUndoActionToChangeKey=function(b,c){ULSEWi:;var a=b.GetVersionNumber();if(j[a]==null)j[a]=[];j[a].push(c)};this.CreateDataUpdateCmd=function(e){ULSEWi:;var c=false,b=d.GetNextVersionKey();a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyCreated,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b));b.Reserve();return {Apply:function(){ULSEWi:;a.paneMgr.ClearAllChangeIndications();d.ApplyChangeKey(b);!c&&!e&&a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b));c=true},Undo:function(){ULSEWi:;a.paneMgr.ClearAllChangeIndications();d.UndoChangeKey(b);var c=j[b.GetVersionNumber()];if(c!=null)for(var e=c.length-1;e>=0;e--)c[e]();j[b.GetVersionNumber()]=null},Dispose:function(a){ULSEWi:;a==SP.JsGrid.CommandManager.DisposeState.Unapplied&&d.VacateChange(b);b.Release()},GetChangeKey:function(){ULSEWi:;return b},NotifyInitialUpdateComplete:function(){ULSEWi:;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b))}}};function v(g,d){ULSEWi:;function e(){ULSEWi:;var f=c.RecordIdxToRecordKey(d),g=b.NotifyCollapse(d,f),e=c.RecordIdxToViewIdx(d);a.paneMgr.NotifyChangedRows(e,1);a.paneMgr.NotifyDeleteRows(e+1,g);a.paneMgr.ScrollCellIntoView(e,null);a.cutcopypasteMgr.CancelMode()}function f(){ULSEWi:;var f=c.RecordIdxToRecordKey(d),g=b.NotifyExpand(d,f),e=c.RecordIdxToViewIdx(d);a.paneMgr.NotifyChangedRows(e,1);a.paneMgr.NotifyInsertRows(e+1,g,true);a.paneMgr.ScrollCellIntoView(e,null);a.cutcopypasteMgr.CancelMode()}return g=="collapse"?{Apply:e,Undo:f}:{Apply:f,Undo:e}}function F(d,f,b,j,h,o,l,k,i){ULSEWi:;a.cutcopypasteMgr.CancelMode();var c=null,n=l!=null?l:a.entryRecordMgr.IsEntryRecordKey(d)?a.entryRecordMgr.GetEntryRecord(d):a.tableCache.GetCachedRecord(d);if(b==null)b=new SP.JsGrid.Internal.PropertyUpdate(null,"");var g=new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.EmptyValue,SP.JsGrid.EmptyValue);if(n!=null){var m=true;c=n.GetProp(f);if(c!=null){g.localized=c.HasLocalizedValue()?c.GetLocalized():SP.JsGrid.EmptyValue;g.data=c.HasDataValue()?c.GetData():SP.JsGrid.EmptyValue;if(g.data!=b.data||g.localized!=b.localized)c.Update(b.data,b.localized);else m=false}m&&a.paneMgr.NotifyUpdateProperty(d,f,true,b,h,j)}a.errorMgr.ClearAllErrorsOnCell(d,f);var q=SP.JsGrid.Internal.MakeCellKey(d,f);if(h==SP.JsGrid.ValidationState.Invalid){var p=k!=null?k:b.localized!=SP.JsGrid.EmptyValue?String.format(e("LocalizedConversionError"),b.localized):e("GeneralConversionError");a.errorMgr.SetCellError(d,f,p)}if(!o)if(!a.entryRecordMgr.IsEntryRecordKey(d))a.eventMgr.FireEvent(SP.JsGrid.EventType.OnPropertyChanged,new SP.JsGrid.EventArgs.PropertyChanged(d,f,i==null?g:i,b,c&&c.propType,j,h));else a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,new SP.JsGrid.EventArgs.PropertyChanged(d,f,i==null?g:i,b,c&&c.propType,j,h))}function E(g,i,e){ULSEWi:;a.cutcopypasteMgr.CancelMode();for(var f=i==1?b.NotifyIndent(g,e&&e[0]):b.NotifyOutdent(g),d=0;d<f.length;d++){var h=f[d];a.paneMgr.NotifyChangedRows(c.RecordKeyToViewIdx(h.startingRecordKey),h.count)}}function D(c,b,e){ULSEWi:;var d=false,a=null;if("visualAfterRecordKey" in c){d=true;a=c.visualAfterRecordKey;while(a!=null&&b!=null&&b[a]!=null){a=b[a].visualAfterRecordKey;if(e(a))a=null}}return w(c.afterRecordKey,a,d)}function J(d,j,g,i){ULSEWi:;a.cutcopypasteMgr.CancelMode();if(g(d.recordKey))return null;var e=null;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordInserted,new SP.JsGrid.Internal.EventArgs.RecordInserted(d.recordKey));if(d.bIsInView){var e=D(d,i,g),f;if(b!=null)f=b.NotifyInsertRowAfter(d.afterRecordKey,e,d.recordKey,d.newOutlineLevel);a.tableCache.InsertRecord(e,d.recordKey);if(!d.bDoNotUpdatePaneOnFirstInsert)a.paneMgr.NotifyInsertRows(c.RecordIdxToViewIdx(e),1,d.bUpdateFocusPos,h);else{delete d.bDoNotUpdatePaneOnFirstInsert;h()}}a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordInserted,new SP.JsGrid.EventArgs.RecordInserted(d.recordKey,e,d.afterRecordKey,j));return d;function h(){ULSEWi:;if(f!=null){var b=c.RecordKeyToViewIdx(f);b!=null&&a.paneMgr.NotifyChangedRows(b,1)}}}function I(h,q,p){ULSEWi:;a.cutcopypasteMgr.CancelMode();var o=[],f=[h.recordKey];if(p(h.recordKey))return null;if(b!=null&&b.GetUnfilteredHierarchyMgr()!=null&&h.bIsInView){var i=b.ValidateAndExpandKeyList(f);if(i.bGroupingRowFound){alert(e("NoDeletingGroupingRow"));return null}if(i.bLevelZeroFound){alert(e("DeleteNotSupportedOnTopLevel"));return null}if(!i.bAllChildKeysInView){alert(e("NoDeletingParentWithMissingChildren"));return null}f=i.expandedKeys;f.sort(function(a,b){ULSEWi:;return c.RecordKeyToRecordIdx(b)-c.RecordKeyToRecordIdx(a)})}for(var k=0;k<f.length;k++){var d=f[k],m=d==h.recordKey?h:s(d),j,g=null;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordDeleted,new SP.JsGrid.Internal.EventArgs.RecordDeleted(d));if(m.bIsInView){g=c.RecordKeyToRecordIdx(d);var n=c.RecordIdxToViewIdx(g);if(b!=null){var l=b.GetParentKey(d);j=l&&c.RecordKeyToViewIdx(l);b.NotifyDeleteRow(d,g)}a.tableCache.IsKeyInView(d)&&a.tableCache.DeleteRecord(g);n!=null&&a.paneMgr.NotifyDeleteRows(n,1);j!=null&&a.paneMgr.NotifyChangedRows(j,1)}a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordDeleted,new SP.JsGrid.EventArgs.RecordDeleted(d,g,q));o.push(m)}return o}function s(e){ULSEWi:;var f=a.tableCache.IsKeyInView(e),j=f?c.RecordKeyToRecordIdx(e):null,d=null,i=0,h,g;if(f){d=j==0?null:c.RecordIdxToRecordKey(j-1);if(b!=null&&b.GetUnfilteredHierarchyMgr()!=null){var k=b.GetInsertAfterInfoForDelete(e);g=true;h=d;d=k.insertAfterKey;i=k.outlineLevel}}var l=new SP.JsGrid.Internal.RowUpdate(e,d,i,f,true,false,h,g);return l}function t(j,f,a,i,h,d,e){ULSEWi:;var g=0;if(f&&b!=null&&!b.IsGrouped())g=b.GetInsertAfterInfoForInsert(a,c.RecordIdxToRecordKey(w(a,d,e)));return new SP.JsGrid.Internal.RowUpdate(j,a,g,f,i,h,d,e)}function O(b){ULSEWi:;return a.tableCache.GetCachedRecord(b)}function w(d,h,g){ULSEWi:;var e=!g?d:h,a=e==null?null:c.RecordKeyToRecordIdx(e);if(g&&e!=null&&a==null)a=d==null?null:c.RecordKeyToRecordIdx(d);var f=a==null?0:a+1;if(r())f=b.GetNextNonGroupingIdx(f);return f}};SP.JsGrid.Internal.RowUpdate=function(h,g,f,c,b,a,d,e){ULSEWi:;this.recordKey=h;this.afterRecordKey=g;this.newOutlineLevel=f;if(c)this.bIsInView=c;if(b)this.bUpdateFocusPos=b;if(a)this.bDoNotUpdatePaneOnFirstInsert=a;if(e)this.visualAfterRecordKey=d};SP.JsGrid.Internal.CheckSelectionManager=function(b){ULSEWi:;b.checkSelMgr=this;var a=new SP.Utilities.Set,e,c=new SP.Utilities.Set,d=new SP.Utilities.Set,k=this;function p(){ULSEWi:;e=0;var a=b.gridControls[SP.JsGrid.RecordIndicatorControlId]=new SP.JsGrid.DisplayControl.RecordIndicatorCheckboxControl(b.gridId,m,h,g,k.IsRecordIndicatorCheckboxChecked);SP.JsGrid.PropertyType.Utils.RegisterDisplayControl(a.Id,a,[])}function h(c){ULSEWi:;if(d.Contains(c))return true;var a=b.controller.GetHierarchyManager();return a!=null&&a.IsGroupingRecord(c)}function g(a){ULSEWi:;return c.Contains(a)}function o(b){ULSEWi:;!a.Contains(b)&&j(b)}function n(b){ULSEWi:;a.Contains(b)&&j(b)}function i(c,g){ULSEWi:;b.commandMgr.Execute({Apply:function(){ULSEWi:;d(g)},Undo:function(){ULSEWi:;d(!g)}},"ChangeIndicatorCheckBox",SP.JsGrid.CommandManager.CommandType.Explicit);function d(g){ULSEWi:;if(g){for(var d in c.GetCollection())if(!a.Contains(d)){a.Add(d);++e}}else for(var d in c.GetCollection())if(a.Contains(d)){a.Remove(d);--e}f(null);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordChecked,new SP.JsGrid.EventArgs.RecordChecked(c,g))}}function j(c){ULSEWi:;b.commandMgr.Execute({Apply:d,Undo:d,Dispose:function(){ULSEWi:;d=null}},"ChangeIndicatorCheckBox",SP.JsGrid.CommandManager.CommandType.Explicit);function d(){ULSEWi:;if(h(c)||g(c))return;var d=!k.IsRecordIndicatorCheckboxChecked(c);if(d){a.Add(c);++e}else{a.Remove(c);--e}f(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordChecked,new SP.JsGrid.EventArgs.RecordChecked((new SP.Utilities.Set).AddArray([c]),d))}}function m(d){ULSEWi:;j(d);if(k.IsRecordIndicatorCheckboxChecked(d)){var b=l(SP.JsGrid.RecordIndicatorCheckboxColumnKey);if(b.Contains(d)){for(var c in b)(a.Contains(c)||h(c)||g(c))&&b.Remove(c);i(b,true)}}}function l(f){ULSEWi:;for(var g=b.jsGridObj.GetSelectedRowRanges(),e=b.jsGridObj.GetSelectedColumnRanges(),d=b.jsGridObj.GetSelectedCellRanges(),c=new SP.Utilities.Set,a=0;a<e.length;a++)if(SP.Internal.JS.FindInArray(e[a].keys,function(a){ULSEWi:;return a==f})!=null){c.AddArray(b.tableCache.GetView());break}if(c.IsEmpty()){for(var a=0;a<g.length;a++)c.AddArray(g[a].keys);for(var a=0;a<d.length;a++)SP.Internal.JS.FindInArray(d[a].colRange.keys,function(a){ULSEWi:;return a==f})!=null&&c.AddArray(d[a].rowRange.keys)}return c}function f(a){ULSEWi:;b.paneMgr.NotifyUpdateProperty(a,SP.JsGrid.RecordIndicatorCheckboxColumnKey,false,null)}this.IsRecordIndicatorCheckboxChecked=function(b){ULSEWi:;return a.Contains(b)};this.SetTableView=function(g,f,b){ULSEWi:;d=new SP.Utilities.Set;d.AddArray(g);c=new SP.Utilities.Set;c.AddArray(f);a=new SP.Utilities.Set;a.AddArray(b);e=b.length};this.ExternalAPI={CheckAllRecords:function(){ULSEWi:;for(var f=b.tableCache.GetView(),e=new SP.Utilities.Set,d=0;d<f.length;d++){var c=f[d];!a.Contains(c)&&!h(c)&&!g(c)&&e.Add(c)}i(e,true)},ClearCheckedRecords:function(){ULSEWi:;var b=a.Clone();i(b,false)},EnableRecordCheckbox:function(a){ULSEWi:;if(c.Contains(a)){c.Remove(a);f(a)}},DisableRecordCheckbox:function(a){ULSEWi:;if(!c.Contains(a)){c.Add(a);f(a)}},ShowRecordCheckbox:function(a){ULSEWi:;if(d.Contains(a)){d.Remove(a);f(a)}},HideRecordCheckbox:function(a){ULSEWi:;if(!d.Contains(a)){d.Add(a);f(a)}},CheckRecord:o,UncheckRecord:n,AnyRecordsChecked:function(){ULSEWi:;return !a.IsEmpty()},GetCheckedRecordKeys:function(){ULSEWi:;return a.GetCollection()},GetCheckedRecordCount:function(){ULSEWi:;return e},GetHiddenCheckboxRecordKeys:function(){ULSEWi:;return d.GetCollection()},GetDisabledCheckboxRecordKeys:function(){ULSEWi:;return c.GetCollection()}};p()};SP.JsGrid.Internal.CutCopyPasteManager=function(a,c){ULSEWi:;var m=SP.JsGrid.SelectionType,b,e=new SP.JsGrid.Internal.ClipboardManager,f=this;this.GetLastOperation=function(){ULSEWi:;return b&&{gridPane:b.gridPane,rowRange:b.rowRange,colRange:b.colRange,opType:b.opType}};this.CheckClipboard=function(){ULSEWi:;b!=null&&!g()&&this.CancelMode()};this.IsSelectionCopyable=function(b){ULSEWi:;return a.selectionMgr.GetRowRanges(b).length+a.selectionMgr.GetColumnRanges(b).length+a.selectionMgr.GetCellRanges(b).length==1};this.CancelMode=function(){ULSEWi:;var a=b&&b.gridPane;b=null;a!=null&&a.NotifyCopyOperationUpdated()};this.OnCopy=function(e){ULSEWi:;var b=a.selectionMgr.GetLastSelectionRangeNormalized();if(b==null)return;var d=b.rowRange,g=b.colRange,f=e.GetGridPaneConverter(),c;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return c=f.GetRecordsInvolved(d.begin,d.Size(),function(b){ULSEWi:;c=b;a()})},function(){ULSEWi:;h(e,c,d,g,"copy",false)})};this.OnCut=function(e){ULSEWi:;if(!a.editUtil.IsEditingEnabled()){alert(c("GridNotEditable"));return}var g=a.selectionMgr.GetLastSelectionRangeNormalized();if(g==null)return;var b=g.rowRange,o=g.colRange,i=e.GetGridPaneConverter(),p=a.editUtil.IsNewRowEnabled()&&b.end==i.GetVirtualRowCount()-a.entryRecordMgr.GetEntryRecords().length,n=i.GetRecordKeysInvolved(b.begin,b.Size()),d;if(p){alert(c("OpNotSupportedOnEntryRow"));return}var f=a.selectionMgr.GetLastSelectionType()==m.RowRange&&a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.DeleteRecords);if(f){if(e.Id!=SP.JsGrid.PaneId.MainGrid){alert(c("NoCuttingRowsInPane"));return}var j=a.editUtil.ValidateAndExpandKeyList(n);if(j!=null){if(!j.bAllChildKeysInView){alert(c("NoDeletingParentWithMissingChildren"));return}if(j.expandedKeys.length!=n.length){alert(c("NoCuttingParentWithoutChildren"));return}}}a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return d=i.GetRecordsInvolved(b.begin,b.Size(),function(b){ULSEWi:;d=b;a()})},function(){ULSEWi:;if(f){if(l(d)){alert(c("NoCuttingReadOnlyRows"));return}}else if(k(e,d,b,o)){alert(c("NoCuttingReadOnlyCells"));return}h(e,d,b,o,"cut",f)})};this.OnPaste=function(l){ULSEWi:;if(!a.editUtil.IsEditingEnabled()){alert(c("GridNotEditable"));return}if(!this.IsSelectionCopyable(l)){alert(c("MultipleSelections"));return false}var h=j();if(h==null)return;var e=a.selectionMgr.GetLastSelectionRangeNormalized();if(e==null)return;var m=0,v=0,d;if(b!=null&&b.opType=="cut"&&g()){d={gridPane:b.gridPane,rowRange:b.rowRange,colRange:b.colRange,causesRowDelete:b.bCutCausesRowDelete};if(d.causesRowDelete){m=d.gridPane==l&&d.rowRange.begin<e.rowRange.begin?d.rowRange.Size():0;v=d.rowRange.Size();if(l.Id!=SP.JsGrid.PaneId.MainGrid){alert(c("NoPastingRowsInPane"));return}var D=new SP.Utilities.Range(e.rowRange.begin,e.rowRange.begin+d.rowRange.Size()-1);if(D.Overlaps(d.rowRange)){alert(c("CutPasteRowOverlap"));return}}}var u=e.colRange.Size(),t=e.rowRange.Size(),r=l.GetGridPaneConverter(),n,p=r.GetVirtualRowCount();if(a.editUtil.IsNewRowEnabled()){var w=a.entryRecordMgr.GetEntryRecords().length;n=e.rowRange.begin==p-w;p-=w}if(e.colRange.begin+h.width>r.GetVirtualColumnCount()||!n&&e.rowRange.begin-m+h.height>p-v){alert(c("NoRoomToPaste"));return}var A=u%h.width==0,B=t%h.height==0,F=d==null&&A&&(B||t<h.height)?u:h.width,E=d==null&&B&&(A||u<h.widfth)?t:h.height,k=new SP.Utilities.Range(e.rowRange.begin,e.rowRange.begin+E-1),s=new SP.Utilities.Range(e.colRange.begin,e.colRange.begin+F-1);a.commandMgr.OpenGroup();var o,q;if(d!=null)C(function(){ULSEWi:;x(function(){ULSEWi:;z(y)})});else x(function(){ULSEWi:;z(y)});function C(b){ULSEWi:;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return o=d.gridPane.GetGridPaneConverter().GetRecordsInvolved(d.rowRange.begin,d.rowRange.Size(),function(b){ULSEWi:;o=b;a()})},b)}function x(b){ULSEWi:;if(!n)a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return q=r.GetRecordsInvolved(k.begin,k.Size(),function(b){ULSEWi:;q=b;a()})},b);else b()}function z(b){ULSEWi:;f.CancelMode();if(d!=null)if(d.causesRowDelete){a.jsGridObj.DeleteRecords(SP.Internal.JS.ConvertSetKeysToArray(o));k.begin-=m;k.end-=m}else a.jsGridObj.UpdateProperties(i(d.gridPane,o,d.rowRange,d.colRange),"");l.PutData(h,q,"","TL",k,s,b,n)}function y(b){ULSEWi:;a.selectionMgr.SelectRange(l,k.begin,k.begin+Math.min(b,k.end-k.begin),s.begin,s.end,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true,false);a.commandMgr.CloseGroup(d!=null?"Cut/Paste":"Paste",SP.JsGrid.CommandManager.CommandType.Explicit,true)}};function h(d,m,h,j,o,l){ULSEWi:;if(!f.IsSelectionCopyable(d)){alert(c("MultipleSelections"));return false}for(var n=d.GetData(m,h,j),i=new Array(h.Size()),g=0;g<i.length;g++)i[g]=n.matrix[g].join("\t");f.CancelMode();var k=i.join("\r\n");if(e.SetData(k)){b={clipboardText:k,rowRange:h,colRange:j,selType:a.selectionMgr.GetLastSelectionType(),gridPane:d,opType:o,bCutCausesRowDelete:l};d.NotifyCopyOperationUpdated();return true}else return false}function j(){ULSEWi:;var h=e.GetData();if(h==null||h=="")return null;var a=d(h).split("\n");a.length>1&&a[a.length-1]==""&&a.pop();for(var f=a.length,g,b=0;b<f;b++){a[b]=a[b].split("\t");if(g==null)g=a[b].length;else if(g!=a[b].length){if(b==f-1&&a[b].length==1&&a[b][0]==""){f--;break}break}}if(b!=f){alert(c("ClipboardDataNotSquare"));return null}return {matrix:a,width:g,height:f}}function k(i,h,f,e){ULSEWi:;for(var d=i.GetGridPaneConverter(),c=f.begin;c<=f.end;c++)for(var b=e.begin;b<=e.end;b++){var g=d.IdxToKey(c,b);if(!a.editUtil.CanEditField(h[g.recordKey],d.GetColumnByIdx(b),g.fieldKey))return true}return false}function l(b){ULSEWi:;for(var c in b)if(!a.editUtil.CanEditField(b[c],null,null))return true;return false}function i(h,j,b,a){ULSEWi:;for(var g=h.GetGridPaneConverter(),e=new Array(b.Size()*a.Size()),i=0,c=b.begin;c<=b.end;c++)for(var d=a.begin;d<=a.end;d++){var f=g.IdxToKey(c,d);e[i++]=SP.JsGrid.CreateUnvalidatedPropertyUpdate(f.recordKey,f.fieldKey,"",true)}return e}function d(a){ULSEWi:;return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}function g(){ULSEWi:;var c=false,a=e.GetData();if(b.clipboardText==null)c=a==null;else c=(a&&d(a))==d(b.clipboardText);return c}};SP.JsGrid.Internal.ClipboardManager=function(){ULSEWi:;var a=c(),b;this.SetData=function(c){ULSEWi:;if(window.clipboardData&&window.clipboardData.setData)window.clipboardData.setData(a,c);else if(window.Components){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(g){alert(SP.JsGrid.Res.browserPermissionDenied);return false}var e=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),d=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);d.addDataFlavor(a);var f=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);e.data=c;d.setTransferData(a,e,c.length*2);f.setData(d,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}else{b={};b[a]=c}return true};this.GetData=function(){ULSEWi:;if(window.clipboardData!=null&&window.clipboardData.getData!=null)return window.clipboardData.getData(a);else if(window.Components){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(g){alert(SP.JsGrid.Res.browserPermissionDenied);return null}var f=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),d=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);d.addDataFlavor(a);var c={},e={};f.getData(d,Components.interfaces.nsIClipboard.kGlobalClipboard);d.getTransferData(a,c,e);c=c&&c.value.QueryInterface(Components.interfaces.nsISupportsString);return c&&c.data.substring(0,e.value/2)}else return b&&b[a]};function c(){ULSEWi:;if(Sys.Browser.agent==Sys.Browser.Safari||Sys.Browser.agent==Sys.Browser.AppleWebKit)return "text/plain";else if(Sys.Browser.agent==Sys.Browser.Firefox)return "text/unicode";else return "text"}};SP.JsGrid.Deserializer=function(b,c,i){ULSEWi:;this.recordKeyHash;this.recordKeyOrderChanged;this.columns;this.pivotedColumns;this.gridFieldMap;this.view;this.viewDependentKeys;this.isGanttEnabled;this.isHierarchyEnabled;this.groupingLevel;this.isGrouped;this.isSorted;this.data;this.operationalConstantsFieldKeyMap;this.keyColumnName=i;this.unfilteredHierarchyMgr;this.additionalParams;this.autoFilterState;this.hierarchyState;this.sortState;this.autoFilterEntries;this.ganttInfo;this.cellStyles;this.groupingGridRowStyleIds;this.bAutoFilterableColumns;var a=this;this.InitJsGridParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.Parameters;a.tableViewParams=this.InitJsGridTableViewParams(a.tableViewParams);return a};this.InitJsGridTableViewParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.TableViewParameters;a.operationalConstantsFieldKeyMap=this.operationalConstantsFieldKeyMap;a.gridFieldMap=this.gridFieldMap;a.paneLayout=this.paneLayout;a.keyFieldName=this.keyColumnName;a.bAutoFilterableColumns=this.bAutoFilterableColumns;if(this.columns!=null)a.columns=new SP.JsGrid.ColumnInfoCollection(this.columns);if(this.pivotedColumns!=null){a.pivotedGridParams=new SP.JsGrid.JsGridControl.PivotedGridParameters;a.pivotedGridParams.columns=new SP.JsGrid.ColumnInfoCollection(this.pivotedColumns)}if(this.isGanttEnabled)a.ganttParams=this.InitJsGridGanttParams(a.ganttParams);a.rowViewParams=this.InitJsGridRowViewParams(a.rowViewParams);return a};this.InitJsGridRowViewParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.RowViewParameters;a.hierarchyMode=this.isGrouped?SP.JsGrid.HierarchyMode.Grouping:this.isHierarchyEnabled?SP.JsGrid.HierarchyMode.Standard:SP.JsGrid.HierarchyMode.None;a.groupingLevel=this.groupingLevel;a.groupingRecordKeyPrefix=this.groupingPrefix;a.view=this.view;a.autoFilterState=this.autoFilterState;a.unfilteredHierarchyMgr=this.unfilteredHierarchyMgr;a.hierarchyState=this.hierarchyState;a.sortState=this.sortState;a.autoFilterEntries=this.autoFilterEntries;return a};this.InitJsGridGanttParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.GanttParameters;a.dateRange=[this.ganttInfo.StartDate,this.ganttInfo.FinishDate];a.ganttBarStyles=this.ganttInfo.Styles.barStyles;a.fieldKeyRedrawFilter=this.ganttInfo.Styles.fieldKeyRedrawFilter;return a};this.InitCellStyles=function(a){ULSEWi:;if(this.cellStyles!=null)for(var c in this.cellStyles)a.RegisterCellStyle(c,SP.JsGrid.Style.CreateStyle(SP.JsGrid.Style.Type.Cell,this.cellStyles[c]));if(this.groupingGridRowStyleIds!=null){for(var d=[],b=0;b<this.groupingGridRowStyleIds.length;b++)d.push(a.GetCellStyle(this.groupingGridRowStyleIds[b]));a.groupingStyles=d}};function k(){ULSEWi:;if(c==SP.JsGrid.DeserializationMode.Full)j();else if(c==SP.JsGrid.DeserializationMode.TableView)e();else if(c==SP.JsGrid.DeserializationMode.RowView)g();else if(c==SP.JsGrid.DeserializationMode.Slice)d();else c==SP.JsGrid.DeserializationMode.AutoFilter&&h()}function j(){ULSEWi:;e(b)}function e(){ULSEWi:;var f=b.MultiValueSeparator;b.LookupTableInfo!=null&&c(b.LookupTableInfo);h(b.Fields);e(b.Columns);b.PivotedColumns!=null&&d(b.PivotedColumns);a.paneLayout=b.PaneLayout;a.ganttInfo=b.GanttInfo;a.bAutoFilterableColumns=b.AutoFilterableColumns;g();function h(e){ULSEWi:;a.gridFieldMap={};for(var d=0;d<e.length;d++){var b=e[d],c=new SP.JsGrid.GridField(b.fieldKey,b.hasDataValue,b.hasLocalizedValue,b.textDirection,b.defaultCellStyleId,b.editMode);b.multiValue&&c.SetIsMultiValue(f);c.SetSingleValuePropType(b.propertyTypeId!=null?SP.JsGrid.Internal.Property.GetPropType(b.propertyTypeId):null);a.gridFieldMap[c.key]=c}}function e(e){ULSEWi:;a.columns=[];for(var d=0;d<e.length;d++){var b=e[d],c=new SP.JsGrid.ColumnInfo(b.name,b.imgSrc,b.columnKey,b.width);c.isVisible=b.isVisible;c.isHidable=b.isHidable;c.isResizable=b.isResizable;c.isSortable=b.isSortable;c.isAutoFilterable=b.isAutoFilterable;a.columns.push(c)}}function d(d){ULSEWi:;a.pivotedColumns=[];for(var c=0;c<d.length;c++){var b=d[c],e=new SP.JsGrid.PivotedColumnInfo(b.name,b.imgSrc,b.columnKey,b.fieldKeys,b.width);a.pivotedColumns.push(e)}}function c(b){ULSEWi:;for(var a=0;a<b.length;a++)SP.JsGrid.PropertyType.RegisterNewLookupPropType(b[a].id,b[a].lookup,b[a].showImage&&b[a].showText?SP.JsGrid.DisplayControl.Type.ImageText:b[a].showImage?SP.JsGrid.DisplayControl.Type.Image:SP.JsGrid.DisplayControl.Type.Text,b[a].limitToList)}}function g(){ULSEWi:;a.view=b.ViewInfo;a.autoFilterState=b.AutoFilterState;a.sortState=b.SortState;a.hierarchyState=b.HierarchyState;a.cellStyles=b.CellStyles;a.groupingGridRowStyleIds=b.GroupingGridRowStyleIds;if(b.UnfilteredHierarchy!=null)a.unfilteredHierarchyMgr=new SP.JsGrid.UnfilteredHierarchyManager(b.UnfilteredHierarchy);a.autoFilterEntries=b.AutoFilterEntries;d()}function d(){ULSEWi:;f(b.MetaData);if(b.LocalizedTable!=null&&b.UnlocalizedTable!=null){var e=b.LocalizedTable,d=b.UnlocalizedTable;a.viewDependentKeys=b.ViewDepKeys;a.data={};for(var c=0;c<d.length;c++)a.data[d[c][a.keyColumnName]]={data:d[c],localized:e[c]}}a.additionalParams=b.AdditionalParams}function h(){ULSEWi:;f(b.MetaData);a.autoFilterEntries=b.AutoFilterEntries}function f(b){ULSEWi:;switch(c){case SP.JsGrid.DeserializationMode.Full:case SP.JsGrid.DeserializationMode.TableView:a.isGanttEnabled=b.IsGanttEnabled;a.operationalConstantsFieldKeyMap=b.GridOperationalConstantsFieldKeyMap;a.keyColumnName=b.KeyColumnName;case SP.JsGrid.DeserializationMode.RowView:a.isHierarchyEnabled=b.IsHierarchyEnabled;a.groupingLevel=b.GroupingLevel;a.groupingPrefix=b.GroupingPrefix;a.isGrouped=a.groupingLevel!=0;a.isSorted=b.IsSorted;default:a.recordKeyHash=b.RecordKeyHash;a.recordKeyOrderChanged=b.RecordKeyOrderChanged}}k()};SP.JsGrid.Deserializer.DeserializeFromJson=function(b,a){ULSEWi:;if(a==null)a={};if(!("guid" in a))a["guid"]=function(a){ULSEWi:;return SP.JsGrid.GuidManager.GetIndexForGuid(a)};for(var c in a)b=SP.JsGrid.Deserializer.EvalFunctionCallsInJson(b,c,a[c]);return Sys.Serialization.JavaScriptSerializer.deserialize(b)};SP.JsGrid.Deserializer.EvalFunctionCallsInJson=function(jsonText,prefix,fn){ULSEWi:;var unescapedQuoteRegEx='([^\\\\])\\"',regEx=unescapedQuoteRegEx+Escape(prefix)+"<;>(.+?)"+unescapedQuoteRegEx;return jsonText.replace(eval("/"+regEx+"/g"),function(e,b,c,d){ULSEWi:;var a=fn.apply(null,DeserializeEncodedArray(c+d));return b+(a==null?"":a)});function DeserializeEncodedArray(c){ULSEWi:;for(var b=c.split("<;>"),a=0;a<b.length-1;a++)b[a]=Unescape(b[a]);return b}function Unescape(a){ULSEWi:;return a.replace(/;;/g,";")}function Escape(a){ULSEWi:;return a.replace(/;/g,";;")}};SP.JsGrid.Internal.DiffTracker=function(g,f){ULSEWi:;var a=new k,b={};function k(){ULSEWi:;var a=[];this.AddChange=function(e,d,b){ULSEWi:;var c={changeKey:e,bSynchronized:d};if(b!=null)c.events=b;a.push(c)};this.RemoveChange=function(d){ULSEWi:;var c=b(d);return c!=null?a.splice(c,1):null};this.ContainsKey=function(a){ULSEWi:;return b(a)!=null};this.GetItem=function(d){ULSEWi:;var c=d!=null?b(changeKey):a.length-1;return c!=-1&&c!=null?a[c].changeKey:null};this.AddEvent=function(e,d){ULSEWi:;var c=b(e);if(c!=null){if(a[c].events==null)a[c].events=[];a[c].events.push(d)}};this.RemoveEvent=function(f,e){ULSEWi:;var c=b(f);if(c!=null&&a[c].events!=null)for(var d=0;d<a[c].events.length;d++)if(a[c].events[d]==e){a[c].events.splice(d,1);break}};this.Length=function(){ULSEWi:;return a.length};this.Clear=function(){ULSEWi:;a=[]};this.GetChanges=function(c){ULSEWi:;var e,f;if(c.sliceBeginInfo!=null){e=g(c.sliceBeginInfo);if(e==null&&c.sliceBeginInfo.bCancelQueryIfMissing)return [];else if(e!=null&&!c.sliceBeginInfo.bInclusive)e++}if(c.sliceEndInfo!=null){f=g(c.sliceEndInfo,e==null?null:e+1);if(f==null&&c.sliceEndInfo.bCancelQueryIfMissing)return [];else if(f!=null&&c.sliceEndInfo.bInclusive)f++}return a.slice(e==null?0:e,f==null?a.length:f);function g(a,e){ULSEWi:;var c;if(a.event!=null)c=d(a.event,a.bFindLastOccurence,e);else if(a.changeKey!=null)c=b(a.changeKey,a.bCancelQueryIfMissing);return c}};function b(f,e){ULSEWi:;for(var d=null,c,b=a.length-1;b>=0;b--){c=a[b].changeKey.CompareTo(f);if(c==0){d=b;break}else if(c<0){if(e&&b!=a.length-1)d=b+1;break}}return d}function d(f,h,d){ULSEWi:;for(var e=null,g=d!=null?d:0,b=g;b<a.length;b++)if(c(a[b],f)){e=b;if(!h)break}return e}function c(a,d){ULSEWi:;var c=false;if(a.events!=null)for(var b=0;b<a.events.length;b++)if(a.events[b]==d){c=true;break}return c}}function c(){ULSEWi:;this.sliceBeginInfo=null;this.sliceEndInfo=null;this.recordKeys=null;this.bIncludeInvalidPropUpdates=false}function l(){ULSEWi:;this.event=null;this.bFindLastOccurence=false;this.bInclusive=true;this.bCancelQueryIfMissing=false}function j(){ULSEWi:;this.changeKey=null;this.bInclusive=true;this.bCancelQueryIfMissing=false}this.ExternalAPI={RegisterEvent:function(c,b){ULSEWi:;a.AddEvent(c,b)},UnregisterEvent:function(c,b){ULSEWi:;a.RemoveEvent(c,b)},GetChanges:function(f,g,l,i,j,k,h,e){ULSEWi:;var b=new c;if(f!=null)b.sliceBeginInfo={event:f,bFindLastOccurence:!i,bInclusive:j,bCancelQueryIfMissing:false};if(g!=null)b.sliceEndInfo={event:g,bFindLastOccurence:e,bInclusive:k,bCancelQueryIfMissing:true};return d(a.GetChanges(b),false,null,l,h,e)},GetChangesAsJson:function(b,f,g){ULSEWi:;if(b==null)b=new c;var e=d(a.GetChanges(b),true,f,b.recordKeys,b.bIncludeInvalidPropUpdates,g);return e==null||e.length==0?null:Sys.Serialization.JavaScriptSerializer.serialize(e)},AnyChanges:function(){ULSEWi:;return a.Length()>0},GetUniquePropertyChanges:function(b,e){ULSEWi:;if(b==null)b=new c;return h(e,d(a.GetChanges(b),false,null,b.recordKeys,b.bIncludeInvalidPropUpdates))},ChangeQuery:c,EventSliceInfo:l,ChangeKeySliceInfo:j};this.Clear=function(){ULSEWi:;a.Clear();b={}};this.NotifySynchronizeToChange=function(a){ULSEWi:;e(a,true)};this.NotifyRollbackChange=function(a){ULSEWi:;e(a,false)};this.NotifyVacateChange=function(c){ULSEWi:;if(a.ContainsKey(c))b[c.GetVersionNumber()]=f(c,null,true,false,true)};function e(b,d){ULSEWi:;var c=a.GetItem();if(c!=null&&c==b)c.bWasSynchronized!=d&&a.RemoveChange(b);else a.AddChange(b,d)}function d(p,r,m,n,q,j){ULSEWi:;var e=[];rIdx=0;for(var l=0;l<p.length;l++){e.push(SP.Internal.JS.CloneObj(p[l],false));var k=e[rIdx].changeKey.GetVersionNumber(),c=e[rIdx].updates=k in b?i(b[k],n,j):f(e[rIdx].changeKey,n,!e[rIdx].bSynchronized,j);delete e[rIdx].bSynchronized;delete e[rIdx].events;if(!q&&!j)for(var a=c.length-1;a>=0;a--)if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop&&c[a].validationState!=SP.JsGrid.ValidationState.Valid)c.splice(a,1);else delete c[a].validationState;if(j)for(var a=0;a<c.length;a++)if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete)c[a].type=SP.JsGrid.PostViewChangeType.Delete;else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Insert)c[a].type=SP.JsGrid.PostViewChangeType.Insert;else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Level)c[a].type=SP.JsGrid.PostViewChangeType.Level;if(r){for(var a=0;a<c.length;a++){if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop){var d={};if(c[a].propUpdate.data!=SP.JsGrid.EmptyValue){d.dataValue=SP.Internal.JS.CloneObj(c[a].propUpdate.data,true);d.hasDataValue=true}if(c[a].propUpdate.localized!=SP.JsGrid.EmptyValue){d.localizedValue=c[a].propUpdate.localized;d.hasLocalizedValue=true}c[a].newProp=d;delete c[a].propUpdate}else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete)delete c[a].afterRecordKey;var s=c[a].recordKey,h=m!=null?m(e[rIdx].changeKey,c[a]):SP.JsGrid.UpdateSerializeMode.Default;if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop&&h==SP.JsGrid.UpdateSerializeMode.Default){var o=c[a].fieldKey,t=g.jsGridParams.tableViewParams.gridFieldMap[o];h=SP.JsGrid.Internal.Property.GetUpdateSerializeMode(g.controller.GetPropType(s,o),t)}if(h==SP.JsGrid.UpdateSerializeMode.Cancel){c.splice(a,1);a--;continue}if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop){var d=c[a].newProp;if(h==SP.JsGrid.UpdateSerializeMode.PropDataOnly){delete d.localizedValue;delete d.hasLocalizedValue}if(h==SP.JsGrid.UpdateSerializeMode.PropLocalizedOnly){delete d.dataValue;delete d.hasDataValue}if("dataValue" in d)d.dataValue=d.dataValue!=null?Sys.Serialization.JavaScriptSerializer.serialize(d.dataValue):null;if("localizedValue" in d)d.localizedValue=escape(d.localizedValue)}}e[rIdx].changeNumber=k;delete e[rIdx].changeKey}if(e[rIdx].updates.length==0)e.splice(rIdx,1);else rIdx++}return e}function i(a,d){ULSEWi:;var c;if(d==null)c=a;else{var e=new SP.JsGrid.Internal.Set;e.AddArray(d);c=[];for(var b=0;b<a.length;b++)e.Contains(a[b])&&c.push(a[b])}}function h(e,f){ULSEWi:;for(var h=SP.JsGrid.Internal.VersionManager.ChangeType.Prop,b={},c=0;c<f.length;c++)for(var g=f[c].updates,d=0;d<g.length;d++){var a=g[d];if(a.type==h)if(e==null||e(a.recordKey,a.fieldKey)){if(b[a.recordKey]==null)b[a.recordKey]={};b[a.recordKey][a.fieldKey]=a.propUpdate}}return b}};SP.JsGrid.Internal.EditActorsRegistrationManager=function(c,i,f,d,h){ULSEWi:;var b={},a={};this.RegisterEditControl=function(a){ULSEWi:;!(a in b)&&g(a);return b[a]};this.RegisterWidgetControl=function(b){ULSEWi:;!(b in a)&&e(b);return a[b]};this.GetEditControlAPI=function(a){ULSEWi:;return b[a]};this.GetWidgetControlAPI=function(b){ULSEWi:;return a[b]};this.GetActorAPI=function(c){ULSEWi:;return b[c]||a[c]};this.IsActorWidget=function(b){ULSEWi:;return b in a};this.GetEditAndWidgetControlsAPI=function(g,f,d,e){ULSEWi:;var c={editControlAPI:null,widgetControlsAPI:[]},a=SP.JsGrid.Internal.Property.GetEditAndWidgetControlNamesForProperty(g,f,d,e);c.editControlAPI=this.RegisterEditControl(a.editControlName);for(var b=0;b<a.widgetControlNames.length;b++)c.widgetControlsAPI.push(this.RegisterWidgetControl(a.widgetControlNames[b]));return c};this.Dispose=function(){ULSEWi:;for(var c in b)b[c].actor.Dispose();for(var c in a)a[c].actor.Dispose()};function g(a){ULSEWi:;var d=f(a),g=[d.GetGridContext()],e=c.focusMgr.GetFocusElementForTextInput(a);e!=null&&g.push(e);d.actor=SP.JsGrid.Internal.Property.GetEditControl(a,g);b[a]=d}function e(b){ULSEWi:;var e=d(b),f=[e.GetGridContext()];b==SP.JsGrid.ErrorWidgetId&&f.push(c.errorMgr);e.actor=SP.JsGrid.Internal.Property.GetWidgetControl(b,f);h(b,e.actor);a[b]=e}};SP.JsGrid.Internal.EditManager=function(d,rb,xb){ULSEWi:;var Ab=d.jsGridObj,Bb=d.styleMgr,cb=d.errorMgr,g={Inited:1,Bound:2,Editing:3},j=this,J=d.parentNode,m=g.Inited,h,D,e,s,z,u,l,t,A,L,c,b,a,n,r,f,q,R,o={},i=tb(),E,v,k,w,I,K,y=new nb,p=new SP.JsGrid.Internal.EditActorsRegistrationManager(d,J,eb,db,ib);d.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,X);function U(a){ULSEWi:;this.jsGridObj=d.jsGridObj;this.parentNode=J;this.styleManager=d.styleMgr;this.RTL=d.RTL;this.emptyValue=SP.JsGrid.EmptyValue;this.bLightFocus=false;this.OnKeyDown=function(b){ULSEWi:;j.OnActorKeyDown(b,a)}}function T(a){ULSEWi:;this.propType;this.originalValue;this.record;this.column;this.field;this.fieldKey;this.cellExpandSpace;this.SetCurrentValue=function(b){ULSEWi:;j.SetCurrentValue(a,b)}}function W(c,f,e,d){ULSEWi:;var b=e(),a=d();this.name=c;this.actor=f;this.SetCellInfo=function(){ULSEWi:;zb(a,p.IsActorWidget(c))};this.UpdateOriginalValue=function(b){ULSEWi:;a.originalValue=b};this.IsLightFocus=function(){ULSEWi:;return b.bLightFocus};this.NotifyEditComplete=function(b){ULSEWi:;a.NotifyEditComplete(b)};this.GetGridContext=function(){ULSEWi:;return b};this.GetCellContext=function(){ULSEWi:;return a}}function gb(a){ULSEWi:;return new U(a)}function fb(b){ULSEWi:;var a=new T(b);a.NotifyExpandWidget=function(){ULSEWi:;j.NotifyExpandWidget(b)};a.NotifyCollapseWidget=function(){ULSEWi:;j.NotifyCollapseWidget(b)};a.NotifyEditComplete=function(a){ULSEWi:;if(a)j.NotifyWidgetEditCancel(b);else M(a)};return a}function db(a,b){ULSEWi:;return new W(a,b,function(){ULSEWi:;return gb(a)},function(){ULSEWi:;return fb(a)})}function lb(a){ULSEWi:;var b=new U(a);b.OnActivateActor=function(){ULSEWi:;P(a)};b.OnDeactivateActor=function(){ULSEWi:;N(a)};return b}function kb(b){ULSEWi:;var a=new T(b);a.NotifyExpandControl=function(){ULSEWi:;j.NotifyExpandControl(b)};a.NotifyEditComplete=function(a){ULSEWi:;M(a)};a.Show=function(a){ULSEWi:;a.style.position="absolute";a.style.left=l.x+1+"px";a.style.top=l.y+1+"px";s.ClipElementToTableViewport(a);a.style.visibility="inherit"};a.Hide=function(a){ULSEWi:;if(!d.focusMgr.ChangeTextInputElementToFocusElement())a.style.visibility="hidden"};return a}function eb(a,b){ULSEWi:;return new W(a,b,function(){ULSEWi:;return lb(a)},function(){ULSEWi:;return kb(a)})}function M(a){ULSEWi:;if(j.IsEditing()||y.GetCurrentEndingState()==g.Editing)y.HandleStateTransition(g.Bound,true,null,[a]);else if(j.IsBound()){C();if(!a){d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditBegin,new SP.JsGrid.EventArgs.CellEditBegin(h.key(),e.key));var b=S();d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditCompleted,new SP.JsGrid.EventArgs.CellEditCompleted(h.key(),e.key,b,a))}d.focusMgr.Focus()}n=null}function zb(a,b){ULSEWi:;a.propType=z;a.originalValue=q;a.record=h;a.column=D;a.field=e;a.fieldKey=e.key;a.cellExpandSpace=A;if(!b){a.cellWidth=l.width-2;a.cellHeight=l.height-2;a.cellStyle=L}else a.cellRect=l}function ib(c,b){ULSEWi:;var a=document.createElement("div");a.className="jsgrid-widget-cell";a.appendChild(b.GetIcon());o[c]=a;i.appendChild(a)}function nb(){ULSEWi:;function k(b,a){ULSEWi:;this.fn=b;this.bArgsRequired=a}var K=[[g.Inited,{promote:new k(J,true)}],[g.Bound,{demote:new k(F,false),promote:new k(y,true)}],[g.Editing,{demote:new k(E,false)}]],v=SP.Internal.JS.ConvertTableToMap(K,"0","1"),j=[];function F(){ULSEWi:;for(var d=0;d<a.length;d++)x(a[d].name);i.style.display="none";for(var d=0;d<i.childNodes.length;d++)i.childNodes[d].style.visibility="hidden";w=null;for(var d=0;d<c.length;d++)c[d].actor.Unbind();h=null;D=null;e=null;s=null;c=null;b=null;a=null;z=null;u=null;l=null;A=null;t=null;L=null;n=null;r={};f={};q=null;w=null}function E(c){ULSEWi:;var a;b.actor.OnEndEdit();C();if(!c)a=S();I=false;r={};f={};d.focusMgr.Focus();d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditCompleted,new SP.JsGrid.EventArgs.CellEditCompleted(h.key(),e.key,a,c))}function J(n,g,o,d,j,m,k){ULSEWi:;h=g;D=o;e=j[d];s=n;z=g.GetProp(d)!=null?g.GetProp(d).propType:j[d].GetPropType();q=H();c=p.GetEditAndWidgetControlsAPI(h,D,e.key,z);b=c.editControlAPI;a=c.widgetControlsAPI;Y(g.key(),d);c=[b].concat(a);r={};f={};if(m!=null)u=m.GetTd();if(k!=null)L=k;l=Z();t=O();A=bb(l,t);b.SetCellInfo();b.actor.BindToCell(b.GetCellContext());for(var i in a){a[i].SetCellInfo();a[i].actor.BindToCell(a[i].GetCellContext())}B()}function y(a){ULSEWi:;n=SP.JsGrid.EmptyValue;G(H());d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditBegin,new SP.JsGrid.EventArgs.CellEditBegin(h.key(),e.key));b.actor.OnBeginEdit(a);b.actor.OnKeyDown!=null&&(a.type=="keypress"||a.type=="keydown")&&b.actor.OnKeyDown(a)}var o=[];this.HandleStateTransition=function(a,e,d,g){ULSEWi:;var c=j.length>0?j[0].newState:m;if(e&&c<=a||!e&&c>=a)i(a,d,g);else{for(var f=Math.abs(c-a),b=1;b<=f;b++){var a=c+b*(e?-1:1),l=b==1&&g!=null?g:o,k=d!=null&&f==b?[d]:o;j.unshift({newState:a,args:l,callbacks:k})}j.length==f&&h()}function h(){ULSEWi:;while(j.length>0){var a=j[j.length-1],c=m<a.newState?v[m].promote.fn:v[m].demote.fn;c.apply(null,a.args);m=a.newState;j.pop();for(var b=0;b<a.callbacks.length;b++)a.callbacks[b]()}}function i(d,b,c){ULSEWi:;for(var a=0;a<j.length;a++)if(j[a]==d){b!=null&&j[a].callbacks.push(b);if(c!=null)j[a].args=c;return}b!=null&&b()}};this.GetCurrentEndingState=function(){ULSEWi:;return j.length>0?j[0].newState:m}}function Z(){ULSEWi:;var a=u.parentNode!=null?s.GetTdCoordsRelativeToParentNode(u):null;return a!=null?{x:a.left,y:a.top,width:a.width,height:a.height}:null}function O(){ULSEWi:;return s.GetTableViewportRelativeToParentNode()}function bb(a,b){ULSEWi:;return {top:a.y-b.top,right:b.right-a.x-a.width,bottom:b.bottom-a.y-a.height,left:a.x-b.left}}function S(){ULSEWi:;var d,a=pb(),c=ub();if(a||c){var b;if(a&&c)b=SP.JsGrid.CreateValidatedPropertyUpdate(h.key(),e.key,f.data,f.localized);else b=SP.JsGrid.CreateUnvalidatedPropertyUpdate(h.key(),e.key,a?f.localized:f.data,a);f={};d=rb([b],"User Edit",null,function(a){ULSEWi:;K=a});X();G(H())}else f={};return d}function pb(){ULSEWi:;var a=false;if(q.localized!=SP.JsGrid.EmptyValue&&"localized" in f){var b=q.localized!=null?q.localized:"";a=b!=f.localized}return a}function ub(){ULSEWi:;var a=false;if(q.data!=SP.JsGrid.EmptyValue&&"data" in f)a=!e.CompareSingleDataEqual(f.data,q.data);return a}function X(){ULSEWi:;if(m>=g.Bound){var c=a.length>0&&a[0].name==SP.JsGrid.ErrorWidgetId;if(c&&!cb.CellHasError(h.key(),e.key)){var b=a[0];b.name==k&&x(b.name);b.actor.Unbind();a.splice(0,1);if(B())o[b.name].style.visibility="hidden"}else if(!c)if(Y(h.key(),e.key)){var b=p.GetWidgetControlAPI(SP.JsGrid.ErrorWidgetId);b.SetCellInfo();b.actor.BindToCell(b.GetCellContext());B()}}}function G(c){ULSEWi:;q=c;b.UpdateOriginalValue(c);for(var d in a)a[d].UpdateOriginalValue(c)}function tb(){ULSEWi:;var a=document.createElement("div");a.className="jsgrid-widget-dock";a.style.display="none";J.appendChild(a);E=SP.Internal.DomElement.SetMouseHover(a,wb,hb,vb);$addHandler(a,"click",sb);$addHandler(a,"mousedown",qb);return a}function sb(c){ULSEWi:;if(c.button==Sys.UI.MouseButton.leftButton)for(var d=SP.Internal.DomElement.GetEventLocation(c),b=0;b<a.length;b++){var e=o[a[b].name];if(SP.Internal.DomElement.PointInDomElem(d.x,d.y,e)){SP.Internal.DomElement.StopEvent(c);if(k!=a[b].name)F(a[b].actor);else x(k);break}}}function qb(a){ULSEWi:;a.stopPropagation()}function wb(){ULSEWi:;i.style.borderColor="#768290"}function hb(){ULSEWi:;if(k==null)i.style.borderColor="";for(var b=0;b<a.length;b++){var c=[];if(a[b].name!=k)o[a[b].name].style.backgroundColor=""}v=null}function vb(e){ULSEWi:;for(var c=SP.Internal.DomElement.GetEventLocation(e),b=0;b<a.length;b++){var d=o[a[b].name];if(SP.Internal.DomElement.PointInDomElem(c.x,c.y,d)){if(v!=a[b].name){if(v!=null&&v!=k)o[v].style.backgroundColor="";v=a[b].name;if(a[b].name!=k)d.style.backgroundColor="#C4C9CF"}break}}}function B(){ULSEWi:;if(l!=null&&t!=null){var b=l,h=t;if(a.length>0){for(var f=5,g=20,m=22,c=g*a.length,k=d.RTL.bEnabled?b.x-(c+2)>=h.left:b.x+b.width+f+(c+2)>h.right,p=b.y+Math.floor((b.height-m)/2),n=k?b.x-(c+2+f):b.x+f+b.width,e=0;e<a.length;e++){var j=o[a[e].name];j.style.left=e*g+"px";j.style.visibility=""}i.style.top=p+"px";i.style.left=n+"px";i.style.width=c+"px";i.style.display="block"}else i.style.display="none";return true}else return false}function H(){ULSEWi:;return xb(h,e.key,z)}function Y(c,d){ULSEWi:;var b=false;if(cb.CellHasError(c,d)){a.unshift(p.RegisterWidgetControl(SP.JsGrid.ErrorWidgetId));b=true}return b}function yb(a){ULSEWi:;if(p.IsActorWidget(a.name))return F(a.actor);else return ob(a.actor)}function mb(a){ULSEWi:;R=r;C(a);if(k!=null&&k!=a)o[k].style.backgroundColor="";o[a].style.backgroundColor="#8C8F93";k=w=a}function x(a){ULSEWi:;V(a);p.GetWidgetControlAPI(a).actor.Collapse()}function V(a){ULSEWi:;if(a==k){o[a].style.backgroundColor="";k=null}}function F(a){ULSEWi:;if(a.Expand!=null){a.Expand();return true}return false}function jb(a){ULSEWi:;C(a);w=a}function ob(a){ULSEWi:;if(a.Expand!=null){a.Expand();return true}return false}function C(d){ULSEWi:;for(var c=0;c<a.length;c++)a[c].name!=d&&x(a[c].name);if(b.actor.Collapse!=null)b.name!=d&&b.actor.Collapse()}function Q(a,d,e){ULSEWi:;f={};if("localized" in a&&a.localized!=SP.JsGrid.EmptyValue){r.localized=a.localized;if(d==SP.JsGrid.EditActorUpdateType.Uncommitted)f.localized=a.localized}if("data" in a&&a.data!=SP.JsGrid.EmptyValue){r.data=a.data;if(d==SP.JsGrid.EditActorUpdateType.Uncommitted)f.data=a.data}for(var b=0;b<c.length;b++)e!=c[b].name&&c[b].actor.OnValueChanged(r,d)}function P(a){ULSEWi:;ab(true,a)}function N(a){ULSEWi:;setTimeout(function(){ULSEWi:;ab(false,a)},0)}function ab(a,b){ULSEWi:;if(!a&&n!=null&&b==n)j.StopEditing(false);else if(a)n=b}this.Unbind=function(a){ULSEWi:;y.HandleStateTransition(g.Inited,true,a)};this.StopEditing=function(c){ULSEWi:;var a=p.GetActorAPI(n)||b;a!=null&&a.NotifyEditComplete(c)};this.BindToCell=function(f,i,h,e,a,c,b,d){ULSEWi:;y.HandleStateTransition(g.Bound,false,d,[f,i,h,e,a,c,b])};this.BeginEdit=function(a,b){ULSEWi:;I=a.type=="keypress";y.HandleStateTransition(g.Editing,false,b,[a])};this.IsBoundToCell=function(c,a,b){ULSEWi:;return m>=g.Bound&&s==c&&h.key()==a&&e.key==b};this.IsBound=function(){ULSEWi:;return m>=g.Bound};this.IsEditing=function(){ULSEWi:;return m>=g.Editing};this.NotifyMove=function(i){ULSEWi:;if(i!=null&&i!=s)return;if(m>=g.Bound){var c=s.GetFocusedCell(),f=c&&c.GetTd();if(f!=null&&u!=null&&h.key()==c.GetRecordKey()&&e.key==c.GetFieldKey()){u=f;l=Z();if(l!=null){t=O();A=bb(l,t);b.SetCellInfo();b.actor.OnCellMove();for(var d=0;d<a.length;d++){x(a[d].name);a[d].SetCellInfo()}B()}}else f==null&&u!=null&&j.Unbind()}};this.NotifyUpdateProperty=function(f,d,e,a,c){ULSEWi:;if(this.IsBoundToCell(f,d,e)){var b={};if(a.HasDataValue())b.data=a.data;if(a.HasLocalizedValue())b.localized=a.localized;G(b);(K==null||c!=null&&c.CompareTo(K)!=0)&&Q(b,SP.JsGrid.EditActorUpdateType.Committed,null)}};this.ExpandWidget=function(c){ULSEWi:;var b=SP.Internal.JS.FindInArray(a,function(a){ULSEWi:;return a.name==c});b!=null&&F(a[b].actor)};this.ExpandNextActor=function(){ULSEWi:;function d(e){ULSEWi:;if(c.length==0||c[0].actor.Expand==null&&c.length==1)return null;var d,b=c[0].actor.Expand!=null?0:1;if(w==null)d=c[b];else for(var a=b;a<c.length;a++)if(c[a].name==w){d=e?a==c.length-1?c[b]:c[a+1]:a==b?c[c.length-1]:c[a-1];break}return d}if(m>=g.Bound&&(b.actor.Expand!=null||a.length)){var e=d(true);return yb(e)}return false};this.NotifyExpandWidget=function(a){ULSEWi:;P(a);mb(a)};this.NotifyCollapseWidget=function(a){ULSEWi:;N(a);V(a)};this.NotifyWidgetEditCancel=function(a){ULSEWi:;r=R;n=null;x(a);if(this.IsEditing())b.actor.Focus();else d.focusMgr.Focus()};this.NotifyExpandControl=function(a){ULSEWi:;jb(a)};this.SetCurrentValue=function(a,b){ULSEWi:;Q(b,SP.JsGrid.EditActorUpdateType.Uncommitted,a)};this.OnActorKeyDown=function(a,c){ULSEWi:;if(!i(a))if(m==g.Bound&&c==b.name)j.BeginEdit(a);else{var f=false,e=c==b.name?b:p.GetWidgetControlAPI(c);if(e.actor.OnKeyDown!=null)f=e.actor.OnKeyDown(a);var h=I||e.IsLightFocus();if(!f&&h)if(d.focusMgr.HandleKeyDown(a))n!=null&&n==c&&j.StopEditing(false)}else SP.Internal.DomElement.StopEvent(a);function i(){ULSEWi:;var b=false;if(a.keyCode==Sys.UI.Key.tab||a.keyCode==Sys.UI.Key.enter){j.StopEditing(false);d.focusMgr.HandleKeyDown(a);b=true}else if(a.keyCode==Sys.UI.Key.esc){j.StopEditing(true);b=true}return b}};this.GetCurrentEditControlName=function(){ULSEWi:;return b.name};this.Dispose=function(){ULSEWi:;this.Unbind(function(){ULSEWi:;p.Dispose();E!=null&&E();$clearHandlers(i);i.innerHTML="";i=null})}};SP.JsGrid.Internal.ErrorType={Row:1,Cell:2};SP.JsGrid.Internal.RecordErrorCollection=function(d){ULSEWi:;function c(){ULSEWi:;this._errors=[]}c.prototype={AddError:function(b,a){ULSEWi:;this._errors.unshift({id:b,msg:a})},RemoveError:function(b){ULSEWi:;var a=SP.Internal.JS.FindInArray(this._errors,function(a){ULSEWi:;return b==a.id});if(a!=null){this._errors.splice(a,1);return true}return false},AnyErrors:function(){ULSEWi:;return this._errors.length!=0},GetTopMessage:function(){ULSEWi:;return this._errors.length>0?this._errors[0].msg:null},GetTopId:function(){ULSEWi:;return this._errors.length>0?this._errors[0].id:null},GetMinError:function(c){ULSEWi:;for(var d=null,b=this._errors.length-1;b>=0;b--){var a=this._errors[b];if(c==null||c(a.id))d={message:a.msg,id:a.id}}return d},ContainsError:function(a){ULSEWi:;return SP.Internal.JS.FindInArray(this._errors,function(b){ULSEWi:;return a==b.id})!=null}};var b=new c,a={};this.AddRowError=function(c,a){ULSEWi:;b.AddError(c,a)};this.AddCellError=function(b,e,d){ULSEWi:;if(!(b in a))a[b]=new c;a[b].AddError(e,d)};this.ClearRowError=function(a){ULSEWi:;return b.RemoveError(a)};this.ClearCellError=function(b,c){ULSEWi:;if(b in a&&a[b].RemoveError(c)){if(!a[b].AnyErrors())delete a[b];return true}return false};this.ClearAllErrorsOnCell=function(b){ULSEWi:;if(b in a)delete a[b]};this.ClearAllErrorsOnRow=function(){ULSEWi:;b=new c};this.AnyErrors=function(){ULSEWi:;return b.AnyErrors()||!SP.Internal.JS.IsAssocArrayEmpty(a)};this.AnyErrorsOnCell=function(b){ULSEWi:;return b in a&&a[b].AnyErrors()};this.AnyErrorsOnRow=function(){ULSEWi:;return b.AnyErrors()};this.GetMessageForCell=function(b){ULSEWi:;return b in a?a[b].GetTopMessage(b):null};this.GetMessageForRow=function(){ULSEWi:;return b.GetTopMessage()};this.GetIdForCell=function(b){ULSEWi:;return b in a?a[b].GetTopId():null};this.GetIdForRow=function(){ULSEWi:;return b.GetTopId()};this.GetMinError=function(e){ULSEWi:;var c=b.GetMinError(e!=null?function(a){ULSEWi:;return e(d,null,a)}:null);if(c!=null)c.type=SP.JsGrid.Internal.ErrorType.Row;for(var g in a){var f=a[g].GetMinError(e!=null?function(a){ULSEWi:;return e(d,g,a)}:null);if(f!=null&&(c==null||f.id<c.id)){c=f;c.fieldKey=g;c.type=SP.JsGrid.Internal.ErrorType.Cell}}return c}};SP.JsGrid.Internal.ErrorManager=function(b){ULSEWi:;var e=0,a={},j=null,f=this,c=new SP.Utilities.Set;b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordInserted,h);b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordDeleted,i);this.SetRowError=function(c,d){ULSEWi:;var g=this.AnyErrors();if(a[c]==null)a[c]=new SP.JsGrid.Internal.RecordErrorCollection(c);var f=e++;d=d!=null?d:SP.JsGrid.Res.defaultRowMessage;var h=g&&a[c].AnyErrorsOnRow();a[c].AddRowError(f,d);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,true,true,h,f,d));!g&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true));return f};this.ClearRowError=function(c,e){ULSEWi:;if(a[c]!=null&&a[c].ClearRowError(e)){d(c);var f=c in a&&a[c].AnyErrorsOnRow();b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,false,f,true,e));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false));return true}return false};this.SetCellError=function(c,d,i){ULSEWi:;var h=this.AnyErrors();if(a[c]==null)a[c]=new SP.JsGrid.Internal.RecordErrorCollection(c);var g=a[c].AnyErrorsOnCell(d),f=e++;a[c].AddCellError(d,f,i);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,d,true,true,g,f));!h&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true));return f};this.ClearCellError=function(c,e,f){ULSEWi:;if(a[c]!=null&&a[c].ClearCellError(e,f)){d(c);var g=c in a&&a[c].AnyErrorsOnCell(e);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,e,false,g,true,f));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false));return true}return false};this.ClearAllErrorsOnRow=function(c){ULSEWi:;var e=false;if(c in a){e=true;a[c].ClearAllErrorsOnRow();d(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,false,false,-1));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}return e};this.ClearAllErrorsOnCell=function(c,e){ULSEWi:;var f=false;if(c in a&&a[c].AnyErrorsOnCell(e)){f=true;var g=a[c].GetIdForCell(e);a[c].ClearAllErrorsOnCell(e);d(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,e,false,false,g));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}return f};this.CellHasError=function(b,d){ULSEWi:;return b in a&&!c.Contains(b)&&a[b].AnyErrorsOnCell(d)};this.GetMessageForCell=function(b,d){ULSEWi:;return b in a&&!c.Contains(b)?a[b].GetMessageForCell(d):null};this.GetMessageForRow=function(b){ULSEWi:;return b in a&&!c.Contains(b)?a[b].GetMessageForRow():null};this.AnyErrors=function(){ULSEWi:;var b=false;for(var d in a)if(!c.Contains(d)){b=true;break}return b};this.AnyErrorsInRow=function(b){ULSEWi:;return b in a&&!c.Contains(b)&&a[b].AnyErrors()};this.GetNextError=function(c,b){ULSEWi:;var a=null;if(this.AnyErrors()){if(c!=null&&c<e)a=g(function(d,e,a){ULSEWi:;return a>c&&(b==null||b(d,e,a))});if(a==null)a=g(b)}return a};this.GetNextErrorForRecord=function(g,d,f){ULSEWi:;var b=null;if(d in a&&!c.Contains(d)){if(g!=null&&g<e)b=a[d].GetMinError(function(b,c,a){ULSEWi:;return a>g&&(f==null||f(b,c,a))});if(b==null)b=a[d].GetMinError(f);if(b!=null)b.recordKey=d}return b};this.ChangeKeys=function(b,d){ULSEWi:;if(c.Contains(b)){c.Remove(b);c.Add(d)}if(b in a){a[d]=a[b];delete a[b]}};function g(e){ULSEWi:;var b=null;for(var d in a){var c=a[d].GetMinError(e);if(c!=null&&(b==null||c.id<b.id)){b=c;b.recordKey=d}}return b}function h(d){ULSEWi:;var a=f.AnyErrors();c.Remove(d.recordKey);!a&&f.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true))}function i(d){ULSEWi:;var a=f.AnyErrors();c.Add(d.recordKey);a&&!f.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}function d(b){ULSEWi:;if(!a[b].AnyErrors())delete a[b]}};SP.JsGrid.Internal.ErrorNotificationManager=function(){ULSEWi:;var a=null,b,c,d=null;function e(d){ULSEWi:;if(d.bAnyErrors&&a==null)a=addNotification('<div class="jsgrid-error-notification" style="cursor:hand" onclick="'+(c+"_onclick()")+'" >'+String.format(SP.JsGrid.Res.gridErrorNotification,b.jsGridObj.name)+"</div>",true);else if(!d.bAnyErrors&&a!=null){removeNotification(a);a=null}}return {Init:function(f,a){ULSEWi:;b=a;b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,e);c=f;window[c+"_onclick"]=function(){ULSEWi:;d=b.jsGridObj.ScrollToAndExpandNextError(d)}}}}();SP.JsGrid.GridField=function(f,e,c,d,b,a){ULSEWi:;this.key=f;this.hasDataValue=e;this.hasLocalizedValue=c;this.textDirection=d;this._defaultCellStyleId=b;this._editMode=a==null?SP.JsGrid.EditMode.Defer:a;this._propType=null;this._multiValue=false};SP.JsGrid.GridField.prototype={GetEditMode:function(){ULSEWi:;return this._editMode},SetEditMode:function(a){ULSEWi:;this._editMode=a},GetDefaultCellStyleId:function(){ULSEWi:;return this._defaultCellStyleId},CompareSingleDataEqual:function(a,b){ULSEWi:;var c=this.GetSingleValuePropType().IsDataEqual;return c==null?a==b:c(a,b)},GetPropType:function(){ULSEWi:;return this._propType},GetSingleValuePropType:function(){ULSEWi:;return this._multiValue?this._propType.singleValuePropType:this._propType},GetMultiValuePropType:function(){ULSEWi:;return this._multiValue?this._propType:null},SetSingleValuePropType:function(a){ULSEWi:;if(this._multiValue&&a!=null){var b=new SP.JsGrid.PropertyType.MultiValuePropType(a.ID,this._listSeparator);SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(b,a.ID);this._propType=b}else this._propType=a},SetIsMultiValue:function(a){ULSEWi:;if(!this._multiValue){this._listSeparator=a;this._multiValue=true;this.SetSingleValuePropType(this._propType)}},GetIsMultiValue:function(){ULSEWi:;return this._multiValue}};SP.JsGrid.ColumnInfo=function(d,b,a,c){ULSEWi:;this.name=d;this.imgSrc=b;this.columnKey=a;this.fieldKeys=[a];this.width=c};SP.JsGrid.ColumnInfo.prototype={ColumnType:function(){ULSEWi:;return "column"},isVisible:true,isHidable:true,isResizable:true,isSortable:true,isAutoFilterable:true,fnShouldLinkSingleValue:null,fnSingleValueClicked:null,fnGetCellEditMode:null,fnGetDisplayControlName:null,fnGetEditControlName:null,fnGetWidgetControlNames:null,fnGetCellStyleId:null,fnGetSingleValueTooltip:null};SP.JsGrid.PivotedColumnInfo=function(e,c,a,b,d){ULSEWi:;this.name=e;this.imgSrc=c;this.columnKey=a;this.fieldKeys=b;this.width=d};SP.JsGrid.PivotedColumnInfo.prototype={ColumnType:function(){ULSEWi:;return "pivotedColumn"},isVisible:true,isHidable:false,isResizable:false,isSortable:false,isAutoFilterable:false,fnShouldLinkSingleValue:null,fnSingleValueClicked:null,fnGetCellEditMode:null,fnGetDisplayControlName:null,fnGetEditControlName:null,fnGetWidgetControlNames:null,fnGetCellStyleId:null,fnGetSingleValueTooltip:null};SP.JsGrid.ColumnInfoCollection=function(a){ULSEWi:;var b={};c();this.GetColumnByKey=function(a){ULSEWi:;return b[a]};this.GetColumnArray=function(d){ULSEWi:;var c=[];if(d)for(var b=0;b<a.length;++b)a[b].isVisible&&c.push(a[b]);else c=a;return c};this.GetColumnMap=function(){ULSEWi:;return b};this.InsertColumnAt=function(d,b){ULSEWi:;a.splice(d,0,b);c()};this.RemoveColumn=function(e){ULSEWi:;var f=b[e],d=SP.Internal.JS.FindKey(a,function(a){ULSEWi:;return a==f});d!=null&&a.splice(d,1);c()};this.GetColumnPosition=function(d){ULSEWi:;for(var c=0,b=0;b<a.length;++b)if(a[b].isVisible){if(a[b].columnKey==d)return c;c++}return null};function c(){ULSEWi:;for(var c=0;c<a.length;++c)b[a[c].columnKey]=a[c]}};SP.JsGrid.Internal.FillDownManager=function(k,m){ULSEWi:;var i,d,b,g,a,c,e,f;this.OnMouseDown=function(c,n,k,e,o,j){ULSEWi:;c.preventDefault();i=o;d=j;b=n;g=k;f=SP.Internal.DomElement.GetEventLocation(c);a=document.createElement("div");a.style.cssText="position:absolute;visibility:hidden;overflow:hidden;top:0px;left:0px";a.style.border=SP.JsGrid.Style.MakeBorderString(3,"solid",m.gridPaneStyle.fillRectBorderColor);g.appendChild(a);SP.Internal.DomElement.SetCapture(e,h,l);h(c)};function h(k){ULSEWi:;var h=d.GetLastSelectionRangeNormalized(),j=i.GetRowIdxColIdxFromCoord(k);if(j.rowIdx==null||j.colIdx==null)return;var l=SP.Internal.DomElement.GetEventLocation(k);e=Math.abs(l.x-f.x)>Math.abs(l.y-f.y);var g;if(e){c=new SP.Utilities.Range(Math.min(h.colRange.begin,j.colIdx),Math.max(h.colRange.end,j.colIdx));g=b.GetCellRangeBorderDrawingInfo(h.rowRange,c)}else{c=new SP.Utilities.Range(Math.min(h.rowRange.begin,j.rowIdx),Math.max(h.rowRange.end,j.rowIdx));g=b.GetCellRangeBorderDrawingInfo(c,h.colRange)}if(g==null){a.style.visibility="hidden";return}a.style.left=g.left-1+"px";a.style.top=g.top-1+"px";a.style.width=g.width-2+"px";a.style.height=g.height-2+"px";a.style.visibility="";b.ClipElementToTableViewport(a)}function l(){ULSEWi:;if(c==null)return;var b=j();n(b.repeatOrigin,b.srcRowRange,b.srcColRange,b.destRowRange,b.destColRange,b.trimmedDestRowRange,b.trimmedDestColRange);g.removeChild(a);a=null}function j(){ULSEWi:;var f=d.GetLastSelectionRangeNormalized(),l,n,m,b,a,j,i;if(e){n=b=j=f.rowRange;a=c;var k=f.colRange.begin!=a.begin;l=k?"TR":"TL";var g=f.colRange.Size();m=k?new SP.Utilities.Range(a.end-g+1,a.end):new SP.Utilities.Range(a.begin,a.begin+g-1);i=k?new SP.Utilities.Range(a.begin,a.end-g):new SP.Utilities.Range(a.begin+g,a.end)}else{m=a=i=f.colRange;b=c;var o=f.rowRange.begin!=b.begin;l=o?"BL":"TL";var h=f.rowRange.Size();n=o?new SP.Utilities.Range(b.end-h+1,b.end):new SP.Utilities.Range(b.begin,b.begin+h-1);j=o?new SP.Utilities.Range(b.begin,b.end-h):new SP.Utilities.Range(b.begin+h,b.end)}return {repeatOrigin:l,srcRowRange:n,srcColRange:m,destRowRange:b,destColRange:a,trimmedDestRowRange:j,trimmedDestColRange:i}}function n(l,g,f,a,e,i,h){ULSEWi:;if(g.Size()==a.Size()&&f.Size()==e.Size())return;var j=b.GetGridPaneConverter(),c;k.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(b){ULSEWi:;return c=j.GetRecordsInvolved(a.begin,a.Size(),function(a){ULSEWi:;c=a;b()})},function(){ULSEWi:;var k=b.GetData(c,g,f);b.PutData(k,c,"Fill",l,i,h,j);function j(){ULSEWi:;d.SelectRange(b,a.begin,a.end,e.begin,e.end,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true,false)}})}};SP.JsGrid.Internal.FocusManager=function(k,b,e,o,u,H,c,f,I,G,C){ULSEWi:;var m=this,g={anchor:0,input:1,parentNode:2},j=g.input,x,a,t=e.parentNode,i,A=true,d,p,h,l,v,K=SP.JsGrid.Internal.SelectionManager.SelectOp;this.SetView=function(c,d,a,b){ULSEWi:;p=c;h=d;l=a;v=b;x.NotifyViewChange()};this.Dispose=function(){ULSEWi:;$clearHandlers(i);$removeHandler(a,"focus",y);$removeHandler(a,"keydown",q);$removeHandler(a,"keypress",w);$removeHandler(a,"keyup",z);a=i=null};this.Focus=function(){ULSEWi:;try{f.IsEditing()&&f.StopEditing(false);r();a.focus()}catch(b){}};this.GetFocusElementForTextInput=function(b){ULSEWi:;if(A&&j==g.input&&b==SP.JsGrid.EditControl.Type.EditBox)return a;else return null};this.ChangeTextInputElementToFocusElement=function(){ULSEWi:;if(n()){a.blur();r();return true}return false};this.HandleKeyDown=function(a){ULSEWi:;var w=a.ctrlKey&&!a.altKey&&!a.shiftKey,x=!a.ctrlKey&&a.altKey&&!a.shiftKey,s=!a.ctrlKey&&!a.altKey&&a.shiftKey,y=!a.ctrlKey&&a.altKey&&a.shiftKey,t=a.ctrlKey&&!a.altKey&&a.shiftKey,r=!a.ctrlKey&&!a.altKey&&!a.shiftKey,i=c.GetFocus();if(!u()||i==null)return false;var k=i.gridPane,n=k.GetGridPaneConverter();if(B()){SP.Internal.DomElement.StopEvent(a);return true}if(J())return true;var M=L()||H()||z()||D()||E()||A();if(M){SP.Internal.DomElement.StopEvent(a);return true}F();return false;function F(){ULSEWi:;!f.IsEditing()&&c.IsOneCellSelected(c.GetLastSelectionRangeNormalized())&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnSingleCellKeyDown,new SP.JsGrid.EventArgs.SingleCellKeyDown(a,i.recordKey,i.fieldKey))}function J(){ULSEWi:;if(a.keyCode==SP.Internal.Key.IMEInput)return k.TryBeginEdit(a);return false}function L(){ULSEWi:;if(a.keyCode==Sys.UI.Key.esc){b.cutcopypasteMgr.CancelMode();return true}return false}function H(){ULSEWi:;function h(){ULSEWi:;function h(a){ULSEWi:;var c=a.GetColumn(),d=a.GetRecord(),b=a.GetFieldKey();if(d!=null){var e=d.GetProp(b),f=e==null?v[b].GetPropType():e.propType;return SP.JsGrid.Internal.Property.GetDisplayControlForProperty(f,c.fnGetDisplayControlName&&c.fnGetDisplayControlName(c,d,b))}else return null}k.ScrollCellIntoView(i.rowIdx,i.colIdx);var c=k.GetCellByIdx(i.rowIdx,i.colIdx);if(c!=null){var a=h(c),b=c.GetTd().childNodes;if(b&&a&&a.FocusNext&&a.FocusPrevious){var f=a.FocusNext(b,null);if(f!=null){d={};d.displayControl=a;d.displayControlContent=b;d.DOMElement=f;j==g.input&&$addHandler(e,"keydown",q)}}}}function l(){ULSEWi:;var a=b.tableCache.GetCachedRecord(i.recordKey);if(a!=null&&b.editUtil.CanEditField(a,n.GetColumnByIdx(i.colIdx),i.fieldKey)){var c=SP.JsGrid.CreateUnvalidatedPropertyUpdate(i.recordKey,i.fieldKey,null,true);b.jsGridObj.UpdateProperties([c],"User Edit")}}switch(a.keyCode){case Sys.UI.Key.del:if(r||w){if(b.editUtil.IsEditingEnabled())if(r)l();else b.delegateMgr.Apply(SP.JsGrid.DelegateType.DeleteRecords);else alert(o("GridNotEditable"));return true}break;case SP.Internal.Key.insert:if(r){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.InsertRecord);else alert(o("GridNotEditable"));return true}break;case Sys.UI.Key.down:if(x){k.ScrollCellIntoView(i.rowIdx,i.colIdx);var c=k.GetCellByIdx(i.rowIdx,i.colIdx);c!=null&&c.GetRecord()!=null&&f.IsBound()&&f.ExpandNextActor();return true}break;case Sys.UI.Key.up:if(x){h();return true}break;case Sys.UI.Key.right:if(y){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.IndentRecords);else alert(o("GridNotEditable"));return true}break;case Sys.UI.Key.left:if(y){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.OutdentRecords);else alert(o("GridNotEditable"));return true}break;case SP.Internal.Key.comma:if(t)return k.TryShiftColumnSelectionGroup(i.rowIdx,i.colIdx,-1);break;case SP.Internal.Key.dot:if(t)return k.TryShiftColumnSelectionGroup(i.rowIdx,i.colIdx,1);break;case SP.Internal.Key.back_slash:if(x)return k.ExpandColumnMenu(i.colIdx);else if(t){G();return true}break;case SP.Internal.Key.F2:if(r)return k.TryBeginEdit(a)}return false}function z(){ULSEWi:;function f(c,d){ULSEWi:;switch(a.keyCode){case Sys.UI.Key.enter:if(r){if(c!=null)c++}else if(s){if(c!=null)--c}else return null;break;case Sys.UI.Key.down:if(r||s||w||t){if(a.ctrlKey)c=n.GetVirtualRowCount()-1;else if(c!=null)c++}else return null;break;case Sys.UI.Key.up:if(r||s||w||t){if(a.ctrlKey)c=0;else if(c!=null)c--}else return null;break;case Sys.UI.Key.pageDown:if(r||s){if(c!=null){var e=n.RowIdxToRelRowIdx(c),f=n.GetWholeRowDisplayCapacity()-1;e=e!=f?f:f*2;c=n.RelRowIdxToRowIdx(e)}}else return null;break;case Sys.UI.Key.pageUp:if(r||s){if(c!=null){var e=n.RowIdxToRelRowIdx(c),f=n.GetWholeRowDisplayCapacity()-1;e=e!=0?0:-f;c=n.RelRowIdxToRowIdx(e)}}else return null;break;case Sys.UI.Key.home:if(r||s||w||t){d=0;if(a.ctrlKey)c=0}else return null;break;case Sys.UI.Key.end:if(r||s||w||t){d=n.GetVirtualColumnCount()-1;if(a.ctrlKey)c=n.GetVirtualRowCount()-1}else return null;break;case Sys.UI.Key.right:if(r||s){if(d!=null)d=d+(b.RTL.bEnabled?-1:1)}else return null;break;case Sys.UI.Key.left:if(r||s){if(d!=null)d=d-(b.RTL.bEnabled?-1:1)}else return null;break;case SP.Internal.Key.six:if(t){d=0;c=n.GetVirtualRowCount()-1}else return null;break;default:return null}var g;if(c!=null)c=Math.max(0,Math.min(n.GetVirtualRowCount()-1,c));if(d!=null)d=Math.max(0,Math.min(n.GetVirtualColumnCount()-1,d));return {rowIdx:c,colIdx:d}}function g(c,b){ULSEWi:;if(!a.shiftKey){if(++b==n.GetVirtualColumnCount()){b=0;if(++c==n.GetVirtualRowCount())return null}}else if(--b==-1){b=n.GetVirtualColumnCount()-1;if(--c==-1)return null}return {rowIdx:c,colIdx:b}}if(w||x||s||y||r||t)if(a.keyCode==Sys.UI.Key.tab){var d=g(i.rowIdx,i.colIdx);if(d!=null){c.SetFocusByPos(k,d.rowIdx,d.colIdx);return true}}else if(!a.shiftKey||s&&a.keyCode==Sys.UI.Key.enter){var d=f(i.rowIdx,i.colIdx);if(d!=null){c.SetFocusByPos(k,d.rowIdx,d.colIdx);return true}}else{var e=c.GetLastSelectionEndpoints(),d=f(e.rowIdx2,e.colIdx2);if(d!=null){d.rowIdx!=null&&C(d.rowIdx);d.colIdx!=null&&k.ScrollColumnIntoViewHorizontally(d.colIdx);c.SelectRange(k,e.rowIdx1,d.rowIdx,e.colIdx1,d.colIdx,K.Set,false,false);return true}}return false}function D(){ULSEWi:;var b=h.GetGridPaneConverter();if(a.keyCode==Sys.UI.Key.tab){if(p==SP.JsGrid.PaneLayout.GridAndPivotedGrid)if(r){if(k.Id==SP.JsGrid.PaneId.MainGrid){c.SetFocusByPos(l,0,0);return true}}else if(s&&k.Id==SP.JsGrid.PaneId.PivotedGrid){var e=b.GetVirtualRowCount()-1,d=b.GetVirtualColumnCount()-1;c.SetFocusByPos(h,e,d);return true}k.ShowFocus(false)}else if(a.keyCode==SP.Internal.Key.F6)if(p==SP.JsGrid.PaneLayout.GridAndPivotedGrid)if(k.Id==SP.JsGrid.PaneId.MainGrid){c.SetFocusByPos(l,l.GetGridPaneConverter().GetTopRowIdxForKey(i.recordKey),0);return true}else if(k.Id==SP.JsGrid.PaneId.PivotedGrid){c.SetFocusByPos(h,b.GetTopRowIdxForKey(i.recordKey),0);return true}return false}function B(){ULSEWi:;if(d==null)return false;if(a.target==d.DOMElement&&(a.keyCode==Sys.UI.Key.tab||a.keyCode==SP.Internal.Key.shift)){if(a.keyCode==Sys.UI.Key.tab){if(r)d.DOMElement=d.displayControl.FocusNext(d.displayControlContent,d.DOMElement);else if(s)d.DOMElement=d.displayControl.FocusPrevious(d.displayControlContent,d.DOMElement);d.DOMElement==null&&m.Focus()}return true}m.Focus();return false}function E(){ULSEWi:;var c=b.cutcopypasteMgr;if(a.ctrlKey&&!a.altKey&&!a.shiftKey)switch(String.fromCharCode(a.keyCode).toUpperCase()){case "X":c.OnCut(k);return true;case "C":c.OnCopy(k);return true;case "V":c.OnPaste(k);return true}return false}function A(){ULSEWi:;var c=k.GetCellByIdx(i.rowIdx,i.colIdx);if(c!=null){var b=c.GetRecord();if(b!=null){var e=c.GetColumn(),d=c.GetFieldKey(),h=v[d],j=b.GetProp(d),f=j==null?h.GetPropType():j.propType,g=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(f,e.fnGetDisplayControlName&&e.fnGetDisplayControlName(e,b,d));if(g.OnKeyDown!=null)return g.OnKeyDown(a,I(b,d,f),b,e,h,f)}}return false}};function n(){ULSEWi:;return f.IsEditing()&&m.GetFocusElementForTextInput(f.GetCurrentEditControlName())!=null}function y(){ULSEWi:;if(n())return;if(H()){var b=c.GetFocus();if(b==null){var a=h.GetGridPaneConverter();if(a.GetVirtualRowCount()==0)return;else c.SetFocusByPos(h,a.GetTopRowIdx(),h.GetLeftMostColumnIdx())}else b.gridPane.ShowFocus(true);if(d!=null){d=null;j==g.input&&$removeHandler(e,"keydown",q)}}}function q(a){ULSEWi:;if(n())f.OnActorKeyDown(a,f.GetCurrentEditControlName());else if(f.IsEditing())if(j==g.input){f.StopEditing();m.HandleKeyDown(a)}else return;else m.HandleKeyDown(a)}function w(a){ULSEWi:;if(f.IsEditing())return;var b=c.GetFocus();if(!u()||b==null)return;var e=b.gridPane;function d(){ULSEWi:;if(SP.JsGrid.Utility.IsChar(a)&&!a.altKey&&!a.ctrlKey)e.TryBeginEdit(a)&&!n()&&SP.Internal.DomElement.StopEvent(a)}d()}function z(){ULSEWi:;if(f.IsEditing())return;if(j==g.input)a.value=""}function F(){ULSEWi:;switch(j){case g.anchor:a=D();s(a,a);break;case g.input:a=E();r();s(e,e);break;case g.parentNode:a=B();s(e,e)}}function D(){ULSEWi:;var a=document.createElement("a");a.id=k+"_focusElement";a.href="#";t.insertBefore(a,e);a.appendChild(e);return a}function E(){ULSEWi:;var a=document.createElement("input");a.id=k+"_focusElement";a.className="jsgrid-control-editbox";e.insertBefore(a,e.firstChild);return a}function r(){ULSEWi:;var b=a.style;b.position="fixed";b.top="0px";b.left="-10000px";a.value=""}function B(){ULSEWi:;e.tabIndex=0;return e}function s(b,d){ULSEWi:;var a=document.createElement("a");a.href="#";a.className="ms-skip";a.onclick=function(){ULSEWi:;this.href="#"+k+"_skippedGridContent"};SP.Internal.DomElement.SetText(a,SP.JsGrid.Res.skipGridContent);t.insertBefore(a,b);i=document.createElement("a");i.id=k+"_skippedGridContent";i.href="#";t.insertBefore(i,d.nextSibling);$addHandler(i,"keydown",e);function e(d){ULSEWi:;if(d.shiftKey&&d.keyCode==Sys.UI.Key.tab){var g=c.GetFocus();if(g==null){var b=p==SP.JsGrid.PaneLayout.GridAndPivotedGrid?l:h,a=b.GetGridPaneConverter(),f=a.GetVirtualRowCount()-1,e=a.GetVirtualColumnCount()-1;c.SetFocusByPos(b,f,e)}}}}function L(){ULSEWi:;F();x=b.ariaMgr=new J;$addHandler(a,"focus",y);$addHandler(a,"keydown",q);$addHandler(a,"keypress",w);$addHandler(a,"keyup",z)}function J(){ULSEWi:;var d=this;function f(){ULSEWi:;a.setAttribute("role",b.controller.GetHierarchyManager()==null?"grid":"treegrid");var c=document.createElement("label");c.id=a.id+"_labelFor";c.setAttribute("for",a.id);c.appendChild(document.createTextNode(b.jsGridObj.name));c.style.cssText="display:none;";e.appendChild(c);a.setAttribute("aria-label",b.jsGridObj.name);a.setAttribute("aria-labelledby",a.id+"_labelFor");a.setAttribute("aria-multiselectable","true");j==g.input&&a.setAttribute("aria-owns",k)}this.NotifyViewChange=function(){ULSEWi:;d.EnableGrid(u());d.EnableGridEditing(b.editUtil.IsEditingEnabled())};this.EnableGrid=function(b){ULSEWi:;a.setAttribute("aria-disabled",(!b).toString())};this.EnableGridEditing=function(b){ULSEWi:;a.setAttribute("aria-readonly",(!b).toString())};this.OnFocusCell=function(i,j,g,c,f){ULSEWi:;if(j!=null){var e=j.GetTd();e.removeAttribute("id");e.removeAttribute("aria-describedby");d.SetSelected(e,false);if(g!=null){var n=g.GetTd();n.removeAttribute("id")}}if(c!=null){var e=c.GetTd(),l=String.format("{0}_{1}_{2}_{3}",k,i,c.GetRowIdx(),c.GetColIdx());e.setAttribute("id",l);a.setAttribute("aria-activedescendant",l);d.SetSelected(e,true);var m=c.GetRecord(),o=m!=null&&b.editUtil.CanEditField(m,c.GetColumn(),c.GetFieldKey());e.setAttribute("aria-readonly",(!o).toString());if(f!=null){var n=f.GetTd(),h=String.format("{0}_{1}_{2}",k,i,f.GetColIdx());n.setAttribute("id",h);e.setAttribute("aria-describedby",h)}}else a.removeAttribute("aria-activedescendant")};this.OnInsertTableRow=function(e,a,h){ULSEWi:;e.setAttribute("role","row");if(a==null&&h==-1)return;var g=a!=null&&a!=SP.JsGrid.Internal.LoadErrorState,j=g?a.key():null;if(!g)e.setAttribute("aria-busy",a==null?"true":"error");else if(b.controller.GetHierarchyManager()!=null&&!b.entryRecordMgr.IsEntryRecordKey(j)){var f=b.controller.GetHierarchyManager().GetNodeInfo(a);if(f.nodeType==SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed)e.setAttribute("aria-expanded","false");else f.nodeType==SP.JsGrid.Internal.HierarchyManager.NodeType.Expanded&&e.setAttribute("aria-expanded","true");e.setAttribute("aria-level",(f.indent+1).toString())}var k=c.GetFocusedPane(),i=c.IsRowSelected(k,h);d.SetSelected(e,i)};this.OnInsertRowHeaderCell=function(a){ULSEWi:;a.setAttribute("role","presentation")};this.OnInsertColHeaderCell=function(a){ULSEWi:;a.setAttribute("scope","col");a.setAttribute("role","columnheader")};this.OnInsertGridCell=function(a){ULSEWi:;a.setAttribute("role","gridcell")};this.SetSelected=function(b,a){ULSEWi:;b.setAttribute("aria-selected",a.toString())};f()}L()};SP.JsGrid.Internal.GridPane=function(t,c,Hb,hb,U,d,Z,j,R,Yb,l,Tb,Zb,Rb,K){ULSEWi:;var ic=c.intEventMgr,g=c.styleMgr,ec=c.jsGridObj,T=c.delegateMgr,hc=c.intDelegateMgr,db=c.ariaMgr,kb="#B0B5BA",sb="#B0B5BA",i,k=K.selDragHandle,u=K.selFrames,E=K.focusFrames,A=K.copyFrames,Ub,h,s,C,Y=false,m,ac,gc,z,n,r,j,e,y,b=this,wb,D,X,Q,G,P,H,M,tb,f,a,S,w,B=SP.JsGrid.Internal.SelectionManager.SelectOp,p,F,Ab=false,mb,jb,J,o,Bb,ab={width:-1,height:-1},x={};this.Id=SP.JsGrid.PaneId.MainGrid;this.SetEventSinks=function(a){ULSEWi:;ac=a};this.GetLeftMostColumnIdx=function(){ULSEWi:;return m.GetTopItemIdx()};this.Dispose=function(){ULSEWi:;J!=null&&SP.JsGrid.AsynchronousCellUpdater.FlushJob(J);b.ClearView();$clearHandlers(t);$clearHandlers(i);f.Dispose();a.Dispose();m.Dispose();l.Dispose();S.Dispose();i=k=u=E=A=Ub=h=h.textDiv=s=t=null;Ab=true};this.ClearView=function(){ULSEWi:;q();S.ClearHeaderEvents();a.ClearTable()};this.SetView=function(s,q,f,r,h,p,k,o,n,e,j){ULSEWi:;var b=Math.max(0,l.GetHeight()-fb());i.style.height=b+"px";wb=q;X=h;Q=p;G=k;P=o;H=n;M=e;tb=j;D=r;a.SetPosConverterObj(s);var c=a.InitTable(tb);c!=null&&SP.JsGrid.Style.ApplyCornerHeaderBorderStyle(c.GetTd(),g.columnHeaderStyleCollection.normal,g.rowHeaderStyleCollection.normal);cb(f,true);var d=l.GetWidth();m.Update({physicalViewportSize:d-a.GetRowHeaderWidth(),scrollbarSize:d,topItemIdx:0,bScrollNotifiy:false});eb(b);S.SetupHeaderEvents()};this.GetGridPaneConverter=function(){ULSEWi:;return e};this.ShowFocus=function(a){ULSEWi:;W(!a)};this.OnResize=function(){ULSEWi:;var c={width:l.GetWidth(),height:l.GetHeight()};if(c.width!=ab.width||c.height!=ab.height){a.OptimizeTableColumns();yb();var d=l.GetWidth();m.Update({physicalViewportSize:d-a.GetRowHeaderWidth(),scrollbarSize:d});q();j.NotifyMove(b);ab=c}};this.SetRowHeight=function(b){ULSEWi:;Bb=b;a.SetRowHeight(Bb)};this.GetMinRowHeight=function(){ULSEWi:;return 21};this.SpliceRows=function(b,c,e,f,d){ULSEWi:;a.SpliceRows(b,c,e,f);if(r!=null&&r>=b&&r<=b+c-1)r=null;if(d)bb();else q()};this.SetSortState=function(a){ULSEWi:;f.SetSortState(a)};this.SetFilterState=function(a){ULSEWi:;f.SetFilterState(a)};this.NotifyCanEditUpdated=function(){ULSEWi:;vb();W(false)};this.NotifyCopyOperationUpdated=function(){ULSEWi:;ub()};this.UpdateFocusAfterInsertOrDeleteRows=function(c,e,f){ULSEWi:;var a=d.GetFocusForPane(b);if(a!=null)if(f)a.rowIdx>=c&&d.SetFocusByPos(b,a.rowIdx+e,a.colIdx);else if(a.rowIdx>=c&&a.rowIdx<c+e)d.SetFocusByPos(b,Math.max(c-1,0),a.colIdx);else a.rowIdx>=c+e&&d.SetFocusByPos(b,a.rowIdx-e,a.colIdx)};this.ChangeKeys=function(c,b){ULSEWi:;a.ChangeKeys(c,b)};this.RenderRows=function(b){ULSEWi:;a.RenderRows(b)};this.NotifyChangeIndicatorsClearing=function(){ULSEWi:;for(var d=a.GetAllDataCells(),c=0;c<d.length;c++){var b=d[c];if(b.GetRecord()!=null)Z.IsCellIn(b.GetRecordKey(),b.GetFieldKey())&&I(b,true,false)}};this.Select=function(f,g,c,e,a){ULSEWi:;d.SelectRange(b,f,g,c,e,a?B.Append:B.Set,true,false)};this.SelectByKey=function(c,d,a,b,j){ULSEWi:;var h,i,f,g;if(c!=null&&d!=null){h=a!=null?e.KeyToIdx(c,a).rowIdx:e.GetTopRowIdxForKey(c);i=b!=null?e.KeyToIdx(d,b).rowIdx:e.GetTopRowIdxForKey(d)}if(a!=null&&b!=null){f=e.FieldKeyToColIdx(a);g=e.FieldKeyToColIdx(b)}this.Select(h,i,f,g,j)};this.NotifySelectionUpdating=function(){ULSEWi:;var c={rowRange:new SP.Utilities.Range(a.BeginRowIdx(),a.EndRowIdx()-1),colRange:new SP.Utilities.Range(a.BeginColIdx(),a.EndColIdx()-1)},e=d.GetComponentsWithin(b,c.rowRange,c.colRange);return {visibleRanges:c,clearedCells:e,oldFocus:d.GetFocusForPane(b)}};this.ScrollCellIntoView=function(e,d){ULSEWi:;var c=Hb(e),a=b.ScrollColumnIntoViewHorizontally(d);return c||a};this.GetCellByIdx=function(c,b){ULSEWi:;return a.GetCellByIdx(c,b)};this.NotifySelectionUpdated=function(c,l){ULSEWi:;var e=d.GetFocusForPane(b),o=d.GetComponentsWithin(b,c.visibleRanges.rowRange,c.visibleRanges.colRange);m(c.clearedCells,o,c.oldFocus,e);p();var g=false;if(e&&l)g=b.ScrollCellIntoView(e.rowIdx,e.colIdx);!g&&q();vb();var k,i,j,h;if(c.oldFocus!=null){k=a.GetCellByIdx(c.oldFocus.rowIdx,c.oldFocus.colIdx);i=a.GetColumnHeader(c.oldFocus.colIdx)}if(e!=null){j=a.GetCellByIdx(e.rowIdx,e.colIdx);h=a.GetColumnHeader(e.colIdx)}db.OnFocusCell(this.Id,k,i,j,h);function m(i,h,c,b){ULSEWi:;var d=i.SymmetricDifference(h);if(c!=null){d.Remove(SP.JsGrid.Internal.MakeCellKey(c.rowIdx,c.colIdx));e(c)}if(b!=null){d.Remove(SP.JsGrid.Internal.MakeCellKey(b.rowIdx,b.colIdx));e(b)}for(var j in d.GetCollection()){var f=SP.JsGrid.Internal.CrackCellKey(j),g=a.GetCellByIdx(f.rowIdx,f.colIdx);g!=null&&I(g,false,true)}function e(b){ULSEWi:;var c=a.GetCellByIdx(b.rowIdx,b.colIdx);if(c!=null)I(c,false,true);else L(b.recordKey,b.fieldKey,null,false)}}function p(){ULSEWi:;for(var e=a.GetColumnHeaders(),c=0;c<e.length;c++)f.ApplyHeaderStyle(e[c].GetTd(),v(e[c].GetColIdx(),false),e[c].GetColIdx()==n);e=a.GetRowHeaders();for(var c=0;c<e.length;c++){var g=e[c].GetTd();SP.JsGrid.Style.ApplyRowHeaderStyle(g,v(e[c].GetRowIdx(),true),N,e[c].GetRowIdx()==r);var h=d.IsRowSelected(b,e[c].GetRowIdx());db.SetSelected(g.parentNode,h)}}};this.GetMinHeaderHeight=function(){ULSEWi:;return 31};this.SetHeaderHeight=function(b){ULSEWi:;a.SetHeaderHeight(b)};this.ScrollColumnIntoViewHorizontally=function(b){ULSEWi:;if(b<=a.BeginColIdx())return m.Update({topItemIdx:b});else{var f=a.GetColumnHeader(b),d=f&&f.GetTd(),h=d&&(c.RTL.bEnabled?a.GetTdCoords(d).left<0:a.GetTdCoords(d).right>l.GetWidth());if(!d||h){for(var i=a.GetSelectAllSquare()?a.GetSelectAllSquare().GetTd().offsetWidth:0,g=l.GetWidth()-i-e.GetColumnByIdx(b).width;b>0&&(g-=e.GetColumnByIdx(b-1).width,g>=0);b--);return m.Update({topItemIdx:b})}}return false};this.NotifyUpdateProperty=function(b,c,f,d,g,h){ULSEWi:;f&&Z.AddCell(b,c);var e=a.GetCellByKey(b,c);if(e!=null){d!=null&&g==SP.JsGrid.ValidationState.Valid&&j.NotifyUpdateProperty(this,b,c,d,h);a.RefreshCell(e)}};this.BeginRowIdx=function(){ULSEWi:;return a.BeginRowIdx()};this.BeginColIdx=function(){ULSEWi:;return a.BeginColIdx()};this.ShowColumn=function(a,b){ULSEWi:;e.GetColumnByKey(a)==null&&dc(w.GetColumnByKey(a),b)};this.HideColumn=function(b){ULSEWi:;var a=e.GetColumnByKey(b);a!=null&&bc(a)};this.UpdateColumns=function(a){ULSEWi:;cb(a,false)};this.GetVisibleColumns=function(){ULSEWi:;for(var c=[],a=0;a<e.GetVirtualColumnCount();a++){var b=e.GetColumnByIdx(a);c.push({columnKey:b.columnKey,width:b.width})}return c};this.GetAllColumns=function(){ULSEWi:;return w};this.GetColumns=function(){ULSEWi:;for(var c=[],b=w.GetColumnArray(),a=0;a<b.length;a++)c.push(b[a]);return c};this.GetFocusedCell=function(){ULSEWi:;var c=d.GetFocusForPane(b),e=c&&a.GetCellByIdx(c.rowIdx,c.colIdx);return e!=null&&e.GetCellType()==a.CellType.Cell?e:null};this.GetData=function(j,b,a){ULSEWi:;for(var h=new Array(b.Size()),d=b.begin;d<=b.end;d++){for(var g=new Array(a.Size()),f=a.begin;f<=a.end;f++){var i=e.IdxToKey(d,f);g[f-a.begin]=c.editUtil.GetFieldValueForCopy(j[i.recordKey],i.fieldKey)}h[d-b.begin]=g}return {matrix:h,height:b.Size(),width:a.Size()}};this.PutData=function(j,u,r,d,b,a,s,h){ULSEWi:;var m=new Array(b.Size()*a.Size()),i=j.height,k=j.width,v=-b.begin+(d=="TL"||d=="TR"?0:i-b.Size()%i),t=-a.begin+(d=="TL"||d=="BL"?0:k-a.Size()%k),l=c.controller.CreateDataUpdateCmd(true),n=l.GetChangeKey();c.commandMgr.Execute(l,null,SP.JsGrid.CommandManager.CommandType.Explicit);var g=writeRowIdx=b.begin,w=b.Size()*a.Size(),p=100,f=0;c.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.DoLargeTask,w,p,q,o,SP.JsGrid.AsynchronousTaskManager.Priority.SuperHigh);function q(o,q){ULSEWi:;var p;while(g<=b.end){p=false;for(var l=a.begin;l<=a.end;l++){var d=e.IdxToKey(writeRowIdx,l);if(c.editUtil.CanEditField(h?c.entryRecordMgr.GetEntryRecord(d.recordKey):u[d.recordKey],e.GetColumnByIdx(l),d.fieldKey)){m[f++]=SP.JsGrid.CreateUnvalidatedPropertyUpdate(d.recordKey,d.fieldKey,j.matrix[(g+v)%i][(l+t)%k],true);h&&d.recordKey==c.entryRecordMgr.GetLastEntryKey()&&c.entryRecordMgr.CreateEntryRows(1,false,n);p=true}}if(!h||p)writeRowIdx++;g++;o+=a.Size();if(o>=q)break}return o}function o(){ULSEWi:;f>0&&c.controller.UpdateProperties(m.slice(0,f),r,n);l.NotifyInitialUpdateComplete();s(writeRowIdx-b.begin)}};this.FieldKeyToColumnKey=function(c){ULSEWi:;for(var b=w.GetColumnArray(),a=0;a<b.length;a++)if(SP.Internal.JS.FindInArray(b[a].fieldKeys,function(a){ULSEWi:;return a==c})!=null)return b[a].columnKey;return null};function fc(){ULSEWi:;f=new SP.JsGrid.Internal.HeaderManager(c,g);jb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(L);mb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(Lb);J=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(Sb);Gb();Fb();a=new SP.JsGrid.Internal.TableManager(i,t.id,l,Zb,c,Vb,Ob,j,d,h,Qb,Rb,Wb);e=a.GetGridPaneConverter();S=new Jb(b);function j(){ULSEWi:;lb();if(F==null)F=setTimeout(pb,0)}function d(a){ULSEWi:;f.DisposeHeader(a)}function h(a){ULSEWi:;f.UpdateHeaderHeights(a)}t.style.backgroundColor=g.gridPaneStyle.backgroundColor}function Gb(){ULSEWi:;t.style.verticalAlign="top";i=document.createElement("div");i.style.cssText="overflow:hidden;position:relative;text-align:"+c.RTL.left;t.appendChild(i);C=document.createElement("div");C.style.height=SP.Internal.ScrollBar.GetSystemScrollBarThickness()+"px";t.appendChild(C);m=new SP.JsGrid.Internal.ScrollBar(SP.JsGrid.Internal.ScrollBar.BarType.Horizontal,C,false,{itemSize:100},g.scrollBarStyle,c.RTL.bEnabled);m.SetOnScroll(Mb);hb!=null&&m.SetOnVisibilityChanged(Eb,true)}function fb(){ULSEWi:;return C.style.display=="none"?0:SP.Internal.ScrollBar.GetSystemScrollBarThickness()}function Eb(a){ULSEWi:;C.style.display=a?"":"none";yb();hb(a)}function yb(){ULSEWi:;var a=Math.max(0,l.GetHeight()-fb());i.style.height=a+"px";eb(a)}function Mb(c){ULSEWi:;a.ScrollColumns(c.topIdx);q();j.NotifyMove(b)}function cb(k,h){ULSEWi:;var l=d.GetFocusForPane(b);w=k;var i=w.GetColumnArray();p=[];for(var e=[],g=0;g<i.length;g++){var c=i[g];if(c.isVisible){f.AdjustColumnWidth(c);p.push(c.width);e.push(c)}}m.Update({itemCount:e.length,itemSizes:p});a.SetColumns(e,h);if(!h){V(l);q();j.NotifyMove(b)}}function Xb(b){ULSEWi:;r!=null&&zb();r=b;SP.JsGrid.Style.ApplyRowHeaderStyle(a.GetRowHeader(b).GetTd(),v(b,true),N)}function zb(){ULSEWi:;if(r!=null){var b=r;r=null;var c=a.GetRowHeader(b);c!=null&&SP.JsGrid.Style.ApplyRowHeaderStyle(c.GetTd(),v(b,true),N)}}function xb(b){ULSEWi:;if(n!=b){O();n=b;f.ApplyHeaderStyle(a.GetColumnHeader(b).GetTd(),v(b,false),true)}f.ShowMenuOnColumn(a.GetColumnHeader(b).GetTd())}function O(){ULSEWi:;if(n!=null&&(z==null||n!=z)){var b=n;n=null;var c=a.GetColumnHeader(b);c!=null&&f.ApplyHeaderStyle(c.GetTd(),v(b,false));f.HideMenuOnColumn()}}function Fb(){ULSEWi:;h=document.createElement("table");h.style.cssText="position:absolute; visibility:hidden; table-layout:fixed;z-index:1;padding-"+c.RTL.left+":7px;";i.appendChild(h);h.cellPadding=h.cellSpacing=0;var a=h.insertRow(-1).appendChild(document.createElement("th")),b=g.columnHeaderStyleCollection.normal;a.style.borderLeft=a.style.borderRight=SP.JsGrid.Style.MakeBorderString(1,"solid",b.innerBorderColor);a.style.borderTop=SP.JsGrid.Style.MakeBorderString(1,"solid",b.outerBorderColor);h.textDiv=a.appendChild(document.createElement("div"));h.textDiv.style.cssText="text-overflow:none; overflow:hidden; width:100%; margin-"+c.RTL.left+":-1px;";s=document.createElement("div");s.style.cssText="visibility:hidden; width:3px; background-color:"+g.gridPaneStyle.columnDropIndicatorColor+"; position:absolute";i.appendChild(s)}function Sb(c,d,b){ULSEWi:;for(var a=0;a<b.length;a++)b[a]()}function Lb(f,e,k){ULSEWi:;var b=a.GetCellByKey(f,e);if(b==null||!c.editUtil.IsEditingEnabled())return;if(!c.editUtil.CanEditField(b.GetRecord(),b.GetColumn(),e)&&(o==null||o.rk!=f||o.fk!=e)){var d=SP.JsGrid.Style.MergeCellStyles(k,g.readOnlyCellStyle);if(d.backgroundColor!=null){var h=b.GetTd(),j=SP.Internal.DomElement.GetComputedStyle(h,"backgroundColor","background-color"),i=h.computedBackgroundColor;h.computedBackgroundColor=d.backgroundColor;if(i!=j){L(f,e,b);delete d.backgroundColor}SP.JsGrid.Style.ApplyCellStyle(b.GetTd(),d)}else SP.JsGrid.Style.ApplyCellStyle(b.GetTd(),d)}}function L(l,m,w,x){ULSEWi:;var f,j=w==null?a.GetCellByKey(l,m):w;if(j!=null)f=j.GetTd();var h;if(o!=null&&o.rk==l&&o.fk==m){h=o;o=null}if(f==null||j==null)return;var u=Z.IsCellIn(l,m),i=e.KeyToIdx(l,m),q=d.GetFocusForPane(b),t=i!=null&&d.IsCellSelected(b,i.rowIdx,i.colIdx),v=i!=null&&q!=null&&i.rowIdx==q.rowIdx&&i.colIdx==q.colIdx,r=t&&!v,s=null;if(f.computedBackgroundColor==null&&v&&c.editUtil.IsEditingEnabled()&&!c.editUtil.CanEditField(j.GetRecord(),j.GetColumn(),j.GetFieldKey())){o={rk:l,fk:m,textColor:h!=null?h.textColor:f.style.color,backgroundColor:h!=null?h.backgroudColor:f.style.backgroundColor};f.style.color="#4D4E53";f.style.backgroundColor="#E2E2E2";s=true}else if(h!=null){f.style.color=h.textColor;f.style.backgroundColor=h.backgroundColor}if(!s&&(u||r)){var p=f.computedBackgroundColor,k=SP.JsGrid.Internal.Color.HexStringToColor(p=="transparent"||p==null?g.defaultCellStyle.backgroundColor!=null?g.defaultCellStyle.backgroundColor:SP.JsGrid.Style.GetCellStyleDefaultBackgroundColor():p);if(u&&!x){var n=g.gridPaneStyle.changeHighlightCellBgColor;if(n!=null)k=SP.JsGrid.Internal.Color.AlphaBlend(n,k)}if(r){var n=g.gridPaneStyle.selectedCellBgColor;if(n!=null)k=SP.JsGrid.Internal.Color.AlphaBlend(n,k)}f.style.backgroundColor=SP.JsGrid.Internal.Color.ColorToHexString(SP.JsGrid.Internal.Color.RemoveAlphaChannel(k))}db.SetSelected(f,t);return}function Kb(b,m,d,p){ULSEWi:;var a={};if(p)a=SP.JsGrid.Style.MergeCellStyles(g.defaultCellStyle,a);var h=b==null,f;if(h)f=D[d].GetPropType();else{var n=b.GetProp(d);f=n!=null?n.propType:null}if(f!=null&&f.GetStyleId!=null){var i=f.GetStyleId(h?null:b.GetDataValue(d));if(i!=null)a=SP.JsGrid.Style.MergeCellStyles(g.GetCellStyle(i),a)}if(!h){if(c.jsGridParams.tableViewParams.rowViewParams.hierarchyMode==SP.JsGrid.HierarchyMode.Grouping&&g.groupingStyles!=null&&g.groupingStyles.length>0){var j=c.controller.GetHierarchyManager();if(j.IsGroupingRecord(b.key()))a=SP.JsGrid.Style.MergeCellStyles(g.groupingStyles[j.GetNodeIndentLevel(b)%g.groupingStyles.length],a)}var e=X&&X(b);e=e!=null?e:wb.GetValue(b,SP.JsGrid.OperationalConstants.GridRowStyleId);if(e!=null){var k=g.GetCellStyle(e);if(k!=null)a=SP.JsGrid.Style.MergeCellStyles(k,a)}}var l=D[d].GetDefaultCellStyleId();if(l!=null)a=SP.JsGrid.Style.MergeCellStyles(g.GetCellStyle(l),a);if(m.fnGetCellStyleId!=null&&!h){var o=m.fnGetCellStyleId(b,d,b.HasDataValue(d)?b.GetDataValue(d):null);if(o!=null){var i=g.GetCellStyle(o);if(i!=null)a=SP.JsGrid.Style.MergeCellStyles(i,a)}}return a}function I(b,i,j){ULSEWi:;var h=b.GetRecord(),k=b.GetColumn(),d=b.GetFieldKey(),f=b.GetTd(),e=h!=null?h.recordKey:b.GetRecordKey();if(f.style.backgroundColor!="")f.style.backgroundColor="";var a=Kb(h,k,d,false);if(!SP.Internal.JS.IsAssocArrayEmpty(a)){SP.JsGrid.Style.ApplyCellStyle(f,a);if(o!=null&&o.rk==e&&o.fk==d){o.textColor=a.textColor!=null?a.textColor:g.defaultCellStyle.textColor!=null?g.defaultCellStyle.textColor:"";o.backgroundColor=a.backgroundColor!=null?a.backgroundColor:g.defaultCellStyle.backgroundColor!=null?g.defaultCellStyle.backgroundColor:""}}f.computedBackgroundColor=a.backgroundColor;if(j)L(e,d,b,i);else SP.JsGrid.AsynchronousCellUpdater.RegisterCell(jb,e,d);c.editUtil.IsEditingEnabled()&&SP.JsGrid.AsynchronousCellUpdater.RegisterCell(mb,e,d,a);return a}function bb(){ULSEWi:;var a=d.GetFocusForPane(b);a!=null&&d.SelectRange(b,a.rowIdx,a.rowIdx,a.colIdx,a.colIdx,B.Set,false,false)}function vb(){ULSEWi:;var h=d.GetFocusForPane(b);if(h!=null){var e=a.GetCellByIdx(h.rowIdx,h.colIdx);if(e!=null&&e.GetCellType()==a.CellType.Cell){var f=e.GetRecord(),k=e.GetColumn(),g=e.GetFieldKey();if(j.IsBound()&&(f==null||!j.IsBoundToCell(b,f.key(),g)))j.Unbind(function(){ULSEWi:;i(e,f,k,g)});else i(e,f,k,g)}}function i(f,a,e,d){ULSEWi:;!j.IsBound()&&a!=null&&c.editUtil.CanBindToField(a,e,d)&&j.BindToCell(b,a,e,d,D,f,I(f,false,true))}}this.TryShiftColumnSelectionGroup=function(p,j,l){ULSEWi:;var s=false;if(Q){var q=d.GetRowRanges(b),g=d.GetColumnRanges(b),f=d.GetCellRanges(b),t=q==null||q.length==0,c=g==null||g.length==0,m=f==null||f.length==0;if(t&&(c||m)&&(c||g.length==1)&&(m||f.length==1)){var a=c?f[0].colRange:g[0],h=l>0?a.end+1:a.begin-1;if(h>=0&&h<e.GetVirtualColumnCount()){for(var o=c?SP.JsGrid.SelectionType.CellRange:SP.JsGrid.SelectionType.ColumnRange,k=[nb(p,j,c?f[0]:g[0],o,true,false)],r=a.begin;r<=a.end;r++){var n=h+(l>0?-1:1);k.push(qb(h,n));h=n}var i=l>0?1:-1;a.begin+=i;a.end+=i;j+=i;k.push(nb(p,j,c?f[0]:g[0],o,false,true));U.Execute(new SP.JsGrid.CommandManager.AggregateCommand(k,true),"Column Reorder",SP.JsGrid.CommandManager.CommandType.Explicit);s=true}}}return s};function nb(m,l,a,i,j,k){ULSEWi:;var g,h,c,e;if(i==SP.JsGrid.SelectionType.ColumnRange){c=a.begin;e=a.end}if(i==SP.JsGrid.SelectionType.CellRange){c=a.colRange.begin;e=a.colRange.end;g=a.rowRange.begin;h=a.rowRange.end}function f(){ULSEWi:;d.SetFocusByPos(b,m,l);d.SelectRange(b,g,h,c,e,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true)}return {Apply:!j?f:function(){},Undo:!k?f:function(){}}}function eb(d){ULSEWi:;y={left:1+l.GetLeftOffset(),top:1+a.GetHeaderHeight(),right:1+l.GetLeftOffset()+l.GetWidth(),bottom:1+d};var b=a.GetRowHeaderWidth()?a.GetRowHeaderWidth():0;if(c.RTL.bEnabled)y.right-=b;else y.left+=b}this.GetTdCoordsRelativeToParentNode=function(c){ULSEWi:;var b;if(c.parentNode!=null){b=a.GetTdCoords(c);b.left+=1+l.GetLeftOffset();b.right+=1+l.GetLeftOffset();b.top+=1;b.bottom+=1}return b};this.GetTableViewportRelativeToParentNode=function(){ULSEWi:;return y};this.ClipElementToTableViewport=function(a){ULSEWi:;var e=y.top-a.offsetTop+"px",c=y.right-a.offsetLeft+"px",b=y.bottom-a.offsetTop+"px",d=y.left-a.offsetLeft+"px";a.style.clip=["rect(",e,c,b,d,")"].join(" ")};this.GetCellRangeBorderDrawingInfo=function(e,d){ULSEWi:;var b={},g=a.BeginRowIdx(),i=a.EndRowIdx()-1,f=a.BeginColIdx(),h=a.EndColIdx()-1;b.bBeginsBeforeColumnHeader=e.begin<g;var m=e.begin>i;b.bBeginsBeforeRowHeader=d.begin<f;var n=d.begin>h,r=e.end<g,p=e.end>i,q=d.end<f;if(m||n||r||q)return null;var s=a.GetCellByIdx(Math.max(g,e.begin),c.RTL.bEnabled?Math.min(h,d.end):Math.max(f,d.begin)),o=a.GetCellByIdx(Math.min(i,e.end),c.RTL.bEnabled?Math.max(f,d.begin):Math.min(h,d.end)),k=this.GetTdCoordsRelativeToParentNode(s.GetTd()),j=this.GetTdCoordsRelativeToParentNode(o.GetTd());b.left=k.left;b.top=k.top;b.right=j.right;b.bottom=p?b.top+l.GetHeight()+1:j.bottom;b.width=b.right-b.left-2;b.height=b.bottom-b.top-2;return b};function q(){ULSEWi:;W(false);Pb();ub();a.UpdateErrorFrames()}function W(t){ULSEWi:;function s(){ULSEWi:;k.style.backgroundColor=sb;for(var a in u)u[a].style.borderColor=sb}function m(){ULSEWi:;k.style.visibility="hidden";for(var a in u)u[a].style.visibility="hidden"}if(t){s();return}if(d.GetFocusForPane(b)==null||!e.GetVirtualRowCount()||!e.GetVirtualColumnCount()||!R.IsSelectionCopyable(b)){m();return}var j=d.GetLastSelectionRangeNormalized();if(j==null){m();return}var n=false;if(c.editUtil.IsEditingEnabled()&&d.IsOneCellSelected(j)){var l=a.GetCellByIdx(j.rowRange.begin,j.colRange.begin);if(l!=null&&!c.editUtil.CanEditField(l.GetRecord(),l.GetColumn(),l.GetFieldKey()))n=true}var f=b.GetCellRangeBorderDrawingInfo(j.rowRange,j.colRange);if(f==null){m();return}var p=f.width+2+2,o=f.height+2+2,h={Top:{left:f.left-1,top:f.top-1,width:p,visibility:""},Right:{left:f.right-2,top:f.top-1,height:o,visibility:""},Bottom:{left:f.left-1,top:f.bottom-2,width:p,visibility:""},Left:{left:f.left-1,top:f.top-1,height:o,visibility:""}},r=d.GetLastSelectionType();if(f.bBeginsBeforeRowHeader)h[c.RTL.Left].visibility="hidden";if(f.bBeginsBeforeColumnHeader)h.Top.visibility="hidden";k.style.visibility="hidden";if(c.editUtil.IsEditingEnabled()&&c.jsGridParams.tableViewParams.bFillControlEnabled){k.style.backgroundColor=n?kb:g.gridPaneStyle.selectionRectBorderColor;if(r==SP.JsGrid.SelectionType.RowRange){k.style.visibility="";k.style.top=f.bottom-3+"px";h[c.RTL.Left].height-=5;h.Bottom.width-=9;if(c.RTL.bEnabled)k.style.left=f.right-7+"px";else{k.style.left=f.left+2+"px";h.Bottom.left+=9}}else if(r!=SP.JsGrid.SelectionType.ColumnRange){k.style.visibility="";k.style.top=f.bottom-3+"px";h[c.RTL.Right].height-=5;h.Bottom.width-=5;if(c.RTL.bEnabled){k.style.left=f.left-2+"px";h.Bottom.left+=5}else k.style.left=f.right-3+"px"}}b.ClipElementToTableViewport(k);for(var i in u){u[i].style.visibility=h[i].visibility;delete h[i].visibility;for(var q in h[i])u[i].style[q]=h[i][q]+"px";u[i].style["border"+i]=SP.JsGrid.Style.MakeBorderString(3,"solid",n?kb:g.gridPaneStyle.selectionRectBorderColor);b.ClipElementToTableViewport(u[i])}}function ub(){ULSEWi:;function k(){ULSEWi:;for(var a in A)for(var b in A[a])A[a][b].style.visibility="hidden"}var g=R.GetLastOperation(),a=g!=null&&g.gridPane==b?b.GetCellRangeBorderDrawingInfo(g.rowRange,g.colRange):null;if(a==null){k();return}var j=a.width+2,i=a.height+2,d={Top:{left:a.left,top:a.top,width:j,visibility:""},Right:{left:a.right-2,top:a.top,height:i,visibility:""},Bottom:{left:a.left,top:a.bottom-2,width:j,visibility:""},Left:{left:a.left,top:a.top,height:i,visibility:""}};if(a.bBeginsBeforeRowHeader)d[c.RTL.Left].visibility="hidden";if(a.bBeginsBeforeColumnHeader)d.Top.visibility="hidden";for(var h in A)for(var e in A[h]){for(var f in d[e])A[h][e].style[f]=f=="visibility"?d[e][f]:d[e][f]+"px";b.ClipElementToTableViewport(A[h][e])}}function Pb(){ULSEWi:;function f(){ULSEWi:;for(var a in E)E[a].style.visibility="hidden"}var c=d.GetFocusForPane(b);if(c==null||R.IsSelectionCopyable(b)){f();return}var l=(new SP.Utilities.Range(c.rowIdx,c.rowIdx)).Normalize(),k=(new SP.Utilities.Range(c.colIdx,c.colIdx)).Normalize(),a=b.GetCellRangeBorderDrawingInfo(l,k);if(a==null){f();return}var i=a.width,h=a.height,g={Top:{left:a.left+1,top:a.top+1,width:i},Right:{left:a.right-2,top:a.top+1,height:h},Bottom:{left:a.left+1,top:a.bottom-2,width:i},Left:{left:a.left+1,top:a.top+1,height:h}};for(var e in E){for(var j in g[e])E[e].style[j]=g[e][j]+"px";E[e].style.visibility=""}}function ib(h,c,a){ULSEWi:;a=a!=null?a:e.ColKeyToColIdx(c.columnKey);function f(){ULSEWi:;var e=d.GetFocusForPane(b);Cb(c,a);V(e);q();j.NotifyMove(b)}function g(){ULSEWi:;var e=d.GetFocusForPane(b);Db(c,a);V(e);b.ScrollColumnIntoViewHorizontally(a);q();j.NotifyMove(b)}return h=="hide"?{Apply:f,Undo:g}:{Apply:g,Undo:f}}function V(a){ULSEWi:;if(a!=null)if(e.KeyToIdx(a.recordKey,a.fieldKey)!=null)d.SetFocusByKey(b,a.recordKey,a.fieldKey);else{var c=a.colIdx>=e.GetVirtualColumnCount()?e.GetVirtualColumnCount()-1:a.colIdx;d.Clear();d.SetFocusByPos(b,a.rowIdx,c)}}function Cb(c,b){ULSEWi:;bb();a.RemoveColumns(b,1);p.splice(b,1);m.Update({itemCount:p.length,itemSizes:p});c.isVisible=false}function Db(d,c){ULSEWi:;c<e.GetVirtualColumnCount()&&b.ScrollColumnIntoViewHorizontally(c);bb();f.AdjustColumnWidth(d);a.InsertColumns(c,[d]);p.splice(c,0,d.width);m.Update({itemCount:p.length,itemSizes:p});d.isVisible=true}function Ib(c,b){ULSEWi:;for(var d=w.GetColumnArray(),a=0;a<d.length;a++){if(a>c&&a>b)break;if(!d[a].isVisible){if(a<=c)c++;if(a<=b)b++}}SP.Internal.JS.MoveItemInArray(d,c,b)}function qb(c,a){ULSEWi:;function f(a,f){ULSEWi:;if(a!=f){var c=d.GetFocusForPane(b),h=m.GetTopItemIdx(),g=e.GetColumnByIdx(a);Cb(g,a);Db(g,f);c!=null&&d.SetFocusByKey(b,c.recordKey,c.fieldKey);q();m.Update({topItemIdx:h});Ib(a,f);j.NotifyMove(b)}}return {Apply:function(){ULSEWi:;f(c,a)},Undo:function(){ULSEWi:;f(a,c)}}}function dc(e,c){ULSEWi:;if(c==null)for(var d=0,b=w.GetColumnArray(),a=0;a<b.length;a++){if(b[a]==e){c=a-d;break}if(!b[a].isVisible)d++}U.Execute(ib("show",e,c),"Show Column",SP.JsGrid.CommandManager.CommandType.Implicit)}function bc(a){ULSEWi:;e.GetVirtualColumnCount()!=1&&U.Execute(ib("hide",a,null),"Hide Column",SP.JsGrid.CommandManager.CommandType.Implicit)}function cc(b,a){ULSEWi:;var c=b<a?a-1:a;U.Execute(qb(b,c),"Move Column",SP.JsGrid.CommandManager.CommandType.Explicit)}function ob(a){ULSEWi:;function d(){ULSEWi:;z=null;f.SetColumnMenuCollapsed(a);O();c.focusMgr.Focus()}if(z==null){var b=f.GetColumnMenuElementPosition(a);if(b==null)return false;var g=e.GetColumnByKey(a);z=e.ColKeyToColIdx(a);if(T.DelegatePresent(SP.JsGrid.DelegateType.ExpandColumnMenu)){T.Apply(SP.JsGrid.DelegateType.ExpandColumnMenu,a,b,d);f.SetColumnMenuExpanded(a)}else c.columnMenuMgr.ExpandMenu(g,b,d,P,H,M)&&f.SetColumnMenuExpanded(a);return true}else return false}function Nb(b,a){ULSEWi:;ob(a)&&SP.Internal.DomElement.StopEvent(b)}this.ExpandColumnMenu=function(a){ULSEWi:;if(c.columnMenuMgr.CanExpandMenu(e.GetColumnByIdx(a),P,H,M,G)){b.ScrollColumnIntoViewHorizontally(a);xb(a);return ob(e.ColIdxToColKey(a))}else return false};this.GetColumnConfigurationDialog=function(){ULSEWi:;return new SP.JsGrid.Internal.ColumnConfigurationDialog(w,Q,G,c,function(a){ULSEWi:;cb(a,false)})};this.ShowColumnConfigurationDialog=function(){ULSEWi:;function c(){ULSEWi:;var a=b.GetColumnConfigurationDialog(),c=document.createElement("div");options={};options.title=SP.JsGrid.Res.columnConfigurationName;options.html=c;options.width=a.GetWidth();options.height=a.GetHeight();options.dialogReturnValueCallback=function(){ULSEWi:;a.Close();a=null;Y=false};var d=SP.UI.ModalDialog.showModalDialog(options);a.Open(c,function(){ULSEWi:;d.close(SP.UI.DialogResult.Cancel)})}if(T.DelegatePresent(SP.JsGrid.DelegateType.ShowColumnConfigurationDialog))T.Apply(SP.JsGrid.DelegateType.ShowColumnConfigurationDialog);else if(!Y){var a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(d){a="undefined"}Y=true;EnsureScript("SP.UI.Dialog.js",a,c)}};function Vb(a){ULSEWi:;a!=null&&SP.JsGrid.Style.ApplyRowHeaderStyle(a.GetTd(),a.GetRecord()!=null?v(a.GetRowIdx(),true):g.rowHeaderStyleCollection.normal,N)}function Ob(b,h,g){ULSEWi:;for(var a=0;a<b.length;a++){var e=c.columnMenuMgr.CanExpandMenu(b[a].GetColumn(),P,H,M,G),d=b[a].GetTd();f.CreateTableHeaderCell(b[a].GetColumn(),d,g,Q,G,H,true,e?Nb:null,rb);f.ApplyHeaderStyle(d,v(b[a].GetColIdx(),false))}lb();if(F==null)F=setTimeout(pb,0)}function pb(){ULSEWi:;if(!Ab){var b=a.GetColumnHeader(a.BeginColIdx());b!=null&&f.NotifyColumnHeaderOrderSet(b.GetTd())}F=null}function lb(){ULSEWi:;var b=a.GetColumnHeader(a.BeginColIdx());b!=null&&f.ApplyHeaderStyle(b.GetTd(),v(b.GetColIdx(),false))}function gb(i,d,a,j,g){ULSEWi:;var f=d.GetProp(a),b=f==null?D[a].GetPropType():f.propType,e=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(b,g),h=e.Render(Tb(d,a,b),d,i,D[a],b,j,ec,c.RTL);return {content:h,displayControl:e}}this.GetContentForCell=function(c,d,b,e,a){ULSEWi:;return gb(c,d,b,e,a).content};function Qb(c){ULSEWi:;var f=c.GetRecord(),a,j,l;if(f!=null){var e=c.GetColumn(),d=c.GetFieldKey(),k=e.fnGetDisplayControlName&&e.fnGetDisplayControlName(e,f,d),h=gb(e,f,d,I(c),k);a=h.content;l=h.displayControl}if(a!=null){j=c.GetTd();var b=f.key();if(a.multipleChildren!=null)for(var g=0;g<a.multipleChildren.length;g++)i(a.multipleChildren[g]);else i(a);return true}return false;function i(a){ULSEWi:;if(a.fnDispose!=null){if(x[b]==null)x[b]={};if(x[b][d]==null)x[b][d]=[];x[b][d].push(a.fnDispose);a=a.elem}j.appendChild(a);setTimeout(function(){},0)}}function Wb(a){ULSEWi:;if(a in x){for(var b in x[a])SP.JsGrid.AsynchronousCellUpdater.RegisterCell(J,a,b,x[a][b]);delete x[a]}}this.TryBeginEdit=function(c){ULSEWi:;var a=d.GetFocusForPane(b);if(a==null)return false;b.ScrollCellIntoView(a.rowIdx,a.colIdx);if(j.IsBound()){R.CancelMode();j.BeginEdit(c);return true}return false};function rb(a,b){ULSEWi:;return b?a.previousSibling:a.nextSibling}function N(b,c){ULSEWi:;var a=c?b.parentNode.previousSibling:b.parentNode.nextSibling;return a&&a.firstChild}function v(j,f){ULSEWi:;for(var a=f?g.rowHeaderStyleCollection:g.columnHeaderStyleCollection,e=j==(f?r:n),i=f?[d.GetRowRanges(b),d.GetColumnRanges(b)]:[d.GetColumnRanges(b),d.GetRowRanges(b)],c=0;c<i[0].length;c++)if(i[0][c].Contains(j))return e?a.allSelectedHover:a.allSelected;if(i[1].length!=0)return e?a.partSelectedHover:a.partSelected;for(var h=d.GetCellRanges(b),c=0;c<h.length;c++)if((f?h[c].rowRange:h[c].colRange).Contains(j))return e?a.partSelectedHover:a.partSelected;return e?a.normalHover:a.normal}function Jb(g){ULSEWi:;var o=null,v=null,y=false,A,H,G,r,w=false,b={cellType:null,recordKey:null,fieldKey:null,bPendingClick:false,bPendingDoubleClick:false},u;$addHandler(i,"mousedown",T);$addHandler(i,"mousemove",U);$addHandler(i,"mouseup",V);$addHandler(i,"dblclick",S);$addHandler(k,"mousedown",R);i.oncontextmenu=function(){ULSEWi:;return false};this.SetupHeaderEvents=function(){ULSEWi:;if(!w){r=a.GetColumnHeaderTr();$addHandler(r,"mousedown",N);$addHandler(document.body,"mousemove",D);$addHandler(r,"mouseout",Q)}w=true};this.ClearHeaderEvents=function(){ULSEWi:;if(w){$clearHandlers(r);$removeHandler(document.body,"mousemove",D)}w=false};this.Dispose=function(){ULSEWi:;this.ClearHeaderEvents();$clearHandlers(i);$clearHandlers(k);r=null};function F(i,f){ULSEWi:;var c=f.GetCellType(),h=i.ctrlKey?B.ReplaceLast:B.Set,e=d.GetFocusForPane(g);if(e!=null)if(b.cellType==a.CellType.RowHeader&&(c==a.CellType.RowHeader||c==a.CellType.Cell))d.SelectRange(g,e.rowIdx,f.GetRowIdx(),null,null,h,false,true);else if(b.cellType==a.CellType.ColumnHeader&&(c==a.CellType.ColumnHeader||c==a.CellType.Cell))d.SelectRange(g,null,null,e.colIdx,f.GetColIdx(),h,false,true);else b.cellType==a.CellType.Cell&&c==a.CellType.Cell&&d.SelectRange(g,e.rowIdx,f.GetRowIdx(),e.colIdx,f.GetColIdx(),h,false,true)}function R(b){ULSEWi:;b.button==Sys.UI.MouseButton.leftButton&&d.GetFocusedPane()==g&&Yb.OnMouseDown(b,g,c.parentNode,k,a,d)}function S(c){ULSEWi:;var b=a.GetCellByChildElement(c.target),d=b&&b.GetCellType();d==a.CellType.ColumnHeader&&P();E(c,b,SP.JsGrid.EventType.OnDoubleClick)}function T(e){ULSEWi:;var c=a.GetCellByChildElement(e.target);b={cellType:null,recordKey:null,fieldKey:null,bPendingClick:false,bPendingDoubleClick:false};if(e.button==Sys.UI.MouseButton.leftButton){if(c&&c.GetRowIdx()==null&&!y)return;y=false;f()}else e.button==Sys.UI.MouseButton.rightButton&&E(e,c,SP.JsGrid.EventType.OnRightClick);return;function f(){ULSEWi:;if(c!=null){b.cellType=c.GetCellType();b.recordKey=c.GetRecordKey();b.fieldKey=c.GetFieldKey();var j=d.GetFocusForPane(g);if(b.cellType!=a.CellType.SelectAllSquare){e.preventDefault();u=c;SP.Internal.DomElement.SetCapture(i,M,null)}if(e.shiftKey)F(e,c);else{var h=c.GetRowIdx(),f=c.GetColIdx(),k=e.ctrlKey?B.Append:B.Set;if(b.cellType==a.CellType.RowHeader)d.SelectRange(g,h,h,null,null,k,true,false);else if(b.cellType==a.CellType.ColumnHeader)d.SelectRange(g,null,null,f,f,k,true,false);else b.cellType==a.CellType.Cell&&d.SelectRange(g,h,h,f,f,k,true,false);u=c=a.GetCellByKey(b.recordKey,b.fieldKey);b.bPendingClick=b.bPendingDoubleClick=true}if(b.cellType==a.CellType.Cell&&j!=null&&j.recordKey==b.recordKey&&j.fieldKey==b.fieldKey)g.TryBeginEdit(e)&&e.stopPropagation()}}}function V(f){ULSEWi:;if(b.bPendingClick){var e=a.GetCellByChildElement(f.target);e!=null&&!j.IsEditing()&&d.IsOneCellSelected(d.GetLastSelectionRangeNormalized())&&e.GetCellType()==a.CellType.Cell&&b.recordKey==e.GetRecordKey()&&b.fieldKey==e.GetFieldKey()&&c.eventMgr.FireEvent(SP.JsGrid.EventType.OnSingleCellClick,new SP.JsGrid.EventArgs.SingleCellClick(f,b.recordKey,b.fieldKey));b.bPendingClick=false}}function E(f,d,g){ULSEWi:;var e=d&&d.GetCellType(),k=d&&d.GetRecord(),h=k&&k.key(),i=d&&d.GetFieldKey(),j=e==a.CellType.SelectAllSquare?SP.JsGrid.ClickContext.SelectAllSquare:e==a.CellType.RowHeader?SP.JsGrid.ClickContext.RowHeader:e==a.CellType.ColumnHeader?SP.JsGrid.ClickContext.ColumnHeader:e==a.CellType.Cell?SP.JsGrid.ClickContext.Cell:SP.JsGrid.ClickContext.Other;if(g==SP.JsGrid.EventType.OnRightClick||j!=SP.JsGrid.ClickContext.Cell||b.bPendingDoubleClick&&b.cellType==e&&b.recordKey==h&&b.fieldKey==i){c.eventMgr.FireEvent(g,new SP.JsGrid.EventArgs.Click(f,j,h,i));b.bPendingDoubleClick=false}SP.Internal.DomElement.StopEvent(f)}function M(c){ULSEWi:;var b=a.GetCellByChildElement(c.target);if(b!=null&&(u==null||!u.Equals(b))){F(c,b);u=b}}function U(c){ULSEWi:;var b=a.GetCellByChildElement(c.target);if(b&&b.GetCellType()==a.CellType.RowHeader)Xb(b.GetRowIdx());else zb()}function L(c){ULSEWi:;var a=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"colAction"),b=null;if(a!=null)b=SP.Internal.DomElement.FindAncestorWithProperty(a.elem,"thColumnKey");return {colAction:a!=null?SP.Internal.DomElement.GetCustomAttribute(a.elem,"colAction"):null,thElem:b!=null?b.elem:null}}function N(c){ULSEWi:;if(c.button!=Sys.UI.MouseButton.leftButton)return;j.StopEditing(false);f.HeaderMouseDown(c);var l=SP.Internal.DomElement.GetEventLocation(c);A=l.x;if(z==null){var b=L(c);if(b.colAction=="resize"||b.colAction=="resize-current"){c.preventDefault();var a=b.colAction=="resize"?rb(b.thElem,true):b.thElem;if(a!=null&&a.thColumnKey!=null){SP.Internal.DomElement.SetCapture(r,I,J);o=e.ColKeyToColIdx(a.thColumnKey);H=parseInt(e.GetColumnByKey(a.thColumnKey).width,10);f.SetColumnResizing(a.thColumnKey)}}else if(b.colAction=="move"){c.preventDefault();var a=b.thElem,d=SP.Internal.DomElement.GetLocation(a),m=SP.Internal.DomElement.GetLocation(i),k=SP.Internal.DomElement.GetLocation(t),g=e.GetColumnByKey(a.thColumnKey);G=d.x-k.x;h.style.top=d.y-m.y+"px";h.style.width=a.offsetWidth+1+"px";h.style.height=a.offsetHeight+"px";h.style.backgroundColor=a.style.backgroundColor;SP.Internal.DomElement.SetText(h.textDiv,g.name);SP.Internal.DomElement.SetOpacity(h,.6);h.style.visibility="";s.style.top=h.style.top;s.style.height=h.style.height;s.style.visibility="";SP.Internal.DomElement.SetCapture(r,C,K);v=e.ColKeyToColIdx(a.thColumnKey);f.SetColumnMoving(a.thColumnKey);C(c)}else if(b.colAction=="select")y=true}}function I(i){ULSEWi:;var n=SP.Internal.DomElement.GetLocation(t).x,k=SP.Internal.DomElement.GetEventLocation(i),m=Math.max(n,k.x),h=(m-A)*(c.RTL.bEnabled?-1:1),b=Math.min(Math.max(H+h,SP.JsGrid.Internal.MinColumnWidth),l.GetWidth()-SP.JsGrid.Internal.RowHeaderWidth),d=a.GetColumnHeader(o).GetTd();e.GetColumnByKey(d.thColumnKey).width=b;f.ResizeColumn(d,b);p[o]=b;q();j.NotifyMove(g)}function J(){ULSEWi:;if(o!=null){var b=a.GetColumnHeader(o).GetTd();f.SetColumnResized(b.thColumnKey);a.OptimizeTableColumns();m.Update({itemSizes:p});o=null}}function P(){ULSEWi:;if(n!=null&&n!=z){var c=e.GetColumnByIdx(n);if(c.isResizable){f.SetColumnResizing(c.columnKey);var d=a.GetColumnHeader(n).GetTd(),b=Math.max(f.GetColumnHeaderAutoResizeWidth(d),a.GetColumnAutoResizeWidth(n));if(b!=c.width){c.width=b;f.ResizeColumn(d,b);p[n]=b;q();j.NotifyMove(g);a.OptimizeTableColumns();m.Update({itemSizes:p})}f.SetColumnResized(d.thColumnKey)}}}function C(f){ULSEWi:;var k=SP.Internal.DomElement.GetEventLocation(f),j=k.x-A;h.style.left=G+j+"px";var d=x(f),l=SP.Internal.DomElement.GetLocation(i),e;if(d.insertColIdx==a.EndColIdx()){var b=a.GetColumnHeader(d.insertColIdx-1).GetTd(),g=SP.Internal.DomElement.GetLocation(b);e=g.x+(c.RTL.bEnabled?0:b.offsetWidth)}else{var b=a.GetColumnHeader(d.insertColIdx).GetTd(),g=SP.Internal.DomElement.GetLocation(b);e=g.x+(c.RTL.bEnabled?b.offsetWidth:0)}s.style.left=e-l.x-2+"px";s.style.visibility=""}function K(b){ULSEWi:;h.style.visibility=s.style.visibility="hidden";var c=a.GetColumnHeader(v).GetTd();f.SetColumnMoved(c.thColumnKey);cc(v,x(b).insertColIdx);v=null}function D(b){ULSEWi:;if(o!=null||v!=null)return;var a=x(b,true);if(a.colIdx!=null&&a.bInVertical&&z==null){xb(a.colIdx);f.HeaderMouseMove(b)}else n!=null&&O()}function Q(a){ULSEWi:;var b=x(a);if(!b.bInVertical||b.colIdx==null){f.HeaderMouseOut(a);O()}}function x(w,x){ULSEWi:;var m=SP.Internal.DomElement.GetLocation(i),p=SP.Internal.DomElement.GetEventLocation(w),d=p.x,k=p.y,b=a.GetColumnHeaders(),l=b.length>0&&(k>=m.y&&k<=m.y+b[0].GetTd().offsetHeight),u=l&&k-m.y<f.constEyeBrowHeight,j,e,h,n,q=!u?(f.constResizeWidth+2)*(c.RTL.bEnabled?-1:1):0;if(!x||l&&SP.Internal.DomElement.PointInDomElem(d,k,t)){for(var g=0;g<b.length;g++){e=b[g].GetTd();h=SP.Internal.DomElement.GetLocation(e);if(d>=h.x+(g!=0?q:0)&&d<h.x+e.offsetWidth+(g!=b.length?q:0)){j=b[g].GetColIdx();break}}var r=0;if(e!=null){var v=d-h.x,s=h.x+e.offsetWidth-d;r=s<v?c.RTL.bEnabled?0:1:c.RTL.bEnabled?1:0}var o=SP.Internal.DomElement.GetLocation(b[0].GetTd());n=j!=null?j+r:c.RTL.bEnabled?d>o.x+e.offsetWidth:d<o.x?a.BeginColIdx():a.EndColIdx()}return {colIdx:j,insertColIdx:n,bInVertical:l}}}fc()};SP.JsGrid.Internal.GridPaneConverter=function(h){ULSEWi:;var b,c,a,e,f,d,i=this;this.SetPosConverterObj=function(a){ULSEWi:;b=a};this.SetView=function(a){ULSEWi:;g(a,true)};this.NotifyColumnsChanged=function(a){ULSEWi:;g(a,false)};this.IdxToKey=function(e,d){ULSEWi:;return {recordKey:b.ViewIdxToRecordKey(Math.floor(e/a)),fieldKey:this.IdxToFieldKey(e,d),columnKey:c[d].columnKey}};this.IdxToFieldKey=function(d,b){ULSEWi:;return c[b].fieldKeys[d%a]};this.KeyToIdx=function(h,c){ULSEWi:;var g=f[c];if(g!=null){var i=b.RecordKeyToViewIdx(h)*a+g,d=e[c];if(d!=null)return {rowIdx:i,colIdx:d}}return null};this.GetTopRowIdxForKey=function(c){ULSEWi:;return b.RecordKeyToViewIdx(c)*a};this.GetTopRowIdx=function(){ULSEWi:;return b.GetTopViewIdx()*a};this.RowIdxToViewIdx=function(b){ULSEWi:;return Math.floor(b/a)};this.RowIdxToRelRowIdx=function(c){ULSEWi:;return c-b.GetTopViewIdx()*a};this.RowIdxToRecordKey=function(a){ULSEWi:;return b.ViewIdxToRecordKey(this.RowIdxToViewIdx(a))};this.RelRowIdxToRowIdx=function(c){ULSEWi:;return c+b.GetTopViewIdx()*a};this.ColKeyToColIdx=function(a){ULSEWi:;return d[a]};this.ColIdxToColKey=function(a){ULSEWi:;return c[a].columnKey};this.ColKeyToFieldKeys=function(a){ULSEWi:;return c[d[a]].fieldKeys};this.FieldKeyToColIdx=function(a){ULSEWi:;return e[a]};this.GetWholeRowDisplayCapacity=function(){ULSEWi:;return b.GetWholeRowDisplayCapacity()*a};this.GetRowMultiple=function(){ULSEWi:;return a};this.GetRecordsInvolved=function(c,f,d){ULSEWi:;function g(){ULSEWi:;var a=i.GetRecordsInvolved(c,f,d);a!=null&&d(a)}function j(b){ULSEWi:;for(var c={},a=0;a<b.length;a++)c[b[a].key()]=b[a];return c}var k=(c-c%a)/a,h=Math.ceil((f+c%a)/a),e=b.GetViewRecords(k,h,g);return e.recordSetComplete?j(e.records):null};this.IsRecordOnScreen=function(a){ULSEWi:;return b.IsRecordOnScreen(a)};this.GetRecordKeysInvolved=function(d,h){ULSEWi:;for(var g=(d-d%a)/a,e=Math.ceil((h+d%a)/a),f=new Array(e),c=0;c<e;c++)f[c]=b.ViewIdxToRecordKey(g+c);return f};this.GetVirtualRowCount=function(){ULSEWi:;return (b.GetViewRecordCount()+h.entryRecordMgr.GetEntryRecords().length)*a};this.GetVirtualColumnCount=function(){ULSEWi:;return c.length};this.GetColumnByIdx=function(a){ULSEWi:;return c[a]};this.GetColumnByKey=function(b){ULSEWi:;var a=d[b];return a==null?null:c[a]};function g(h,j){ULSEWi:;c=h;e={};f={};d={};for(var b=0;b<h.length;b++){d[h[b].columnKey]=b;var i=h[b].fieldKeys;if(j)a=i.length;for(var g=0;g<a;g++){e[i[g]]=b;f[i[g]]=g}}}};SP.JsGrid.EmptyValue={};SP.JsGrid.InvalidValue={};SP.JsGrid.GuidManager=function(){ULSEWi:;var a=[],b=[];return {GetIndexForGuid:function(e){ULSEWi:;var d=SP.Internal.JS.LowerBound(a,e,"guid"),c;if(a[d]!=null&&a[d].guid==e)c=a[d].idx;else{c=b.length;b.push({guid:e,idx:c});a.splice(d,0,b[c])}return c},LookupIndexForGuid:function(c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c,"guid"),d=null;if(a[b]!=null&&a[b].guid==c)d=a[b].idx;return d},LookupGuidForIndex:function(a){ULSEWi:;return b[a]!=null?b[a].guid:null}}}();SP.JsGrid.AsynchronousTaskManager=function(){ULSEWi:;var d=[10,75,150,500],a={},e=this,b=0;function c(c,f,i){ULSEWi:;var h=f==null?SP.JsGrid.AsynchronousTaskManager.Priority.High:f,b=i,g=setInterval(function(){ULSEWi:;b in a&&!c(b)&&e.ClearTask(b)},d[h]);b=b!=null?b:g;a[b]={intervalId:g,priority:h,fn:c};return b}this.RegisterTask=function(a,b){ULSEWi:;return c(a,b)};this.SetTaskPriority=function(b,e){ULSEWi:;var d=a[b];this.ClearTask(b);c(d.fn,e,b)};this.GetTaskPriority=function(b){ULSEWi:;return a[b]&&a[b].priority};this.TaskRegistered=function(b){ULSEWi:;return b in a};this.ClearTask=function(c){ULSEWi:;var b=a[c];if(b!=null){clearInterval(b.intervalId);delete a[c]}};this.Stop=function(){ULSEWi:;for(var c in a)clearInterval(a[c].intervalId);b++};this.Resume=function(){ULSEWi:;if(b==1){var e={};for(var d in a)e[d]=a[d];a={};for(var d in e)c(e[d].fn,e[d].priority,d)}b=Math.min(b-1,0)}};SP.JsGrid.AsynchronousTaskManager=new SP.JsGrid.AsynchronousTaskManager;SP.JsGrid.AsynchronousTaskManager.Priority={Low:3,Medium:2,High:1,SuperHigh:0};SP.JsGrid.AsynchronousCellUpdater=function(){ULSEWi:;var b={},c=10,h=0,g=5,f=20,a=SP.JsGrid.AsynchronousTaskManager;function e(c){ULSEWi:;var d=c.cells.length-c.lastCellCount,b=a.GetTaskPriority(c.token)==a.Priority.SuperHigh;if(!b&&d<g){a.SetTaskPriority(c.token,a.Priority.SuperHigh);b=true}else if(b&&d>f){a.SetTaskPriority(c.token,a.Priority.Medium);b=false}return b}function d(h,i){ULSEWi:;var a=b[h],d;if(!i){var g=e(a);d=Math.min(g?c*7:c,a.cells.length)}else d=a.cells.length;for(var l=0,k=false,j=[],f=0;f<d;f++)a.fn.apply(null,a.cells[f]);a.cells.splice(0,d);a.lastCellCount=a.cells.length;return a.cells.length!=0}this.RegisterCell=function(d){ULSEWi:;var c=b[d];if(c.token==null||!a.TaskRegistered(c.token))c.token=a.RegisterTask(c.fnProcess,a.Priority.Medium);c.cells[c.cells.length]=Array.prototype.slice.apply(arguments,[1,arguments.length])};this.ChangeRecordKeys=function(f,e){ULSEWi:;for(var d in b)for(var c=b[d].cells,a=0;a<c.length;a++)if(c[a][0]==f)c[a][0]=e};this.RegisterJob=function(c){ULSEWi:;var a=h++;b[a]={fn:c,cells:[],fnProcess:function(){ULSEWi:;return d(a)},lastCellCount:0};return a};this.FlushJob=function(a){ULSEWi:;a in b&&d(a,true)}};SP.JsGrid.AsynchronousCellUpdater=new SP.JsGrid.AsynchronousCellUpdater;SP.JsGrid.Internal.Color=function(){ULSEWi:;var a={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,A:10,B:11,C:12,D:13,E:14,F:15},b="0123456789ABCDEF";return {MakeColor:function(c,b,a){ULSEWi:;return SP.JsGrid.Internal.Color.MakeAlphaColor(1,c,b,a)},MakeAlphaColor:function(a,d,c,b){ULSEWi:;return {a:a,r:d*a,g:c*a,b:b*a}},RemoveAlphaChannel:function(a){ULSEWi:;return a.a<1?SP.JsGrid.Internal.Color.MakeColor(a.r/a.a,a.g/a.a,a.b/a.a):a},HexStringToColor:function(b){ULSEWi:;function c(b){ULSEWi:;return (a[b.charAt(0)]*16+a[b.charAt(1)])/255}var f;if(b.charAt(0)=="#"){var e=b.toUpperCase();f=SP.JsGrid.Internal.Color.MakeColor(c(e.substr(1,2)),c(e.substr(3,2)),c(e.substr(5,2)))}else if(b.indexOf("rgb(")==0||b.indexOf("RGB(")==0){var d=b.substr(4,b.length-5).split(",");f=SP.JsGrid.Internal.Color.MakeColor(d[0]/255,d[1]/255,d[2]/255)}return f},ColorToHexString:function(c){ULSEWi:;function a(a){ULSEWi:;a=Math.floor(a*255);return b.charAt(Math.floor(a/16))+b.charAt(a%16)}return "#"+a(c.r)+a(c.g)+a(c.b)},AlphaBlend:function(a,b){ULSEWi:;var c=1-a.a;return SP.JsGrid.Internal.Color.MakeAlphaColor(a.a+b.a*c,a.r+c*b.r,a.g+c*b.g,a.b+c*b.b)}}}();SP.Internal.JS={object:function(b){ULSEWi:;function a(){}a.prototype=b;return new a},ConvertTableToMap:function(b,e,c){ULSEWi:;for(var d={},a=0;a<b.length;a++)d[b[a][e]]=c!=null?b[a][c]:b[a];return d},ConvertTableColumnToArray:function(b,d){ULSEWi:;for(var c=[],a=0;a<b.length;a++)c.push(b[a][d]);return c},ConvertSetKeysToArray:function(c){ULSEWi:;var a=[];for(var b in c)a.push(b);return a},ConvertSetDataToArray:function(a){ULSEWi:;var b=[];for(var c in a)b.push(a[c]);return b},ConvertArrayToSet:function(b,d){ULSEWi:;for(var c={},a=0;a<b.length;a++)c[b[a][d]]=b[a];return c},EncodeString:function(a){ULSEWi:;return '"'+a+'"'},MoveItemInArray:function(a,b,d){ULSEWi:;var c=a.splice(b,1);a.splice(d,0,c[0])},GetFirstElement:function(a){ULSEWi:;for(var b in a)return a[b];return undefined},IsAssocArrayEmpty:function(a){ULSEWi:;for(var b in a)return false;return true},GetAssocArraySize:function(b){ULSEWi:;var a=0;for(var c in b)a++;return a},CloneObj:function(a,d){ULSEWi:;if(a==null)return null;if(a.clone!=null&&d)return a.clone();if(a.Clone!=null&&d)return a.Clone();if(a instanceof Array){for(var b=[],e=0;e<a.length;e++)b.push(d?SP.Internal.JS.CloneObj(a[e],true):a[e]);return b}if(a instanceof Date){b=new Date(a.getTime());return b}if(a instanceof Function)return a;if(a instanceof Object){var f=true;for(var c in a)f=f&&!(a[c]instanceof Function);if(f){var b={};for(var c in a)if(!(c in b))b[c]=d?SP.Internal.JS.CloneObj(a[c],true):a[c]}return b}return a},BinarySearch:function(a,d,c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,d,c);return b===a.length||(c?a[b][c]:a[b])!==d?null:b},LowerBound:function(a,c,b){ULSEWi:;return SP.Internal.JS.LowerBoundCompare(a,c,function(d,e){ULSEWi:;var c=b?a[d][b]:a[d];return e>c?1:c>e?-1:0})},LowerBoundCompare:function(d,f,e){ULSEWi:;var c=-1,b=d.length,a;while(b-c>1){a=c+b>>>1;e(a,f)>0?(c=a):(b=a)}return b},UpperBound:function(c,g,e){ULSEWi:;var d=-1,b=c.length,a;while(b-d>1){a=d+b>>>1;var f=e?c[a][e]:c[a];g>=f?(d=a):(b=a)}return b},Compose:function(a,b){ULSEWi:;return function(d){ULSEWi:;var c=b?b(d):d;return a?a(c):c}},FindInArray:function(b,d,e){ULSEWi:;for(var c,a=0;a<b.length;a++)if(d(b[a])){c=a;if(!e)break}return c},Find:function(a,c,d){ULSEWi:;var b=SP.Internal.JS.FindKey(a,c,d);return b==null?null:a[b]},FindKey:function(a,d,e){ULSEWi:;var c=undefined;for(var b in a)if(d(a[b])){c=b;if(!e)break}return c},RoundTo:function(a,c){ULSEWi:;var b=Math.pow(10,c);return a==0?a:Math.round(a*b)/b},_shutUpKeys:null,CoalesceFunctionCalls:function(b,e,c){ULSEWi:;if(this._shutUpKeys==null)this._shutUpKeys=new SP.Utilities.Set;var a=this._shutUpKeys;if(!a.Contains(b)){a.Add(b);setTimeout(d,c==null?0:c)}function d(){ULSEWi:;a.Remove(b);e()}},Flatten2LevelArray:function(a){ULSEWi:;var c=[];for(var b in a)for(var d in a[b])c.push(a[b][d]);return c},TokenizeString:function(a,f){ULSEWi:;var d=[];if(a!=null&&a!=SP.JsGrid.EmtpyValue)for(var c=a.split(f),b=0;b<c.length;b++){var e=c[b].replace(/^\s+|\s+$/g,"");e!=""&&d.push(e)}return d},JoinStrings:function(a,d){ULSEWi:;if(a==null)return null;for(var c=[],b=0;b<a.length;b++)a[b]!=""&&a[b]!=null&&c.push(a[b]);return c.join(d)},ProfilerMark:function(a){ULSEWi:;window.msWriteProfilerMark&&window.msWriteProfilerMark(a)}};SP.JsGrid.EventArgs={CellFocusChanged:function(a,c,b,d){ULSEWi:;return {newRecordKey:a,newFieldKey:c,oldRecordKey:b,oldFieldKey:d}},RowFocusChanged:function(a,b){ULSEWi:;return {newRecordKey:a,oldRecordKey:b}},CellEditBegin:function(a,b){ULSEWi:;return {recordKey:a,fieldKey:b}},CellEditCompleted:function(c,d,b,a){ULSEWi:;return {recordKey:c,fieldKey:d,changeKey:b,bCancelled:a}},Click:function(a,d,b,c){ULSEWi:;return {eventInfo:a,context:d,recordKey:b,fieldKey:c}},PropertyChanged:function(c,d,g,f,e,b,a){ULSEWi:;return {recordKey:c,fieldKey:d,oldProp:g,newProp:f,propType:e,changeKey:b,validationState:a}},RecordInserted:function(d,c,a,b){ULSEWi:;return {recordKey:d,recordIdx:c,afterRecordKey:a,changeKey:b}},RecordDeleted:function(c,b,a){ULSEWi:;return {recordKey:c,recordIdx:b,changeKey:a}},RecordChecked:function(a,b){ULSEWi:;return {recordKeySet:a,bChecked:b}},OnCellErrorStateChanged:function(d,e,c,a,b,f){ULSEWi:;return {recordKey:d,fieldKey:e,bAddingError:c,bCellCurrentlyHasError:a,bCellHadError:b,errorId:f}},OnRowErrorStateChanged:function(d,b,a,c,e,f){ULSEWi:;return {recordKey:d,bAddingError:b,bErrorCurrentlyInRow:a,bRowHadError:c,errorId:e,message:f}},OnEntryRecordAdded:function(a){ULSEWi:;return {recordKey:a}},OnEntryRecordCommitted:function(a,c,b){ULSEWi:;return {originalRecordKey:a,recordKey:c,changeKey:b}},SingleCellClick:function(a,b,c){ULSEWi:;return {eventInfo:a,recordKey:b,fieldKey:c}},PendingChangeKeyInitiallyComplete:function(a){ULSEWi:;return {changeKey:a}},VacateChange:function(a){ULSEWi:;return {changeKey:a}},GridErrorStateChanged:function(a){ULSEWi:;return {bAnyErrors:a}},SingleCellKeyDown:function(a,b,c){ULSEWi:;return {eventInfo:a,recordKey:b,fieldKey:c}}};SP.JsGrid.Internal.EventArgs={OnRowHeaderStateChanged:function(b,a){ULSEWi:;return {recordKey:b,rowHeaderState:a}},ChangeKeyStageUpdated:function(a){ULSEWi:;return {changeKey:a}},RecordInserted:function(a){ULSEWi:;return {recordKey:a}},RecordDeleted:function(a){ULSEWi:;return {recordKey:a}}};SP.JsGrid.Image=function(d,c,a,b){ULSEWi:;this.imgSrc=d;this.bIsClustered=c;this.outerCssNames=a;this.imgCssNames=b};SP.JsGrid.Image.prototype={Render:function(d,b){ULSEWi:;if(this.imgSrc==null)return null;var a=document.createElement("img");a.style.border=0;a.src=this.imgSrc;if(d!=null){a.title=d;a.alt=a.title=d}else a.alt="";if(this.imgCssNames!=null)a.className=this.imgCssNames;if(this.bIsClustered){var c=document.createElement("div");c.className=this.outerCssNames;c.appendChild(a);a=c}if(b!=null){$addHandler(a,"mousedown",b);$addHandler(a,"keydown",function(a){ULSEWi:;if(a.keyCode==Sys.UI.Key.enter){b(a);SP.Internal.DomElement.StopEvent(a)}});a.style.cursor="pointer";a.tabIndex=-1}if(b!=null)a.Dispose=function(){ULSEWi:;$clearHandlers(a);b=null;c=null;a.Dispose=null;a=null};return a}};SP.JsGrid.ApplyServerChangesToGrid=function(i,h,p,u,q,l){ULSEWi:;var g;if(h!=null)for(var j=0;j<h.length;j++){for(var c=h[j],b=[],d=[],m=[],k=0;k<c.updates.length;k++){var a=c.updates[k];if(a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop)b.push(r(a.recordKey,a.fieldKey,a.newProp));else if(a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Insert)m.push(a);else a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete&&d.push(a.recordKey)}t(m);o(b);s(d);n()}function r(c,d,a){ULSEWi:;var b;if(a.hasLocalizedValue&&a.hasDataValue)b=SP.JsGrid.CreateValidatedPropertyUpdate(c,d,a.dataValue,a.localizedValue);else b=SP.JsGrid.CreateUnvalidatedPropertyUpdate(c,d,a.hasDataValue?a.dataValue:a.localizedValue,!a.hasDataValue);return b}function f(){ULSEWi:;var a=g;if(a==null&&!q)if(c.changeNumber!=-1)a=i.GetChangeKeyForVersion(c.changeNumber);return a}function e(a){ULSEWi:;g=a}function n(){ULSEWi:;g=null;optChangeKey=null}function t(b){ULSEWi:;for(var a=0;a<b.length;a++){var c=p(b[a].afterRecordKey,b[a].recordKey,f());e(c)}}function o(){ULSEWi:;if(b.length>0){var a=i.UpdateProperties(b,null,f());l!=null&&l(b,a);e(a)}}function s(){ULSEWi:;if(d.length>0){var a=i.DeleteRecords(d,f());e(a)}}};SP.JsGrid.EventManager=function(){ULSEWi:;var a={};this.FireEvent=function(d,c){ULSEWi:;var b=a[d];if(b!=null)for(var e in b)b[e](c)};this.AttachEvent=function(b,c){ULSEWi:;if(a[b]==null)a[b]=[];a[b].push(c)};this.DetachEvent=function(b,d){ULSEWi:;if(a[b]!=null){var c=SP.Internal.JS.FindInArray(a[b],function(a){ULSEWi:;return a==d});c!=null&&a[b].splice(c,1)}}};SP.JsGrid.DelegateManager=function(){ULSEWi:;var a={};this.SetDelegate=function(b,c){ULSEWi:;if(c!=null)a[b]=c;else delete a[b]};this.DelegatePresent=function(b){ULSEWi:;return b in a};this.GetDelegate=function(b){ULSEWi:;return a[b]};this.Apply=function(){ULSEWi:;var b=a[arguments[0]];if(b!=null)return b.apply(null,Array.prototype.slice.call(arguments,1))}};SP.JsGrid.MakeShapeStyle=function(b,a){ULSEWi:;return {shape:b,color:a}};SP.JsGrid.MakeBarStyle=function(f,e,d,a,b,c){ULSEWi:;return {shape:f,color:e,pattern:d,start:a,end:b,strokeWeight:c}};SP.JsGrid.Internal.EmptyFunction=function(){};SP.JsGrid.Internal.CrackCellKey=function(b){ULSEWi:;var a=b.split(",");return {rowIdx:a[0],colIdx:a[1]}};SP.JsGrid.Internal.MakeCellKey=function(b,a){ULSEWi:;return [b,a].join()};Type.registerNamespace("SP.Internal.DomElement");SP.Internal.DomElement=function(){ULSEWi:;var f=1,a,d,e,k,g;function h(b){ULSEWi:;if(a!=null&&b.button==Sys.UI.MouseButton.leftButton)d!=null&&d(g?b:o(b))}function i(b){ULSEWi:;if(a!=null&&b.button==Sys.UI.MouseButton.leftButton){e!=null&&e(g?b:o(b));l()}}function b(a){ULSEWi:;a.stopPropagation();a.preventDefault()}function o(a){ULSEWi:;return new Sys.UI.DomEvent(a)}function q(f,b,c){ULSEWi:;g=true;a=f;d=b;e=c;$addHandler(document,"mousemove",h);$addHandler(document,"mouseup",i);a.setCapture(true)}function p(j,c,f){ULSEWi:;g=false;a=j;d=c;e=f;k=document.body.style.cursor;document.body.style.cursor=SP.Internal.DomElement.GetComputedStyle(a,"cursor","cursor");document.addEventListener("mousemove",h,true);document.addEventListener("mouseup",i,true);document.addEventListener("mouseover",b,true);document.addEventListener("mouseenter",b,true);document.addEventListener("mouseleave",b,true)}function l(){ULSEWi:;if(a!=null){if(g){a.releaseCapture();$removeHandler(document,"mousemove",h);$removeHandler(document,"mouseup",i)}else{document.body.style.cursor=k;document.removeEventListener("mousemove",h,true);document.removeEventListener("mouseup",i,true);document.removeEventListener("mouseover",b,true);document.removeEventListener("mouseenter",b,true);document.removeEventListener("mouseleave",b,true)}a=null;d=null;e=null;k=null}}function j(){ULSEWi:;if(c.BrowserIsIE){var a,b;if((a=$get("__iezoomtest1"))==null||(b=$get("__iezoomtest2"))==null){a=document.createElement("div");b=document.createElement("div");a.style.cssText="position:absolute;top:0px;left:0px";b.style.cssText="position:absolute;top:0px;left:200px";a.appendChild(b);a.id="__iezoomtest1";b.id="__iezoomtest2";document.body.appendChild(a)}var d=Sys.UI.DomElement.getLocation(a),e=Sys.UI.DomElement.getLocation(b);f=(e.x-d.x)/200;if(f==0)f=1}}function r(a,c){ULSEWi:;var b=a.rawEvent;a.wheelDelta=Math.round(b.wheelDelta!=null?b.wheelDelta/-40:b.detail);c(a)}for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c={PointInDomElem:function(d,e,b,c){ULSEWi:;var a=c==null?SP.Internal.DomElement.GetLocation(b):c;return a.x<=d&&a.x+b.offsetWidth>=d&&a.y<=e&&a.y+b.offsetHeight>=e},ReleaseCapture:l,StopEvent:b,ForceIEZoomFactorRecomputation:j,GetLocation:function(a){ULSEWi:;return SP.Internal.DomElement.AdjustCoordsForIEZoom(Sys.UI.DomElement.getLocation(a))},GetEventLocation:function(a){ULSEWi:;var b=SP.Internal.DomElement.GetScreenOffsets();return SP.Internal.DomElement.AdjustCoordsForIEZoom({x:a.clientX+b.left,y:a.clientY+b.top})},GetNextElement:function(b){ULSEWi:;do var a=b.nextSibling;while(a&&a.nodeType!=1);return a},GetPrevElement:function(b){ULSEWi:;do var a=b.previousSibling;while(a&&a.nodeType!=1);return a},GetFirstChildElement:function(b){ULSEWi:;var a=b.firstChild;while(a&&a.nodeType!=1)a=b.nextSibling;return a},AddMouseWheelHandler:function(a,c){ULSEWi:;var b=function(a){ULSEWi:;r(a,c)};if(a._mouseWheelFnInfo==null)a._mouseWheelFnInfo=[];a._mouseWheelFnInfo.push({usrFn:c,wheelFn:b});$addHandler(a,"mousewheel",b);$addHandler(a,"DOMMouseScroll",b)},RemoveMouseWheelHandler:function(a,c){ULSEWi:;var b=SP.Internal.JS.FindInArray(a._mouseWheelFnInfo,function(a){ULSEWi:;return a.usrFn==c});if(b!=null){$removeHandler(a,"mousewheel",a._mouseWheelFnInfo[b].wheelFn);$removeHandler(a,"DOMMouseScroll",a._mouseWheelFnInfo[b].wheelFn);if(a._mouseWheelFnInfo.length==1)a._mouseWheelFnInfo=null;else a._mouseWheelFnInfo.splice(b,1)}},GetCustomAttribute:function(b,c){ULSEWi:;var a=b.getAttribute!=null?b.getAttribute(c):null;return a==null||a==""?b[c]:a},GetParentElement:function(b){ULSEWi:;var a=b.parentNode;return a&&a.nodeType!=1?null:a},SetOpacity:function(a,b){ULSEWi:;a.style.opacity=b;a.style["-moz-opacity"]=b;a.style.filter="alpha(opacity="+b*100+")"},RemoveOpacity:function(a){ULSEWi:;a.style.opacity="";a.style["-moz-opacity"]=1;a.style.filter=""},ForEachElementChild:function(a,c,d){ULSEWi:;!d&&c(a);for(var b=0;b<a.childNodes.length;b++)SP.Internal.DomElement.ForEachElementChild(a.childNodes[b],c,false)},FindAncestorWithProperty:function(a,b,c){ULSEWi:;return a==null?null:this.GetCustomAttribute(a,b)!==undefined?{elem:a,child:c}:SP.Internal.DomElement.FindAncestorWithProperty(a.parentNode,b,a)},FindFirstAncestorWithAnyPropertyValue:function(a,c,b,d){ULSEWi:;return a==null?null:this.GetCustomAttribute(a,c) in b?{elem:a,child:d}:SP.Internal.DomElement.FindFirstAncestorWithAnyPropertyValue(a.parentNode,c,b,a)},GetChildrenWithCustomAttribute:function(d,c){ULSEWi:;var b={},a=this;a.ForEachElementChild(d,function(e){ULSEWi:;var d=a.GetCustomAttribute(e,c);if(d!=null)b[d]=e});return b},FindChildrenWithProperty:function(e,b){ULSEWi:;var c=[],d=this;function a(g){ULSEWi:;for(var f=0;f<g.childNodes.length;f++){var e=g.childNodes[f];d.GetCustomAttribute(e,b)!=null&&c.push(e);a(e,b)}}a(e);return c},ComputeMaximumSizeForWebPart:function(b,e){ULSEWi:;var d={},a=$get("MSO_ContentTable"),f=SP.Internal.DomElement.GetLocation(b),g=SP.Internal.DomElement.GetLocation(a);if(!e)b.style.display="none";var c=f.y-g.y;d.height=a.offsetHeight-c;c=f.x-g.x;d.width=a.offsetWidth-c;if(!e)b.style.display="block";return d},SetMouseHover:function(a,i,h,g){ULSEWi:;$addHandler(a,"mousemove",d);$addHandler(a,"mouseout",e);var c=true,b=false;function e(){ULSEWi:;b=true;setTimeout(f,0)}function d(a){ULSEWi:;c&&i!=null&&i();g!=null&&g(a);c=b=false}function f(){ULSEWi:;if(!c&&b){h!=null&&h();c=true;b=false}}return function(){ULSEWi:;$removeHandler(a,"mouseout",e);$removeHandler(a,"mousemove",d);e=null;d=null;f=null;a=null}},DashNameFromCamelName:function(a){ULSEWi:;return a.replace(/[A-Z]/g,function(a){ULSEWi:;return "-"+a.toLowerCase()})},CamelNameFromDashName:function(a){ULSEWi:;return a.replace(/-(\w)/g,function(b,a){ULSEWi:;return a.toUpperCase()})},GetXmlDomObj:function(b){ULSEWi:;var a;if(document.implementation&&document.implementation.createDocument)a=document.implementation.createDocument("","",null);else try{var c=document.createElement("xml");document.body.appendChild(c);a=c.XMLDocument;document.body.removeChild(c)}catch(d){a=new ActiveXObject("Microsoft.XMLDOM")}if(b!=null)if("loadXML" in a){a.async=false;a.loadXML(b)}else{parser=new DOMParser;a=parser.parseFromString(b,"text/xml")}return a},BrowserIsIE:Sys.Browser.agent==Sys.Browser.InternetExplorer,BrowserIsIEAndRenderingModeIs7:Sys.Browser.agent==Sys.Browser.InternetExplorer&&(document.documentMode==null||document.documentMode==7),SetTextNoBR:function(a,b){ULSEWi:;a.innerHTML="";a.appendChild(document.createTextNode(b))}},n=[{name:"SetText",selector:function(){ULSEWi:;return document.body.innerText!=null?function(a,b){ULSEWi:;a.innerText=b}:function(a,b){ULSEWi:;a.textContent=b}}},{name:"SetCapture",selector:function(){ULSEWi:;return document.body.setCapture!=null?q:p}},{name:"GetScreenOffsets",selector:function(){ULSEWi:;return "pageYOffset" in window?function(){ULSEWi:;return {top:window.pageYOffset,left:window.pageXOffset}}:function(){ULSEWi:;return {top:document.documentElement.scrollTop,left:document.documentElement.scrollLeft}}}},{name:"GetXmlHttpObj",selector:function(){ULSEWi:;return window.XMLHttpRequest?function(){ULSEWi:;return new XMLHttpRequest}:function(){ULSEWi:;return new ActiveXObject("Microsoft.XMLHTTP")}}},{name:"GetComputedStyle",selector:function(){ULSEWi:;return document.body.currentStyle!=null?function(b,a){ULSEWi:;return b.currentStyle[a]}:function(b,c,a){ULSEWi:;return document.defaultView.getComputedStyle(b,null).getPropertyValue(a)}}},{name:"AdjustCoordsForIEZoom",selector:function(){ULSEWi:;if(c.BrowserIsIE){j();$addHandler(window,"resize",j)}return function(a){ULSEWi:;return {x:Math.round(a.x/f),y:Math.round(a.y/f)}}}},{name:"GetOuterHTML",selector:function(){ULSEWi:;return document.body.outerHTML!=null?function(a){ULSEWi:;return a.outerHTML}:function(c){ULSEWi:;var b=c.ownerDocument,d=c.cloneNode(true),a=b.createElement("div");b.documentElement.appendChild(a);a.appendChild(d);var e=a.innerHTML;b.documentElement.removeChild(a);return e}}}],m=0;m<n.length;m++)s(n[m]);return c;function s(a){ULSEWi:;c[a.name]=function(){ULSEWi:;c[a.name]=a.selector();return c[a.name].apply(c,arguments)}}}();SP.GetSingleStopBreakpoint=function(){ULSEWi:;var a;return function(b){ULSEWi:;if(a==null)a=b!=null?b:1;if(a==1)debugger;if(a>0)--a}};var bpt=SP.GetSingleStopBreakpoint();SP.Internal.Timer=function(){ULSEWi:;this.Reset()};SP.Internal.Timer.prototype={ElapsedMs:function(){ULSEWi:;return (new Date).getTime()-this.start},Reset:function(){ULSEWi:;this.start=(new Date).getTime()},toString:function(f){ULSEWi:;var g=this.ElapsedMs(),e=new Date(g),a=Math.floor(g/3.6e6),b=e.getUTCMinutes(),d=e.getUTCSeconds()+e.getUTCMilliseconds()/1e3;if(f=="M"){b+=a*60;a=0}else if(f=="S"){d+=(a*60+b)*60;a=b=0}var c=[];a&&c.push(a);a+b&&c.push((b<10?"0":"")+b);c.push((d<10?"0":"")+d.toFixed(3));return c.join(":")}};SP.Internal.CallAsyncFn=function(d,a,c,b){ULSEWi:;if(d(function(){ULSEWi:;a!=null&&a();b!=null&&b()}))a();else c!=null&&c()};SP.ElementCover=function(a,e,g){ULSEWi:;var b,c,d,h=this;this.Show=function(){ULSEWi:;$addHandler(a,"resize",f);a.appendChild(b);a.appendChild(d);this.RefreshLayout()};this.Hide=function(){ULSEWi:;$removeHandler(a,"resize",f);a.removeChild(b);a.removeChild(d)};this.Dispose=function(){ULSEWi:;b=c=d=null};this.RefreshLayout=function(){ULSEWi:;d.style.height=b.style.height=Math.max(0,a.offsetHeight-2)+"px";d.style.width=b.style.width=Math.max(0,a.offsetWidth-2)+"px";c.style.left=Math.max((a.offsetWidth-c.offsetWidth)/2,50)+"px";c.style.marginTop=(a.offsetHeight-c.offsetHeight)/2+"px"};function f(){ULSEWi:;h.RefreshLayout()}function i(){ULSEWi:;b=document.createElement("div");b.style.cssText="z-index:5; position:absolute; top:0px; left:0px; background-color:#ffffff;border:1px solid #999999;";SP.Internal.DomElement.SetOpacity(b,.85);if(g!=null)b.id=g;d=document.createElement("div");d.style.cssText="z-index:6; position:absolute; top:0px; left:0px; background-color:transparent;";c=document.createElement("div");c.style.cssText="position:absolute; vertical-align:middle; top:0px; left:0px; padding-left:20px; padding-right:20px; background-color:#ffffff; border:1px solid #EBEEF2; white-space:nowrap;";for(var a=0;a<e.length;a++)c.appendChild(e[a]);d.appendChild(c)}i()};SP.LoadingBanner=function(d,e){ULSEWi:;var g,b,a,c;this.Show=function(d){ULSEWi:;if(d==null){a.alt=a.title="";b.style.display="none"}else{SP.Internal.DomElement.SetText(b,d);a.alt=a.title=d;b.style.display=""}c.Show()};this.Hide=function(){ULSEWi:;c.Hide()};this.UpdateText=function(a){ULSEWi:;SP.Internal.DomElement.SetText(b,a);c.RefreshLayout()};this.Dispose=function(){ULSEWi:;c.Dispose();b=a=d=null};function f(){ULSEWi:;a=document.createElement("img");a.src="/_layouts/Images/progress-circle-24.gif";a.style.cssText="vertical-align:middle;margin:30px 10px 30px 10px";b=document.createElement("span");b.style.cssText="vertical-align:middle; margin:30px 10px 30px 10px; color:black; text-align:center; white-space:nowrap; overflow:hidden";c=new SP.ElementCover(d,[a,b],e)}f()};SP.ErrorBanner=function(c,d){ULSEWi:;var b,a;this.Show=function(c){ULSEWi:;SP.Internal.DomElement.SetText(b,c);a.Show()};this.Hide=function(){ULSEWi:;a.Hide()};this.UpdateText=function(c){ULSEWi:;SP.Internal.DomElement.SetText(b,c);a.RefreshLayout()};this.Dispose=function(){ULSEWi:;a.Dispose();b=c=null};function e(){ULSEWi:;var e=document.createElement("table");b=e.insertRow().insertCell();b.style.cssText="align:middle; vertical-align:middle; color:#AA0000;text-align:center; padding:20px;";a=new SP.ElementCover(c,[e],d)}e()};SP.Internal.Key={shift:16,insert:45,six:54,numpad_plus:107,numpad_minus:109,F2:113,F6:117,plus:Sys.Browser.agent==Sys.Browser.InternetExplorer?187:61,comma:188,minus:Sys.Browser.agent==Sys.Browser.InternetExplorer?189:109,dot:190,back_slash:220,IMEInput:229};SP.JsGrid.Utility={IsChar:function(a){ULSEWi:;return a.type=="keypress"&&(a.rawEvent.which==null||a.rawEvent.which>0&&a.rawEvent.charCode>0)},FocusElementInDOMCollection:function(d,c,g){ULSEWi:;var a=[];function f(a){ULSEWi:;var b;if(a.hasAttribute!=null)b=a.hasAttribute("tabIndex")&&a.getAttribute("tabIndex")==-1;else b=a.tabIndex!=null&&a.tabIndex==-1;return b}function b(e){ULSEWi:;for(var d=0;d<e.length;d++){var c=e[d];f(c)&&a.push(c);b(c.childNodes)}}function e(){ULSEWi:;if(a.length==0)return null;var d;if(c==null)d=a[0];else for(var b=0;b<a.length;b++){if(a[b]!=c)continue;d=g?b==a.length-1?a[0]:a[b+1]:b==0?a[a.length-1]:a[b-1];break}if(d!=null)try{d.focus()}catch(e){}return d}b(d);return e()},CloneObj:function(b,a){ULSEWi:;return SP.Internal.JS.CloneObj(b,a)},GetDocumentDirection:function(){ULSEWi:;return document.documentElement.getAttribute("dir")}};SP.JsGrid.Internal.HeaderManager=function(c,I){ULSEWi:;var p={menu:c.RTL.Left,resize:c.RTL.Right,eyeBrow:"Bottom"},i={Normal:1,Hover:2,Clicked:3},a={},l={},b={},g={},h={},m={},k={},e=null,j=this,f,d,o,n,y,r=15,C=2;this.constEyeBrowHeight=5;this.constResizeWidth=5;J();function F(e,a,d){ULSEWi:;e.style.width=a.move.style.width=d-1+"px";a.eyeBrow.style.width=d-1+"px";var b=d-j.constResizeWidth-j.constResizeWidth;a.content.style.width=b+"px";if(a.sort!=null)a.sort.style[c.RTL.left]=Math.round((b-6)/2)+"px";a.coreContent.style.width=b-C+"px"}function q(b,c){ULSEWi:;var a=parseInt(SP.Internal.DomElement.GetComputedStyle(b,"width","width"));if(!isNaN(a))b.style.width=a+c+"px"}function v(a){ULSEWi:;q(a.content,-r);q(a.coreContent,-r)}function A(a){ULSEWi:;q(a.content,r);q(a.coreContent,r)}function J(){ULSEWi:;var a=I.columnHeaderStyleCollection.normal,e=a.font!=null?"font-family:"+a.font+";":"";y=String.format("text-align:{0};padding-{0}:{1}px;{2}font-size:{3};font-weight:{4};",c.RTL.left,C,e,a.fontSize,a.fontWeight);var b=document.createElement("table");b.style.cssText="position:absolute;visibility:hidden;top:0px;left:0px;width:0px;height:0px;";b.insertRow(-1);var d=document.createElement("th");b.rows[0].appendChild(d);n=document.createElement("div");n.className="jsgrid-header-core-content";n.style.cssText=y;d.appendChild(n);c.parentNode.appendChild(b)}function K(a){ULSEWi:;var b=SP.Internal.DomElement.GetChildrenWithCustomAttribute(a,"colid");b.th=a;return b}this.CreateTableHeaderCell=function(b,g,v,p,t,u,r,i,s){ULSEWi:;var q=u&&b.isSortable,n=t&&b.isResizable,x=I.columnHeaderStyleCollection.normal,f=['<div colid="eyeBrow" class="jsgrid-header-eyebrow" colAction="select" style="border-bottom:1px solid transparent;"></div>','<div colid="move" '+(p?'colAction="move"':"")+' style="position:relative;">'];f.push('<div colid="resize" class="jsgrid-header-expand" style="float:'+c.RTL.left+';"></div>');f.push('<div colid="content" class="jsgrid-header-content" style="float:'+c.RTL.left+';"><div colid="coreContent" class="jsgrid-header-core-content" style="'+y+"cursor:"+(p?"move":"default")+';"></div>');q&&f.push('<div colid="sort" class="clip9x6"><img colid="sortImg" class="jsgridcluster_jsgrid-down-arrow" src="/_layouts/Images/jsgridcluster.png"/></div>');f.push("</div>");i!=null&&f.push('<div colid="menu" class="jsgrid-header-menu" colAction="menu" style="float:'+c.RTL.left+";width:14px;border-"+c.RTL.left+':1px solid transparent;"><div style="padding-'+c.RTL.left+':4px;"><div colid="menuImg" class="clip9x6" ><img class="jsgridcluster_jsgrid-down-arrow"  src="/_layouts/Images/jsgridcluster.png" alt="'+SP.JsGrid.Res.openMenu+'" title="'+SP.JsGrid.Res.openMenu+'"/></div></div></div>');f.push('<div colid="filterState" class="jsgrid-header-filter-state" style="float:'+c.RTL.left+";width:14px;border-"+c.RTL.left+':1px solid transparent;"><div style="padding-'+c.RTL.left+':3px;"><div colid="filterStateImg" class="clip11x11" ><img class="jsgridcluster_jsgrid-header-filter-icon"  src="/_layouts/Images/jsgridcluster.png" title="'+SP.JsGrid.Res.filterIndicator+'"/></div></div></div>');f.push('<div colid="resizeRight" class="jsgrid-header-expand"'+(n?'colAction="resize-current"':"")+'style="float:'+c.RTL.left+";cursor:"+(n?"w-resize":"default")+';"></div>');f.push("</div>");g.innerHTML=f.join("");var d=b.columnKey,h=a[d]=K(g);l[d]={selection:r,move:p,resize:n};q&&D(d,m[d]);i!=null&&$addHandler(h.menu,"click",function(a){ULSEWi:;i(a,d)});if(b.imgSrc!=null){h.coreContent.className="jsgrid-header-core-img-content";h.coreContent.innerHTML='<img style="border:0px; padding-top:2px" src="'+b.imgSrc+'"/>'}else b.name!=null&&SP.Internal.DomElement.SetText(h.coreContent,b.name);if(b.name!=null)g.title=b.name;o=s;j.UpdateHeaderHeights(v);F(g,h,b.width);g.thColumnKey=d;if(e!=null&&e.thColumnKey==d)e=null;g=h=null;d in k&&w(d);return g};function O(d,c){ULSEWi:;var b=a[d.thColumnKey].resize;if(c!=null&&l[c.thColumnKey].resize){b.colAction="resize";b.style.cursor="w-resize"}else if(l[d.thColumnKey].move){b.colAction="move";b.style.cursor="move"}else{b.colAction=null;b.style.cursor="default"}}this.NotifyColumnHeaderOrderSet=function(c){ULSEWi:;var a=c,b=null;while(a!=null){O(a,b);b=a;a=o(a,false)}};this.DisposeHeader=function(c){ULSEWi:;if(f!=null&&f.columnKey==c.thColumnKey)f=null;if(d!=null&&d.key==c.thColumnKey)d=null;var e=a[c.thColumnKey]&&a[c.thColumnKey].menu;e!=null&&$clearHandlers(e);delete a[c.thColumnKey];delete g[c.thColumnKey];delete b[c.thColumnKey];delete l[c.thColumnKey];delete h[c.thColumnKey];c.thColumnKey=null};this.Dispose=function(){ULSEWi:;var b=[];for(var g in a)b.push(a[g].th);for(var c=b.length-1;c>=0;c--){delete m[b[c].thColumnKey];this.DisposeHeader(b[c])}e=a=d=f=h=l=m=j=null};this.ApplyHeaderStyle=function(e,f,n){ULSEWi:;var h=a[e.thColumnKey];if(d!=null&&d.key==e.thColumnKey){d.curStyle=f;return}if(e.headerStyleType!=f.type){b[e.thColumnKey]={};e.style["border"+c.RTL.Right]=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.outerBorderColor);if(f.font!=null)h.coreContent.style.fontFamily=f.font;h.coreContent.style.fontSize=f.fontSize;h.coreContent.style.fontWeight=f.fontWeight;h.coreContent.style.color=f.textColor;e.style.backgroundColor=h.resize.style.backgroundColor=h.content.style.backgroundColor=f.backgroundColor;h.resize.style["border"+c.RTL.Right]=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.backgroundColor);b[e.thColumnKey].eyeBrow={};b[e.thColumnKey].eyeBrow.bg=h.eyeBrow.style.backgroundColor=f.eyeBrowColor;b[e.thColumnKey].eyeBrow.border=h.eyeBrow.style["border"+p.eyeBrow+"Color"]=f.eyeBrowBorderColor;h.move.style.borderBottom=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.outerBorderColor);b[e.thColumnKey].move=h.move.style.backgroundColor=f.backgroundColor;if(h.menu!=null){b[e.thColumnKey].menu={};b[e.thColumnKey].menu.bg=h.menu.style.backgroundColor=f.menuColor;b[e.thColumnKey].menu.border=h.menu.style["border"+p.menu+"Color"]=f.menuBorderColor}else delete b[e.thColumnKey].menu;h.resizeRight.style.backgroundColor=h.menu!=null&&h.menu.style.display=="block"?f.menuColor:f.backgroundColor;g[e.thColumnKey]=f}e.headerStyleType=f.type;e.headerStyleBorderString=SP.JsGrid.Style.MakeBorderString(1,"solid",f.outerBorderColor);var k=o(e,true);if(k!=null)k.style["border"+c.RTL.Right]=m(k,e).headerStyleBorderString;if(l[e.thColumnKey].resize){var i=o(e,false);if(i!=null&&a[i.thColumnKey]!=null){e.style["border"+c.RTL.Right]=m(i,e).headerStyleBorderString;var j=a[i.thColumnKey].resize;if(!n){b[i.thColumnKey].resize={};b[i.thColumnKey].resize=j.style.backgroundColor=j.style["border"+p.resize+"Color"]=g[i.thColumnKey].backgroundColor}else{b[i.thColumnKey].resize={};b[i.thColumnKey].resize.bg=j.style.backgroundColor=g[i.thColumnKey].resizeColor;b[i.thColumnKey].resize.border=j.style["border"+p.resize+"Color"]=g[i.thColumnKey].resizeBorderColor}}}function m(a,b){ULSEWi:;return a.headerStyleType==null?b:b.headerStyleType==null?a:a.headerStyleType>b.headerStyleType?a:b}};this.GetColumnHeaderAutoResizeWidth=function(c){ULSEWi:;var b=a[c.thColumnKey];if(b.coreContent!=null)return c.offsetWidth+Math.max(b.coreContent.scrollWidth-b.coreContent.offsetWidth,0);return c.offsetWidth};this.AdjustColumnWidth=function(a){ULSEWi:;if(a.width==null||a.width<=0){a.width=SP.JsGrid.Internal.MinColumnWidth;if(a.name!=null){SP.Internal.DomElement.SetText(n,a.name);a.width=n.scrollWidth+j.constResizeWidth+j.constResizeWidth}}a.width=Math.max(a.width,SP.JsGrid.Internal.MinColumnWidth)};this.ResizeColumn=function(d,e){ULSEWi:;var c=d.thColumnKey;F(d,a[c],e);if(c in k){var b=a[c];b!=null&&b.filterState!=null&&b.filterState.style.display=="block"&&v(b)}};this.ShowMenuOnColumn=function(b){ULSEWi:;if(e!=b&&b.thColumnKey!=null){var c=a[b.thColumnKey];if(c.menu!=null){this.HideMenuOnColumn();b.thColumnKey in k&&B(b.thColumnKey);c.resizeRight.style.backgroundColor=g[b.thColumnKey].menuColor;c.menu.style.display="block";v(c);e=b}}};this.HideMenuOnColumn=function(){ULSEWi:;if(e!=null&&e.thColumnKey!=null){var c=e.thColumnKey,b=a[c];if(b.menu!=null){b.resizeRight.style.backgroundColor=g[e.thColumnKey].backgroundColor;b.menu.style.display="none";A(b);e=null;c in k&&w(c)}}};this.GetColumnMenuElementPosition=function(e){ULSEWi:;var b=a[e].menu;if(b==null)return null;var d=a[e].resizeRight,f=SP.Internal.DomElement.GetLocation(b),g=SP.Internal.DomElement.GetLocation(d);return {left:Math.min(f.x,g.x),width:b.offsetWidth+d.offsetWidth,top:f.y+(c.RTL.bEnabled?4:0),height:b.offsetHeight}};this.UpdateHeaderHeights=function(c){ULSEWi:;for(var d in a){var b=a[d];b.move.style.height=c-5+"px";if(b.menuImg!=null)b.menuImg.style.marginTop=Math.floor((c-5-6)/2)+"px";if(b.filterStateImg!=null)b.filterStateImg.style.marginTop=Math.floor((c-5-11)/2)+"px";b.coreContent.style.lineHeight=b.coreContent.style.height=c-12+"px"}};function E(b){ULSEWi:;return b in a}function x(c,d){ULSEWi:;var b=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"thColumnKey");if(b!=null&&E(b.thColumnKey)){var a=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"colid");if(a!=null)if(s(b.elem.thColumnKey,a.elem,d))return a.elem}return null}function s(c,f,e){ULSEWi:;var d=SP.Internal.DomElement.GetCustomAttribute(f,"colid");if(SP.Internal.DomElement.GetCustomAttribute(f,"colAction")=="move")return false;else if(d=="resizeRight"){var j=o(a[c].th,false);if(j!=null){d="resize";c=j.thColumnKey}else d="menu"}if(d!=null&&c in b&&d in b[c]&&!(c in h&&d in h[c]))if(d!="eyeBrow"||l[c].selection)if(e==i.Normal)z(c,d,b[c][d].bg,b[c][d].border);else if(e==i.Hover)z(c,d,g[c][d+"HoverColor"],g[c][d+"HoverBorderColor"]);else e==i.Clicked&&z(c,d,g[c].elementClickColor,g[c].elementClickBorderColor);return true}function z(c,b,d,e){ULSEWi:;if(d!=null){a[c][b].style.backgroundColor=d;if(b=="menu")a[c]["resizeRight"].style.backgroundColor=d}if(e!=null)a[c][b].style["border"+p[b]+"Color"]=e}function H(b){ULSEWi:;delete m[b];if(a[b]!=null&&a[b].sortImg!=null)a[b].sortImg.style.display="none"}function G(a,b,c){ULSEWi:;if(a.sortImg!=null){a.sortImg.className=b;a.sortImg.style.display="";a.sortImg.alt=a.sortImg.title=c}}function D(b,c){ULSEWi:;delete m[b];if(c==SP.JsGrid.SortMode.Ascending||c==SP.JsGrid.SortMode.Descending){m[b]=c;var d=a[b];if(d!=null)if(c==SP.JsGrid.SortMode.Ascending)G(d,"jsgridcluster_jsgrid-up-arrow",SP.JsGrid.Res.sortedAsc);else G(d,"jsgridcluster_jsgrid-down-arrow",SP.JsGrid.Res.sortedDesc)}else H(b)}function L(a){ULSEWi:;delete k[a];B(a)}function M(a){ULSEWi:;k[a]=null;w(a)}function B(c){ULSEWi:;var b=a[c];if(b!=null&&b.filterState!=null&&b.filterState.style.display=="block"){b.filterState.style.display="none";A(b)}}function w(c){ULSEWi:;var b=a[c];if(b!=null&&b.filterState!=null&&b.filterState.style.display!="block"&&!(e!=null&&e.thColumnKey==c)){b.filterState.style.display="block";v(b)}}this.SetSortState=function(a){ULSEWi:;for(var c in m)H(c);if(a!=null)for(var b=0;b<a.length;b++)D(a[b].fieldKey,a[b].isDescending?SP.JsGrid.SortMode.Descending:SP.JsGrid.SortMode.Ascending)};this.SetFilterState=function(a){ULSEWi:;for(var c in k)L(c);if(a!=null)for(var b=0;b<a.length;b++)M(a[b])};this.HeaderMouseDown=function(a){ULSEWi:;x(a,i.Clicked)};this.HeaderMouseUp=function(a){ULSEWi:;x(a,i.Normal)};this.HeaderMouseMove=function(b){ULSEWi:;var a=x(b,i.Hover),c=f!=null?f.elem:null;if(c!=a){j.HeaderMouseOut(b);if(c!=a&&a!=null)f={elem:a,columnKey:SP.Internal.DomElement.FindAncestorWithProperty(b.target,"thColumnKey").elem.thColumnKey}}};this.HeaderMouseOut=function(){ULSEWi:;if(f!=null){s(f.columnKey,f.elem,i.Normal);f=null}};this.SetColumnSelected=function(a){ULSEWi:;u(a,"eyebrow")};this.SetColumnUnselected=function(){ULSEWi:;t(columnKey,"eyebrow")};this.SetColumnMenuExpanded=function(a){ULSEWi:;u(a,"menu")};this.SetColumnMenuCollapsed=function(a){ULSEWi:;t(a,"menu")};this.SetColumnMoving=function(a){ULSEWi:;this.HideMenuOnColumn();u(a,"move",true)};this.SetColumnMoved=function(a){ULSEWi:;t(a,"move",true)};this.SetColumnResizing=function(a){ULSEWi:;this.HideMenuOnColumn();u(a,"resize",true)};this.SetColumnResized=function(a){ULSEWi:;t(a,"resize",true)};function P(a){ULSEWi:;if(d!=null);d={};d.key=a}function N(){ULSEWi:;if(d!=null){var b=d;d=null;b.curStyle!=null&&j.ApplyHeaderStyle(a[b.key].th,b.curStyle)}}function u(b,c,d){ULSEWi:;s(b,a[b][c],i.Clicked);if(h[b]==null)h[b]={};h[b][c]="";d&&P(b)}function t(b,c){ULSEWi:;delete h[b][c];if(SP.Internal.JS.IsAssocArrayEmpty(h[b]))delete h[b];d!=null&&d.key==b&&N();E(b)&&s(b,a[b][c],a[b][c]==f?i.Hover:i.Normal)}};SP.JsGrid.Internal.HierarchyManager=function(n,y,l,k,v,B,p,C,D,j){ULSEWi:;var b=[],g=new SP.Utilities.Set,i=0,c,q={},a=B,h=this,f={},z=n.jsGridObj,d=n.tableCache,H=n.commandMgr,G=n.delegateMgr;if(j==null)j={};if(a!=null)c=new w(a);this.GetState=function(g){ULSEWi:;var d=[],c=[],a=[];f(b);return {recordKeys:d,recordIdxs:c,recordDescendantCounts:a};function f(i){ULSEWi:;for(var b=0;b<i.length;b++){f(i[b].collapsedChildren);var j=i[b].recordKey;d.push(g&&!h.IsGroupingRecord(j)?SP.JsGrid.GuidManager.LookupGuidForIndex(j):j);c.push(i[b].recordIdx);a.push(e(j))}}};this.SetState=function(e,f){ULSEWi:;b=[];g=new SP.Utilities.Set;i=0;if(f!=null){a=f;c=new w(a)}if(e!=null){q={};for(var d=0;d<e.recordIdxs.length;d++)q[e.recordKeys[d]]=e.recordDescendantCounts[d];for(var d=0;d<e.recordIdxs.length;d++)this.NotifyCollapse(e.recordIdxs[d],e.recordKeys[d])}};this.GetUnfilteredHierarchyMgr=function(){ULSEWi:;return a};this.GetViewRecords=function(b,c,a){ULSEWi:;return d.GetRecords(E(b,c),a)};this.GetViewRecordCount=function(){ULSEWi:;return d.GetRecordCount()-i};this.SetTableView=function(d,c,b,a){ULSEWi:;y=d;l=c;k=b;v=a;f={}};this.ConvertViewIdxToRecordIdx=function(c){ULSEWi:;var d=SP.Internal.JS.UpperBound(b,c,"viewIdx");if(!d)return c;var a=b[d-1];return a.viewIdx==c?a.recordIdx:a.recordIdx+(c-a.viewIdx)+e(a.recordKey)};this.ConvertRecordIdxToViewIdx=function(c){ULSEWi:;var f=SP.Internal.JS.UpperBound(b,c,"recordIdx");if(!f)return c;var a=b[f-1];if(a.recordIdx==c)return a.viewIdx;else{var d=c-a.recordIdx-e(a.recordKey);return d<=0?null:a.viewIdx+d}};this.IsGroupingRecord=function(a){ULSEWi:;return this.IsGrouped()&&a.constructor==String&&a.indexOf(v)==0};this.GetNodeInfo=function(a){ULSEWi:;return {nodeType:this.GetNodeType(a.key()),indent:this.GetNodeIndentLevel(a)}};this.GetNodeType=function(a){ULSEWi:;if(D.Contains(a))return SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed;else if(z.IsEntryRecordKey(a)||e(a)==0)return SP.JsGrid.Internal.HierarchyManager.NodeType.Leaf;else if(g.Contains(a))return SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed;else return SP.JsGrid.Internal.HierarchyManager.NodeType.Expanded};this.GetNodeIndentLevel=function(a){ULSEWi:;if(z.IsEntryRecordKey(a.key()))return 0;else if(this.IsGrouped()){var b=l.GetValue(a,SP.JsGrid.OperationalConstants.GroupingOutlineLevel);return b==null?k:b}else return u(a)};this.GetInsertAfterInfoForInsert=function(g,e){ULSEWi:;var b=null,c=g;while((c=a.GetParent(c))!=null)if(!m(c))b=null;else if(b==null&&d.IsKeyInView(c))b=c;var f=Math.max(b!=null?a.GetOutlineLevel(b)+1:0,1);return C(e)?f:Math.max(f,a.GetOutlineLevel(e))};this.GetAfterKeyFromBeforeKey=function(b){ULSEWi:;return a.GetPrevNode(b)};this.GetInsertAfterInfoForDelete=function(b){ULSEWi:;return {insertAfterKey:a.GetPrevNode(b),outlineLevel:a.GetOutlineLevel(b)}};this.NotifyCollapse=function(c,d){ULSEWi:;var m=h.ConvertRecordIdxToViewIdx(c),k=e(d);g.Add(d);var a=k,j=0;s(c,k,function(c,b){ULSEWi:;a-=e(b);j++});var f=SP.Internal.JS.LowerBound(b,c,"recordIdx"),l=b.splice(f,j,{recordIdx:c,recordKey:d,viewIdx:m});b[f].collapsedChildren=l;r(f+1,-a,b);i+=a;return a};this.NotifyExpand=function(j,h){ULSEWi:;g.Remove(h);var d=SP.Internal.JS.BinarySearch(b,j,"recordIdx"),a=b[d],c=e(h),k=a.recordIdx-a.viewIdx;for(var l in a.collapsedChildren){var f=e(a.collapsedChildren[l].recordKey);c-=f;k+=f}Array.prototype.splice.apply(b,[d,1].concat(a.collapsedChildren));r(d+a.collapsedChildren.length,c,b);i-=c;return c};this.GetNextNonGroupingIdx=function(a){ULSEWi:;while(this.IsGroupingRecord(d.RecordIdxToKey(a))){if(a==d.GetRecordCount()-1)return a;a++}return a};this.NotifyInsertRowAfter=function(l,j,i,k){ULSEWi:;function h(a){ULSEWi:;if(a!=null)for(var c=0;c<a.length;c++){var b=a[c];b.recordIdx++;b.viewIdx++;h(b.collapsedChildren)}}var d=null;if(a!=null){var g=A(l,k);d=g.parentKey;!m(d)&&p(d);a.Insert(i,g.parentKey,g.previousSiblingKey,false);a.ForEachAncestor(i,false,function(a){ULSEWi:;c.AdjustCount(a,1)})}else if(this.IsGrouped()){var e=o(j);if(f[e]==null)f[e]=0;f[e]++}var n=SP.Internal.JS.LowerBound(b,j,"recordIdx");h(b.slice(n));return d};this.ValidateAndMinimizeKeyList=function(b){ULSEWi:;for(var c=0;c<b.length;c++)if(a.GetParent(b[c])==null)return {bLevelZeroFound:true};return {bLevelZeroFound:false,minimizedKeys:x(b).ToArray()}};this.ValidateAndExpandKeyList=function(b){ULSEWi:;for(var c=0;c<b.length;c++){if(!a.IsKeyPresent(b[c]))return {bGroupingRowFound:true};if(a.GetParent(b[c])==null)return {bLevelZeroFound:true}}function e(g){ULSEWi:;function c(g){ULSEWi:;for(var f=a.GetChildren(g),e=f.length-1;e>=0;e--){if(!d.IsKeyInView(f[e])||!c(f[e]))return false;b.push(f[e])}return true}var e=true,b=[];for(var f in g.GetCollection()){if(!c(f)){e=false;break}b.push(f)}return {bAllChildKeysInView:e,bGroupingRowFound:false,bLevelZeroFound:false,expandedKeys:b}}return e(x(b))};this.CanDelete=function(b){ULSEWi:;return a.GetChildren(b).length==0};this.NotifyDeleteRow=function(e,d){ULSEWi:;function l(a){ULSEWi:;if(a!=null)for(var c=0;c<a.length;c++){var b=a[c];b.recordIdx--;if(!k)b.viewIdx--;l(b.collapsedChildren)}}g.Remove(e);var k=this.ConvertRecordIdxToViewIdx(d)==null;if(k)i--;if(a!=null){var m=a.GetParent(e);a.Delete(e);c.Delete(e);a.ForEachAncestor(m,true,function(a){ULSEWi:;c.AdjustCount(a,-1)})}else if(this.IsGrouped()){var j=o(d);if(f[j]==null)f[j]=0;f[j]--}var h=SP.Internal.JS.LowerBound(b,d,"recordIdx");b[h]!=null&&b[h].recordIdx==d&&b.splice(h,1);l(b.slice(h))};this.CanIndent=function(b){ULSEWi:;return a.GetPrevSibling(b)!=null};this.EnsureIndentPreconditionsMet=function(d){ULSEWi:;var b=a.GetPrevSibling(d);c.GetCount(b)!=0&&!m(b)&&p(b);return null};this.NotifyIndent=function(b,h){ULSEWi:;var g=a.GetPrevSibling(b),j=c.GetCount(b),f=h==null?[]:[].concat(a.GetSiblingSlice(h,false,true));a.Move(b,g,null,true);for(var i=0,e=0;e<f.length;e++){i+=(d.IsKeyInView(f[e])?1:0)+c.GetCount(f[e]);a.Move(f[e],g,null,true)}c.AdjustCount(b,-i);c.AdjustCount(g,1+j);return [{startingRecordKey:g,count:1},{startingRecordKey:b,count:1+t(b)}]};this.CanOutdent=function(c){ULSEWi:;var b=a.GetParent(c);return b!=null&&a.GetParent(b)!=null};this.EnsureOutdentPreconditionsMet=function(b){ULSEWi:;var d=a.GetParent(b),c=a.GetSiblingSlice(b,false,false);c.length!=0&&!m(b)&&p(b);return c.length==0?null:c};this.NotifyOutdent=function(b){ULSEWi:;var g=a.GetParent(b),i=t(b),f=[].concat(a.GetSiblingSlice(b,false,false));a.Move(b,a.GetParent(g),g,false);for(var h=0,e=0;e<f.length;e++){h+=(d.IsKeyInView(f[e])?1:0)+c.GetCount(f[e]);a.Move(f[e],b,null,true)}c.AdjustCount(b,h);c.AdjustCount(g,-1*(1+c.GetCount(b)));return [{startingRecordKey:g,count:1},{startingRecordKey:b,count:1+i}]};this.IsGrouped=function(){ULSEWi:;return k!=0&&k!=null};this.GetOutlineLevel=function(a){ULSEWi:;return u(a)};this.GetParentKey=function(c,b){ULSEWi:;return a!=null?a.GetParent(c):this.IsGrouped()?o(b):null};function o(e){ULSEWi:;var b=null,a=e-1;while(b==null&&a>=0){var c=d.RecordIdxToKey(a);if(h.IsGroupingRecord(c))b=c;a--}return b}function E(d,g){ULSEWi:;for(var e=[],c=h.ConvertViewIdxToRecordIdx(d),b={pos:c,count:1},a,f=d+1;f<d+g;f++){a=h.ConvertViewIdxToRecordIdx(f);if(a==c+1)b.count++;else{e.push(b);b={pos:a,count:1}}c=a}e.push(b);return e}function t(b){ULSEWi:;if(g.Contains(b))return 0;var a=e(b),c=y.RecordKeyToRecordIdx(b);s(c,a,function(c,b){ULSEWi:;a-=e(b)});return a}function s(c,d,f){ULSEWi:;var e=c+d,a=SP.Internal.JS.UpperBound(b,c,"recordIdx");while(a<b.length&&b[a].recordIdx<=e){f(b[a].recordIdx,b[a].recordKey);a++}}function r(d,c,b){ULSEWi:;for(var a=d;a<b.length;a++){b[a].viewIdx+=c;r(0,c,b[a].collapsedChildren)}}function u(b){ULSEWi:;return a!=null?a.GetOutlineLevel(b.key()):l.GetValue(b,SP.JsGrid.OperationalConstants.HierarchyOutlineLevel)}function e(b){ULSEWi:;var e,g=h.IsGrouped();if(a!=null&&!g)e=c.GetCount(b);else if(!g&&b in j)e=j[b];else{var i=d.GetCachedRecord(b);if(i==null)e=q[b];else e=l.GetValue(i,g?SP.JsGrid.OperationalConstants.GroupingDescendantCount:SP.JsGrid.OperationalConstants.HierarchyDescendantCount)||0;if(g&&h.IsGroupingRecord(b)&&b in f)e+=f[b]}return e}function x(f){ULSEWi:;var c=new SP.Utilities.Set,d=new SP.Utilities.Set;c.AddArray(f);for(var e in c.GetCollection()){for(var b=a.GetParent(e);b!=null;b=a.GetParent(b))if(c.Contains(b))break;b==null&&d.Add(e)}return d}function m(a){ULSEWi:;return !g.Contains(a)}function A(c,d){ULSEWi:;var e,f=a.GetOutlineLevel(c);if(d==f+1)e={parentKey:c,previousSiblingKey:null};else{var b=c;while(d!=f){b=a.GetParent(b);d++}e={parentKey:a.GetParent(b),previousSiblingKey:b}}return e}function w(b){ULSEWi:;var e=this,a={};this.Clear=function(){ULSEWi:;a={}};this.Delete=function(b){ULSEWi:;delete a[b]};this.GetCount=function(b){ULSEWi:;c(b);return a[b]||0};this.AdjustCount=function(b,c){ULSEWi:;if(b in a)a[b]+=c};function c(f){ULSEWi:;if(!(f in a)){for(var i=b.GetChildren(f),c=0,g=0;g<i.length;g++){var h=i[g];c+=(d.IsKeyInView(h)?1:0)+e.GetCount(h)}if(c!=0)a[f]=c}}}};SP.JsGrid.Internal.HierarchyManager.NodeType={Leaf:0,Expanded:1,Collapsed:2};SP.JsGrid.UnfilteredHierarchyManager=function(b){ULSEWi:;var a={},d,c=this;g();this.GetUnfilteredHierarchyMap=function(){ULSEWi:;return a};this.GetTopNodeKey=function(){ULSEWi:;return d};this.GetLastNodeKey=function(){ULSEWi:;var c=d;while(true){var b=a[c].childKeys;if(b.length>0)c=b[b.length-1];else break}return c};this.Hydrate=function(b,c){ULSEWi:;a=b;d=c};this.IsKeyPresent=function(b){ULSEWi:;return b in a};this.GetParent=function(b){ULSEWi:;return a[b].parentKey};this.GetChildren=function(b){ULSEWi:;return a[b].childKeys};this.GetSiblingSlice=function(d,c,b){ULSEWi:;var a=e(d);return c?a.siblingKeys.slice(0,a.siblingIdx+(b?1:0)):a.siblingKeys.slice(a.siblingIdx+(b?0:1))};this.GetFirstChild=function(b){ULSEWi:;var a=this.GetChildren(b);return a.length?a[0]:null};this.GetLastChild=function(b){ULSEWi:;var a=this.GetChildren(b);return a.length?a[a.length-1]:null};this.GetNextSibling=function(b){ULSEWi:;var a=e(b);return a.siblingIdx==a.siblingKeys.length-1?null:a.siblingKeys[a.siblingIdx+1]};this.GetPrevSibling=function(b){ULSEWi:;var a=e(b);return a.siblingIdx==0?null:a.siblingKeys[a.siblingIdx-1]};this.GetNextNode=function(a){ULSEWi:;for(var b=this.GetFirstChild(a);b==null&&a!=null;b=this.GetNextSibling(a),a=this.GetParent(a));return b};this.GetPrevNode=function(d){ULSEWi:;var c=this.GetPrevSibling(d);if(c==null)return this.GetParent(d);var b=c,a;while(a=this.GetLastChild(b),a!=null)b=a;return b};this.ForEachAncestor=function(a,b,c){ULSEWi:;if(!b)a=this.GetParent(a);for(;a!=null;a=this.GetParent(a))c(a)};this.ForEachChild=function(d,c){ULSEWi:;for(var b=this.GetChildren(d),a=0;a<b.length;a++)c(b[a])};this.GetAllNodes=function(){ULSEWi:;var b=[];a(d);return b;function a(d){ULSEWi:;b.push(d);c.ForEachChild(d,a)}};this.GetKeysInOrder=function(b){ULSEWi:;var h=b,a,g=0;if(b.length>1){h=[];for(var a=b[0],e=1;e<b.length;e++)k(b[e]);var f=i(a,0);f=[a].concat(f);for(var j=(new SP.Utilities.Set).AddArray(b),e=0;e<f.length;e++)if(j.Contains(f[e])){h.push(f[e]);if(h.length==b.length)break}}return h;function i(f,e){ULSEWi:;var b=c.GetChildren(f),a;if(e+1<g&&b.length>0){a=[];for(var d=0;d<b.length;d++){a.push(b[d]);Array.prototype.splice.apply(a,[a.length,0].concat(i(b[d],e+1)))}}return a||b}function k(b){ULSEWi:;var e=new SP.Utilities.Set,f=0;while(b!=null&&b!=a){e.Add(b);b=c.GetParent(b);f++}if(b!=null)g=Math.max(f,g);else{while(!e.Contains(a)&&a!=null){a=c.GetParent(a);g++}if(a==null)a=d}}};this.GetOutlineLevel=function(d){ULSEWi:;for(var b=a[d],c=0;b.parentKey!=null;c++)b=a[b.parentKey];return c};this.Insert=function(b,e,d,c){ULSEWi:;a[b]={parentKey:null,childKeys:[]};this.Move(b,e,d,c)};this.Delete=function(b){ULSEWi:;f(b);delete a[b]};this.Move=function(d,i,h,g){ULSEWi:;f(d);var c,b;if(h==null){b=this.GetChildren(i);c=g?b.length:0}else{var j=e(h);b=j.siblingKeys;c=j.siblingIdx+(g?0:1)}b.splice(c,0,d);a[d].parentKey=i};function e(b){ULSEWi:;var a=c.GetParent(b),d=a!=null?c.GetChildren(a):[b],e=SP.Internal.JS.FindInArray(d,function(a){ULSEWi:;return a==b});return {siblingKeys:d,siblingIdx:e,parentKey:a}}function f(b){ULSEWi:;if(c.GetParent(b)!=null){var a=e(b);a.siblingKeys.splice(a.siblingIdx,1)}}function g(){ULSEWi:;if(b.length>0){d=b[0].Key;for(var c=0;c<b.length;c++){var g=b[c].Key,f=b[c].Parent,e=f!=null?b[f].Key:null;a[g]={parentKey:e,childKeys:[]};e!=null&&a[e].childKeys.push(g)}}b=null}};SP.JsGrid.Internal.ChangeHighlightManager=function(){ULSEWi:;var a;this.AddCell=function(c,d){ULSEWi:;var e=b(c,d);a.Add(e)};this.Clear=function(){ULSEWi:;a=new SP.Utilities.Set};this.IsCellIn=function(c,d){ULSEWi:;return a.Contains(b(c,d))};function b(a,b){ULSEWi:;return [a,b].join()}this.Clear()};SP.JsGrid.JsGridControl=function(c,t){ULSEWi:;G();c.style.position="relative";var b,d,l,s,x,y,r=0,j,v=false,m=false,e,n=new SP.JsGrid.EventManager,h=new SP.JsGrid.DelegateManager,p=new SP.JsGrid.DelegateManager,q=new SP.LoadingBanner(c,c.id+"_disable_banner"),a={},k,g={Start:0,Finish:1},f=this;this.parentNode=c;c.jsgrid=this;t&&o(false);this.IsInitialized=function(){ULSEWi:;return v};this.Init=function(k){ULSEWi:;var f=k;e=c.jsgridparams=f;c.jsgridtableviewparams=f.tableViewParams;c.jsgridrowviewparams=f.tableViewParams&&f.tableViewParams.rowViewParams;i(g.Start);this.name=f.name!=null?f.name:"";D();j=f.tableCache;l=f.commandMgr;l.IsUndoEnabled()&&l.AddPreExecuteNotifier(A);a.RTL={bEnabled:f.isRTL,left:f.isRTL?"right":"left",Left:f.isRTL?"Right":"Left",right:f.isRTL?"left":"right",Right:f.isRTL?"Left":"Right",ltr:f.isRTL?"rtl":"ltr"};SP.JsGrid.Style.SetRTL(a.RTL);p.SetDelegate(SP.JsGrid.Internal.DelegateType.CallAsyncFn,E);p.SetDelegate(SP.JsGrid.Internal.DelegateType.GetLocalizedString,u);p.SetDelegate(SP.JsGrid.Internal.DelegateType.DoLargeTask,F);a.jsGridObj=this;a.jsGridParams=e;a.gridId=c.id;a.eventMgr=n;a.intEventMgr=new SP.JsGrid.EventManager;a.intDelegateMgr=p;a.commandMgr=f.commandMgr;a.delegateMgr=h;a.styleMgr=f.styleManager;a.tableCache=f.tableCache;a.errorMgr=new SP.JsGrid.Internal.ErrorManager(a);a.rowHeaderStateMgr=new SP.JsGrid.Internal.RowHeaderStateManager(a.intEventMgr);a.rowHeaderStates=new SP.JsGrid.RowHeaderStates(a);a.rowHeaderAutoStates=new SP.JsGrid.AutoRowHeaderStates(f.enabledRowHeaderAutoStates,a);a.entryRecordMgr=new SP.JsGrid.Internal.EntryRecordManager(a);a.parentNode=c;a.gridControls={};var m="{cursor:hand} :link {color:"+a.styleMgr.gridPaneStyle.linkColor+"} :visited {color: "+a.styleMgr.gridPaneStyle.visitedLinkColor+"}";SP.JsGrid.DisplayControl.ImageTextDisplayControl._styleForLinks=m;SP.JsGrid.DisplayControl.TextDisplayControl._styleForLinks=m;f.bNotificationsEnabled&&SP.JsGrid.Internal.ErrorNotificationManager.Init(a.gridId,a);a.controller=d=new SP.JsGrid.Internal.MVCController(a,u,f.bEnableDiffTracking);a.paneMgr=b=new SP.JsGrid.Internal.PaneManager(c.id,a,u,c,f.minHeaderHeight,f.minRowHeight,function(){ULSEWi:;return r==0});b.SetEventSinks(d.GetViewEventSinks());k.tableViewParams!=null&&z(k.tableViewParams);$addHandler(window,"unload",w);v=true;i(g.Finish)};function D(){ULSEWi:;e.fnCreateNewRecords!=null&&h.SetDelegate(SP.JsGrid.DelegateType.CreateRecords,e.fnCreateNewRecords);e.fnExpandColumnMenu!=null&&h.SetDelegate(SP.JsGrid.DelegateType.ExpandColumnMenu,e.fnExpandColumnMenu);e.fnSort!=null&&h.SetDelegate(SP.JsGrid.DelegateType.Sort,e.fnSort)}function w(){ULSEWi:;$removeHandler(window,"unload",w);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnBeforeGridDispose);a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnGridDisposing);q.Dispose();b.Dispose();c.innerHTML="";c=c.jsgrid=c.jsgridparams=c.jsgridtableviewparams=c.jsgridrowviewparams=null;delete f.parentNode;a.parentNode=null;v=m=false;l.RemovePreExecuteNotifier(A)}this.Dispose=w;this.NotifyDataAvailable=function(){ULSEWi:;d.NotifyDataAvailable()};this.NotifySave=function(){ULSEWi:;d.NotifySave()};this.NotifyHide=function(){ULSEWi:;d.NotifyHide()};this.NotifyResize=function(){ULSEWi:;b.NotifyResize()};this.ClearTableView=function(){ULSEWi:;if(m){d.ClearTableView();m=false}};this.HideInitialLoadingBanner=function(){ULSEWi:;if(t){o(true);t=false}};this.ShowInitialGridErrorMsg=function(a){ULSEWi:;this.HideInitialLoadingBanner();errorBanner=new SP.ErrorBanner(c,c.id+"_initial_error_banner");errorBanner.Show(a)};this.ShowGridErrorMsg=function(a){ULSEWi:;this.HideInitialLoadingBanner();errorBanner=new SP.ErrorBanner(c,c.id+"_error_banner");errorBanner.Show(a)};this.LaunchPrintPreview=function(k,m,l,f,g,p,i,h,o,n){ULSEWi:;var d=null;if(f==null)f="test";b.GetRecordMap(function(){ULSEWi:;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return d=j.GetRecords([{pos:0,count:j.GetRecordCount()}],function(b){ULSEWi:;d=b;a()})},function(){ULSEWi:;e.tableViewParams.rowViewParams.view=j.GetView();if(g)SP.JsGrid.FinishLaunchPrintPreview(d.records[0],e,k,m,l,i,h,f,g,p,c.clientWidth-a.paneMgr.GetSplitterPosition()-SP.JsGrid.Internal.SplitterWidth,a.paneMgr.GetGanttZoomLevel(),o,n);else SP.JsGrid.FinishLaunchPrintPreview(d.records[0],e,k,m,l,i,h,f,g,null,0,0,null,null)})})};this.GetAllDataJson=function(c,a){ULSEWi:;b.GetAllDataJson(c,a)};this.SetTableView=function(a){ULSEWi:;e.tableViewParams=c.jsgridtableviewparams=a;c.jsgridrowviewparams=a.rowViewParams;i(g.Start);z(a);i(g.Finish)};function z(b){ULSEWi:;m&&f.ClearTableView();m=true;f.HideInitialLoadingBanner();if(h.DelegatePresent(SP.JsGrid.DelegateType.GetGridRowStyleId))b.fnGetGridRowStyleId=h.GetDelegate(SP.JsGrid.DelegateType.GetGridRowStyleId);k!=null&&n.DetachEvent(SP.JsGrid.EventType.OnRightClick,k);k=b.fnOnRightClick==null?null:function(a){ULSEWi:;b.fnOnRightClick(a.eventInfo,a.context,a.recordKey,a.fieldKey)};k!=null&&n.AttachEvent(SP.JsGrid.EventType.OnRightClick,k);s=new SP.JsGrid.Internal.PositionConverter(j,a);if(b.operationalConstantsFieldKeyMap!=null){x=b.operationalConstantsFieldKeyMap;y=B()}d.SetTableView(b.rowViewParams,b.columns,b.gridFieldMap,b.defaultEditMode,b.bNewRowEnabled,b.bEditingEnabled,b.splitterPos,s,y,b.fnGetGridRowStyleId,b.allowedSelectionTypes,b.bMovableColumns,b.bResizableColumns,b.bHidableColumns,b.bSortableColumns,b.bAutoFilterableColumns,b.bRowHeadersEnabled,b.paneLayout,b.ganttParams,b.pivotedGridParams,b.bRecordIndicatorCheckboxesEnabled,b.checkSelectionCheckboxHiddenRecordKeys,b.checkSelectionCheckboxDisabledRecordKeys,b.checkSelectionCheckedRecordKeys)}this.SetRowView=function(a){ULSEWi:;e.tableViewParams.rowViewParams=c.jsgridrowviewparams=a;i(g.Start);d.SetRowView(a);i(g.Finish)};this.Enable=function(){ULSEWi:;o(true)};this.Disable=function(a){ULSEWi:;o(false,a)};this.EnableEditing=function(){ULSEWi:;d.EnableEditing()};this.DisableEditing=function(){ULSEWi:;d.DisableEditing()};this.FinalizeEditing=function(a,b){ULSEWi:;d.FinalizeEditing(a,b)};this.ShowColumnConfigurationDialog=function(){ULSEWi:;b.ShowColumnConfigurationDialog()};this.GetDiffTracker=function(){ULSEWi:;return d.GetDiffTracker()};this.Focus=function(){ULSEWi:;b.Focus()};this.TryCommitFirstEntryRecords=function(b){ULSEWi:;a.entryRecordMgr.TryCommitFirstEntryRecords(b)};this.ClearUncommittedEntryRecords=function(){ULSEWi:;a.entryRecordMgr.ClearUncommittedEntryRecords()};this.AnyUncomittedEntryRecords=function(){ULSEWi:;return a.entryRecordMgr.AnyUncomittedEntryRecords()};this.GetEntryRecord=function(b){ULSEWi:;return a.entryRecordMgr.GetEntryRecord(b)};this.IsEntryRecordKey=function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)};this.IsCellEditable=function(d,c,a){ULSEWi:;return b.IsCellEditable(d,c,a)};this.AddBuiltInRowHeaderState=function(c,b){ULSEWi:;this.AddRowHeaderState(c,a.rowHeaderStates[b])};this.AddRowHeaderState=function(c,b){ULSEWi:;a.rowHeaderStateMgr.AddRowHeaderState(c,b)};this.RemoveRowHeaderState=function(c,b){ULSEWi:;a.rowHeaderStateMgr.RemoveRowHeaderState(c,b)};this.GetCheckSelectionManager=function(){ULSEWi:;return d.GetCheckSelectionManager()};this.UpdateProperties=function(a,c,b){ULSEWi:;var e=d.UpdateProperties(a,c,b,null);return e};this.InsertRecordAfter=function(a,c,b){ULSEWi:;return d.InsertRecordAfter(a,c,b,true)};this.InsertRecordBefore=function(a,c,b){ULSEWi:;return d.InsertRecordBefore(a,c,b,true)};this.InsertHiddenRecord=function(c,b,a){ULSEWi:;return d.InsertHiddenRecord(c,b,a)};this.DeleteRecords=function(b,a){ULSEWi:;return d.DeleteRecords(b,a)};this.IndentRecords=function(b,a){ULSEWi:;return d.AdjustRecordsIndentLevel(b,1,a)};this.OutdentRecords=function(b,a){ULSEWi:;return d.AdjustRecordsIndentLevel(b,-1,a)};this.AttachEvent=function(a,b){ULSEWi:;n.AttachEvent(a,b)};this.DetachEvent=function(a,b){ULSEWi:;n.DetachEvent(a,b)};this.SetDelegate=function(a,b){ULSEWi:;h.SetDelegate(a,b)};this.GetDelegate=function(a){ULSEWi:;return h.GetDelegate(a)};this.RefreshRow=function(a){ULSEWi:;b.NotifyChangedRows(s.RecordKeyToViewIdx(a),1)};this.RefreshAllRows=function(a){ULSEWi:;b.RefreshAllRows(a)};this.ClearChanges=function(){ULSEWi:;d.ClearChanges()};this.GetGanttZoomLevel=function(){ULSEWi:;return b.GetGanttZoomLevel()};this.SetGanttZoomLevel=function(a){ULSEWi:;b.SetGanttZoomLevel(a)};this.ScrollGanttToDate=function(a){ULSEWi:;b.ScrollGanttToDate(a)};this.ScrollCellIntoView=function(d,c,a){ULSEWi:;b.ScrollCellIntoView(d,c,a)};this.GetTopRecordIndex=function(){ULSEWi:;return s.GetTopViewIdx()};this.GetTopRowIndex=function(a){ULSEWi:;return b.GetTopRowIndex(a)};this.GetLeftColumnIndex=function(a){ULSEWi:;return b.GetLeftColumnIndex(a)};this.GetOutlineLevel=function(a){ULSEWi:;return d.GetOutlineLevel(a)};this.ShowColumn=function(a,c){ULSEWi:;b.ShowColumn(a,c)};this.HideColumn=function(a){ULSEWi:;b.HideColumn(a)};this.UpdateColumns=function(a){ULSEWi:;b.UpdateColumns(a)};this.GetColumns=function(a){ULSEWi:;return b.GetColumns(a)};this.GetSplitterPosition=function(){ULSEWi:;return b.GetSplitterPosition()};this.SetSplitterPosition=function(a){ULSEWi:;b.SetSplitterPosition(a)};this.AnyErrors=function(){ULSEWi:;return a.errorMgr.AnyErrors()};this.AnyErrorsInRecord=function(b){ULSEWi:;return a.errorMgr.AnyErrorsInRow(b)};this.SetCellError=function(c,d,b){ULSEWi:;return a.errorMgr.SetCellError(c,d,b)};this.SetRowError=function(c,b){ULSEWi:;return a.errorMgr.SetRowError(c,b)};this.ClearCellError=function(b,c,d){ULSEWi:;a.errorMgr.ClearCellError(b,c,d)};this.ClearRowError=function(b,c){ULSEWi:;a.errorMgr.ClearRowError(b,c)};this.ClearAllErrorsOnRow=function(b){ULSEWi:;return a.errorMgr.ClearAllErrorsOnRow(b)};this.GetRowErrorMessage=function(b){ULSEWi:;return a.errorMgr.GetMessageForRow(b)};this.GetCellErrorMessage=function(b,c){ULSEWi:;return a.errorMgr.GetMessageForCell(b,c)};this.ScrollToAndExpandNextError=function(c,b){ULSEWi:;return a.paneMgr.ScrollToAndExpandNextError(c,null,b)};this.ScrollToAndExpandNextErrorOnRecord=function(d,b,c){ULSEWi:;return a.paneMgr.ScrollToAndExpandNextError(d,b,c)};this.GetFocusedItem=function(){ULSEWi:;return b.GetFocusedItemInfo()};this.JumpToEntryRecord=function(){ULSEWi:;b.JumpToEntryRecord()};this.SelectRowRange=function(d,e,c,a){ULSEWi:;b.Select(d,e,null,null,c,a)};this.SelectColumnRange=function(d,e,c,a){ULSEWi:;b.Select(null,null,d,e,c,a)};this.SelectCellRange=function(f,g,d,e,c,a){ULSEWi:;b.Select(f,g,d,e,c,a)};this.SelectRowRangeByKey=function(d,e,c,a){ULSEWi:;b.SelectByKey(d,e,null,null,c,a)};this.SelectColumnRangeByKey=function(d,e,c,a){ULSEWi:;b.SelectByKey(null,null,d,e,c,a)};this.SelectCellRangeByKey=function(a,c,f,g,e,d){ULSEWi:;b.SelectByKey(a,c,f,g,e,d)};this.GetSelectedRowRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.RowRange)};this.GetSelectedColumnRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.ColumnRange)};this.GetSelectedCellRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.CellRange)};this.GetSelectedRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,null)};this.MarkPropUpdateInvalid=function(c,e,b,a){ULSEWi:;return d.MarkPropUpdateInvalid(c,e,b,a)};this.GetCurrentChangeKey=function(){ULSEWi:;return d.GetCurrentChangeKey()};this.GetChangeKeyForVersion=function(a){ULSEWi:;return d.GetChangeKeyForVersion(a)};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForChangeKey(b,c,a)};this.GetHierarchyState=function(b){ULSEWi:;var a=d.GetHierarchyManager();return a&&a.GetState(b)};this.IsGroupingRecordKey=function(b){ULSEWi:;var a=d.GetHierarchyManager();return a&&a.IsGroupingRecord(b)};this.GetSelectedRecordKeys=function(a){ULSEWi:;return C(a)};this.CutToClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnCut(b)};this.CopyToClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnCopy(b)};this.PasteFromClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnPaste(b)};this.GetUndoManager=function(){ULSEWi:;return l};this.GetVisibleRecordCount=function(){ULSEWi:;return a.paneMgr.GetVisibleRecordCount()};this.GetRecordIndicatorCheckBoxColumnIndex=function(){ULSEWi:;return a.paneMgr.GetRecordIndicatorCheckBoxColumnIndex()};function A(){ULSEWi:;a.paneMgr.StopEditing(false)}function C(g){ULSEWi:;var d=f.GetSelectedRowRanges(),h=f.GetSelectedColumnRanges(),c=f.GetSelectedCellRanges(),b;if(h.length!=0)b=j.GetView();else if(g){b=[];for(var a=0;a<d.length;a++)b=b.concat(d[a].keys);for(var a=0;a<c.length;a++)b=b.concat(c[a].rowRange.keys)}else{for(var e=new SP.Utilities.Set,a=0;a<d.length;a++)e.AddArray(d[a].keys);for(var a=0;a<c.length;a++)e.AddArray(c[a].rowRange.keys);b=e.ToArray()}return b}function G(){ULSEWi:;if(!SP.JsGrid.JsGridControl._bStaticInit){SP.JsGrid.Internal.Property=new SP.JsGrid.Internal.Property;SP.JsGrid.JsGridControl._bStaticInit=true}}function B(){ULSEWi:;function a(a){ULSEWi:;return x[a]}return {GetFieldKey:a,GetProp:function(d,c){ULSEWi:;var b=a(c);return {fieldKey:b,prop:d.GetProp(b)}},GetValue:function(c,b){ULSEWi:;return c.GetDataValue(a(b))}}}function E(b,a){ULSEWi:;return SP.Internal.CallAsyncFn(b,a,function(){ULSEWi:;f.Disable()},function(){ULSEWi:;f.Enable()})}function F(c,b,d,e,g){ULSEWi:;var a=0;if(c>b){f.Disable();SP.JsGrid.AsynchronousTaskManager.RegisterTask(h,g)}else{d(0,c);e()}function h(){ULSEWi:;var g=(Math.floor(a/b)+1)*b;a=d(a,g);if(a<c)return true;else{f.Enable();e();return false}}}function u(a){ULSEWi:;a=a.charAt(0).toLowerCase()+a.substr(1);var b=e.tableViewParams.messageOverrides;return b&&b[a]||SP.JsGrid.Res[a]}function i(a){ULSEWi:;if(c.fireEvent)switch(a){case g.Start:c.fireEvent("onbeforeupdate");break;case g.Finish:c.fireEvent("onafterupdate")}}function o(b,c){ULSEWi:;if(b&&r==1)q.Hide();else if(!b){var d=c==null?SP.JsGrid.Res.loadingMsg:c;if(r==0)q.Show(d);else q.UpdateText(d)}r-=b?1:-1;a.ariaMgr!=null&&a.ariaMgr.EnableGrid(b)}};SP.JsGrid.JsGridControl.Parameters=function(){ULSEWi:;this.tableCache=null;this.name=null;this.bNotificationsEnabled=false;this.styleManager=SP.JsGrid.Style.MakeJsGridStyleManager();this.minHeaderHeight=0;this.minRowHeight=0;this.commandMgr=new SP.JsGrid.CommandManager(100);this.enabledRowHeaderAutoStates=(new SP.Utilities.Set).AddArray([SP.JsGrid.RowHeaderAutoStyleId.Error,SP.JsGrid.RowHeaderAutoStyleId.NewRow]);this.bEnableDiffTracking=false;this.isRTL=SP.JsGrid.Utility.GetDocumentDirection()=="rtl";this.tableViewParams=new SP.JsGrid.JsGridControl.TableViewParameters};SP.JsGrid.JsGridControl.TableViewParameters=function(){ULSEWi:;this.keyFieldName=null;this.columns=null;this.gridFieldMap=null;this.messageOverrides=null;this.operationalConstantsFieldKeyMap=null;this.defaultEditMode=SP.JsGrid.EditMode.ReadWriteDefer;this.allowedSelectionTypes=SP.JsGrid.SelectionTypeFlags.MultipleCellRanges|SP.JsGrid.SelectionTypeFlags.MultipleRowRanges|SP.JsGrid.SelectionTypeFlags.MultipleColRanges;this.bMovableColumns=true;this.bResizableColumns=true;this.bHidableColumns=true;this.bSortableColumns=true;this.bAutoFilterableColumns=true;this.bRowHeadersEnabled=true;this.bRecordIndicatorCheckboxesEnabled=false;this.bFillControlEnabled=true;this.checkSelectionCheckboxHiddenRecordKeys=[];this.checkSelectionCheckboxDisabledRecordKeys=[];this.checkSelectionCheckedRecordKeys=[];this.bEditingEnabled=false;this.bNewRowEnabled=false;this.splitterPos=400;this.paneLayout=SP.JsGrid.PaneLayout.GridOnly;this.ganttParams=null;this.pivotedGridParams=null;this.rowViewParams=new SP.JsGrid.JsGridControl.RowViewParameters};SP.JsGrid.JsGridControl.RowViewParameters=function(){ULSEWi:;this.view=null;this.topViewIdx=0;this.hierarchyMode=SP.JsGrid.HierarchyMode.None;this.groupingLevel=null;this.groupingRecordKeyPrefix;this.autoFilterState=null;this.unfilteredHierarchyMgr=null;this.hierarchyDelayLoadKeys=null;this.hierarchyState=null;this.sortState=null;this.filterState=null;this.autoFilterEntries=null;this.filteredDescCounts=null};SP.JsGrid.JsGridControl.PivotedGridParameters=function(){ULSEWi:;this.columns=null};SP.JsGrid.JsGridControl.GanttParameters=function(){ULSEWi:;this.dateRange=null;this.ganttBarStyles=null;this.ganttZoomLevel=3;this.fnRenderGanttRow=null;this.fnGetGanttBarDate=null;this.fnGetGanttBarStyleIds=null;this.fnGetPredecessors=null;this.workDayStart=_spRegionalSettings.workDayStart;this.workDayEnd=_spRegionalSettings.workDayEnd;this.fieldKeyRedrawFilter=null};SP.JsGrid.Internal.EntryRecordManager=function(a){ULSEWi:;var x="NewRowKey",t=this,i=new SP.Utilities.Set,b=[],c={},z=new SP.Utilities.Set,C,h=false,d=false,A=0,e=false,j=null,l=false,f=[];function v(){ULSEWi:;return x+A++}function q(e,d){ULSEWi:;var c=d==null?a.delegateMgr.Apply(SP.JsGrid.DelegateType.CreateEntryRecord):d;if(c.recordKey==null)c.recordKey=v();c.properties[a.jsGridParams.tableViewParams.keyFieldName].dataValue=c.recordKey;b.push(c);i.Add(c.key());c.bIsNewRow=true;a.paneMgr.NotifyCreateEntryRow(b.length-1,e);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordAdded,new SP.JsGrid.EventArgs.OnEntryRecordAdded(c.key()));return c}function p(c){ULSEWi:;var b=a.controller.GetEarliestChangeKeyForRecord(c);return b!=null&&a.controller.IsChangeKeyApplied(b)}function s(e,f){ULSEWi:;a.editUtil.IsNewRowEnabled()&&!f&&a.paneMgr.NotifyRemoveEntryRow(e);var g=b[e],d=g.key();b.splice(e,1);i.Remove(d);delete c[d];a.controller.ClearAllPropChangesForRecord(d);return d}function w(){ULSEWi:;var a=null;if(b.length>1)a=s(b.length-1);return a}function m(c){ULSEWi:;l=true;a.paneMgr.StopEditing(true);a.paneMgr.UnbindEditing(function(){ULSEWi:;while(b.length>0)s(0,c);l=false})}function k(b,c,d){ULSEWi:;var e=q(b,d);a.controller.AttachUndoActionToChangeKey(c,function(){ULSEWi:;var a=w()})}function n(d){ULSEWi:;t.GetLastEntryKey()==d.recordKey&&k(false,d.changeKey);if(d.validationState==SP.JsGrid.ValidationState.Valid){if(c[d.recordKey]==null)c[d.recordKey]=[];c[d.recordKey].push(d);if(d.recordKey==b[0].key()){e=true;if(j!=null){var h=a.errorMgr.ClearRowError(b[0].key(),j);j=null}}}var f=a.paneMgr.GetFocusedItemInfo();(f==null||f.recordKey!=d.recordKey)&&g()}function r(a){ULSEWi:;b.length>0&&a.oldRecordKey==b[0].key()&&g()}function y(c){ULSEWi:;a.commandMgr.Unlock();d=false;e=false;j=a.errorMgr.SetRowError(b[0].key(),c)}function u(e,c,b){ULSEWi:;a.commandMgr.Unlock();d=false;return B(e,c,b)}function B(l,p,o){ULSEWi:;var d=b[0],e=d.key(),q=s(c[e]);delete c[e];i.Remove(e);z.Add(e);if(l!=null&&l!=e){t(e,l);d.recordKey=l;d.properties[a.jsGridParams.tableViewParams.keyFieldName].dataValue=d.recordKey}b.shift();delete d.bIsNewRow;for(var f in p)!(f in q)&&d.AddFieldValue(f,{hasLocalized:true,localized:p[f]});for(var f in o)!(f in q)&&d.AddFieldValue(f,{hasData:true,data:o[f]});var j=a.controller.GetEarliestChangeKeyForRecord(d.key());b.length==0&&k(false,j);var h=a.paneMgr.GetLastRecordKey(),m=null,n=a.jsGridParams.tableViewParams.rowViewParams.unfilteredHierarchyMgr;if(n!=null){var r=n.GetLastNodeKey();if(r!=h){m=h;h=r}}a.controller.InsertRecordAfter(h,d,j,false,true,m,m!=null);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordCommitted,new SP.JsGrid.EventArgs.OnEntryRecordCommitted(e,d.key(),j));a.paneMgr.NotifyChangedRowByKey(d.key());g();return j;function s(c){ULSEWi:;for(var d={},b=0;b<c;b++)if(a.controller.IsChangeKeyApplied(c[b].changeKey))d[c[b].fieldKey]=0;return d}function t(c,b){ULSEWi:;a.paneMgr.ChangeKeys(c,b);a.controller.ChangeKeysInVersionMgr(c,b);SP.JsGrid.AsynchronousCellUpdater.ChangeRecordKeys(c,b);a.rowHeaderStateMgr.ChangeKeys(c,b);a.errorMgr.ChangeKeys(c,b)}}this.TryCommitFirstEntryRecords=function(a){ULSEWi:;a!=null&&f.push(a);g()};function g(){ULSEWi:;var f=false;if(!d&&e&&b.length>0&&b[0].key() in c&&!l)if(p(b[0].key())){f=d=true;a.commandMgr.Lock();setTimeout(function(){ULSEWi:;a.pendingChangeMgr.WaitForPendingUpdates(g)},0)}!f&&!d&&o();function g(){ULSEWi:;if(!a.errorMgr.AnyErrorsInRow(b[0].key()))a.delegateMgr.Apply(SP.JsGrid.DelegateType.TryInsertEntryRecord,b[0],c[b[0].key()],u,y);else{d=false;e=false;a.commandMgr.Unlock();o()}}}function o(){ULSEWi:;if(f.length>0){var a=!t.AnyUncomittedEntryRecords();while(f.length>0)f.shift()(a)}}this.CreateEntryRows=function(c,b,d){ULSEWi:;for(var a=0;a<c;a++)k(!b,d)};this.AnyUncomittedEntryRecords=function(){ULSEWi:;return b.length>1||b.length==1&&p(b[0].key())};this.ClearUncommittedEntryRecords=function(){ULSEWi:;m(false)};this.EnsureLastEntryRowExists=function(){ULSEWi:;if(a.editUtil.IsNewRowEnabled()&&b.length==0){q(false);if(!h){a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,n);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,r);h=true}}};this.NotifyTableViewChangeCompleted=function(){ULSEWi:;e=false;this.EnsureLastEntryRowExists()};this.NotifyTableViewCleared=function(){ULSEWi:;if(b.length>0){m(true);if(h){a.eventMgr.DetachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,n);a.eventMgr.DetachEvent(SP.JsGrid.EventType.OnRowFocusChanged,r);h=false}}};this.GetEntryRecords=function(){ULSEWi:;return b};this.IsEntryRecordKey=function(a){ULSEWi:;return i.Contains(a)};this.GetLastEntryKey=function(){ULSEWi:;return a!=null?b[b.length-1].key():null};this.GetEntryRecordIdx=function(a){ULSEWi:;var c=SP.Internal.JS.FindInArray(b,function(b){ULSEWi:;return a==b.key()});return c};this.GetEntryRecord=function(a){ULSEWi:;return b[this.GetEntryRecordIdx(a)]}};SP.JsGrid.Internal.PaneManager=function(Y,a,P,h,fb,kb,eb){ULSEWi:;var K=SP.Internal.ScrollBar.GetMinScrollBarLength(),zb=K*2+SP.JsGrid.Internal.SplitterWidth+SP.Internal.ScrollBar.GetSystemScrollBarThickness(),yb=SP.Internal.ScrollBar.GetMinScrollBarLength()+SP.Internal.ScrollBar.GetSystemScrollBarThickness(),r,l,q,f,R,b,d=[],k=0,n,s,g,c,i,p,j,u={},t=this,jb=false,H,A,B={height:h.offsetHeight,width:h.offsetWidth},bb=true,x=a.selectionMgr=new SP.JsGrid.Internal.SelectionManager(function(a){ULSEWi:;H.OnFocusedCellChanged!=null?H.OnFocusedCellChanged(a):0}),V=new SP.JsGrid.Internal.ChangeHighlightManager,m=new SP.JsGrid.Internal.EditManager(a,function(b,d,c,a){ULSEWi:;H.OnPropertiesChanged(b,d,c,a)},O),y=a.cutcopypasteMgr=new SP.JsGrid.Internal.CutCopyPasteManager(a,P),mb=new SP.JsGrid.Internal.FillDownManager(a.intDelegateMgr,a.styleMgr),Q=true,e,Bb,z,C,G,v=new SP.JsGrid.SplitterBar(a,K,function(){ULSEWi:;return t.GetSplitterPosition()},N,function(a){ULSEWi:;return t.SetSplitterPosition(a)}),U=false,T=false,F=false,ab=a.focusMgr=new SP.JsGrid.Internal.FocusManager(Y,a,h,P,eb,ib,x,m,O,Z,I);Hb();this.SetEventSinks=function(a){ULSEWi:;H=a};this.Dispose=function(){ULSEWi:;if(g!=null){y.CancelMode();m.StopEditing(true);m.Unbind(function(){ULSEWi:;o(0,d.length,0,0,true);g.each("Dispose");b.Dispose();$removeHandler(h,"mousedown",nb);$removeHandler(window,"focus",hb);$removeHandler(window,"resize",gb);try{typeof SP.UI.Workspace.add_resized=="function"&&SP.UI.Workspace.remove_resized(L)}catch(c){}SP.Internal.DomElement.RemoveMouseWheelHandler(h,lb);if(v!=null){v.Dispose();v=null}a()})}else a();function a(){ULSEWi:;q=loadingBanner=r=l=h=f=null;m.Dispose();ab.Dispose()}};this.ClearView=function(){ULSEWi:;Q=true;a.entryRecordMgr.NotifyTableViewCleared();m.Unbind();x.Clear();y.CancelMode();this.RefreshAllRows(0);g.each("ClearView")};this.NotifyCreateEntryRow=function(f,d){ULSEWi:;if(e!=null){var c=f+e.GetViewRecordCount(),a=e.ViewIdxToRelViewIdx(c);X(1);if(b.GetItemDisplayCapacity()>a)o(0,0,a,1,true);else d&&I(c)}};this.NotifyRemoveEntryRow=function(a){ULSEWi:;e!=null&&this.NotifyDeleteRows(a+e.GetViewRecordCount(),1)};this.GetLastRecordKey=function(){ULSEWi:;return e!=null?e.GetLastRecordKey():null};this.ChangeKeys=function(a,b){ULSEWi:;g.each("ChangeKeys",a,b);if(a in u){u[b]=u[a];delete u[a]}};this.GetVirtualRowCount=function(){ULSEWi:;return c.GetGridPaneConverter().GetVirtualRowCount()};this.GetVisibleRecordCount=function(){ULSEWi:;return Math.min(k-b.GetTopItemIdx(),b.GetItemDisplayCapacity())};this.GetPartialRecordMap=function(d,f){ULSEWi:;var e=c.GetGridPaneConverter(),b;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return b=e.GetRecordsInvolved(d.begin,d.Size(),function(c){ULSEWi:;b=c;a()})},function(){ULSEWi:;f(b)})};this.GetRecordMap=function(d){ULSEWi:;var a=c.GetGridPaneConverter(),b=new SP.Utilities.Range(0,a.GetVirtualRowCount()-1);t.GetPartialRecordMap(b,d)};this.GetGridPaneRowRange=function(){ULSEWi:;return new SP.Utilities.Range(0,c.GetGridPaneConverter().GetVirtualRowCount()-1)};this.GetAllDataJson=function(x,m){ULSEWi:;var e=128;a.jsGridObj.Disable();var n=c.GetGridPaneConverter(),w=new SP.Utilities.Range(0,n.GetVirtualRowCount()-1),v=new SP.Utilities.Range(0,n.GetVirtualColumnCount()-1),j=i!=null?i.GetGridPaneConverter():null,d=i!=null?j.GetRowMultiple():0,u=i!=null?new SP.Utilities.Range(0,j.GetVirtualColumnCount()-1):null;function g(b){ULSEWi:;for(var c=b.GetColumnArray(true),d=[],a=0;a<c.length;++a)d.push(b.GetColumnByKey(c[a].columnKey).name);return d}var b={gridPaneData:null,gridPaneColumns:null,gridPaneStyleData:{cellStyleData:[]},pivotedGridPaneData:null,pivotedGridPaneColumns:null,pivotedGridPaneStyleData:{cellStyleData:[]}},h=[],o=0,p=0,f=[],k=0,l=0,s=c.GetAllColumns(),q=s.GetColumnArray();b.gridPaneColumns=g(s);if(i!=null)b.pivotedGridPaneColumns=g(i.GetAllColumns());function r(g){ULSEWi:;var j=g,n=null;if(g.end-g.begin+1>e){j=new SP.Utilities.Range(g.begin,g.begin+e-1);n=new SP.Utilities.Range(g.begin+e,g.end)}t.GetPartialRecordMap(j,function(g){ULSEWi:;var t=c.GetData(g,j,v);if(m!=null)for(var z in g)for(var E=a.paneMgr.RecordKeyToViewIdx(z),D=g[z],s=0;s<q.length;++s){var C=q[s].columnKey,A=m(D,C);A!=null&&b.gridPaneStyleData.cellStyleData.push({matrixRow:E,matrixColumn:s,styleText:A})}var y=Sys.Serialization.JavaScriptSerializer.serialize(t.matrix);h.push(y.substr(1,y.length-2));o+=t.height;p=t.width;var e=null;if(i!=null){var B=new SP.Utilities.Range(j.begin*d,j.end*d+d-1);e=i.GetData(g,B,u);var w=Sys.Serialization.JavaScriptSerializer.serialize(e.matrix);f.push(w.substr(1,w.length-2));k+=e.height;l=e.width}if(n!=null)setTimeout(function(){ULSEWi:;r(n)},0);else setTimeout(function(){ULSEWi:;var c=["{",'"gridPaneData":{"matrix":',"[",h.join(","),"]",',"height":',o,',"width":',p,"},",'"gridPaneColumns":',Sys.Serialization.JavaScriptSerializer.serialize(b.gridPaneColumns),",",'"gridPaneStyleData":',Sys.Serialization.JavaScriptSerializer.serialize(b.gridPaneStyleData),",",'"pivotedGridPaneData":',i!=null?['{"matrix":',"[",f.join(","),"]",',"height":',k,',"width":',l,"}"].join(""):"null",",",'"pivotedGridPaneColumns":',i!=null?Sys.Serialization.JavaScriptSerializer.serialize(b.pivotedGridPaneColumns):"null",",",'"pivotedGridPaneStyleData":',Sys.Serialization.JavaScriptSerializer.serialize(b.pivotedGridPaneStyleData),",",'"pivotedGridPaneRowMultiple":',d,"}"].join("");a.jsGridObj.Enable();setTimeout(function(){ULSEWi:;x(c)},0)},0)})}r(w)};this.SetView=function(n,Y,S,X,k,T,s,M,E,v,D,w,o,u,W,U,N,K,F){ULSEWi:;B={height:h.offsetHeight,width:h.offsetWidth};Q=false;e=n;Bb=k;z=W;G=S;C=T;A=a.editUtil.IsNewRowEnabled();e.SetPaneMgrObj(t);e.SetScrollBarObj(b);x.SetAllowedSelectionTypes(M);y.CancelMode();if(c==null){wb();sb();vb();var d=new ob(r);c=new SP.JsGrid.Internal.GridPane(r,a,I,z==SP.JsGrid.PaneLayout.GridOnly?pb:null,a.commandMgr,x,V,m,y,mb,d,O,P,Z,R);c.paneSize=d;g=[c];g.each=Fb}else f.style.display="none";if(p!=null&&z!=SP.JsGrid.PaneLayout.GridAndGantt||i!=null&&z!=SP.JsGrid.PaneLayout.GridAndPivotedGrid){tb();i=p=j=null;g.splice(1,1)}if(z!=SP.JsGrid.PaneLayout.GridOnly&&j==null){ub();var d=new ob(l);p=i=null;if(z==SP.JsGrid.PaneLayout.GridAndGantt){SP.JsGrid.Internal.GanttPane==null&&alert("Javascript support for Gantt-drawing is not enabled.");p=j=new SP.JsGrid.Internal.GanttPane(l,a,SP.Internal.DomElement.BrowserIsIE?new SP.JsGrid.Internal.VmlGanttDrawImpl(a.RTL.bEnabled):new SP.JsGrid.Internal.SvgGanttDrawImpl(a.RTL.bEnabled),d)}else i=j=new SP.JsGrid.Internal.PivotedGridPane(l,a,I,null,a.commandMgr,x,V,m,y,mb,d,O,P,Z,R);j.paneSize=d;g.push(j)}if(b==null)b=new SP.JsGrid.Internal.ScrollBar(SP.JsGrid.Internal.ScrollBar.BarType.Vertical,q,true,null,a.styleMgr.scrollBarStyle,a.RTL.bEnabled);e.SetScrollBarObj(b);b.Update({topItemIdx:0,bScrollNotifiy:false});db();J(true);c.SetView(n,k,qb(Y,K),G,s,E,v,D,w,o,u,F);p!=null&&p.SetView(n,k,U);i!=null&&i.SetView(n,k,N.columns,G,s,false,false,false,false,false,false,null);db();g.each("SetEventSinks",H);this.RefreshAllRows(X);if(!jb){b.SetOnScroll(Ab);b.SetOnVisibilityChanged(rb,true);$addHandler(h,"mousedown",nb);$addHandler(window,"focus",hb);$addHandler(window,"resize",gb);try{typeof SP.UI.Workspace.add_resized=="function"&&SP.UI.Workspace.add_resized(L)}catch(bb){}SP.Internal.DomElement.AddMouseWheelHandler(h,lb);jb=true}g.each("OnResize");ab.SetView(z,c,i,G,E,v,D,w,o,u,F);a.entryRecordMgr.NotifyTableViewChangeCompleted();f.style.display=""};this.SetFilterState=function(a){ULSEWi:;c.SetFilterState(a)};this.SetSortState=function(a){ULSEWi:;c.SetSortState(a)};this.ShowColumnConfigurationDialog=function(){ULSEWi:;c.ShowColumnConfigurationDialog()};this.RecordKeyToViewIdx=function(a){ULSEWi:;return u[a]};this.RefreshAllRows=function(a){ULSEWi:;T=true;Cb(e.GetViewRecordCount(),a);o(0,d.length,0,this.GetVisibleRecordCount(),true);T=false};this.NotifyNewRowStateChanged=function(b){ULSEWi:;y.CancelMode();var c=A;A=a.editUtil.IsNewRowEnabled();if(c!=A){a.entryRecordMgr.EnsureLastEntryRowExists();!b&&this.RefreshAllRows()}};this.NotifyChangedRowByKey=function(a){ULSEWi:;a in u&&this.NotifyChangedRows(u[a],1)};this.NotifyChangedRows=function(b,c){ULSEWi:;var a=S(b,c);if(a.clippedCount<1)return;o(a.clippedRelViewIdx,a.clippedCount,a.clippedRelViewIdx,a.clippedCount,false)};this.NotifyUpdateProperty=function(f,i,b,e,c,h){ULSEWi:;if(f!=null)g.each("NotifyUpdateProperty",f,i,b,e,c,h);else for(var a=0;a<d.length;a++){var j=d[a];j!=null&&g.each("NotifyUpdateProperty",j.recordKey,i,b,e,c,h)}};this.NotifyInsertRows=function(c,a,f,e){ULSEWi:;m.Unbind(function(){ULSEWi:;F=true;var h=b.GetTopItemIdx(),k=h+(c<h?a:0);X(a,k);F=false;var g=S(c,a);if(g.clippedCount<1){M();return}var m=g.clippedRelViewIdx,i=g.clippedCount,p=b.GetItemDisplayCapacity(),n=p-d.length,j=Math.max(i-n,0),l=d.length-j;o(l,j,m,i,true);f&&t.UpdateFocusAfterInsertOrDeleteRows(c,a-1,true);e!=null&&e()})};this.NotifyDeleteRows=function(c,a){ULSEWi:;m.Unbind(function(){ULSEWi:;var f=S(c,a);F=true;var l=b.GetTopItemIdx(),e=l+Math.max(Math.min(c-l,0),-a);X(-a,e);var g=Math.max(e-b.GetTopItemIdx(),0);e=b.GetTopItemIdx();F=false;if(f.clippedCount<1){M();return}var n=b.GetItemDisplayCapacity(),p=e+n==k+1&&b.PartialRowPresent(),q=d.length!=n,i=f.clippedRelViewIdx,r=Math.max(Math.min(i+f.clippedCount,d.length)-i,0);o(i,r,0,g,true);var m=Math.max(Math.min(f.clippedCount,k-d.length+g),0),j=Math.min(k-(e+d.length),m);o(0,0,d.length,j,true);var h=m-j-g;if(h>0&&!q&&p)h--;o(0,0,0,h,true);t.UpdateFocusAfterInsertOrDeleteRows(c,a,false)})};this.UpdateFocusAfterInsertOrDeleteRows=function(b,c,a){ULSEWi:;g.each("UpdateFocusAfterInsertOrDeleteRows",b,c,a)};this.ScrollCellIntoView=function(c,a,e){ULSEWi:;var d=this.GetPane(e);c!=null&&b.ScrollIntoView(d.GetGridPaneConverter().RowIdxToViewIdx(c));a!=null&&d.ScrollColumnIntoViewHorizontally(a)};this.IsCellEditable=function(f,c,d){ULSEWi:;var b=this.GetPane(d).GetGridPaneConverter(),e=b.GetColumnByIdx(b.FieldKeyToColIdx(c));return a.editUtil.CanEditField(f,e,c)};this.GetGanttZoomLevel=function(){ULSEWi:;return p?p.GetZoomLevel():null};this.SetGanttZoomLevel=function(a){ULSEWi:;p?p.SetZoomLevel(a):null};this.Focus=function(){ULSEWi:;ab.Focus()};this.StopEditing=function(a){ULSEWi:;m.StopEditing(a)};this.UnbindEditing=function(a){ULSEWi:;m.Unbind(a)};this.NotifyResize=function(){ULSEWi:;L()};this.ScrollGanttToDate=function(a){ULSEWi:;p!=null&&p.SetFocusDate(a)};this.GetTopRowIndex=function(a){ULSEWi:;return this.GetPane(a).BeginRowIdx()};this.GetLeftColumnIndex=function(a){ULSEWi:;return this.GetPane(a).BeginColIdx()};this.ShowColumn=function(a,b){ULSEWi:;c.ShowColumn(a,b)};this.HideColumn=function(a){ULSEWi:;c.HideColumn(a)};this.UpdateColumns=function(a){ULSEWi:;c.UpdateColumns(a)};this.GetColumns=function(a){ULSEWi:;return Db(this.GetPane(a).GetColumns(),[SP.JsGrid.RecordIndicatorCheckboxColumnKey])};this.GetRecordIndicatorCheckBoxColumnIndex=function(){ULSEWi:;var a=this.GetPane();return a&&SP.Internal.JS.FindInArray(a.GetColumns(),function(a){ULSEWi:;return a.columnKey==SP.JsGrid.RecordIndicatorCheckboxColumnKey})};this.ScrollToAndExpandNextError=function(l,i,j){ULSEWi:;var b=i==null?a.errorMgr.GetNextError(l,j):a.errorMgr.GetNextErrorForRecord(l,i,j);if(b!=null){var k=e.RecordKeyToViewIdx(b.recordKey),d;if(k!=null){for(var f=0;f<g.length&&d==null;f++){var c=g[f];if(c.Id==SP.JsGrid.PaneId.MainGrid||c.Id==SP.JsGrid.PaneId.PivotedGrid){d=b.type==SP.JsGrid.Internal.ErrorType.Row?0:c.GetGridPaneConverter().FieldKeyToColIdx(b.fieldKey);if(d==null){var h=c.FieldKeyToColumnKey(b.fieldKey);if(h!=null){c.ShowColumn(h,null);d=c.GetGridPaneConverter().FieldKeyToColIdx(b.fieldKey)}}}}t.ScrollCellIntoView(k,d,c.Id);if(b.type==SP.JsGrid.Internal.ErrorType.Cell&&d!=null){x.SetFocusByKey(c,b.recordKey,b.fieldKey);setTimeout(function(){ULSEWi:;m.ExpandWidget(SP.JsGrid.ErrorWidgetId)},0)}return b.id}}return null};function Db(a,d){ULSEWi:;for(var c=0;c<d.length;c++)for(var b=0;b<a.length;b++)if(a[b].columnKey==d[c]){a.splice(b,1);break}return a}this.ClearAllChangeIndications=function(){ULSEWi:;g.each("NotifyChangeIndicatorsClearing");V.Clear()};this.GetFocusedItemInfo=function(){ULSEWi:;var a=x.GetFocus();return a==null?null:{recordKey:a.recordKey,fieldKey:a.fieldKey,paneId:a.gridPane.Id}};this.JumpToEntryRecord=function(){ULSEWi:;if(A){var b=a.entryRecordMgr.GetLastEntryKey(),d=c.GetColumns()[0].columnKey;c.SelectByKey(b,b,d,d,false);t.ScrollCellIntoView(e.RecordKeyToViewIdx(b),0,c.Id)}};this.GetSplitterPosition=function(){ULSEWi:;return j!=null?C:0};this.SetSplitterPosition=function(a){ULSEWi:;cb(a);J()};this.Select=function(e,f,c,d,b,a){ULSEWi:;this.GetPane(a).Select(e,f,c,d,b)};this.SelectByKey=function(a,b,e,f,d,c){ULSEWi:;this.GetPane(c).SelectByKey(a,b,e,f,d)};this.GetOrderedSelections=function(b,a){ULSEWi:;return x.GetOrderedSelections(this.GetPane(b),a)};this.NotifyCanEditUpdated=function(){ULSEWi:;g.each("NotifyCanEditUpdated")};this.GetGridPane=function(){ULSEWi:;return c};this.GetPane=function(a){ULSEWi:;var b=a==SP.JsGrid.PaneId.MainGrid||a==null?c:a==SP.JsGrid.PaneId.PivotedGrid?i:a==SP.JsGrid.PaneId.Gantt?p:null;return b};function cb(a){ULSEWi:;if(j!=null)C=Math.min(Math.max(a,K),N()-SP.Internal.ScrollBar.GetSystemScrollBarThickness()-(j?K+SP.JsGrid.Internal.SplitterWidth:0))}function lb(a){ULSEWi:;b.Update({topItemIdx:b.GetTopItemIdx()+a.wheelDelta});a.stopPropagation();a.preventDefault()}function N(){ULSEWi:;return Math.max(B.width-2,zb)}function w(){ULSEWi:;return Math.max(B.height-2,yb)}function ob(c){ULSEWi:;var b,a;this.SetValues=function(d,c){ULSEWi:;b=d;a=c};this.GetHeight=function(){ULSEWi:;return w()};this.GetWidth=function(){ULSEWi:;return b};this.GetLeftOffset=function(){ULSEWi:;return a};this.Dispose=function(){ULSEWi:;c=null}}function qb(e,h){ULSEWi:;var f=e;if(h){var d=SP.JsGrid.RecordIndicatorCheckboxColumnKey,g=G[d]=new SP.JsGrid.GridField(d,false,false,null,SP.JsGrid.TextDirection.Default,SP.JsGrid.EditMode.ReadOnly),c=SP.Internal.JS.object(SP.JsGrid.Internal.Property.GetPropType("CheckBoxBoolean"));c.ID="RecordIndicatorCheckBoxBoolean";c.GetDisplayValue=function(b){ULSEWi:;return a.checkSelMgr.IsRecordIndicatorCheckboxChecked(b.key())?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(c,"CheckBoxBoolean");g.SetSingleValuePropType(c);var b=new SP.JsGrid.ColumnInfo("",null,d,SP.JsGrid.Internal.MinColumnWidth);b.isResizable=b.isSortable=b.isHidable=b.isAutoFilterable=b.isAutoFilterable=false;b.fnGetDisplayControlName=function(){ULSEWi:;return a.gridControls[SP.JsGrid.RecordIndicatorControlId].Id};f=new SP.JsGrid.ColumnInfoCollection([b].concat(e.GetColumnArray()))}return f}function Hb(){}function I(a){ULSEWi:;return b.ScrollIntoView(a)}function Cb(d,c){ULSEWi:;k=Q?0:d+(A?a.entryRecordMgr.GetEntryRecords().length:0);b.Update({itemCount:k,topItemIdx:c});return k}function X(c,a){ULSEWi:;k+=c;b.Update({itemCount:k,topItemIdx:a});return k}function S(g,h){ULSEWi:;var d=g,f=g+h-1;d=Math.max(0,Math.min(k-1,d));f=Math.max(0,Math.min(k-1,f));var a=e.ViewIdxToRelViewIdx(d),c=e.ViewIdxToRelViewIdx(f);a=Math.max(a,0);c=Math.min(c,b.GetItemDisplayCapacity()-1);return {clippedRelViewIdx:a,clippedCount:c-a+1}}function wb(){ULSEWi:;h.style.position="relative";h.style.direction=a.RTL.ltr;f=document.createElement("div");f.style.cssText="overflow:hidden;top:"+f.style[a.RTL.left]+"1px;width:"+N()+"px;height:"+w()+"px;border:1px solid "+a.styleMgr.timescaleTierStyle.outerBorderColor+";display:none";h.appendChild(f)}function vb(){ULSEWi:;r=document.createElement("div");r.id=Y+"_leftpane";r.gridItem=true;r.style.cssText="background:"+a.styleMgr.gridPaneStyle.backgroundColor+";overflow:hidden;width:484px;float:"+a.RTL.left;f.appendChild(r);q=document.createElement("div");q.gridItem=true;q.style.cssText="float:"+a.RTL.left+";width:"+SP.Internal.ScrollBar.GetSystemScrollBarThickness()+"px;overflow:hidden;";f.appendChild(q)}function ub(){ULSEWi:;if(!v.IsInited()){var b=v.Init(f,w()+2,-1);b.gridItem=true;f.insertBefore(b,q);b=null}else v.Show();l=document.createElement("div");l.gridItem=true;l.style.cssText="overflow:hidden;float:"+a.RTL.left;l.id=Y+"_rightpane";f.insertBefore(l,q)}function sb(){ULSEWi:;var e,d={},c={},b={},g="position:absolute; visibility:hidden; top:0px; left:0px; width:0px; height:0px;";e=document.createElement("div");e.style.cssText=g;e.style.width=e.style.height="5px";a.parentNode.appendChild(e);d.Top=document.createElement("div");d.Right=document.createElement("div");d.Bottom=document.createElement("div");d.Left=document.createElement("div");for(var f in d){var k=d[f];k.style.cssText=g;a.parentNode.appendChild(k)}c.Top=document.createElement("div");c.Right=document.createElement("div");c.Bottom=document.createElement("div");c.Left=document.createElement("div");for(var f in c){var i=c[f];i.style.cssText=g;i.style["border"+f]=SP.JsGrid.Style.MakeBorderString(1,"solid",a.styleMgr.gridPaneStyle.selectionRectBorderColor);a.parentNode.appendChild(i)}b={Back:{},Fore:{}};b.Back.Top=document.createElement("div");b.Back.Right=document.createElement("div");b.Back.Bottom=document.createElement("div");b.Back.Left=document.createElement("div");b.Fore.Top=document.createElement("div");b.Fore.Right=document.createElement("div");b.Fore.Bottom=document.createElement("div");b.Fore.Left=document.createElement("div");for(var f in b){var l=f=="Back"?SP.JsGrid.Style.MakeBorderString(2,"solid",a.styleMgr.gridPaneStyle.copyRectBackBorderColor):SP.JsGrid.Style.MakeBorderString(2,"dashed",a.styleMgr.gridPaneStyle.copyRectForeBorderColor);for(var j in b[f]){var h=b[f][j];h.style.cssText=g;h.style["border"+j]=l;a.parentNode.appendChild(h)}}R={selDragHandle:e,selFrames:d,focusFrames:c,copyFrames:b}}function D(){ULSEWi:;return bb?SP.Internal.ScrollBar.GetSystemScrollBarThickness():0}function E(){ULSEWi:;return q.style.display!="none"?SP.Internal.ScrollBar.GetSystemScrollBarThickness():0}function J(o){ULSEWi:;cb(C);var e=w();f.style.height=e+"px";for(var k=0;k<f.childNodes.length;k++)if(f.childNodes[k].gridItem)f.childNodes[k].style.height=e+"px";b!=null&&b.Update({physicalViewportSize:e-n-D(),scrollbarSize:e});v.IsInited()&&v.SetHeight(e+2);var h=N();f.style.width=h+"px";if(l!=null){var d=C,i=h-(C+SP.JsGrid.Internal.SplitterWidth+E());r.style.width=d+"px";l.style.width=i+"px";if(a.RTL.bEnabled){j.paneSize.SetValues(i,E());c.paneSize.SetValues(d,h-d)}else{c.paneSize.SetValues(d,0);j.paneSize.SetValues(i,h-E()-i)}}else{var d=h-E();r.style.width=d+"px";c.paneSize.SetValues(d,a.RTL.bEnabled?E():0)}!Q&&!o&&g.each("OnResize");m.NotifyMove()}function tb(){ULSEWi:;v.Hide();SP.Internal.DomElement.GetParentElement(l).removeChild(l);l=null}function hb(){ULSEWi:;y.CheckClipboard()}function gb(){ULSEWi:;L()}function L(){ULSEWi:;f.style.display="none";if(!ib()||h.offsetHeight==B.height&&h.offsetWidth==B.width){f.style.display="";return}B={height:h.offsetHeight,width:h.offsetWidth};f.style.display="";SP.Internal.DomElement.ForceIEZoomFactorRecomputation();var d=b.GetItemDisplayCapacity(),c=b.GetTopItemIdx();U=true;J();var a=w();b.SetViewportSize(a-n-D(),true,a-D());U=false;xb(d,c)}function nb(a){ULSEWi:;if(eb()){SP.Internal.DomElement.StopEvent(a);t.Focus()}}function db(){ULSEWi:;var a=n,d=s;n=fb?fb:0;n=Math.max(n,c.GetMinHeaderHeight());if(j){n=Math.max(n,j.GetMinHeaderHeight());j.SetHeaderHeight(n)}c.SetHeaderHeight(n);s=kb?kb:0;s=Math.max(s,c.GetMinRowHeight());if(j){s=Math.max(s,j.GetMinRowHeight());j.SetRowHeight(s)}c.SetRowHeight(s);(a!=n||d!=s)&&b!=null&&b.Update({physicalViewportSize:w()-n-D(),scrollbarSize:w(),itemSize:s})}function rb(a){ULSEWi:;q.style.display=a?"":"none";J()}function pb(a){ULSEWi:;bb=a;b.Update({bOtherScrollMeets:a,physicalViewportSize:w()-n-D()})}function Ab(b,c){ULSEWi:;var a=b.topIdx-c;if(a!=0&&!U&&!T&&!F)a<0?Gb(b.topIdx,-a):Eb(b.topIdx,a)}function Eb(f,h){ULSEWi:;var a=b.GetItemDisplayCapacity(),d=f+a==k+1&&b.PartialRowPresent(),c=Math.min(h,a),g=c-(d?1:0),e=a-c;o(0,c,e,g,false)}function Gb(i,h){ULSEWi:;var a=b.GetItemDisplayCapacity(),e=d.length!=a,c=Math.min(Math.min(h,k),a),g=c-(e?1:0),f=a-c;o(f,g,0,c,false)}function xb(p,n){ULSEWi:;var i=b.GetItemDisplayCapacity(),a=i-p,m=b.GetTopItemIdx();if(a<0){var j=Math.max(d.length-i,0),l=d.length-j;o(l,j,null,0,false)}else if(a>0){var f=n-m;o(null,0,0,f,false);var c=a-f,g=d.length,h=e.RelViewIdxToViewIdx(g);c=Math.min(h+c,k)-h;o(null,0,g,c,false)}}function o(h,c,a,f,k){ULSEWi:;var j=h!=null&&c>0,b=a!=null&&f>0;if(j||b){var i=b&&f>0?e.GetViewRecords(e.RelViewIdxToViewIdx(a),f,W).records:[];j&&d.splice(h,c);b&&Array.prototype.splice.apply(d,[a,0].concat(i));M();g.each("SpliceRows",h,c,a,i,k);m.NotifyMove()}}function Z(){ULSEWi:;W(b.GetTopItemIdx(),d.length,true)}function W(h,k,i,j){ULSEWi:;if(SP.Internal.JS.FindKey(d,function(a){ULSEWi:;return a==null})===undefined)return;var c=b.GetTopItemIdx(),f={};if(!i||c==j){for(var l=new SP.Utilities.Range(h,h+k-1),a=0;a<d.length;a++)if(d[a]==null&&l.Contains(c+a))f[a]=SP.JsGrid.Internal.LoadErrorState}else{for(var m=e.GetViewRecords(c,d.length,function(a,b,d){ULSEWi:;W(a,b,d,c)}).records,a=0;a<d.length;a++)if(d[a]==null)f[a]=d[a]=m[a];d=[].concat(d);M()}g.each("RenderRows",f)}function M(){ULSEWi:;u={};for(var b=e.GetTopViewIdx(),a=0;a<d.length;a++)if(d[a]!=null)u[d[a].key()]=a+b}function Fb(c){ULSEWi:;for(var d=Array.prototype.slice.call(arguments,1),a=0;a<this.length;++a){var b=this[a][c];b&&b.apply(this[a],d)}}function O(a,b,c){ULSEWi:;var d={data:a.HasDataValue(b)?a.GetDataValue(b):SP.JsGrid.EmptyValue,localized:c.GetDisplayValue!=null?c.GetDisplayValue(a,a.HasDataValue(b)?a.GetDataValue(b):null,a.HasLocalizedValue(b)?a.GetLocalizedValue(b):null):a.HasLocalizedValue(b)?a.GetLocalizedValue(b):SP.JsGrid.EmptyValue};return d}function ib(){ULSEWi:;return h.offsetHeight>0&&h.offsetWidth>0}};SP.JsGrid.Internal.PivotedGridPane=function(c,x,g,e,u,q,j,w,m,r,v,n,s,k,f){ULSEWi:;var a=new SP.JsGrid.Internal.GridPane(c,x,h,e,u,q,j,w,m,r,v,n,s,k,f),b=1;c=null;a.Id=SP.JsGrid.PaneId.PivotedGrid;var t=a.SetView;a.SetView=function(l,j,n,k,d,i,f,h,g,c,e,m){ULSEWi:;t.call(a,l,j,n,k,d,i,f,h,g,c,e,m);b=a.GetGridPaneConverter().GetRowMultiple()};var p=a.SpliceRows;a.SpliceRows=function(h,j,i,e,g){ULSEWi:;for(var d=[],c=0;c<e.length;c++)for(var f=0;f<b;f++)d.push(e[c]);p.call(a,h*b,j*b,i*b,d,g)};var o=a.RenderRows;a.RenderRows=function(f){ULSEWi:;var d={};for(var e in f)for(var g=+e*b,c=0;c<b;c++)d[g+c]=f[e];o.call(a,d)};var d=a.UpdateFocusAfterInsertOrDeleteRows;a.UpdateFocusAfterInsertOrDeleteRows=function(e,f,c){ULSEWi:;d.call(a,e*b,f*b,c)};var i=a.GetMinRowHeight;a.GetMinRowHeight=function(){ULSEWi:;return i.call(a)*b};var l=a.SetRowHeight;a.SetRowHeight=function(c){ULSEWi:;l.call(a,c/b)};function h(b){ULSEWi:;g(a.GetGridPaneConverter().RowIdxToViewIdx(b))}return a};SP.JsGrid.Internal.PositionConverter=function(b,c){ULSEWi:;var d,a,e,f=this;this.SetHierarchyMgrObj=function(b){ULSEWi:;a=b};this.SetScrollBarObj=function(a){ULSEWi:;d=a};this.SetPaneMgrObj=function(a){ULSEWi:;e=a};this.GetTopViewIdx=function(){ULSEWi:;return d.GetTopItemIdx()};this.GetWholeRowDisplayCapacity=function(){ULSEWi:;return d.GetWholeItemDisplayCapacity()};this.RecordIdxToRecordKey=function(a){ULSEWi:;var e;if(c.editUtil.IsNewRowEnabled()&&a>=b.GetRecordCount()){var d=c.entryRecordMgr.GetEntryRecords();if(d.length>0)e=d[Math.min(a-b.GetRecordCount(),d.length-1)].key()}else e=b.RecordIdxToKey(a);return e};this.RecordIdxToViewIdx=function(b){ULSEWi:;return a?a.ConvertRecordIdxToViewIdx(b):b};this.ViewIdxToRecordIdx=function(b){ULSEWi:;return a?a.ConvertViewIdxToRecordIdx(b):b};this.ViewIdxToRelViewIdx=function(a){ULSEWi:;return a-d.GetTopItemIdx()};this.RelViewIdxToViewIdx=function(a){ULSEWi:;return a+d.GetTopItemIdx()};this.IsRecordOnScreen=function(a){ULSEWi:;return e.RecordKeyToViewIdx(a)!=null};this.GetLastRecordKey=function(){ULSEWi:;return b.RecordIdxToKey(b.GetRecordCount()-1)};this.RecordKeyToViewIdx=function(d){ULSEWi:;var f=e.RecordKeyToViewIdx(d);if(f!=null)return f;var a;if(c.entryRecordMgr.IsEntryRecordKey(d))a=c.entryRecordMgr.GetEntryRecordIdx(d)+this.GetViewRecordCount();else a=b.KeyToRecordIdx(d);return a==null?null:this.RecordIdxToViewIdx(a)};this.RecordKeyToRelViewIdx=function(b){ULSEWi:;var a=this.RecordKeyToViewIdx(b);return a!=null?this.ViewIdxToRelViewIdx(a):null};this.RecordKeyToRecordIdx=function(a){ULSEWi:;var c=e.RecordKeyToViewIdx(a);return c!=null?this.ViewIdxToRecordIdx(c):b.KeyToRecordIdx(a)};this.ViewIdxToRecordKey=function(a){ULSEWi:;return this.RecordIdxToRecordKey(this.ViewIdxToRecordIdx(a))};this.GetViewRecordCount=function(){ULSEWi:;return a?a.GetViewRecordCount():b.GetRecordCount()};this.GetViewRecords=function(f,e,j){ULSEWi:;var g=0;if(c.editUtil.IsNewRowEnabled())g=Math.min(Math.max(f+e-this.GetViewRecordCount(),0),e);e-=g;var d=e==0?null:a?a.GetViewRecords(f,e,i):b.GetRecords([{pos:f,count:e}],i);if(d==null)d={recordSetComplete:true,records:[]};else d.records=SP.Internal.JS.Flatten2LevelArray(d.records);if(g>0){var h=Math.max(f-this.GetViewRecordCount(),0);d.records=d.records.concat(c.entryRecordMgr.GetEntryRecords().slice(h,h+g))}return d;function i(b,a){ULSEWi:;j(f,e,a)}}};function AdjustPrintPreviewGridDivWidth(c,d,f,e){ULSEWi:;for(var a=0,b=0;b<c.length;++b)if(c[b].isVisible)a+=c[b].width;a+=d?SP.JsGrid.Internal.RowHeaderWidth:0;a+=f?SP.JsGrid.Internal.SplitterWidth+e:0;a+=2;$get("jsgrid_div_element").style.width=a+"px";return a}SP.JsGrid.PrintPreviewGrid=function(){ULSEWi:;var c,a,i,e,j,m=false,d=false,b=null,f,h;this.Init=function(D,p,B,G,E,s,o,y,w,r,q,F,x,z,A,u,t){ULSEWi:;d=F;b=x;f=z;h=A;i=B;function v(f,b){ULSEWi:;var e=new Array(b.length);for(var d in b){var a=f[b[d]],c=j.MakeRecord(a.data,a.localized,m);c.fieldRawDataMap=a.fieldRawDataMap;c.fieldRawLocMap=a.fieldRawLocMap;e[b[d]]=c}return e}SP.JsGrid.Internal.Property.RegisterDefaultPropTypesFromDefaultDisplayControlMap(s,o);fnInitJsGridParams=g(y,[w]);c=D;a=new SP.JsGrid.JsGridControl.Parameters;a.name=String.format(SP.JsGrid.Res.printPreviewName,c.name);a.tableViewParams=p;for(var C in a.tableViewParams.gridFieldMap){var n=a.tableViewParams.gridFieldMap[C];if(n._propType.ID in o||!n._propType.bMultiValue){if(SP.JsGrid.Internal.Property.PropTypeExists(n._propType.ID))n._propType=SP.JsGrid.Internal.Property.GetPropType(n._propType.ID)}else if(n._propType.bMultiValue)n._propType=new SP.JsGrid.PropertyType.MultiValuePropType(n._propType.singleValuePropType.ID,n._propType.separator,!SP.JsGrid.Internal.Property.PropTypeExists(n._propType.singleValuePropType.ID))}fnInitJsGridParams!=null&&typeof fnInitJsGridParams=="function"&&fnInitJsGridParams(a,c);g(r,[a.tableViewParams,q]);g(u,[a.tableViewParams,c,t]);e=new SP.JsGrid.TableCache(null,v);k(G,p.gridFieldMap,E);a.tableCache=e;l();c.Init(a);$addHandler(window.document.body,"mouseup",function(){ULSEWi:;var e=parseInt($get("jsgrid_div_element").clientWidth),g=AdjustPrintPreviewGridDivWidth(c.GetColumns(),a.tableViewParams.bRowHeadersEnabled,d,f);c.NotifyResize();if(d){var b=c.GetSplitterPosition();c.SetSplitterPosition(b+(g-e))}});setTimeout(function(){ULSEWi:;window.print()},0)};function g(d,e){ULSEWi:;if(d==null)return null;for(var b=d.split("."),c=window,a=0;a<b.length;++a)if(a==b.length-1&&b[a] in c&&typeof c[b[a]]=="function")return c[b[a]].apply(null,e);else if(b[a] in c)c=c[b[a]];else break;return null}function k(a,c,b){ULSEWi:;e.Clear();e.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(a),a);j=new SP.JsGrid.RecordFactory(c,b)}function l(){ULSEWi:;a.styleManager.groupingStyles=i;if(d){a.tableViewParams.splitterPos=parseInt($get("jsgrid_div_element").clientWidth,10)-f-SP.JsGrid.Internal.SplitterWidth;a.tableViewParams.ganttParams.ganttZoomLevel=h;if(b!=null){if(b.fnGetGanttBarDate!=null&&b.fnGetGanttBarDate in window)a.tableViewParams.ganttParams.fnGetGanttBarDate=window[b.fnGetGanttBarDate];if(b.fnGetGanttBarStyleIds!=null&&b.fnGetGanttBarStyleIds in window)a.tableViewParams.ganttParams.fnGetGanttBarStyleIds=window[b.fnGetGanttBarStyleIds];if(b.fnRenderGanttRow!=null&&b.fnRenderGanttRow in window)a.tableViewParams.ganttParams.fnRenderGanttRow=window[b.fnRenderGanttRow];if(b.fnGetPredecessors!=null&&b.fnGetPredecessors in window)a.tableViewParams.ganttParams.fnGetPredecessors=window[b.fnGetPredecessors]}}else{a.tableViewParams.ganttParams=null;a.tableViewParams.paneLayout=SP.JsGrid.PaneLayout.GridOnly}a.tableViewParams.bMovableColumns=true;a.tableViewParams.bResizableColumns=true;a.tableViewParams.bEditingEnabled=false;a.tableViewParams.allowedSelectionTypes=0;a.tableViewParams.bNewRowEnabled=false;a.tableViewParams.bSortableColumns=false;a.tableViewParams.bHidableColumns=false;a.tableViewParams.bAutoFilterableColumns=false;a.tableViewParams.bRecordIndicatorCheckboxesEnabled=false}};SP.JsGrid.CreatePrintPreviewBlobFromRecords=function(f){ULSEWi:;for(var g={},c=0;c<f.length;++c){var a=f[c],e={},d={};for(var b in a.properties){e[b]=a.properties[b].dataValue;if(a.properties[b].HasLocalizedValue())d[b]=a.properties[b].localizedValue}g[a.key()]={data:e,localized:d,fieldRawDataMap:a.fieldRawDataMap,fieldRawLocMap:a.fieldRawLocMap}}return g};SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone=function(e){ULSEWi:;var a=new SP.JsGrid.JsGridControl.TableViewParameters,b=Sys.Serialization.JavaScriptSerializer.deserialize(e);a.messageOverrides=b.simpleFields.messageOverrides;a.operationalConstantsFieldKeyMap=b.simpleFields.operationalConstantsFieldKeyMap;a.defaultEditMode=b.simpleFields.defaultEditMode;a.allowedSelectionTypes=b.simpleFields.allowedSelectionTypes;a.bMovableColumns=b.simpleFields.bMovableColumns;a.bResizableColumns=b.simpleFields.bResizableColumns;a.bHidableColumns=b.simpleFields.bHidableColumns;a.bSortableColumns=b.simpleFields.bSortableColumns;a.bAutoFilterableColumns=b.simpleFields.bAutoFilterableColumns;a.bRowHeadersEnabled=b.simpleFields.bRowHeadersEnabled;a.bRecordIndicatorCheckboxesEnabled=b.simpleFields.bRecordIndicatorCheckboxesEnabled;a.checkSelectionCheckboxHiddenRecordKeys=b.simpleFields.checkSelectionCheckboxHiddenRecordKeys;a.checkSelectionCheckboxDisabledRecordKeys=b.simpleFields.checkSelectionCheckboxDisabledRecordKeys;a.checkSelectionCheckedRecordKeys=b.simpleFields.checkSelectionCheckedRecordKeys;a.bEditingEnabled=b.simpleFields.bEditingEnabled;a.bNewRowEnabled=b.simpleFields.bNewRowEnabled;a.hierarchyKey=b.simpleFields.hierarchyKey;a.splitterPos=b.simpleFields.splitterPos;a.paneLayout=b.simpleFields.paneLayout;a.rowViewParams=b.simpleFields.rowViewParams;var c=Sys.Serialization.JavaScriptSerializer.deserialize(b.gridFieldMap);a.gridFieldMap={};for(var d in c)a.gridFieldMap[d]=SP.JsGrid.GridField.CreateFromSerializedClone(c[d]);a.columns=SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone(b.columns);if(b.pivotedGridParams_columns!=null){a.pivotedGridParams=new SP.JsGrid.JsGridControl.PivotedGridParameters;a.pivotedGridParams.columns=SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone(b.pivotedGridParams_columns)}if(b.ganttParams!=null)a.ganttParams=SP.JsGrid.JsGridControl.GanttParameters.CreateFromSerializedClone(b.ganttParams);if(b.unfilteredHierarchyMgr!=null)a.rowViewParams.unfilteredHierarchyMgr=SP.JsGrid.UnfilteredHierarchyManager.CreateFromSerializedClone(b.unfilteredHierarchyMgr);return a};SP.JsGrid.UnfilteredHierarchyManager.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({unfilteredHierMap:a.rowViewParams.unfilteredHierarchyMgr.GetUnfilteredHierarchyMap(),topNodeKey:a.rowViewParams.unfilteredHierarchyMgr.GetTopNodeKey()})};SP.JsGrid.UnfilteredHierarchyManager.CreateFromSerializedClone=function(c){ULSEWi:;var b=new SP.JsGrid.UnfilteredHierarchyManager([]),a=Sys.Serialization.JavaScriptSerializer.deserialize(c);b.Hydrate(a.unfilteredHierMap,a.topNodeKey);return b};SP.JsGrid.JsGridControl.TableViewParameters.GetSerializedClone=function(a){ULSEWi:;var b={};for(var c in a.gridFieldMap)b[c]=SP.JsGrid.GridField.GetSerializedClone(a.gridFieldMap[c]);return Sys.Serialization.JavaScriptSerializer.serialize({simpleFields:{messageOverrides:a.messageOverrides,operationalConstantsFieldKeyMap:a.operationalConstantsFieldKeyMap,defaultEditMode:a.defaultEditMode,allowedSelectionTypes:a.allowedSelectionTypes,bMovableColumns:a.bMovableColumns,bResizableColumns:a.bResizableColumns,bHidableColumns:a.bHidableColumns,bSortableColumns:a.bSortableColumns,bAutoFilterableColumns:a.bAutoFilterableColumns,bRowHeadersEnabled:a.bRowHeadersEnabled,bRecordIndicatorCheckboxesEnabled:a.bRecordIndicatorCheckboxesEnabled,checkSelectionCheckboxHiddenRecordKeys:a.checkSelectionCheckboxHiddenRecordKeys,checkSelectionCheckboxDisabledRecordKeys:a.checkSelectionCheckboxDisabledRecordKeys,checkSelectionCheckedRecordKeys:a.checkSelectionCheckedRecordKeys,bEditingEnabled:a.bEditingEnabled,bNewRowEnabled:a.bNewRowEnabled,hierarchyKey:a.hierarchyKey,splitterPos:a.splitterPos,paneLayout:a.paneLayout,rowViewParams:a.rowViewParams},gridFieldMap:Sys.Serialization.JavaScriptSerializer.serialize(b),columns:SP.JsGrid.ColumnInfoCollection.GetSerializedClone(a.columns),pivotedGridParams_columns:a.pivotedGridParams==null?null:SP.JsGrid.ColumnInfoCollection.GetSerializedClone(a.pivotedGridParams.columns),ganttParams:a.ganttParams==null?null:SP.JsGrid.JsGridControl.GanttParameters.GetSerializedClone(a.ganttParams),unfilteredHierarchyMgr:a.rowViewParams.unfilteredHierarchyMgr==null?null:SP.JsGrid.UnfilteredHierarchyManager.GetSerializedClone(a)})};SP.JsGrid.JsGridControl.GanttParameters.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({dateRange:a.dateRange,ganttBarStyles:a.ganttBarStyles,ganttZoomLevel:a.ganttZoomLevel})};SP.JsGrid.JsGridControl.GanttParameters.CreateFromSerializedClone=function(c){ULSEWi:;var a=new SP.JsGrid.JsGridControl.GanttParameters,b=Sys.Serialization.JavaScriptSerializer.deserialize(c);a.dateRange=b.dateRange;a.ganttBarStyles=b.ganttBarStyles;a.ganttZoomLevel=b.ganttZoomLevel;return a};SP.JsGrid.GridField.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({key:a.key,hasDataValue:a.hasDataValue,hasLocalizedValue:a.hasLocalizedValue,textDirection:a.textDirection,_defaultCellStyleId:a._defaultCellStyleId,_editMode:a._editMode,_propType:a._propType,_multiValue:a._multiValue})};SP.JsGrid.GridField.CreateFromSerializedClone=function(c){ULSEWi:;var a=new SP.JsGrid.GridField,b=Sys.Serialization.JavaScriptSerializer.deserialize(c);a.key=b.key;a.hasDataValue=b.hasDataValue;a.hasLocalizedValue=b.hasLocalizedValue;a.textDirection=b.textDirection;a._defaultCellStyleId=b._defaultCellStyleId;a._editMode=b._editMode;a._multiValue=b._multiValue;a._propType=b._propType;return a};SP.JsGrid.GetSerializedCloneFromColumnInfo=function(a){ULSEWi:;if(a.ColumnType()=="column")return Sys.Serialization.JavaScriptSerializer.serialize({name:a.name,imgSrc:a.imgSrc,columnKey:a.columnKey,fieldKeys:a.fieldKeys,width:a.width,isVisible:a.isVisible,isHidable:a.isHidable,isResizable:a.isResizable,isSortable:a.isSortable,isAutoFilterable:a.isAutoFilterable,pivoted:false});else if(a.ColumnType()=="pivotedColumn")return Sys.Serialization.JavaScriptSerializer.serialize({name:a.name,imgSrc:a.imgSrc,columnKey:a.columnKey,fieldKeys:a.fieldKeys,width:a.width,pivoted:true})};SP.JsGrid.CreateColumnInfoFromSerializedClone=function(c){ULSEWi:;var a=Sys.Serialization.JavaScriptSerializer.deserialize(c),b;if(a.pivoted)b=new SP.JsGrid.PivotedColumnInfo(a.name,a.imgSrc,a.columnKey,a.fieldKeys,a.width);else{b=new SP.JsGrid.ColumnInfo(a.name,a.imgSrc,a.columnKey,a.width);b.isVisible=a.isVisible;b.isHidable=a.isHidable;b.isResizable=a.isResizable;b.isSortable=a.isSortable;b.isAutoFilterable=a.isAutoFilterable}return b};SP.JsGrid.ColumnInfoCollection.GetSerializedClone=function(d){ULSEWi:;for(var c=[],b=d.GetColumnArray(),a=0;a<b.length;++a)c.push(SP.JsGrid.GetSerializedCloneFromColumnInfo(b[a]));return Sys.Serialization.JavaScriptSerializer.serialize(c)};SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone=function(d){ULSEWi:;for(var b=[],c=Sys.Serialization.JavaScriptSerializer.deserialize(d),a=0;a<c.length;++a)b.push(SP.JsGrid.CreateColumnInfoFromSerializedClone(c[a]));return new SP.JsGrid.ColumnInfoCollection(b)};SP.JsGrid.FinishLaunchPrintPreview=function(records,jsGridParams,additionalScriptFiles,beforeInitFnName,beforeInitFnArgsObj,initTableViewParamsFnName,initTableViewParamsFnArgsObj,title,bEnableGantt,optGanttDelegateNames,ganttPaneWidth,ganttZoomLevel,initGanttStylesFnName,initGanttStylesFnArgsObj){ULSEWi:;var newWin,cssLinkScripts=[],AJAXScripts=[],scripts=[],requiredScriptFiles=["scriptresx.ashx","jsgrid.js","sp.datetimeutil.js","jsgrid.gantt.js","init.js"],requiredAJAXFiles=["scriptresource.axd","webresource.axd"],requiredCssFiles=["jsgrid.css","corev4.css","cui.css"];function MatchNodeWithSourceFiles(node,requiredFilesArray,htmlElementArray,attrib){ULSEWi:;var nodeStr=(eval("node."+attrib)).toLowerCase();if(requiredFilesArray!=null)for(var idx=0;idx<requiredFilesArray.length;++idx){var fileName=requiredFilesArray[idx].toLowerCase();if(nodeStr.indexOf(fileName)!=-1||fileName.indexOf(".js")==fileName.length-3&&nodeStr.indexOf(fileName.substr(0,fileName.length-3)+".debug.js")!=-1){htmlElementArray.push(SP.Internal.DomElement.GetOuterHTML(node));return true}}}function CopyRequiredDOMElements(a){ULSEWi:;for(var b=0;b<a.childNodes.length;++b){var c=a.childNodes[b];c.nodeType==1&&CopyRequiredDOMElements(c)}if(a.nodeName=="LINK"){if(MatchNodeWithSourceFiles(a,requiredCssFiles,cssLinkScripts,"href"))return}else if(a.nodeName=="SCRIPT"){if(MatchNodeWithSourceFiles(a,requiredScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(a,additionalScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(a,requiredAJAXFiles,AJAXScripts,"src"))return}}function RenderHTMLElementArray(b){ULSEWi:;for(var a=0;a<b.length;++a)newWin.document.writeln(b[a])}function RenderPrintPreviewDocument(){ULSEWi:;newWin.document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"');newWin.document.writeln('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">');newWin.document.writeln("<html>");newWin.document.writeln("<head>");newWin.document.writeln("<title>"+title+"</title>");RenderHTMLElementArray(cssLinkScripts);RenderHTMLElementArray(AJAXScripts);newWin.document.writeln("</head>");newWin.document.writeln("<body>");newWin.document.writeln('<div id="jsgrid_outer_div_element" style="width:100%; height:100%; overflow-y:auto">');newWin.document.writeln('<div id="jsgrid_div_element" style="width:100%; height:570px" display="block"/>');newWin.document.writeln("</div>");newWin.document.writeln(String.format(["<script>","var _spRegionalSettings={0}","</script>"].join("\n"),Sys.Serialization.JavaScriptSerializer.serialize(_spRegionalSettings)));RenderHTMLElementArray(scripts);newWin.document.writeln(String.format(["<script>","Sys.Application.initialize();","var printPreviewGrid=new SP.JsGrid.PrintPreviewGrid();","Sys.Application.add_init(function()","{{",'    var jsGridDiv=$get("jsgrid_div_element");','    jsGridDiv.style.backgroundColor="white";','    var defaultDisplayControlMap=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{0}"));','    var lookupPropTypeMap=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{8}"));','    var tableViewParams=new SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone(unescape("{1}"));','    var dataBlob=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{2}"));',"    var recordCount={3};",'    jsGridDiv.style.height=(recordCount * 21+50)+"px";',"    AdjustPrintPreviewGridDivWidth(tableViewParams.columns.GetColumnArray(), tableViewParams.bRowHeadersEnabled, {9}, {11});",'    var keyColumnName=unescape("{4}");',"    printPreviewGrid.Init(","        new SP.JsGrid.JsGridControl(jsGridDiv, false),","        tableViewParams,",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{7}")),',"        dataBlob,","        keyColumnName,","        defaultDisplayControlMap,","        lookupPropTypeMap,","        {5},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{6}")),',"        {13},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{14}")),',"        {9},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{10}")),',"        {11},","        {12},","        {16},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{17}"))',"    );","}});",'Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse(unescape("{15}"));',"</script>","</body>","</html>"].join("\n"),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.Internal.Property.GetDefaultDisplayControlMap())),escape(SP.JsGrid.JsGridControl.TableViewParameters.GetSerializedClone(jsGridParams.tableViewParams)),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.CreatePrintPreviewBlobFromRecords(records))),records.length,escape(jsGridParams.tableViewParams.keyFieldName),beforeInitFnName?['"',beforeInitFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(beforeInitFnArgsObj)),escape(Sys.Serialization.JavaScriptSerializer.serialize(jsGridParams.styleManager.groupingStyles)),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.Internal.Property.GetLookupPropTypeMap())),bEnableGantt?"true":"false",escape(Sys.Serialization.JavaScriptSerializer.serialize(optGanttDelegateNames)),ganttPaneWidth,ganttZoomLevel,initTableViewParamsFnName?['"',initTableViewParamsFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(initTableViewParamsFnArgsObj)),escape(Sys.Serialization.JavaScriptSerializer.serialize(Sys.CultureInfo.CurrentCulture)),initGanttStylesFnName?['"',initGanttStylesFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(initGanttStylesFnArgsObj))))}CopyRequiredDOMElements(document);newWin=window.open();newWin.document.clear();newWin.document.open("text/html");RenderPrintPreviewDocument();newWin.document.close()};Type.registerNamespace("SP.JsGrid.PropertyType");SP.JsGrid.PropertyType.String=function(){ULSEWi:;this.ID="String";this.BeginValidateNormalizeConvert=function(d,e,a,c,b){ULSEWi:;a=a!=null&&a.length==0?null:a;b({isValid:true,dataValue:a,normalizedLocValue:a})}};SP.JsGrid.PropertyType.LookupTable=function(a,e,c){ULSEWi:;function b(b){ULSEWi:;if(b==null)return null;return SP.Internal.JS.Find(a,function(a){ULSEWi:;return a.value==b})}function d(b){ULSEWi:;if(b==null)return null;var c=b.toLowerCase();return SP.Internal.JS.Find(a,function(a){ULSEWi:;return a.localString.toLowerCase()==c})}return {ID:e,BeginValidateNormalizeConvert:function(h,i,e,f,g){ULSEWi:;r={};var a=f?d(e):b(e);r.isValid=a!=null||!c;if(a!=null){r.normalizedLocValue=a.localString;r.dataValue=a.value}else r.normalizedLocValue=r.dataValue=e;g(r)},GetItems:function(d){ULSEWi:;for(var c=[],b=0;b<a.length;b++)c.push(SP.JsGrid.Property.MakeProperty(a[b].value,a[b].localString,true,true,this));d(c)},DataToLocalized:function(c){ULSEWi:;var a=b(c);return a?a.localString:SP.JsGrid.EmptyValue},LocalizedToData:function(b){ULSEWi:;var a=d(b);return a?a.value:SP.JsGrid.EmptyValue},GetImageSource:function(d,c){ULSEWi:;var a=b(c);return a!=null?a.imageUrl:null},GetStyleId:function(c){ULSEWi:;var a=b(c);return a!=null?a.styleId:null},GetIsLimitedToList:function(){ULSEWi:;return c},GetSerializableLookupPropType:function(){ULSEWi:;return {items:a,id:e,bLimitToList:c}}}};SP.JsGrid.PropertyType.CheckBoxBoolean=function(){ULSEWi:;this.ID="CheckBoxBoolean";this.BeginValidateNormalizeConvert=function(d,e,a,b,c){ULSEWi:;a=b?a!=""&&a!=SP.JsGrid.Res.checkboxUnchecked:!!a;c({isValid:true,dataValue:a,normalizedLocValue:this.DataToLocalized(a)})};this.DataToLocalized=function(a){ULSEWi:;return a?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};this.GetBool=function(a){ULSEWi:;return a==SP.JsGrid.EmptyValue?false:!!a}};SP.JsGrid.PropertyType.MultiValuePropType=function(d,c,g,h){ULSEWi:;var a=null;function f(){ULSEWi:;a=SP.JsGrid.Internal.Property.GetPropType(d);b.singleValuePropType=a;b.GetImageSource=a.GetImageSource&&function(c,b){ULSEWi:;return e(b,function(b){ULSEWi:;return a.GetImageSource(c,b)})};b.GetItems=a.GetItems;b.GetUpdateTrackingMode=a.GetUpdateTrackingMode;b.GetUpdateSerializeMode=a.GetUpdateSerializeMode;b.DataToLocalized=a.DataToLocalized&&function(c){ULSEWi:;return b.LocStrArrayToLocStr(e(c,function(b){ULSEWi:;return a.DataToLocalized(b)}))};b.LocalizedToData=a.LocalizedToData&&function(c){ULSEWi:;return e(b.LocStrToLocStrArray(c),function(b){ULSEWi:;return a.LocalizedToData(b)})};b.GetDisplayValue=a.GetDisplayValue&&function(h,d,g){ULSEWi:;var f=[];if(d!=null&&d!=SP.JsGrid.EmptyValue&&d!=SP.JsGrid.InvalidValue)for(var i=b.LocStrToLocStrArray(g),e=0;e<d.length;e++)f.push(a.GetDisplayValue(h,d[e],e>=i.length?null:i[e]));else f.push(a.GetDisplayValue(h,d,g));return SP.Internal.JS.JoinStrings(f,c+" ")}}this.ID=d+"_MultiValue";this.bMultiValue=true;this.separator=c;this.singleValuePropType=a;var b=this;!g&&f();this.GetSerializableMultiValuePropType=function(){ULSEWi:;return {singleValuePropTypeID:d,separatorChar:c,bDelayInit:g}};this.InitSingleValuePropType=function(){ULSEWi:;f()};this.BeginValidateNormalizeConvert=function(m,n,d,e,g,o){ULSEWi:;if(e&&d==""||!e&&(d==null||d.length==0)){g({isValid:true,dataValue:[],normalizedLocValue:""});return}if(e)d=this.LocStrToLocStrArray(d);var c,f=0;i();return;function i(){ULSEWi:;a.BeginValidateNormalizeConvert(m,n,d[f],e,l,o)}function l(a){ULSEWi:;k(a);f++;if(f<d.length)i();else g(j())}function k(a){ULSEWi:;if(f==0)c={isValid:a.isValid,dataValue:[a.dataValue],normalizedLocValue:[a.normalizedLocValue]};else{c.isValid=c.isValid&&a.isValid;c.dataValue.push(a.dataValue);c.normalizedLocValue.push(a.normalizedLocValue)}}function j(){ULSEWi:;if(c!=null)if(c.isValid){if(!h)for(var g=a.IsDataEqual,d=c.dataValue,f=0;f<d.length;f++)for(var e=0;e<d.length;e++){if(f==e)continue;(g==null?d[f]==d[e]:g(d[f],d[e]))&&d.splice(e,1)}c.normalizedLocValue=b.LocStrArrayToLocStr(c.normalizedLocValue);return c}else return {isValid:false};return {isValid:true,dataValue:null,normalizedLocValue:null}}};this.LocStrToLocStrArray=function(a){ULSEWi:;if(a&&a.constructor!=String)return [];return SP.Internal.JS.TokenizeString(a,c)};this.LocStrArrayToLocStr=function(a){ULSEWi:;return SP.Internal.JS.JoinStrings(a,c+" ")};function e(a,d){ULSEWi:;if(a==null)return null;for(var c=[],b=0;b<a.length;b++)c.push(d(a[b]));return c}};SP.JsGrid.PropertyType.Hyperlink=function(){ULSEWi:;this.ID="Hyperlink";this.bHyperlink=true;var b='"',a='", "',c=encodeURIComponent(a);this.BeginValidateNormalizeConvert=function(f,g,a,c,e){ULSEWi:;var b=c?d(a):a;e({isValid:b!=null,dataValue:b,normalizedLocValue:this.DataToLocalized(a)})};this.DataToLocalized=function(a){ULSEWi:;return a?a.display:""};this.GetAddress=function(a){ULSEWi:;return a?a.address:""};this.GetCopyValue=function(c,a){ULSEWi:;return e(a)};function e(d){ULSEWi:;var e=d.address.replace(a,c);return d?String.format("{0}{1}{2}{3}{0}",b,e,a,d.display):null}function d(d){ULSEWi:;if(d==null)return null;if(d.length==0)d="";var e=d.indexOf(a);if(e<0||!d.startsWith(b)||!d.endsWith(b))return {address:d,display:d};return {address:d.substring(1,e).replace(c,a),display:d.substring(e+a.length,d.length-1)}}};SP.JsGrid.PropertyType.RegisterNewLookupPropType=function(d,c,a,b){ULSEWi:;var e=new SP.JsGrid.PropertyType.LookupTable(c,d,b);SP.JsGrid.Internal.Property.RegisterPropType(e,a,SP.JsGrid.EditControl.Type.ComboBox,[])};SP.JsGrid.PropertyType.RegisterNewCustomPropType=function(d,b,c,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterPropType(d,b,c,a)};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterDerivedPropType(b,a)};Type.registerNamespace("SP.JsGrid.PropertyType.Utils");SP.JsGrid.PropertyType.Utils.RegisterDisplayControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterDisplayControl(c,b,a)};SP.JsGrid.PropertyType.Utils.RegisterEditControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterEditControl(c,b,a)};SP.JsGrid.PropertyType.Utils.RegisterWidgetControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterWidgetControl(c,b,a)};SP.JsGrid.PropertyType.Utils.UpdateDisplayControlForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateDisplayControlForPropType(b,a)};SP.JsGrid.PropertyType.Utils.UpdateEditControlForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateEditControlForPropType(b,a)};SP.JsGrid.PropertyType.Utils.UpdateWidgetControlsForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateWidgetControlsForPropType(b,a)};SP.JsGrid.PropertyType.Utils.GetPropType=function(a){ULSEWi:;return SP.JsGrid.Internal.Property.GetPropType(a)};SP.JsGrid.Internal.Property=function(){ULSEWi:;var e=this,d=[[new SP.JsGrid.PropertyType.String,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[]],[new SP.JsGrid.PropertyType.CheckBoxBoolean,SP.JsGrid.DisplayControl.Type.Checkbox,SP.JsGrid.EditControl.Type.Checkbox,[]],[new SP.JsGrid.PropertyType.Hyperlink,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[SP.JsGrid.WidgetControl.Type.Hyperlink]]],b=SP.Internal.JS.ConvertTableToMap(d,"0","1"),i=[[SP.JsGrid.DisplayControl.Type.Image,SP.JsGrid.DisplayControl.ImageDisplayControl,["GetImageSource"]],[SP.JsGrid.DisplayControl.Type.ImageText,SP.JsGrid.DisplayControl.ImageTextDisplayControl,["GetImageSource"]],[SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.DisplayControl.TextDisplayControl,[]],[SP.JsGrid.DisplayControl.Type.Checkbox,SP.JsGrid.DisplayControl.CheckboxDisplayControl,["GetBool"]]],f=SP.Internal.JS.ConvertTableToMap(i,"0","1"),o=SP.Internal.JS.ConvertTableToMap(i,"0","2"),l=[[SP.JsGrid.EditControl.Type.EditBox,function(a,b){ULSEWi:;return new SP.JsGrid.EditControl.EditBoxEditControl(a,b)},[]],[SP.JsGrid.EditControl.Type.ComboBox,function(a){ULSEWi:;return new SP.JsGrid.EditControl.ComboBoxEditControl(a)},["GetItems"]],[SP.JsGrid.EditControl.Type.Checkbox,function(a){ULSEWi:;return new SP.JsGrid.EditControl.CheckboxEditControl(a)},["GetBool"]]],j=SP.Internal.JS.ConvertTableToMap(l,"0","1"),r=SP.Internal.JS.ConvertTableToMap(l,"0","2"),k=[[SP.JsGrid.WidgetControl.Type.Date,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.DateWidget(a)},[]],[SP.JsGrid.WidgetControl.Type.AddressBook,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.AddressBookWidget(a)},["GetPeoplePickerUrl"]],[SP.JsGrid.WidgetControl.Type.Hyperlink,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.HyperlinkWidget(a)},["GetAddress"]],[SP.JsGrid.ErrorWidgetId,function(a,b){ULSEWi:;return new SP.JsGrid.WidgetControl.ErrorWidget(a,b)},[]]],h=SP.Internal.JS.ConvertTableToMap(k,"0","1"),p=SP.Internal.JS.ConvertTableToMap(k,"0","2"),a={},c={};this.GetDefaultDisplayControlMap=function(){ULSEWi:;var c={};for(var b in a)c[b]=a[b].display.Id;return c};this.RegisterDefaultPropTypesFromDefaultDisplayControlMap=function(d,b){ULSEWi:;if(b==null)b={};for(var c in d)a[c]==undefined&&m(c,this.GetDisplayControl(d[c]),b)};this.GetLookupPropTypeMap=function(){ULSEWi:;var c={};for(var a in b)if(b[a].GetSerializableLookupPropType!=null)c[a]=b[a].GetSerializableLookupPropType();else if(b[a].bMultiValue&&b[a].singleValuePropType.GetSerializableLookupPropType!=null)c[a]=b[a].GetSerializableMultiValuePropType();return c};this.RegisterDisplayControl=function(a,d,b){ULSEWi:;f[a]=d;o[a]=b;c={}};this.RegisterEditControl=function(a,d,b){ULSEWi:;j[a]=d;r[a]=b;c={}};this.RegisterWidgetControl=function(a,d,b){ULSEWi:;h[a]=d;p[a]=b;c={}};this.GetPropType=function(a){ULSEWi:;return b[a]};this.PropTypeExists=function(a){ULSEWi:;return a in b};this.GetDisplayControl=function(a){ULSEWi:;return f[a]};this.GetEditControl=function(c,a){ULSEWi:;var b=j[c];return b.apply(null,a)};this.GetWidgetControl=function(c,a){ULSEWi:;var b=h[c];return b.apply(null,a)};this.GetUpdateTrackingMode=function(b,a){ULSEWi:;if(b.GetUpdateTrackingMode!=null)return b.GetUpdateTrackingMode();return a.hasDataValue?a.hasLocalizedValue?SP.JsGrid.UpdateTrackingMode.PropBoth:SP.JsGrid.UpdateTrackingMode.PropData:SP.JsGrid.UpdateTrackingMode.PropLocalized};this.GetUpdateSerializeMode=function(a,c){ULSEWi:;if(a&&a.GetUpdateSerializeMode!=null)return a.GetUpdateSerializeMode();var b=a!=null&&c!=null?this.GetUpdateTrackingMode(a,c):SP.JsGrid.UpdateSerializeMode.PropBoth;if(b==SP.JsGrid.UpdateSerializeMode.PropBoth)b=SP.JsGrid.UpdateSerializeMode.PropLocalizedOnly;return b};function m(e,g,f){ULSEWi:;if(e in f){var d=f[e];if(d.singleValuePropTypeID!=null)b[e]=new SP.JsGrid.PropertyType.MultiValuePropType(d.singleValuePropTypeID,d.separatorChar,d.bDelayInit);else b[e]=new SP.JsGrid.PropertyType.LookupTable(d.items,d.id,d.bLimitToList)}delete c[e];a[e]={display:g,editControlName:"",widgetControlNames:[]}}this.RegisterPropType=function(d,b,c,a){ULSEWi:;a=a==null?[]:a;g(d,this.GetDisplayControl(b),c,a)};this.RegisterDerivedPropType=function(d,c){ULSEWi:;var b=a[c];g(d,b.display,b.editControlName,b.widgetControlNames)};function g(d,g,f,e){ULSEWi:;b[d.ID]=d;delete c[d.ID];var h=a[d.ID]={display:g,editControlName:f,widgetControlNames:e}}this.UpdateDisplayControlForPropType=function(c,b){ULSEWi:;a[c].display=this.GetDisplayControl(b)};this.UpdateEditControlForPropType=function(c,b){ULSEWi:;a[c].editControlName=b};this.UpdateWidgetControlsForPropType=function(c,b){ULSEWi:;a[c].widgetControlNames=b};this.GetDisplayControlForProperty=function(c,b){ULSEWi:;if(b!=null)return this.GetDisplayControl(b);return a[c.ID].display};this.GetEditAndWidgetControlNamesForProperty=function(g,b,e,f){ULSEWi:;var d,c,i;if(b.fnGetEditControlName!=null&&(i=b.fnGetEditControlName(g,e))!=null)d=i;else d=a[f.ID].editControlName;var h;if(b.fnGetWidgetControlNames!=null&&(h=b.fnGetWidgetControlNames(g,e))!=null)c=h;else c=[].concat(a[f.ID].widgetControlNames);return {editControlName:d,widgetControlNames:c}};function t(){ULSEWi:;for(var b in d){var a=d[b];e.RegisterPropType(a[0],a[1],a[2],a[3])}n();q()}function s(b,a){ULSEWi:;this.ID=b;this.BeginValidateNormalizeConvert=function(g,h,c,e,f){ULSEWi:;var d={},b=e?Date.parseLocale(c)||Date.parseInvariant(c)||Date.parse(c):c.getTime!=null?c:new Date(+c);b=b!=null?new Date(b):null;d.isValid=b!=null&&!isNaN(b.getTime());d.dataValue=d.isValid?b:null;d.normalizedLocValue=d.isValid?b.localeFormat(a):null;f(d)}}function q(){ULSEWi:;e.RegisterPropType(new s("JSDateTime",Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortDatePattern),SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[SP.JsGrid.WidgetControl.Type.Date])}function n(){ULSEWi:;var c={BeginValidateNormalizeConvert:function(i,j,a,e,g){ULSEWi:;var c=this;function f(a){ULSEWi:;a=c.PreParse!=null?c.PreParse(a):a;var b=Number.parseLocale(a);return c.PostParse!=null?c.PostParse(b):b}function h(){ULSEWi:;return a.format!=null?a:Number.parseInvariant(a+"")}var b=e?f(a):h(a),d=b.localeFormat(this.FormatString);g({isValid:!isNaN(b),dataValue:this.ProcessData!=null?ProcessData(b):b,normalizedLocValue:this.ProcessLocalized!=null?this.ProcessLocalized(b,d):d})},CompareTo:function(a,b){ULSEWi:;return a-b}},b=[{ID:"JSNumber",FormatString:"D"}];for(var d in b){var a=SP.Internal.JS.object(b[d]);a.BeginValidateNormalizeConvert=c.BeginValidateNormalizeConvert;a.CompareTo=c.CompareTo;e.RegisterPropType(a,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[])}}t()};SP.JsGrid.RecordFactory=function(a,d,b){ULSEWi:;this.gridFieldMap=a;this.MakeRecord=function(e,h,k){ULSEWi:;var g=new c;g.recordKey=e[d];for(var f in a){var i=a[f],j=SP.JsGrid.Property.MakePropertyFromGridField(i,e[f],h[f],b!=null&&!i.GetIsMultiValue()?b(g.recordKey,i.key,e):null);if(j!=null){g.properties[f]=j;if(!k){delete e[f];delete h[f]}}}g.fieldRawDataMap=e!=null?e:{};g.fieldRawLocMap=h!=null?h:{};return g};var c=function(){ULSEWi:;this.properties={}};c.prototype={key:function(){ULSEWi:;return this.recordKey},GetDataValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].GetData():this.fieldRawDataMap[a]},GetLocalizedValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].GetLocalized():this.fieldRawLocMap[a]},HasDataValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].HasDataValue():a in this.fieldRawDataMap},HasLocalizedValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].HasLocalizedValue():a in this.fieldRawLocMap},GetProp:function(a){ULSEWi:;return this.properties[a]},SetProp:function(a,b){ULSEWi:;this.properties[a]=b},AddFieldValue:function(b,a){ULSEWi:;if(a.isProp)this.properties[b]=a.prop;else if(b in this.properties)this.properties[b].Update(a.hasData?a.data:SP.JsGrid.EmptyValue,a.hasLocalized?a.localized:SP.JsGrid.EmptyValue);else{if(a.hasLocalized)this.fieldRawLocMap[b]=a.localized;if(a.hasData)this.fieldRawDataMap[b]=a.data}},RemoveFieldValue:function(a){ULSEWi:;delete this.properties[a];delete this.fieldRawLocMap[a];delete this.fieldRawDataMap[a]}}};SP.JsGrid.Property=function(){ULSEWi:;PropertyBase=function(b,a,c){ULSEWi:;if(c!=null)this.propType=c;if(b!=null)this.dataValue=b;if(a!=null)this.localizedValue=a};LocalizedProperty=function(b,a){ULSEWi:;this.localizedValue=b;if(a!=null)this.propType=a};DataProperty=function(b,a){ULSEWi:;this.dataValue=b;if(a!=null)this.propType=a};PropertyBase.prototype={HasLocalizedValue:function(){ULSEWi:;return true},HasDataValue:function(){ULSEWi:;return true},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,true,true,this.propType)},Update:function(a,b){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.dataValue=a!=SP.JsGrid.InvalidValue?SP.Internal.JS.CloneObj(a):a;if(b!=SP.JsGrid.EmptyValue)this.localizedValue=b},GetLocalized:function(){ULSEWi:;return this.localizedValue},GetData:function(){ULSEWi:;return this.dataValue}};DataProperty.prototype={HasLocalizedValue:function(){ULSEWi:;return this.propType.DataToLocalized!=null},HasDataValue:function(){ULSEWi:;return true},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,true,false,this.propType)},Update:function(a){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.dataValue=a!=SP.JsGrid.InvalidValue?SP.Internal.JS.CloneObj(a):a},GetLocalized:function(){ULSEWi:;return this.dataValue!=SP.JsGrid.InvalidValue?this.propType.DataToLocalized(this.dataValue):""},GetData:function(){ULSEWi:;return this.dataValue}};LocalizedProperty.prototype={HasLocalizedValue:function(){ULSEWi:;return true},HasDataValue:function(){ULSEWi:;return this.propType.LocalizedToData!=null},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,false,true,this.propType)},Update:function(b,a){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.localizedValue=a},GetLocalized:function(){ULSEWi:;return this.localizedValue},GetData:function(){ULSEWi:;return this.localizedValue!=SP.JsGrid.InvalidValue?this.propType.LocalizedToData(this.localizedValue):null}};return {MakeProperty:function(d,b,c,e,a){ULSEWi:;if(c&&e)return new PropertyBase(d,b,a);if(c)return new DataProperty(d,a);return new LocalizedProperty(b,a)},MakePropertyFromGridField:function(a,f,e,b){ULSEWi:;var d=null,c=b!=null?b:a.GetPropType();if(c!=null)d=SP.JsGrid.Property.MakeProperty(f,e,a.hasDataValue,a.hasLocalizedValue,c);return d}}}();SP.JsGrid.Internal.PropertyUpdate=function(b,a){ULSEWi:;this.data=b;this.localized=a};SP.JsGrid.Internal.PropertyUpdate.prototype={HasDataValue:function(){ULSEWi:;return this.data!=SP.JsGrid.EmptyValue},HasLocalizedValue:function(){ULSEWi:;return this.localized!=SP.JsGrid.EmptyValue}};SP.JsGrid.CreateUnvalidatedPropertyUpdate=function(b,c,d,a){ULSEWi:;return new SP.JsGrid.UnvalidatedPropertyUpdate(b,c,d,a)};SP.JsGrid.CreateValidatedPropertyUpdate=function(c,d,b,a){ULSEWi:;return new SP.JsGrid.ValidatedPropertyUpdate(c,d,b,a)};SP.JsGrid.UnvalidatedPropertyUpdate=function(b,c,d,a){ULSEWi:;this.recordKey=b;this.fieldKey=c;this.newValue=d;this.newValueIsLocalized=a};SP.JsGrid.UnvalidatedPropertyUpdate.prototype={validated:false};SP.JsGrid.ValidatedPropertyUpdate=function(c,d,b,a){ULSEWi:;this.recordKey=c;this.fieldKey=d;this.newDataValue=b;this.newLocalizedValue=a};SP.JsGrid.ValidatedPropertyUpdate.prototype={validated:true};SP.JsGrid.Internal.PropertyUpdateManager=function(a){ULSEWi:;this.ApplyPropUpdates=function(c,d){ULSEWi:;for(var a=0;a<c.length;a++)b(c[a],d)};function b(b,d){ULSEWi:;if(b.validated)c(new SP.JsGrid.Internal.PropertyUpdate(b.newDataValue,b.newLocalizedValue),SP.JsGrid.ValidationState.Valid);else{var h=a.controller.GetPropType(b.recordKey,b.fieldKey);if(b.newValueIsLocalized)b.newValue=b.newValue==null?"":b.newValue.replace(/^\s+|\s+$/g,"");var g=true,f=false;h.BeginValidateNormalizeConvert(b.recordKey,b.fieldKey,b.newValue,b.newValueIsLocalized,e,i);if(g){a.pendingChangeMgr.IncrementPendingChangeCount(d);f=true;c(b.newValueIsLocalized?new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.InvalidValue,b.newValue):new SP.JsGrid.Internal.PropertyUpdate(b.newValue,SP.JsGrid.InvalidValue),SP.JsGrid.ValidationState.Pending)}}function e(e){ULSEWi:;g=false;if(e.isValid)c(new SP.JsGrid.Internal.PropertyUpdate(e.dataValue,e.normalizedLocValue),SP.JsGrid.ValidationState.Valid);else c(b.newValueIsLocalized?new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.InvalidValue,b.newValue):new SP.JsGrid.Internal.PropertyUpdate(b.newValue,SP.JsGrid.InvalidValue),SP.JsGrid.ValidationState.Invalid,e.errorMsg);f&&a.pendingChangeMgr.DecrementPendingChangeCount(d)}function i(){ULSEWi:;var a={isValid:false,errorMsg:SP.JsGrid.Res.vncfailed};e(a)}function c(c,e,f){ULSEWi:;if(b.fieldKey!=SP.JsGrid.RecordIndicatorCheckboxColumnKey)a.versionMgr.AddPropChange(b.recordKey,b.fieldKey,d,c,e,f);else if(c.data)a.checkSelMgr.ExternalAPI.CheckRecord(b.recordKey);else a.checkSelMgr.ExternalAPI.UncheckRecord(b.recordKey)}}};SP.JsGrid.Internal.PendingChangesManager=function(b){ULSEWi:;var i=0,g=0,d={},e=[],c=[],a={},f={};b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnChangeKeyCreated,o);b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,m);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,l);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordCommitted,n);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnVacateChange,p);function p(c){ULSEWi:;var b=c.changeKey.GetVersionNumber();delete d[b];delete a[b]}function l(a){ULSEWi:;var b=a.recordKey;if(!(b in f))f[b]=[];f[b].push(a.changeKey);j(a.changeKey)}function n(d){ULSEWi:;var c=d.originalRecordKey;if(c in f)for(var b=f[c],a=0;a<b.length;a++)h(b[a])}function o(b){ULSEWi:;var c=b.changeKey.GetVersionNumber();d[c]=b.changeKey;a[c]=1}function m(a){ULSEWi:;h(a.changeKey)}function h(f){ULSEWi:;var e=f.GetVersionNumber();if(--a[e]==0){delete a[e];i++;setTimeout(function(){ULSEWi:;i--;b.eventMgr.FireEvent(SP.JsGrid.EventType.OnInitialChangesForChangeKeyComplete,new SP.JsGrid.EventArgs.PendingChangeKeyInitiallyComplete(f));delete d[e];if(c.length!=0&&!k()){for(var a=0;a<c.length;a++)c[a]();c=[]}},0)}}function k(){ULSEWi:;var a=false;for(var c in d)if(b.controller.IsChangeKeyApplied(d[c])){a=true;break}return a}function j(c){ULSEWi:;var b=c.GetVersionNumber();if(b in a)a[b]++;else a[b]=1}this.WaitForPendingUpdates=function(a){ULSEWi:;if(a!=null)if(g!=0)e.push(a);else a()};this.WaitForAllChangeKeysToComplete=function(a){ULSEWi:;if(a!=null)if(i!=0||g!=0||k())c.push(a);else a()};this.IncrementPendingChangeCount=function(a){ULSEWi:;g++;j(a)};this.DecrementPendingChangeCount=function(b){ULSEWi:;g--;if(g==0&&e.length!=0){for(var a=0;a<e.length;a++)e[a]();e=[]}h(b)}};SP.JsGrid.Internal.RowHeaderStateManager=function(b){ULSEWi:;var a={};this.AddRowHeaderState=function(d,f){ULSEWi:;var e=null;if(!(d in a))a[d]=[];else e=a[d][0];var c=a[d],g=SP.Internal.JS.LowerBoundCompare(c,f.GetPriority(),function(b,a){ULSEWi:;return a>c[b].GetPriority()});c.splice(g,0,f);(e==null||c[0].GetId()!=e.GetId())&&b.FireEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,new SP.JsGrid.Internal.EventArgs.OnRowHeaderStateChanged(d,c[0]))};this.RemoveRowHeaderState=function(d,f){ULSEWi:;if(d in a){var e=a[d][0];c(a[d],f);if(a[d].length==0)delete a[d];(a[d]==null||e.GetId()!=a[d][0].GetId())&&b.FireEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,new SP.JsGrid.Internal.EventArgs.OnRowHeaderStateChanged(d,a[d]&&a[d][0]))}};this.ChangeKeys=function(b,c){ULSEWi:;if(b in a){a[c]=a[b];delete a[b]}};this.GetRowHeaderState=function(b){ULSEWi:;return b in a?a[b][0]:null};function c(b,c){ULSEWi:;for(var a=0;a<b.length;a++)if(b[a].GetId()==c){b.splice(a,1);break}}};SP.JsGrid.RowHeaderState=function(a,e,c,d,b){ULSEWi:;this.GetId=function(){ULSEWi:;return a};this.GetImg=function(){ULSEWi:;return e};this.GetPriority=function(){ULSEWi:;return c};this.GetOnClick=function(){ULSEWi:;return b};this.GetTooltip=function(){ULSEWi:;return d};this.toString=function(){ULSEWi:;return a}};SP.JsGrid.AutoRowHeaderStates=function(e,a){ULSEWi:;var d=[[SP.JsGrid.RowHeaderAutoStyleId.Dirty,function(d){ULSEWi:;a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellEditBegin,g);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellEditCompleted,e);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,f);var c,b,h=a.rowHeaderStates[SP.JsGrid.RowHeaderAutoStyleId.Dirty];function e(e){ULSEWi:;if(e.bCancelled)b--;b==0&&e.bCancelled&&e.recordKey==c&&a.jsGridObj.RemoveRowHeaderState(c,d)}function g(d){ULSEWi:;if(b==0){c=d.recordKey;a.jsGridObj.AddRowHeaderState(d.recordKey,h)}b++}function f(e){ULSEWi:;b>0&&a.jsGridObj.RemoveRowHeaderState(c,d);b=0;c=e.recordKey}}],[SP.JsGrid.RowHeaderAutoStyleId.Error,function(d){ULSEWi:;var b=document.createElement("span");b.id=d+"mainDiv";b.style.cssText="display:none; font-size:10; position:absolute; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important";document.body.appendChild(b);var f,c=null,e=null,g=d+"RowError",h=new SP.JsGrid.RowHeaderState(d,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error"),SP.JsGrid.RowHeaderStatePriorities.CellError,SP.JsGrid.Res.errorHeaderStateTooltip,function(d,b){ULSEWi:;if(e!=b)c=null;c=a.jsGridObj.ScrollToAndExpandNextErrorOnRecord(c,b);e=b}),j=new SP.JsGrid.RowHeaderState(g,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error"),SP.JsGrid.RowHeaderStatePriorities.RowError,SP.JsGrid.Res.rowErrorToolTip,function(c,d){ULSEWi:;if(b.curRecKey!=d){b.curRecKey=d;b.style.display="";SP.Internal.DomElement.SetText(b,a.jsGridObj.GetRowErrorMessage(d));var e=h(c.target);if(e!=null){var g=SP.Internal.DomElement.GetLocation(e);b.style.left=g.x+"px";b.style.top=g.y+e.offsetHeight+2+"px"}else{b.style.left=c.clientX+5+"px";b.style.top=c.clientY+5+"px"}}f!=null&&clearTimeout(f);f=setTimeout(function(){ULSEWi:;b.curRecKey=null;b.style.display="none"},2500);function h(a){ULSEWi:;while(a!=null&&a.tagName.toUpperCase()!="TD")a=a.parentNode;return a}});a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,i);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,l);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,k);a.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnGridDisposing,function(){ULSEWi:;b.curRecKey=null;b.innerHTML="";b=null});function i(b){ULSEWi:;if(b.bAddingError&&!b.bCellHadError)a.jsGridObj.AddRowHeaderState(b.recordKey,h);else!b.bCellCurrentlyHasError&&a.jsGridObj.RemoveRowHeaderState(b.recordKey,d)}function l(b){ULSEWi:;if(b.bAddingError&&!b.bRowHadError)a.jsGridObj.AddRowHeaderState(b.recordKey,j);else!b.bErrorCurrentlyInRow&&a.jsGridObj.RemoveRowHeaderState(b.recordKey,g)}function k(a){ULSEWi:;if(a.newRecordKey!=e)c=null}}],[SP.JsGrid.RowHeaderAutoStyleId.NewRow,function(c){ULSEWi:;var b=null,d=new SP.JsGrid.RowHeaderState(c,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_newrowheader"),SP.JsGrid.RowHeaderStatePriorities.NewRow,"",null);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordAdded,function(e){ULSEWi:;b!=null&&a.jsGridObj.RemoveRowHeaderState(b,c);a.jsGridObj.AddRowHeaderState(e.recordKey,d);b=e.recordKey})}]],c=SP.Internal.JS.ConvertTableToMap(d,0,1);for(var b in c)if(e.Contains(b))c[b]=new c[b](b);d=null};SP.JsGrid.RowHeaderStates=function(a){ULSEWi:;this[SP.JsGrid.RowHeaderStyleId.Transfer]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderStyleId.Transfer,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_transferheader"),SP.JsGrid.RowHeaderStatePriorities.Transfer,SP.JsGrid.Res.transferHeaderStateTooltip,null);this[SP.JsGrid.RowHeaderStyleId.Conflict]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderStyleId.Conflict,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_conflictheader"),SP.JsGrid.RowHeaderStatePriorities.Conflict,a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.ExpandConflictResolution)?SP.JsGrid.Res.conflictHeaderStateClickTooltip:SP.JsGrid.Res.conflictHeaderStateTooltip,a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.ExpandConflictResolution)?function(b,c){ULSEWi:;a.delegateMgr.Apply(SP.JsGrid.DelegateType.ExpandConflictResolution,b,c)}:null);this[SP.JsGrid.RowHeaderAutoStyleId.Dirty]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderAutoStyleId.Dirty,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_editheader"),SP.JsGrid.RowHeaderStatePriorities.Dirty,SP.JsGrid.Res.editingHeaderStateTooltip,null)};SP.JsGrid.Internal.ScrollBar=function(n,A,W,L,gb,v){ULSEWi:;var q,b=SP.Internal.ScrollBar.GetSystemScrollBarThickness(),u=b-1,e,d=[],a=new S(n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical),cb=this,z,x,i=false,M=true,J=false,N,r,p,m,eb,y=0,l=0,k,g,j,f,t,c=0,s=W;function db(){ULSEWi:;L!=null&&cb.Update(L)}function Z(c){ULSEWi:;var d=false;if(g!=null&&j!=null&&f!=null&&t!=null){var a=s?b:0;q=Math.max(t-a,SP.Internal.ScrollBar.GetMinScrollBarLength()+a);if(e==null){c=true;ab();A.appendChild(e);A.style.position="relative"}if(c){d=true;U();R();X()}}return d}function U(){ULSEWi:;a.SetLength("outerContainer",q+(s?b:0));a.SetLength("innerContainer",q-4)}function F(a){ULSEWi:;return Math.max(0,Math.min(a,m!=null?m:0))}function P(b){ULSEWi:;var a=Math.max(Math.min(b,g-1),0);return a-o(null,a).count}function O(a,f,b,e){ULSEWi:;var d=c;if(c!=a||b){c=a;w(c);z!=null&&(d!=c||b)&&!e&&z(f,d);return true}return false}function Y(a,d,c){ULSEWi:;M=false;var b=P(a);return O(b,new SP.JsGrid.Internal.ScrollBar.PosInfo(b,a,SP.JsGrid.Internal.ScrollBar.UserSetType.Bottom),d,c)}function h(c,d,b){ULSEWi:;M=true;var a=F(c);return O(a,new SP.JsGrid.Internal.ScrollBar.PosInfo(a,o(a),SP.JsGrid.Internal.ScrollBar.UserSetType.Top),d,b)}function I(b){ULSEWi:;if(b==-1){if(!i){k!=null&&k(false);a.UpdateDisplay("bgMiddleBox",false);a.UpdateDisplay("middleBoxDiv",false);y=0;l=0;h(0);i=true}}else if(b>4){if(i){k!=null&&k(true);i=false}y=b;a.UpdateDisplay("bgMiddleBox",true);a.UpdateDisplay("middleBoxDiv",true);a.UpdateMiddleScroll("middleBoxDiv",b);a.UpdateBGDiv("bgMiddleBox",b)}}function G(){ULSEWi:;return Math.max(0,E()-l-y)}function E(){ULSEWi:;return q-2*u-4}function R(){ULSEWi:;r=0;for(var a=0;a<d.length;a++)r+=Math.max(Math.min(f,d[a].size),0);r+=Math.max(g-d.length,0)*j}function o(c,i){ULSEWi:;var b=c!=null?c:i,k=c==null,h=0,e=d.length!=0?SP.Internal.JS.UpperBound(d,b,"pos")-1:-1,a;while(h<f&&b>=0&&b<g){if(a==null&&e!=-1&&e<d.length)a=d[e];h+=a!=null&&b==a.pos?a.size:j;if(a!=null&&b==a.pos){e+=k?-1:1;a=null}b+=k?-1:1}var l=h!=f;return {count:Math.max(Math.abs((c!=null?c:i)-b)-(l?1:0),0),partial:l}}function Q(){ULSEWi:;var a=o(null,g-1);J=a.partial;return Math.max(a.count,1)}function C(){ULSEWi:;return Math.ceil(f/j)}function D(){ULSEWi:;return Math.floor(f/j)}function X(){ULSEWi:;if(f<r){var a=E();p=a-Math.max(Math.ceil(f/r*a),SP.Internal.ScrollBar.GetMinBoxLength());I(a-p);B()}else{I(-1);B(0)}}function H(a){ULSEWi:;if(v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal)a=m-a;return Math.floor(p/m*a)}function T(a){ULSEWi:;if(v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal)a=p-a;return p>0?F(Math.round(a/(p/m))):0}function w(b){ULSEWi:;l=m>0?H(b):0;a.UpdateBGDiv("bgAboveBox",l+1);a.SetTop("middleBoxDiv",l+u);a.UpdateBGDiv("bgBelowBox",G()+1)}function B(a){ULSEWi:;m=a==null?g-Q():a}function K(j,g,f,h){ULSEWi:;var b,i=0,c=h,k=this;function d(){ULSEWi:;b=setTimeout(e,250-200*Math.min(1,i++/4))}function e(){ULSEWi:;g();d();f&&c!=null&&k.MouseMove(c)}this.MouseMove=function(e){ULSEWi:;var f=SP.Internal.DomElement.GetEventLocation(e),g=SP.Internal.DomElement.PointInDomElem(f.x,f.y,a.GetDomElem(j));if(g&&b==null)d();else if(!g&&b!=null){window.clearTimeout(b);b=null}c=e};this.MouseUp=function(){ULSEWi:;window.clearTimeout(b)};e()}function bb(){ULSEWi:;var d=false;$addHandler(e,"mousedown",j);$addHandler(document.body,"mousemove",b);var k={scrollUpArrowDiv:null,middleBoxDiv:null,scrollDownArrowDiv:null,bgBelowBox:null,bgAboveBox:null},l;function g(b){ULSEWi:;if(!i){d=true;a.ActivateArrowDiv("scrollUpArrowDiv","upArrowDiv",true,b);a.ActivateArrowDiv("scrollDownArrowDiv","downArrowDiv",false,b);a.ActivateDiv("middleBoxDiv",b)}}function f(){ULSEWi:;if(d){d=false;a.DeactivateArrowDiv("scrollUpArrowDiv","upArrowDiv",true);a.DeactivateArrowDiv("scrollDownArrowDiv","downArrowDiv",false);a.DeactivateDiv("middleBoxDiv")}}function b(b){ULSEWi:;var a=SP.Internal.DomElement.GetEventLocation(b);if(!SP.Internal.DomElement.PointInDomElem(a.x,a.y,e))f();else{d=false;g(a)}}function j(f){ULSEWi:;if(i)return;var g;if(f.target!=null){var l=SP.Internal.DomElement.FindFirstAncestorWithAnyPropertyValue(f.target,"elemid",k);if(l!=null){var d=SP.Internal.DomElement.GetCustomAttribute(l.elem,"elemid");if(d=="middleBoxDiv"){var j=c;a.MarkMouseDown("middleBoxDiv");a.ActivateDiv("middleBoxDiv");var p=H(c);SP.Internal.DomElement.SetCapture(f.target,function(c){ULSEWi:;var b=n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical?"clientY":"clientX",a=T(p+c[b]-f[b]);if(j!=a){w(a);j=a;x&&h(a)}},function(c){ULSEWi:;h(j);a.RemoveMouseDown("middleBoxDiv");b(c)})}else if(d=="scrollUpArrowDiv"||d=="scrollDownArrowDiv"){a.MarkMouseDown(d);var m=d=="scrollUpArrowDiv";a.ActivateArrowDiv(d,m?"upArrowDiv":"downArrowDiv",m,true);var e=d=="scrollUpArrowDiv";e=v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal?!e:e;g=new K(d,function(){ULSEWi:;h(c+(e?-1:1))});SP.Internal.DomElement.SetCapture(f.target,g.MouseMove,function(c){ULSEWi:;g.MouseUp();a.RemoveMouseDown(d);b(c)})}else{var e=d=="bgAboveBox";e=v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal?!e:e;a.HighlightBGDiv(d);g=new K(d,e?function(){ULSEWi:;Y(c-(o(c).count==0?1:0))}:function(){ULSEWi:;h(c+Math.max(o(c).count,1))},true,f);SP.Internal.DomElement.SetCapture(f.target,g.MouseMove,function(c){ULSEWi:;a.RestoreBGDiv(d);g.MouseUp();b(c)})}}}}return b}this.Dispose=function(){ULSEWi:;$clearHandlers(e);$removeHandler(document.body,"mousemove",N);a.Dispose();e=null;A=null};this.SetOnVisibilityChanged=function(a,b){ULSEWi:;k=a;k!=null&&b!=!i&&k(!i)};this.Update=function(a){ULSEWi:;var e=false,i=a.itemCount!=null&&a.itemCount!=g||a.itemSize!=null&&a.itemSize!=j||a.physicalViewportSize!=null&&a.physicalViewportSize!=f||a.scrollbarSize!=null&&a.scrollbarSize!=t||a.bClearItemSizes&&d.length!=0||a.bOtherScrollMeets!=null&&a.bOtherScrollMeets!=s||a.itemSizes!=null;g=a.itemCount==null?g:a.itemCount;j=a.itemSize==null?j:a.itemSize;s=a.bOtherScrollMeets==null?s:a.bOtherScrollMeets;if(a.bClearItemSizes)d=[];d=a.itemSizes==null?d:V(a.itemSizes,a.bMergeItemSizes);f=a.physicalViewportSize==null?f:a.physicalViewportSize;t=a.scrollbarSize==null?t:a.scrollbarSize;var b=Z(i);if(a.topItemIdx!=null||b)e=h(a.topItemIdx==null?c:a.topItemIdx,b,a.bScrollNotifiy==false);x=a.bUpdateWhileDragging==null?x:a.bUpdateWhileDragging;return e};this.GetItemDisplayCapacity=function(){ULSEWi:;return C()};this.GetWholeItemDisplayCapacity=function(){ULSEWi:;return D()};this.GetTopItemIdx=function(){ULSEWi:;return c};this.Refresh=function(){ULSEWi:;w(c)};this.ScrollIntoView=function(a){ULSEWi:;a=Math.max(0,Math.min(g-1,a));var b=this.GetItemDisplayInfo(a);if(b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Before){h(a);return true}else if(b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.After||b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Partial){h(a+1-D());return true}return false};this.PartialRowPresent=function(){ULSEWi:;return J};this.GetVisibleItemCount=function(){};this.SetOnScroll=function(a){ULSEWi:;z=a};this.SetViewportSize=function(){};this.GetItemDisplayInfo=function(a){ULSEWi:;var b=C();return a<c?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Before:a>c+b-1?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.After:a==c+b-1?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Partial:SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.InView};function V(e,g){ULSEWi:;if(!g)d=[];for(var f in e){var b=parseInt(f,10),c=parseInt(e[f],10);if(!isNaN(b)&&!isNaN(c)){var a=SP.Internal.JS.LowerBound(d,b,"pos");if(a<0||a>=d.length||d[a].pos!=b)d.splice(a,0,{pos:b,size:c});else d[a].size=c}}return d}function ab(){ULSEWi:;var c=['<div elemid="innerContainer" class="inner-scroll-bar" style="'+a.GetLengthAndThicknessCssString(q-4,b-4)+';">'];c.push(a.GenerateBGDivHTML(u-1,"upArrowDiv",true));c.push(a.GenerateBGDivHTML(1+Math.max(l,0),"bgAboveBox"));c.push(a.GenerateBGDivHTML(Math.max(l,0),"bgMiddleBox",false));c.push(a.GenerateBGDivHTML(G()+1,"bgBelowBox"));c.push(a.GenerateBGDivHTML(u-1,"downArrowDiv",true));e=document.createElement("div");e.innerHTML=c.join("");e.elemid="outerContainer";e.className="outer-scroll-bar";var d=n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical;e.style.cssText=(d?"float:right":"")+a.GetLengthAndThicknessCssString(q,b);a.RegisterPrimitives([e].concat(SP.Internal.DomElement.FindChildrenWithProperty(e,"elemid")));a.AppendItem("upArrowDiv",a.GenerateArrowDiv("scrollUpArrowDiv",-2,true));a.AppendItem("bgMiddleBox",a.GenerateMiddleScroll("middleBoxDiv"));a.AppendItem("downArrowDiv",a.GenerateArrowDiv("scrollDownArrowDiv",0,false));N=bb()}function S(c){ULSEWi:;var e={outerBorder:{mouseDown:"#737A83",mouseOver:"#8A8D91",mouseOut:"#B7BABE"},innerBorder:{mouseDown:"#C3C6CA",mouseOver:"#DADBDD",mouseOut:"#F0F1F4"},shade:{mouseDown:"#969BA2",mouseOver:"#CACCD0",mouseOut:"#E8EBEE"},main:{mouseDown:"#868C93",mouseOver:"#B3B6BB",mouseOut:"#DFE3E8"}},a={},m=c?"width":"height",d=c?"height":"width",o=c?"vert-":"horiz-",f=c?"top":"left",h=c?"left":"top",n=c?"clip9x6":"clip6x9",j="jsgridcluster_scrollbar-mouseout-"+(c?"uparrow":"leftarrow"),i="jsgridcluster_scrollbar-mouseout-"+(c?"downarrow":"rightarrow"),l="jsgridcluster_scrollbar-mousein-"+(c?"uparrow":"leftarrow"),k="jsgridcluster_scrollbar-mousein-"+(c?"downarrow":"rightarrow"),p=c?"scrollbar-highlight-vert.png":"scrollbar-highlight-horiz.png";this.Dispose=function(){ULSEWi:;a=null};this.GetThicknessCssString=function(a){ULSEWi:;return m+":"+a+"px;"};this.GetLengthCssString=function(a){ULSEWi:;return d+":"+a+"px;"};this.GetLengthAndThicknessCssString=function(b,a){ULSEWi:;return this.GetLengthCssString(b)+this.GetThicknessCssString(a)};this.GetCssName=function(a,b){ULSEWi:;return o+a+(b?" "+a:"")};this.RegisterPrimitives=function(c){ULSEWi:;for(var b=0;b<c.length;b++){var d=SP.Internal.DomElement.GetCustomAttribute(c[b],"elemid");if(d!=null)a[d]=c[b]}};this.GetLocation=function(b){ULSEWi:;return SP.Internal.DomElement.GetLocation(a[b])};this.GetHeight=function(b){ULSEWi:;return a[b].offsetHeight};this.GetWidth=function(b){ULSEWi:;return a[b].offsetWidth};this.GetDomElem=function(b){ULSEWi:;return a[b]};this.AppendItem=function(b,c){ULSEWi:;a[b].appendChild(c);this.RegisterPrimitives(SP.Internal.DomElement.FindChildrenWithProperty(a[b],"id"))};this.GenerateBGDivHTML=function(c,a,d){ULSEWi:;return ['<div class="'+this.GetCssName("scroll-bar-bg-block")+'" style="'+(d?"position:relative;":"")+this.GetLengthCssString(c)+'" '+g("elemid",a)+">",'<div class="'+this.GetCssName("scroll-bar-background-shade",true)+'" style="'+this.GetLengthAndThicknessCssString(c,Math.ceil((b-4)/2))+'" '+g("elemid",a,"_shade")+"></div>",'<div class="'+this.GetCssName("scroll-bar-background-main",true)+'" style="'+this.GetLengthAndThicknessCssString(c,Math.floor((b-4)/2))+'" '+g("elemid",a,"_main")+"></div></div>"].join("")};function g(c,b,a){ULSEWi:;return b==null?"":c+'="'+b+(a==null?"":a)+'"'}this.GenerateMiddleScroll=function(a){ULSEWi:;var c=document.createElement("div");c.innerHTML=['<div style="position:relative;',this.GetThicknessCssString(b-6),';margin-top:1px;margin-left:1px;">','<div elemid="',a,'_shade" class="',this.GetCssName("scroll-bar-inner-box-shade",true),'" style="',this.GetThicknessCssString(Math.floor((b-6)/2)),';"></div>','<div elemid="',a,'_main" class="',this.GetCssName("scroll-bar-inner-box-main",true),'" style="',this.GetThicknessCssString(Math.ceil((b-6)/2)),';"></div>','<div elemid="',a,'_gripTop" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px"></div>','<div elemid="',a,'_gripMiddle" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px;"></div>','<div elemid="',a,'_gripBottom" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px"></div></div>'].join("");c.elemid=a;c.className=this.GetCssName("scroll-bar-outer-box",true);c.style.cssText=this.GetThicknessCssString(b-4);return c};this.GenerateArrowDiv=function(f,h,g){ULSEWi:;var a=document.createElement("div"),e=(b-4-(c?6:9))/2,d=(b-4-(c?9:6))/2;a.innerHTML=['<div elemid="'+f+'_inner" class="scroll-bar-inner-arrow-cell" style="'+this.GetLengthAndThicknessCssString(b-4,b-4)+'">','<div class="'+n+'" style="margin-top:'+(!c?Math.round(e):g?Math.floor(e):Math.ceil(e))+"px;margin-left:"+(c?Math.round(d):g?Math.floor(d):Math.ceil(d))+'px;"><img elemid="'+f+'_img" src="/_layouts/Images/jsgridcluster.png" class="'+this.GetCssName("scroll-bar-arrow")+" "+(g?j:i)+'"/>',"</div>","</div>"].join("");a.elemid=f;a.className=this.GetCssName("scroll-bar-arrow-cell",true);a.style.cssText=(c?"top:":"left:")+h+"px;"+this.GetLengthAndThicknessCssString(b-2,b-2);return a};this.UpdateBGDiv=function(c,b){ULSEWi:;a[c].style[d]=b+"px";a[c+"_shade"].style[d]=b+"px";a[c+"_main"].style[d]=b+"px"};this.UpdateMiddleScroll=function(b,g){ULSEWi:;a[b].style[d]=g-2+"px";var c=g-4;a[b+"_main"].style[d]=c+"px";a[b+"_shade"].style[d]=c+"px";var e=Math.round(Math.max(c-8,0)/2);a[b+"_gripTop"].style[f]=e+"px";a[b+"_gripMiddle"].style[f]=e+3+"px";a[b+"_gripBottom"].style[f]=e+6+"px"};this.UpdateDisplay=function(b,c){ULSEWi:;a[b].style.display=c?"block":"none"};this.ActivateArrowDiv=function(b,c,e,d){ULSEWi:;a[b+"_img"].className=this.GetCssName("scroll-bar-arrow")+" "+(e?l:k);this.ActivateDiv(b,d,c)};this.DeactivateArrowDiv=function(b,c,d){ULSEWi:;a[b+"_img"].className=this.GetCssName("scroll-bar-arrow")+" "+(d?j:i);this.DeactivateDiv(b,c)};this.MarkMouseDown=function(b){ULSEWi:;a[b].curStateName="mouseDownPending"};this.RemoveMouseDown=function(b){ULSEWi:;a[b].curStateName=""};this.ActivateDiv=function(d,g,f){ULSEWi:;var c=a[d];if(c.curStateName=="mouseDown")return;var b=c.curStateName=="mouseDownPending"?"mouseDown":SP.Internal.DomElement.PointInDomElem(g.x,g.y,c)?"mouseOver":"mouseOut";if(c.curStateName!=b){c.style.borderColor=e["outerBorder"][b];if(d+"_inner" in a)a[d+"_inner"].style.borderColor=e["innerBorder"][b];else a[d].style.backgroundColor=e["innerBorder"][b];a[(f!=null?f:d)+"_shade"].style.backgroundColor=e["shade"][b];a[(f!=null?f:d)+"_main"].style.backgroundColor=e["main"][b];c.curStateName=b}};this.DeactivateDiv=function(b,c){ULSEWi:;a[b].curStateName="";a[b].style.borderColor="";if(b+"_inner" in a)a[b+"_inner"].style.borderColor="";else a[b].style.backgroundColor="";a[(c!=null?c:b)+"_shade"].style.backgroundColor="";a[(c!=null?c:b)+"_main"].style.backgroundColor=""};this.HighlightBGDiv=function(b){ULSEWi:;a[b+"_main"].style.backgroundColor="#DEDFE2";a[b+"_shade"].style.backgroundColor="#DEDFE2"};this.RestoreBGDiv=function(b){ULSEWi:;a[b+"_shade"].style.backgroundColor="";a[b+"_main"].style.backgroundColor=""};this.SetTop=function(b,c){ULSEWi:;a[b].style[f]=c+"px"};this.SetLength=function(b,c){ULSEWi:;a[b].style[d]=c+"px"}}db()};SP.JsGrid.Internal.ScrollBar.PosInfo=function(c,b,a){ULSEWi:;this.topIdx=c;this.bottomIdx=b;this.userSetType=a};SP.JsGrid.Internal.ScrollBar.UserSetType={Bottom:0,Top:1};SP.JsGrid.Internal.ScrollBar.UpdateParams=function(){ULSEWi:;this.itemCount;this.itemSize;this.itemSizes={};this.physicalViewportSize;this.scrollbarSize;this.topItemIdx;this.bClearItemSizes=false;this.bMergeItemSizes=false;this.bUpdateWhileDragging=false};SP.JsGrid.Internal.ScrollBar.BarType={Horizontal:0,Vertical:1};SP.JsGrid.Internal.ScrollBar.RowDisplayInfo={Before:-1,InView:0,Partial:1,After:2};Type.registerNamespace("SP.Internal.ScrollBar");SP.Internal.ScrollBar.GetSystemScrollBarThickness=function(){ULSEWi:;var a=document.createElement("div"),c=document.createElement("div");a.style.cssText="overflow-x:scroll;position:absolute;visibility:hidden";c.style.cssText="height:50px;width:50px";a.appendChild(c);document.body.appendChild(a);var b=Math.max(a.offsetHeight-50,13);document.body.removeChild(a);SP.Internal.ScrollBar.GetSystemScrollBarThickness=function(){ULSEWi:;return b};return b};SP.Internal.ScrollBar.GetMinBoxLength=function(){ULSEWi:;return 12};SP.Internal.ScrollBar.GetMinScrollBarLength=function(){ULSEWi:;return 2*SP.Internal.ScrollBar.GetSystemScrollBarThickness()+SP.Internal.ScrollBar.GetMinBoxLength()+8+2};SP.JsGrid.Internal.SelectionManager=function(s){ULSEWi:;var e,g,c,k,h,i,d,a,m,r,n=this,j,b=SP.JsGrid.SelectionType,f=SP.JsGrid.Internal.SelectionManager.SelectOp;this.SetAllowedSelectionTypes=function(a){ULSEWi:;k=a};this.GetLastSelectionEndpoints=function(){ULSEWi:;return {rowIdx1:h.rowIdx,colIdx1:h.colIdx,rowIdx2:i.rowIdx,colIdx2:i.colIdx}};this.GetLastSelectionRangeNormalized=function(){ULSEWi:;return d==b.None?null:{rowRange:new SP.Utilities.Range(d!=b.ColumnRange?Math.min(h.rowIdx,i.rowIdx):0,d!=b.ColumnRange?Math.max(h.rowIdx,i.rowIdx):a.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1),colRange:new SP.Utilities.Range(d!=b.RowRange?Math.min(h.colIdx,i.colIdx):0,d!=b.RowRange?Math.max(h.colIdx,i.colIdx):a.gridPane.GetGridPaneConverter().GetVirtualColumnCount()-1)}};this.GetFocus=function(){ULSEWi:;return q(null)};this.GetFocusForPane=function(a){ULSEWi:;return q(a)};this.GetFocusedPane=function(){ULSEWi:;return a.gridPane};this.SetFocusByKey=function(b,c,d){ULSEWi:;var a=b.GetGridPaneConverter().KeyToIdx(c,d);a!=null&&this.SetFocusByPos(b,a.rowIdx,a.colIdx)};this.SetFocusByPos=function(c,b,a){ULSEWi:;this.SelectRange(c,b,b,a,a,f.Set,true,false)};this.IsCellSelected=function(h,f,d){ULSEWi:;if(h!=a.gridPane)return false;for(var b=0;b<e.length;b++)if(e[b].Contains(f))return true;for(b=0;b<g.length;b++)if(g[b].Contains(d))return true;for(b=0;b<c.length;b++)if(c[b].rowRange.Contains(f)&&c[b].colRange.Contains(d))return true;return false};this.IsRowSelected=function(c,d){ULSEWi:;if(c!=a.gridPane)return false;for(var b=0;b<e.length;b++)if(e[b].Contains(d))return true;return false};this.IsOneCellSelected=function(a){ULSEWi:;return a!=null&&a.rowRange.begin==a.rowRange.end&&a.colRange.begin==a.colRange.end};this.GetComponentsWithin=function(j,h,f){ULSEWi:;if(j!=a.gridPane)return new SP.Utilities.Set;var i={};function d(b,a){ULSEWi:;if(!b.IsEmpty()&&!a.IsEmpty())for(var d=b.begin;d<=b.end;d++)for(var c=a.begin;c<=a.end;c++)i[SP.JsGrid.Internal.MakeCellKey(d,c)]=1}for(var b=0;b<e.length;b++)d(e[b].Intersect(h),f);for(b=0;b<g.length;b++)d(h,g[b].Intersect(f));for(b=0;b<c.length;b++)d(c[b].rowRange.Intersect(h),c[b].colRange.Intersect(f));return new SP.Utilities.Set(i)};this.SelectRange=function(u,q,t,m,s,r,w,B){ULSEWi:;function z(){ULSEWi:;var d=k&SP.JsGrid.SelectionTypeFlags._RowMask,c=k&SP.JsGrid.SelectionTypeFlags._ColMask,e=k&SP.JsGrid.SelectionTypeFlags._CellMask;do{var a=false;switch(l(q,t,m,s)){case b.RowRange:switch(d){case SP.JsGrid.SelectionTypeFlags.SingleRow:t=q;case SP.JsGrid.SelectionTypeFlags.SingleRowRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoRows:return false}break;case b.ColumnRange:switch(c){case SP.JsGrid.SelectionTypeFlags.SingleCol:s=m;case SP.JsGrid.SelectionTypeFlags.SingleColRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoCols:return false}break;case b.CellRange:switch(e){case SP.JsGrid.SelectionTypeFlags.SingleCell:t=q;s=m;case SP.JsGrid.SelectionTypeFlags.SingleCellRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoCells:if(d!=SP.JsGrid.SelectionTypeFlags.NoRows){m=s=null;a=true}else if(c!=SP.JsGrid.SelectionTypeFlags.NoCols){q=t=null;a=true}else return false}}}while(a);return true}function C(){ULSEWi:;if(l(q,t,m,s)==b.CellRange)if(Math.abs(m-s)+1==u.GetGridPaneConverter().GetVirtualColumnCount())m=s=null;else if(Math.abs(q-t)+1==u.GetGridPaneConverter().GetVirtualRowCount())q=t=null}function E(c,d){ULSEWi:;if(u!=a.gridPane){r=f.Set;a.gridPane=u}if(B){var e=u.GetGridPaneConverter().KeyToIdx(c.recordKey,c.fieldKey);a.rowIdx=e.rowIdx;a.colIdx=e.colIdx}else if(v!=null){a.rowIdx=v.rowIdx;a.colIdx=v.colIdx}else{a.rowIdx=d==b.ColumnRange?u.BeginRowIdx():q;a.colIdx=d==b.RowRange?u.BeginColIdx():m}}function D(a){ULSEWi:;var k=a==b.ColumnRange?null:(new SP.Utilities.Range(q,t)).Normalize(),i=a==b.RowRange?null:(new SP.Utilities.Range(m,s)).Normalize();if(r==f.Set){e=[];g=[];c=[];j=[]}else if(r==f.ReplaceLast){if(d==b.RowRange)e.pop();else if(d==b.ColumnRange)g.pop();else d==b.CellRange&&c.pop();j.pop()}var h;if(a==b.RowRange){h=k;e.push(h)}else if(a==b.ColumnRange){h=i;g.push(h)}else if(a==b.CellRange){h={rowRange:k,colRange:i};c.push(h)}j.push({type:a,range:h});d=a}var v,A=q!=null&&q==t&&m!=null&&m==s&&w&&r==f.Set;if(A)v={rowIdx:q,colIdx:m};if(!z())return false;C();h={rowIdx:q,colIdx:m};i={rowIdx:t,colIdx:s};p(a.gridPane,u);var x=n.GetFocus(),y=l(q,t,m,s);E(x,y);D(y);o(x,w);return true};this.GetRowRanges=function(b){ULSEWi:;return b==a.gridPane?e:[]};this.GetColumnRanges=function(b){ULSEWi:;return b==a.gridPane?g:[]};this.GetCellRanges=function(b){ULSEWi:;return b==a.gridPane?c:[]};this.Clear=function(f){ULSEWi:;var k;if(!f){p(a.gridPane,null);k=n.GetFocus()}e=[];g=[];c=[];j=[];a={};h=i=null;d=b.None;!f&&o(k,false)};this.GetLastSelectionType=function(){ULSEWi:;return d};this.GetOrderedSelections=function(k,h){ULSEWi:;function g(a){ULSEWi:;for(var c=new Array(a.Size()),b=a.begin;b<=a.end;b++)c[b-a.begin]=i.RowIdxToRecordKey(b);return {begin:a.begin,end:a.end,keys:c}}function f(a){ULSEWi:;for(var c=new Array(a.Size()),b=a.begin;b<=a.end;b++)c[b-a.begin]=i.ColIdxToColKey(b);return {begin:a.begin,end:a.end,keys:c}}var e=[];if(k==a.gridPane)for(var i=k.GetGridPaneConverter(),d=0;d<j.length;d++){var l=j[d].type,c=j[d].range;if(h==null||h==l)switch(l){case b.RowRange:e.push(g(c));break;case b.ColumnRange:e.push(f(c));break;case b.CellRange:e.push({rowRange:g(c.rowRange),colRange:f(c.colRange)})}}return e};function p(b,a){ULSEWi:;m=b!=null?b.NotifySelectionUpdating():null;r=a!=null?a!=b?a.NotifySelectionUpdating():m:null}function o(a,c){ULSEWi:;var b=n.GetFocus();a!=null&&a.gridPane.NotifySelectionUpdated(m,c);b!=null&&(a==null||b.gridPane!=a.gridPane)&&b.gridPane.NotifySelectionUpdated(r,c);(a==null&&b!=null||a!=null&&b==null||a!=null&&b!=null&&(a.recordKey!=b.recordKey||a.fieldKey!=b.fieldKey))&&s(new SP.JsGrid.EventArgs.CellFocusChanged(b&&b.recordKey,b&&b.fieldKey,a&&a.recordKey,a&&a.fieldKey))}function l(d,e,a,c){ULSEWi:;return d==null||e==null?b.ColumnRange:a==null||c==null?b.RowRange:b.CellRange}function q(c){ULSEWi:;if(a.gridPane==null||c!=null&&a.gridPane!=c||a.colIdx>=a.gridPane.GetGridPaneConverter().GetVirtualColumnCount())return null;var b=a.gridPane.GetGridPaneConverter().IdxToKey(a.rowIdx,a.colIdx);if(b.recordKey==null||b.fieldKey==null||b.columnKey==null)return null;return {rowIdx:a.rowIdx,colIdx:a.colIdx,recordKey:b.recordKey,fieldKey:b.fieldKey,columnKey:b.columnKey,gridPane:a.gridPane}}this.Clear(true)};SP.JsGrid.Internal.SelectionManager.SelectOp={Set:0,Append:1,ReplaceLast:2};SP.Utilities.Set=function(a){ULSEWi:;this.collection=a!=null?a:{}};SP.Utilities.Set.prototype={IsEmpty:function(){ULSEWi:;for(var a in this.collection)return false;return true},First:function(){ULSEWi:;for(var a in this.collection)return a;return null},GetCollection:function(){ULSEWi:;return this.collection},ToArray:function(){ULSEWi:;return SP.Internal.JS.ConvertSetKeysToArray(this.collection)},AddArray:function(b){ULSEWi:;for(var a=0;a<b.length;a++)this.collection[b[a]]=1;return this},Add:function(a){ULSEWi:;this.collection[a]=1;return a},Remove:function(a){ULSEWi:;var b=this.collection[a];delete this.collection[a];return b},Clear:function(){ULSEWi:;this.collection={};return this},Contains:function(a){ULSEWi:;return a in this.collection},Clone:function(){ULSEWi:;var a={};for(var b in this.collection)a[b]=1;return new SP.Utilities.Set(a)},SymmetricDifference:function(c){ULSEWi:;var b={};for(var a in this.collection)if(!(a in c.collection))b[a]=1;for(a in c.collection)if(!(a in this.collection))b[a]=1;return new SP.Utilities.Set(b)},Difference:function(c){ULSEWi:;var b={};for(var a in this.collection)if(!(a in c.collection))b[a]=1;return new SP.Utilities.Set(b)},Union:function(b){ULSEWi:;var a=this.Clone();for(var c in b.collection)a.collection[c]=1;return a},UnionWith:function(a){ULSEWi:;for(var b in a.collection)this.collection[b]=1},Intersection:function(c){ULSEWi:;var b={};for(var a in this.collection)if(a in c.collection)b[a]=1;return new SP.Utilities.Set(b)}};SP.Utilities.KeyMap=function(){ULSEWi:;this.dictionary={};this.valueKeyMap={}};SP.Utilities.KeyMap.prototype={Add:function(b,a){ULSEWi:;this.dictionary[b]=a;this.valueKeyMap[a]=b},RemoveKey:function(a){ULSEWi:;delete this.valueKeyMap[this.dictionary[a]];delete this.dictionary[a]},RemoveValue:function(a){ULSEWi:;delete this.dictionary[this.valueKeyMap[a]];delete this.valueKeyMap[a]},GetValue:function(a){ULSEWi:;return this.dictionary[a]},GetKey:function(a){ULSEWi:;return this.valueKeyMap[a]},GetDictionary:function(){ULSEWi:;return this.dictionary},Clear:function(){ULSEWi:;this.dictionary={};this.valueKeyMap={}},ContainsKey:function(a){ULSEWi:;return a in this.dictionary},ContainsValue:function(a){ULSEWi:;return a in this.valueKeyMap}};SP.Utilities.Range=function(a,b){ULSEWi:;if(a==null||b==null)this.Clear();else{this.begin=a;this.end=b}};SP.Utilities.Range.prototype={Normalize:function(){ULSEWi:;var a=Math.min(this.begin,this.end),b=Math.max(this.begin,this.end);this.begin=a;this.end=b;return this},Contains:function(a){ULSEWi:;return a>=this.begin&&a<=this.end},IsEmpty:function(){ULSEWi:;return this.begin>this.end},Clear:function(){ULSEWi:;this.begin=0;this.end=-1},Size:function(){ULSEWi:;return Math.max(0,this.end-this.begin+1)},Overlaps:function(a){ULSEWi:;return this.end>=a.begin&&a.end>=this.begin},Intersect:function(a){ULSEWi:;return new SP.Utilities.Range(Math.max(this.begin,a.begin),Math.min(this.end,a.end))}};Type.registerNamespace("SP.JsGrid.SplitterBar");SP.JsGrid.SplitterBar=function(g,m,k,i,o){ULSEWi:;var d={None:0,Hover:1,Drag:2},a,b,c=g.styleMgr.splitterStyleCollection,q,e=d.None,h,p=["<div splitId='innerContainer' style='position:absolute;top:1px;left:1px;width:2px;border:1px solid;'></div>","<div splitId='outerHandle' style='position:absolute;left:0px;height:43px;width:4px;border:1px solid;'>","<div splitId='innerHandle' style='height:41px;width:2px;position:relative;border:1px solid;'>","<div splitId='bitTop' style='position:absolute;top:17px;left:0px;height:1px;width:2px;border-top:1px solid;'></div>","<div splitId='bitMiddle' style='position:absolute;top:20px;left:0px;height:1px;width:2px;border-top:1px solid;'></div>","<div splitId='bitBottom' style='position:absolute;top:23px;left:0px;height:1px;width:2px;border-top:1px solid;'></div></div></div>"].join("");function j(){ULSEWi:;var a;a=document.createElement("div");a.innerHTML=p;a.splitId="outerContainer";a.style.cssText="width:6px;float:"+g.RTL.left+";position:relative;cursor:col-resize;";a.childObjects=SP.Internal.DomElement.GetChildrenWithCustomAttribute(a,"splitId");return a}function l(a,b){ULSEWi:;a.outerContainer.style.height=b+"px";a.innerContainer.style.height=Math.max(b-4,0)+"px";a.outerHandle.style.top=Math.round((b-45)/2)+"px"}function f(a,c,b){ULSEWi:;a.outerContainer.style.backgroundColor=c.outerBorderColor;a.innerContainer.style.borderColor=c.innerBorderColor;a.innerContainer.style.borderLeftColor=c.leftInnerBorderColor;a.innerContainer.style.backgroundColor=c.backgroundColor;a.outerHandle.style.borderColor=b.outerBorderColor;a.innerHandle.style.borderColor=b.innerBorderColor;a.innerHandle.style.borderLeftColor=b.leftInnerBorderColor;a.innerHandle.style.backgroundColor=b.backgroundColor;a.bitTop.style.borderTopColor=b.gripUpperColor;a.bitTop.style.backgroundColor=b.gripLowerColor;a.bitMiddle.style.borderTopColor=b.gripUpperColor;a.bitMiddle.style.backgroundColor=b.gripLowerColor;a.bitBottom.style.borderTopColor=b.gripUpperColor;a.bitBottom.style.backgroundColor=b.gripLowerColor}function n(){ULSEWi:;var h;$addHandler(document.body,"mousemove",j);$addHandler(a,"mousedown",p);function l(a){ULSEWi:;return SP.Internal.DomElement.AdjustCoordsForIEZoom({x:a.screenX,y:a.screenY}).x}function j(g){ULSEWi:;if(e!=d.Drag){var b=SP.Internal.DomElement.GetEventLocation(g);if(SP.Internal.DomElement.PointInDomElem(b.x,b.y,a)){if(e==d.None){f(a.childObjects,c.hover,c.hoverHandle);e=d.Hover}}else if(e==d.Hover){f(a.childObjects,c.normal,c.normalHandle);e=d.None}}}function p(g){ULSEWi:;if(g.button==Sys.UI.MouseButton.leftButton){g.preventDefault();h=l(g);SP.Internal.DomElement.SetCapture(a,n,q);b.style.display="block";e=d.Drag;f(a.childObjects,c.drag,c.dragHandle);SP.Internal.DomElement.SetOpacity(a,.4);n(g)}}function n(e){ULSEWi:;var d=(l(e)-h)*(g.RTL.bEnabled?-1:1),c=k()+d;c=Math.max(c,m);c=Math.min(c,i()-SP.Internal.ScrollBar.GetSystemScrollBarThickness()-a.offsetWidth-m);b.style.left=(g.RTL.bEnabled?i()-a.offsetWidth-c:c+1)+"px"}function q(c){ULSEWi:;b.style.display="none";var f=(l(c)-h)*(g.RTL.bEnabled?-1:1),i=k()+f;o(i);h=null;e=d.None;SP.Internal.DomElement.RemoveOpacity(a);j(c)}return function(){ULSEWi:;$removeHandler(document.body,"mousemove",j);$removeHandler(a,"mousedown",p)}}this.Init=function(g,e,d){ULSEWi:;a=j();a.style.marginTop=d+"px";h=n();b=j();b.style.display="none";b.style.position="absolute";b.style.top=d+1+"px";b.style.zIndex=1;this.SetHeight(e);f(a.childObjects,c.normal,c.normalHandle);f(b.childObjects,c.drag,c.dragHandle);g.appendChild(b);return a};this.Hide=function(){ULSEWi:;a.style.display="none"};this.Show=function(){ULSEWi:;a.style.display="block"};this.IsInited=function(){ULSEWi:;return a!=null};this.Dispose=function(){ULSEWi:;h!=null&&h();if(a!=null)a=a.childObjects=null;if(b!=null)b=b.childObjects=null};this.SetHeight=function(c){ULSEWi:;l(a.childObjects,c);l(b.childObjects,c)}};SP.JsGrid.StaticDataSource=function(c,f){ULSEWi:;var a=this,b,d=false;this.tableCache;this.styleMgr;this.recordFactory;this.bHollowOutBlobs;this.LoadSerializedData=function(h){ULSEWi:;b=new SP.JsGrid.Deserializer(h,SP.JsGrid.DeserializationMode.Full);var g=b.view.length,c=g<750,e=!c&&g>300?300:null;d=e!=null;a.tableCache.Clear();a.tableCache.SetMaxRecordCount(e);a.tableCache.SetConvertAllBlobsToRecords(c);a.tableCache.SetKeepDataInBlobCache(!d);a.tableCache.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(b.data),b.data);a.recordFactory=new SP.JsGrid.RecordFactory(b.gridFieldMap,b.keyColumnName,f);b.InitCellStyles(a.styleMgr)};this.InitJsGridParams=function(c){ULSEWi:;var a=b.InitJsGridParams(c);a.tableCache=this.tableCache;a.styleManager=this.styleMgr;return a};this.InitJsGridTableViewParams=function(a){ULSEWi:;return b.InitJsGridTableViewParams(a)};this.InitJsGridRowViewParams=function(a){ULSEWi:;return b.InitJsGridRowViewParams(a)};this.GetAdditionalParams=function(){ULSEWi:;return b.additionalParams};this.AddColumn=function(a,c){ULSEWi:;this.recordFactory.gridFieldMap[a.key]=a;var d={};for(var b in c){var e=this.recordFactory.MakePropForRecord(a,c[b].data,c[b].localized);if(e!=null)d[b]={isProp:true,prop:e};else d[b]={hasLocalized:a.hasLocalizedValue,hasData:a.hasDataValue,data:c[b].data,localized:c[b].localized}}this.tableCache.AddColumn(a.key,d)};this.RemoveColumn=function(a){ULSEWi:;delete this.recordFactory.gridFieldMap[a];this.tableCache.RemoveColumn(a)};function e(h,b){ULSEWi:;var f=new Array(b.length),g=a.bHollowOutBlobs!=null?!a.bHollowOutBlobs:!d;for(var e in b){var c=h[b[e]];f[b[e]]=a.recordFactory.MakeRecord(c.data,c.localized,g)}return f}function g(){ULSEWi:;a.tableCache=new SP.JsGrid.TableCache(null,e);a.styleMgr=SP.JsGrid.Style.MakeJsGridStyleManager();if(c!=null){a.LoadSerializedData(c);c=null}}g()};SP.JsGrid.Style=function(){ULSEWi:;var i="#FFFFFF",e,d,c={Normal:0,PartSelected:1,AllSelected:2,NormalHover:3,PartSelectedHover:4,AllSelectedHover:5},a={Splitter:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{}},SplitterHandle:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{},gripUpperColor:{jsId:"color",defaultValue:"#A7AAAF"},gripLowerColor:{jsId:"borderRightColor",defaultValue:"#FEFEFE"}},GridPane:{verticalBorderColor:{jsId:"borderRightColor",defaultValue:"#DADCDD"},verticalBorderStyle:{jsId:"borderRightStyle",defaultValue:"solid"},horizontalBorderColor:{jsId:"borderBottomColor",defaultValue:"#DADCDD"},horizontalBorderStyle:{jsId:"borderBottomStyle",defaultValue:"solid"},backgroundColor:{jsId:"backgroundColor",defaultValue:"#F6F6F6"},linkColor:{classId:"link",jsId:"color",defaultValue:"#003399"},visitedLinkColor:{classId:"link",jsId:"backgroundColor",defaultValue:"#003399"},copyRectForeBorderColor:{classId:"selection",jsId:"borderLeftColor",defaultValue:"#333333"},copyRectBackBorderColor:{classId:"selection",jsId:"borderRightColor",defaultValue:"#FFFFFF"},focusRectBorderColor:{classId:"selection",jsId:"borderTopColor",defaultValue:"#333333"},selectionRectBorderColor:{classId:"selection",jsId:"borderBottomColor",defaultValue:"#333333"},selectedCellBgColor:{classId:"selection",jsId:"color",classId:"selection",defaultValue:SP.JsGrid.Internal.Color.MakeAlphaColor(.4,.8,.8,.8),fromCss:j},changeHighlightCellBgColor:{classId:"edit",jsId:"backgroundColor",defaultValue:SP.JsGrid.Internal.Color.MakeAlphaColor(.4,198/255,223/255,255/255),fromCss:j},fillRectBorderColor:{classId:"edit",jsId:"borderColor",defaultValue:"#FFDCA0"},errorRectBorderColor:{classId:"edit",jsId:"borderTopColor",defaultValue:"#FF0000"},columnDropIndicatorColor:{jsId:"borderLeftColor",defaultValue:"#DC9A06"}},Header:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#363636"},backgroundColor:{},outerBorderColor:{jsId:"borderBottomColor"},eyeBrowBorderColor:{jsId:"borderRightColor"},menuColor:{classId:"menuBaseControl",jsId:"borderLeftColor"},eyeBrowColor:{classId:"menuBaseControl",jsId:"borderTopColor"},resizeColor:{classId:"menuBaseControl",jsId:"borderRightColor"},menuBorderColor:{classId:"menuBorderControl",jsId:"borderLeftColor"},eyeBrowBorderColor:{classId:"menuBorderControl",jsId:"borderTopColor"},resizeBorderColor:{classId:"menuBorderControl",jsId:"borderRightColor"},menuHoverColor:{classId:"menuHoverControl",jsId:"borderLeftColor"},eyeBrowHoverColor:{classId:"menuHoverControl",jsId:"borderTopColor"},resizeHoverColor:{classId:"menuHoverControl",jsId:"borderRightColor"},menuHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderLeftColor"},eyeBrowHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderTopColor"},resizeHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderRightColor"},elementClickColor:{classId:"menuClickControl",jsId:"backgroundColor"},elementClickBorderColor:{classId:"menuClickControl",jsId:"borderColor"}},TimescaleTier:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#363636"},backgroundColor:{defaultValue:"#DFE3E8"},verticalBorderColor:{jsId:"borderRightColor",defaultValue:"#C8CCD0"},verticalBorderStyle:{jsId:"borderRightStyle",defaultValue:"solid"},horizontalBorderColor:{jsId:"borderBottomColor",defaultValue:"#C8CCD0"},horizontalBorderStyle:{jsId:"borderBottomStyle",defaultValue:"solid"},outerBorderColor:{jsId:"borderLeftColor",defaultValue:"#B1B5BA"},todayLineColor:{jsId:"borderRightColor",defaultValue:"#F59D56"}},Cell:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},fontStyle:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#131519"},backgroundColor:{defaultValue:i},textAlign:{defaultValue:SP.JsGrid.Utility.GetDocumentDirection()=="rtl"?"right":"left"}}};for(var n in a)for(var l in a[n]){var f=a[n][l],h=f.jsId==null?l:f.jsId;if(h!=""&&(f.cssId==null||f.cssId=="")){f.cssId=SP.Internal.DomElement.DashNameFromCamelName(h);f.jsId=h}}$addHandler(window,"unload",m);function m(){ULSEWi:;$removeHandler(window,"unload",m);e=d=null}function j(b){ULSEWi:;var a=SP.JsGrid.Internal.Color.HexStringToColor(b);if(a!=null)a=new SP.JsGrid.Internal.Color.MakeAlphaColor(.2,a.r,a.g,a.b);return a}function b(a){ULSEWi:;var c={};for(var b in a)c[b]=a[b].defaultValue;return c}function q(){ULSEWi:;return {textColor:"#6C6F72"}}function k(){ULSEWi:;function e(d){ULSEWi:;var c=b(a.Header);c.type=d;return c}var d={normal:e(c.Normal),normalHover:e(c.NormalHover),partSelected:e(c.PartSelected),partSelectedHover:e(c.PartSelectedHover),allSelected:e(c.AllSelected),allSelectedHover:e(c.AllSelectedHover)};d.normal.backgroundColor="#DFE3E8";d.normal.outerBorderColor="#B1B5BA";d.normal.eyeBrowColor="#DFE3E8";d.normal.eyeBrowBorderColor="#C8CCD0";d.normal.resizeColor="#EAEFF3";d.normal.resizeBorderColor="#C5C9CE";d.normal.resizeHoverColor="#FEFEFE";d.normal.resizeHoverBorderColor="#6E7B8A";d.normal.elementClickColor="#FFDC61";d.normal.elementClickBorderColor="#C28A30";d.partSelected.backgroundColor="#FFDC61";d.partSelected.outerBorderColor="#C28A30";d.partSelected.eyeBrowColor="#FFDC61";d.partSelected.eyeBrowBorderColor="#F3AA07";d.partSelected.resizeColor="#FFDC63";d.partSelected.resizeBorderColor="#F3AA07";d.partSelected.resizeHoverColor="#FFE9A3";d.partSelected.resizeHoverBorderColor="#BC8205";d.partSelected.elementClickColor="#FCAF00";d.partSelected.elementClickBorderColor="#CB8C00";d.allSelected.backgroundColor="#CACFD6";d.allSelected.outerBorderColor="#75777A";d.allSelected.eyeBrowColor="#CACFD6";d.allSelected.eyeBrowBorderColor="#8C949D";d.allSelected.resizeColor="#EAEFF3";d.allSelected.resizeBorderColor="#C5C9CE";d.allSelected.resizeHoverColor="#FEFEFE";d.allSelected.resizeHoverBorderColor="#6E7B8A";d.allSelected.elementClickColor="#FFDC61";d.allSelected.elementClickBorderColor="#C28A30";d.normalHover.backgroundColor="#FFEB91";d.normalHover.outerBorderColor="#C28A30";d.normalHover.eyeBrowColor="#FFEB91";d.normalHover.menuColor="#FFEB91";d.normalHover.eyeBrowBorderColor="#F3AA07";d.normalHover.menuBorderColor="#FFD359";d.normalHover.resizeBorderColor="#F3AA07";d.normalHover.eyeBrowHoverColor="#FFF5c8";d.normalHover.resizeColor=d.normalHover.menuHoverColor="#FFF5C8";d.normalHover.eyeBrowHoverBorderColor=d.normalHover.menuHoverBorderColor="#F3AA07";d.normalHover.elementClickColor="#FFDC61";d.normalHover.elementClickBorderColor="#C28A30";d.partSelectedHover=SP.Internal.JS.CloneObj(d.normalHover);d.allSelectedHover=SP.Internal.JS.CloneObj(d.normalHover);return d}function o(){ULSEWi:;var c={normal:b(a.Splitter),normalHandle:b(a.SplitterHandle),hover:b(a.Splitter),hoverHandle:b(a.SplitterHandle),drag:b(a.Splitter),dragHandle:b(a.SplitterHandle)};c.normal.outerBorderColor="#B1B5BA";c.normal.leftInnerBorderColor="#E9EBED";c.normal.innerBorderColor="#E9EBED";c.normal.backgroundColor="#DFE3E8";c.normalHandle.outerBorderColor="#A7AAAF";c.normalHandle.leftInnerBorderColor="#E5E7EB";c.normalHandle.innerBorderColor="#E3E6E8";c.normalHandle.backgroundColor="#DCE0E6";c.normalHandle.gripUpperColor="#A7AAAF";c.normalHandle.gripLowerColor="#FEFEFE";c.hover.outerBorderColor="#B8BCC0";c.hover.leftInnerBorderColor="#F4F5F6";c.hover.innerBorderColor="#EDEFF0";c.hover.backgroundColor="#E8EBEC";c.hoverHandle.outerBorderColor="#8A8D91";c.hoverHandle.leftInnerBorderColor="#C3C6C9";c.hoverHandle.innerBorderColor="#C1C5C8";c.hoverHandle.backgroundColor="#B1B5B9";c.hoverHandle.gripUpperColor="#A7AAAF";c.hoverHandle.gripLowerColor="#FEFEFE";c.drag.outerBorderColor="#797B7F";c.drag.leftInnerBorderColor="#E6E6E8";c.drag.innerBorderColor="#DCDDDF";c.drag.backgroundColor="#D3D4D6";c.dragHandle.outerBorderColor="#5F6164";c.dragHandle.leftInnerBorderColor="#A4A7AA";c.dragHandle.innerBorderColor="#A4A7AA";c.dragHandle.backgroundColor="#8C8F93";c.dragHandle.gripUpperColor="#A7AAAF";c.dragHandle.gripLowerColor="#FEFEFE";return c}function p(a){ULSEWi:;var c={};for(var b in a){var d=a[b].classId==null?"base":a[b].classId;if(!(d in c))c[d]={};c[d][b]=a[b]}return c}function g(d,c,b){ULSEWi:;for(var a in c)b[a]!=null&&SP.JsGrid.Style.CreateStyleFromCss(c[a],b[a],d)}return {Type:a,SetRTL:function(a){ULSEWi:;_rtl=a},MakeJsGridStyleManager:function(){ULSEWi:;var c={};function d(b){ULSEWi:;for(var e=[[b.gridPaneStyle,function(c,a){ULSEWi:;b.UpdateGridPaneStyleFromCss(a)},null,{base:"ms-grid",link:"ms-grid-link",selection:"ms-grid-selection",edit:"ms-grid-edit"}],[b.columnHeaderStyleCollection,b.UpdateHeaderStyleFromCss,null,{normal:{base:"ms-grid-col-header-normal",menuControl:"ms-grid-col-header-normal-control"},normalHover:{base:"ms-grid-col-header-normal-hover",menuControl:"ms-grid-col-header-normal-hover-control"},partSelected:{base:"ms-grid-col-header-part-selected",menuControl:"ms-grid-col-header-part-selected-control"},partSelectedHover:{base:"ms-grid-col-header-part-selected-hover",menuControl:"ms-grid-col-header-part-selected-hover-control"},allSelected:{base:"ms-grid-col-header-all-selected",menuControl:"ms-grid-col-header-all-selected-control"},allSelectedHover:{base:"ms-grid-col-header-all-selected-hover",menuControl:"ms-grid-col-header-all-selected-hover"}}],[b.rowHeaderStyleCollection,b.UpdateHeaderStyleFromCss,null,{normal:{base:"ms-grid-row-header-normal",menuControl:"ms-grid-row-header-normal-control"},normalHover:{base:"ms-grid-row-header-normal-hover",menuControl:"ms-grid-row-header-normal-hover-control"},partSelected:{base:"ms-grid-row-header-part-selected",menuControl:"ms-grid-row-header-part-selected-control"},partSelectedHover:{base:"ms-grid-row-header-part-selected-hover",menuControl:"ms-grid-row-header-part-selected-hover-control"},allSelected:{base:"ms-grid-row-header-all-selected",menuControl:"ms-grid-row-header-all-selected-control"},allSelectedHover:{base:"ms-grid-row-header-all-selected-hover",menuControl:"ms-grid-row-header-all-selected-hover"}}],[b.splitterStyleCollection,b.UpdateSplitterStyleFromCss,null,{normal:{base:"ms-grid-splitter"},normalHandle:{base:"ms-grid-splitter-handle"},hover:{base:"ms-grid-splitter-hover"},hoverHandle:{base:"ms-grid-splitter-handle-hover"},drag:{base:"ms-grid-splitter-drag"},dragHandle:{base:"ms-grid-splitter-handle-drag"}}],[b.defaultCellStyle,a.Cell,"ms-grid-cell"],[b.readOnlyCellStyle,a.Cell,"ms-grid-cell-readonly"],[b.timescaleTierStyle,a.TimescaleTier,"ms-grid-timescale"],[b.groupingStyles,function(c,a){ULSEWi:;b.UpdateGroupStylesFromCss(a)},null,"ms-grid-group"]],d=0;d<e.length;d++){var c=e[d];if(c[2]!=null)SP.JsGrid.Style.CreateStyleFromCss(c[1],c[2],c[0]);else c[1].apply(b,[c[0],c[3]])}return b}return d({gridPaneStyle:b(a.GridPane),columnHeaderStyleCollection:k(),rowHeaderStyleCollection:k(),splitterStyleCollection:o(),defaultCellStyle:b(a.Cell),readOnlyCellStyle:q(),timescaleTierStyle:b(a.TimescaleTier),groupingStyles:[{backgroundColor:"#FFF6C1"},{backgroundColor:"#00ADEE"},{backgroundColor:"#81DEFF"},{backgroundColor:"#ECECEC"},{backgroundColor:"#BFBFBF"},{backgroundColor:"#EC008C"},{backgroundColor:"#FF89CF"},{backgroundColor:"#62CE33"},{backgroundColor:"#ACCC6C"}],RegisterCellStyle:function(b,a){ULSEWi:;c[b]=a},GetCellStyle:function(a){ULSEWi:;return c[a]},UpdateSplitterStyleFromCss:function(c,b){ULSEWi:;g(c,b,a.Splitter)},UpdateHeaderStyleFromCss:function(c,b){ULSEWi:;g(c,b,a.Header)},UpdateGridPaneStyleFromCss:function(b){ULSEWi:;g(this.gridPaneStyle,p(a.GridPane),b)},UpdateGroupStylesFromCss:function(d){ULSEWi:;var b=[],c={},e=1;while(true){c=SP.JsGrid.Style.CreateStyleFromCss(a.Cell,d+e++);if(!SP.Internal.JS.IsAssocArrayEmpty(c))b.push(c);else break}if(b.length>0)this.groupingStyles=b}})},CreateStyleFromCss:function(a,j,g){ULSEWi:;var i=g==null?{}:g;if(d==null){d=document.createElement("div");document.body.appendChild(d);d.style.display="none";e=document.createElement("div");document.body.appendChild(e);e.style.display="none"}e.className=j;for(var b in a){var f=a[b].jsId;if(f!=""){var c=SP.Internal.DomElement.GetComputedStyle(e,f,a[b].cssId);if(c!=SP.Internal.DomElement.GetComputedStyle(d,f,a[b].cssId)){var h=a[b].fromCss!=null?a[b].fromCss(c):c;if(h!=null)i[b]=h}}}return i},CreateStyle:function(d,b){ULSEWi:;var c={};for(var a in d)if(b[a]!=null)c[a]=b[a];return c},MergeCellStyles:function(c,e){ULSEWi:;var d={};for(var b in a.Cell)d[b]=c!=null&&c[b]!=null?c[b]:e[b];return d},ApplyCellStyle:function(c,a){ULSEWi:;var b=c.style;if(a.textColor!=null)b.color=a.textColor;if(a.backgroundColor!=null)b.backgroundColor=a.backgroundColor;if(a.font!=null)b.fontFamily=a.font;if(a.fontSize!=null)b.fontSize=a.fontSize;if(a.fontWeight!=null)b.fontWeight=a.fontWeight;if(a.fontStyle!=null)b.fontStyle=a.fontStyle;if(a.textAlign!=null)b.textAlign=a.textAlign},ApplyRowHeaderStyle:function(a,d,c){ULSEWi:;var b=a.style;if(a.headerStyleType!=d.type){a.headerStyleType=d.type;b.backgroundColor=d.backgroundColor;a.headerStyleBorderString=b.borderBottom=b["border"+_rtl.Right]="1px solid "+d.outerBorderColor;b.borderTop="0px"}var e=c&&c(a,true);if(e!=null){var h=f(e,a);e.style.borderBottom=h.headerStyleBorderString}var g=c&&c(a,false),h=g!=null?f(g,a):a;b.borderBottom=h.headerStyleBorderString;function f(a,b){ULSEWi:;return a.headerStyleType==null?b:b.headerStyleType==null?a:a.headerStyleType>b.headerStyleType?a:b}},ApplyCornerHeaderBorderStyle:function(b,a){ULSEWi:;this.ApplyRowHeaderStyle(b,a,function(){ULSEWi:;return null})},ApplyHeaderInnerBorderStyle:function(c,a,b){ULSEWi:;c.style[a?"borderTop":"border"+_rtl.Left]=b.headerStyleInnerBorderString},ApplyColumnContextMenuStyle:function(a,b){ULSEWi:;a.style.border=SP.JsGrid.Style.MakeBorderString(1,"solid",b.borderColor);a.style.backgroundColor=b.backgroundColor},ApplySplitterStyle:function(a,b){ULSEWi:;a.style.borderLeft=a.style.borderRight=SP.JsGrid.Style.MakeBorderString(1,"solid",b.outerColor);a.style.backgroundColor=b.innerColor},MakeBorderString:function(c,b,a){ULSEWi:;return [c,"px ",b," ",a].join("")},GetCellStyleDefaultBackgroundColor:function(){ULSEWi:;return i}}}();SP.JsGrid.TableCache=function(E,p){ULSEWi:;this.fnApplyUpdatesToNewRecord;var j=300,g=null,n=false,q=false,o=10,t=0,a,c,d,f=[],e,b,r=0,A,h,l=this;v();this.SetDataPageSize=function(a){ULSEWi:;j=a};this.GetDataPageSize=function(){ULSEWi:;return j};this.SetMaxRecordCount=function(a){ULSEWi:;g=a;u(false)};this.GetMaxRecordCount=function(){ULSEWi:;return g};this.SetConvertAllBlobsToRecords=function(a){ULSEWi:;n=a};this.GetConvertAllBlobsToRecords=function(){ULSEWi:;return n};this.SetBackgroundConversionSize=function(a){ULSEWi:;o=a};this.GetBackgroundConversionSize=function(){ULSEWi:;return o};this.SetKeepDataInBlobCache=function(a){ULSEWi:;q=a};this.GetKeepDataInBlobCache=function(){ULSEWi:;return q};function H(b,a){ULSEWi:;return {pos:b,count:a}}this.GetCachedRecord=function(b){ULSEWi:;b in c&&!(b in a)&&this.AddRecordsToCache(p(c[b],[b]));return a[b]};this.GetRecordsByKey=function(a,e){ULSEWi:;var f=c();if(f==null)return false;d(f);return true;function c(){ULSEWi:;for(var d=new Array(a.length),c=0;c<a.length;c++){var e=b.GetPosFromKey(a[c]);if(e==null)return null;d[c]={pos:e,count:1}}return d}function d(d){ULSEWi:;var b=l.GetRecords(d,g);if(b.recordSetComplete){var c=SP.Internal.JS.Flatten2LevelArray(b.records);setTimeout(function(){ULSEWi:;e(a,c,true)},0)}}function g(b,f){ULSEWi:;var b=c();if(f&&b!=null)d(b);else e(a,null,false)}};this.GetRecords=function(e,l){ULSEWi:;var f=[],a=[],h=[];for(var i in e)f[i]=C(e[i],h,a);G(h);if(a.length>0){var m,b,d=true;function j(a){ULSEWi:;d=d&&a;b--;b==0&&setTimeout(function(){ULSEWi:;l(e,d)},0)}var g=x(a,j);b=g.rangesToFillRequest;var c=g.totalRanges;if(c.length>0){var k=r;E(c,function(a){ULSEWi:;y(c,a,k)})}}return {recordSetComplete:a.length==0,records:f}};this.AddRecordsToCache=function(f){ULSEWi:;for(var b in f){var e=f[b];a[b]=e;h!=null&&h.AddRecord(b);t++;this.fnApplyUpdatesToNewRecord!=null&&this.fnApplyUpdatesToNewRecord(e);if((g==null||!q)&&b in c){delete c[b];if(b in d){for(var i in d[b])e.AddFieldKey(fieldKeycolumnCache[b][i]);delete d[b]}}}};this.AddColumn=function(f,e){ULSEWi:;m();for(var b in a)e[b]!=null&&a[b].AddFieldValue(f,e[b]);for(var b in c)if(e[b]!=null){if(d[b]==null)d[b]={};d[b][f]=e[b]}};this.RemoveColumn=function(c){ULSEWi:;m();for(var b in a)a[b].RemoveFieldValue(c);for(var b in d){delete d[b][c];if(SP.Internal.JS.IsAssocArrayEmpty(d[b]))delete d[b]}};this.ClearRecords=function(d){ULSEWi:;for(var b=0;b<d.length;b++){delete a[d[b]];delete c[d[b]]}};this.SetView=function(a){ULSEWi:;k();b.SetViewMap(a)};this.GetView=function(){ULSEWi:;return b.GetKeys(0,b.GetRecordCount())};this.RecordIdxToKey=function(a){ULSEWi:;return b.GetKeyFromPos(a)};this.KeyToRecordIdx=function(a){ULSEWi:;return b.GetPosFromKey(a)};this.UpdateProperty=function(b,a,c){ULSEWi:;b.SetProp(a,c)};this.SeedInsertedRecord=function(b){ULSEWi:;if(!(b.key() in a)){a[b.key()]=b;t++}this.fnApplyUpdatesToNewRecord!=null&&this.fnApplyUpdatesToNewRecord(b)};this.InsertRecord=function(c,a){ULSEWi:;k();b.InsertRecord(c,a)};this.DeleteRecord=function(a){ULSEWi:;k();b.DeleteRecord(a)};this.GetRecordCount=function(){ULSEWi:;return b.GetRecordCount()};this.IsKeyInView=function(a){ULSEWi:;return b.IsKeyPresent(a)};this.AddRawDataToCache=function(b,g){ULSEWi:;var d=false;for(var e in b)if(!(b[e] in a)){c[b[e]]=g;d=true}if(n&&d){f.push(b);A=SP.JsGrid.AsynchronousTaskManager.RegisterTask(w)}};this.Clear=function(){ULSEWi:;v()};var i=0;function w(){ULSEWi:;if(f.length>0){for(var a=[];i<f[0].length&&a.length<o;i++)f[0][i] in c&&a.push(f[0][i]);if(i==f[0].length){i=0;f.shift()}a.length>0&&l.AddRecordsToCache(p(c[a[0]],a))}return f.length>0}function m(){ULSEWi:;k();r++}function k(){ULSEWi:;if(e!=null)for(var b=e.GetAllCallbacks(),a=0;a<b.length;a++)b[a](false);e=new D}function v(){ULSEWi:;a={};c={};d={};m();b=new I;u(true)}function u(a){ULSEWi:;if(h!=null&&g!=null&&!a)h.SetMaxSize(g);else h=g!=null?new B(20,g):null}function C(i,m,n){ULSEWi:;for(var k=i.pos,g=i.count,o=b.GetKeys(k,g),f=new Array(g),d=0;d<g;d++){var e=o[d],l=a[e];h!=null&&h.TouchRecord(e);if(l!=null)f[d]=l;else{f[d]=null;var j=c[e];if(j!=null)m.push({key:e,blob:j,destArray:f,destIdx:d});else n.push({pos:k+d,key:e})}}return f}function G(d){ULSEWi:;var c=[],b;for(var f in d){b=d[f];var e=SP.Internal.JS.Find(c,function(a){ULSEWi:;return a.blob==b.blob});if(e==null){e={blob:b.blob,keys:[]};c.push(e)}e.keys.push(b.key)}for(var f in c)l.AddRecordsToCache(p(c[f].blob,c[f].keys));for(var f in d){b=d[f];b.destArray[b.destIdx]=a[b.key]}}function y(d,b,f){ULSEWi:;if(f==r){if(b!=null)for(var a=0;a<b.length;a++)l.AddRawDataToCache(b[a].keys,b[a].data);for(var a=0;a<d.length;a++){var c=e.FindRangeObject(d[a].pos);if(c!=null){for(var g in c.callbacks)c.callbacks[g](b!=null);e.RemoveRangeObject(c)}}}}function x(d,i){ULSEWi:;for(var h=0,f=[],a=null,c,b=0;b<d.length;b++){c=d[b].pos;a=e.FindRangeObject(c);if(a==null){var g=F(c,.75);for(var b in g)e.AppendRangeObject(g[b]);f=f.concat(g)}}a=null;for(var b=0;b<d.length;b++){c=d[b].pos;if(a==null||!e.IsPosInRange(c,a)){a=e.FindRangeObject(c);h++;if(a.callbacks==null)a.callbacks=[i];else a.callbacks.push(i)}}return {rangesToFillRequest:h,totalRanges:f}}function B(l,m){ULSEWi:;var f,e=[],c={},b=[],d={},r=0,n=10,p=0,g;function o(j){ULSEWi:;var m=0,i,h,f=0,g=0;this.AddToDeleteCount=function(a){ULSEWi:;if(!SP.JsGrid.AsynchronousTaskManager.TaskRegistered(i))i=SP.JsGrid.AsynchronousTaskManager.RegisterTask(l);m=k(f+a)};this.TotalRemaingToDelete=function(){ULSEWi:;return f};this.NotifyGenUpdated=function(){ULSEWi:;ComputePagesToDelete(f)};function k(c){ULSEWi:;h={};f=0;for(var a=0;a<b.length-3&&f<c;a++){f+=d[b[a]];h[b[a]]=null}}function l(){ULSEWi:;for(var k=0;k<n;k++)if(c[e[g]] in h){var b=e[g],i=c[b];delete a[b];if(d[i]==1)delete h[i];j(b);delete c[b];e.splice(g,1);f--}else g=(g+1)%(e.length-1);return f!=0}}function q(){ULSEWi:;function a(){ULSEWi:;var a=h();b.push(a);d[a]=0}g=new o(j);a();a();f=0}function h(){ULSEWi:;return p++}function i(c){ULSEWi:;var b=g.TotalRemaingToDelete(),a=e.length-m-b;a>0&&g.AddToDeleteCount(a+l);e.push(c)}this.AddRecord=function(a){ULSEWi:;if(c[a]==null){f=k(a,f,Math.ceil((b.length-1)/2));i(a)}};this.SetMaxSize=function(a){ULSEWi:;m=a};this.TouchRecord=function(a){ULSEWi:;if(c[a]!=b[b.length-1]){if(c[a]!=null)j(a);else i(a);k(a,b.length-1)}};function k(g,a,e){ULSEWi:;if(d[b[a]]==l){var f=h();a=e!=null?e:a+1;b.splice(a,0,f);d[f]=0}d[b[a]]++;c[g]=b[a];return a}function j(f){ULSEWi:;var a=c[f],g=d[a];if(g==1){for(var e=0;e<b.length;e++)if(b[e]==a)break;delete d[a];b.splice(e,1);c[f]=-1}else d[a]--}q()}function I(){ULSEWi:;var b,a,d=this;this.SetViewMap=function(c){ULSEWi:;b=c;a=null};this.GetKeys=function(d,b){ULSEWi:;for(var c=new Array(b),a=0;a<b;a++)c[a]=this.GetKeyFromPos(d+a);return c};this.InsertRecord=function(d,c){ULSEWi:;b.splice(d,0,c);a=null};this.DeleteRecord=function(c){ULSEWi:;b.splice(c,1);a=null};this.GetRecordCount=function(){ULSEWi:;return b!=null?b.length:0};this.IsKeyPresent=function(b){ULSEWi:;a==null&&c();return b in a};this.GetKeyFromPos=function(a){ULSEWi:;return b[a]};this.GetPosFromKey=function(b){ULSEWi:;a==null&&c();if(b in a)return a[b];return null};function c(){ULSEWi:;a={};for(var c=b.length-1;c>=0;c--)a[b[c]]=c}}function F(m,n){ULSEWi:;var k=500,f=k*.5,e=k*.5,l=m-1,i=m,b=[],d=j*(1-n),h=true,g=true,a,c=true;while(c&&b.length<j){c=false;if(h&&f>0){a=s(l,d,f,-1);f-=a.scanned;l-=a.scanned+1;h=a.shouldContinue;b=b.concat(a.positions);d=j-b.length;c=true}if(g&&e>0){a=s(i,d,e,1);e-=a.scanned;i+=a.scanned+1;g=a.shouldContinue;b=b.concat(a.positions);d=j-b.length;c=true}}return z(b)}function z(a){ULSEWi:;var e=[];a.sort(function(a,b){ULSEWi:;return a-b});for(var f=a.length,d=Number.NEGATIVE_INFINITY,c=null,b=0;b<f;b++){if(a[b]!=d+1){c=H(a[b],1);e.push(c)}else c.count++;d=a[b]}return e}function s(l,h,m,j){ULSEWi:;for(var g={positions:[],shouldContinue:true,scanned:0},d,n=false,k=b.GetRecordCount(),f=0;f<m;f++){d=l+f*j;if(d<0||d>k){g.shouldContinue=false;break}var i=b.GetKeyFromPos(d);if(!(i in a||i in c||e.FindRangeObject(d)!=null)){g.positions.push(d);h--;if(h<=0)break}}g.scanned=f;return g}function D(){ULSEWi:;var a=[];this.FindRangeObject=function(d){ULSEWi:;var e=null,c=b(d);if(c<a.length&&this.IsPosInRange(d,a[c]))e=a[c];return e};this.AppendRangeObject=function(c){ULSEWi:;var d=b(c.pos);a.splice(d,0,c)};this.RemoveRangeObject=function(c){ULSEWi:;var d=b(c.pos);a.splice(d,1)};this.IsPosInRange=function(b,a){ULSEWi:;return c(b,a)==0};this.IsEmpty=function(){ULSEWi:;return a.length==0};this.GetAllCallbacks=function(){ULSEWi:;for(var b=[],c=0;c<a.length;c++)if(a.callbacks!=null)b=b.concat(a.callbacks);return b};function b(b){ULSEWi:;return SP.Internal.JS.LowerBoundCompare(a,b,function(b,d){ULSEWi:;return c(d,a[b])})}function c(b,a){ULSEWi:;return b<a.pos?1:a.pos+a.count<=b?-1:0}}};SP.JsGrid.Internal.TableManager=function(o,hb,P,G,f,fb,Y,ab,U,Z,F,bb,db){ULSEWi:;var l=0,O,k=[],e=[],s,z,i,c,a,g=0,n=[],b={},m={},d=new SP.JsGrid.Internal.GridPaneConverter(f),p=f.ariaMgr,j=this,v=null,y,cb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(q);this.CellType={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3};this.GetGridPaneConverter=function(){ULSEWi:;return d};this.Dispose=function(){ULSEWi:;I();a=o=null};this.SetPosConverterObj=function(a){ULSEWi:;O=a;d.SetPosConverterObj(a)};this.GetHeaderHeight=function(){ULSEWi:;return a.rows[0].offsetHeight};this.SetHeaderHeight=function(b){ULSEWi:;s=b;if(a.rows.length>0){a.rows[0].style.height=s-1+"px";Z(s)}};this.SetRowHeight=function(a){ULSEWi:;z=SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7?a-1:a};this.InitTable=function(j){ULSEWi:;this.ClearTable();g=0;c=j;i=c?1:0;var f=a.insertRow(-1);f.recordKey="__colheaders";p.OnInsertTableRow(f,null,-1);var d;if(c){var b=document.createElement("th"),e=document.createElement("div");b.style.width=e.style.width=SP.JsGrid.Internal.RowHeaderWidth-1+"px";b.style.padding="0px";b.appendChild(e);a.rows[0].appendChild(b);g++;d=new h(0,0);p.OnInsertRowHeaderCell(b)}this.SetHeaderHeight(s);return d};this.SetColumns=function(a,b){ULSEWi:;if(k.length){u(i,r());l=0}k=a;if(b)d.SetView(k);else d.NotifyColumnsChanged(k);this.OptimizeTableColumns()};this.ClearTable=function(){ULSEWi:;e.length>0&&this.SpliceRows(0,e.length,null,0,null);u(i,r());l=0;a.rows.length>0&&a.deleteRow(0)};this.SpliceRows=function(f,g,c,i){ULSEWi:;var h=i.length,d=h>1;d&&o.removeChild(a);if(f!=null&&g!=0){e.splice(f,g);for(var b=g-1;b>=0;b--)L(f+b)}if(c!=null&&h!=0){Array.prototype.splice.apply(e,[c,0].concat(i));for(var b=0;b<h;b++)M(c+b,e[c+b],d)}d&&o.appendChild(a);B()};this.RenderRows=function(b){ULSEWi:;for(var a in b){var c=b[a];a=+a;L(a);e[a]=c;M(a,c)}if(!SP.Internal.JS.IsAssocArrayEmpty(b))e=[].concat(e);B()};this.InsertColumns=function(c,b){ULSEWi:;var a=t(c);Array.prototype.splice.apply(k,[c,0].concat(b));d.NotifyColumnsChanged(k);a>=i&&a<=g&&D(a,b.length);this.OptimizeTableColumns()};this.RefreshCell=function(a){ULSEWi:;var c=a.GetRecordKey(),b=a.GetFieldKey();E(c,b);var d=a.GetTd();d.innerHTML="";F(a);f.errorMgr.CellHasError(c,b)&&q(c,b)};this.RemoveColumns=function(e,b){ULSEWi:;var a=t(e);if(a>=i&&a<g){var c=b;if(a+b>g)c-=a+b-g;u(a,c)}k.splice(e,b);d.NotifyColumnsChanged(k);this.OptimizeTableColumns()};this.ScrollColumns=function(a){ULSEWi:;var c=H(a),d=r(),b=l;if(a>b){u(i,Math.min(d,a-b));l=a}else if(a<b){l=a;D(i,Math.min(c,b-a))}this.OptimizeTableColumns()};this.ChangeKeys=function(c,f){ULSEWi:;if(d.IsRecordOnScreen(c))for(var e=a.rows.length-1;e>=0;e--)if(a.rows[e].recordKey==c){a.rows[e].recordKey=f;break}if(c in b){b[f]=b[c];delete b[c]}if(c in m){m[f]=m[c];delete m[c]}};this.OptimizeTableColumns=function(){ULSEWi:;var c=H(l),b=r(),a=b-c;if(a<0)D(g,-a);else a>0&&u(g-a,a);B()};this.UpdateErrorFrames=function(){ULSEWi:;for(var a in b)for(var c in b[a])q(a,c,true)};this.GetAllDataCells=function(){ULSEWi:;for(var d=[],b=1;b<a.rows.length;b++)for(var c=i;c<g;c++)d.push(new h(b,c));return d};this.GetSelectAllSquare=function(){ULSEWi:;return c?new h(0,0):null};this.GetRowHeaderByKey=function(a){ULSEWi:;var b;if(c&&d.IsRecordOnScreen(a))b=new h(C(d.GetTopRowIdxForKey(a)),0);return b};this.GetRowHeader=function(b){ULSEWi:;if(c){var a=new h(C(b),0,true,false);return a.bIsInvalid?null:a}return null};this.GetRowHeaders=function(){ULSEWi:;var d=[];if(c)for(var b=1;b<a.rows.length;b++)d.push(new h(b,0));return d};this.GetColumnHeader=function(b){ULSEWi:;var a=new h(0,t(b),true,false);return a.bIsInvalid||a.GetColIdx()==null?null:a};this.GetColumnHeaders=function(){ULSEWi:;for(var b=[],a=i;a<g;a++)b.push(new h(0,a));return b};this.GetColumnHeaderTr=function(){ULSEWi:;return a.rows[0]};this.GetRowHeaderWidth=function(){ULSEWi:;return c?SP.JsGrid.Internal.RowHeaderWidth:0};this.GetRowIdxColIdxFromCoord=function(k){ULSEWi:;for(var f=SP.Internal.DomElement.GetEventLocation(k),m,l,e={},j=a.rows,d=1;d<j.length;d++){var h=j[d],b=SP.Internal.DomElement.GetLocation(h);if(f.y>=b.y&&f.y<b.y+h.offsetHeight){e.rowIdx=x(d);e.top=b.y;e.bottom=b.y+h.offsetHeight;break}}for(var i=a.rows[0].cells,d=c?1:0;d<i.length;d++){var g=i[d],b=SP.Internal.DomElement.GetLocation(g);if(f.x>=b.x&&f.x<b.x+g.offsetWidth){e.colIdx=w(d);e.left=b.x;e.right=b.x+g.offsetWidth;break}}return e};this.GetTdCoords=function(c){ULSEWi:;var b={};if(f.RTL.bEnabled){b.left=a.offsetLeft+c.offsetLeft;b.right=a.offsetLeft+c.offsetLeft+c.offsetWidth+1}else{b.left=a.offsetLeft+c.offsetLeft-1;b.right=a.offsetLeft+c.offsetLeft+c.offsetWidth}if(c.previousSibling!=null){if(v==null){var e=a.rows[0].cells,d=e[f.RTL.bEnabled?0:e.length-1],g=d.offsetWidth-(SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7&&!f.RTL.bEnabled?1:0);v=a.offsetWidth-(d.offsetLeft+g)}b.left+=v;b.right+=v}b.top=a.offsetTop+c.offsetTop-1;b.bottom=a.offsetTop+c.offsetTop+c.offsetHeight;b.width=b.right-b.left;b.height=b.bottom-b.top;return b};this.GetCellByKey=function(b,c){ULSEWi:;if(!O.IsRecordOnScreen(b))return null;var a=d.KeyToIdx(b,c);return a&&this.GetCellByIdx(a.rowIdx,a.colIdx)};this.GetCellByIdx=function(c,b){ULSEWi:;var a=new h(C(c),t(b),true,true);return a.bIsInvalid?null:a};this.GetCellByChildElement=function(i){ULSEWi:;function g(a,b){ULSEWi:;return SP.Internal.JS.FindInArray(a.rows,function(a){ULSEWi:;return a==b})}function f(b,d){ULSEWi:;for(var c=null,a=b.cells.length-1;a>=0;a--)if(b.cells[a]==d){c=a;break}return c}var b=SP.Internal.DomElement.FindAncestorWithProperty(i,"recordKey");if(b==null)return null;var e=b.elem,j=b.child,d=g(a,e),c=f(e,j);return d!=null&&c!=null?new h(d,c):null};this.GetRowCount=function(){ULSEWi:;return e.length()};this.GetColumnCount=function(){ULSEWi:;return r()};this.BeginRowIdx=function(){ULSEWi:;return d.RelRowIdxToRowIdx(0)};this.EndRowIdx=function(){ULSEWi:;return this.BeginRowIdx()+e.length};this.BeginColIdx=function(){ULSEWi:;return l};this.EndColIdx=function(){ULSEWi:;return l+r()};this.GetColumnAutoResizeWidth=function(f){ULSEWi:;for(var e=t(f),d=a.rows,b=0,c=0;c<d.length;c++)b=Math.max(b,d[c].cells[e].scrollWidth);return b};function eb(c){ULSEWi:;var a=c.defaultCellStyle,b=c.gridPaneStyle;y=";vertical-align:middle;white-space:nowrap;overflow:hidden;border-"+f.RTL.right+":"+SP.JsGrid.Style.MakeBorderString(1,b.verticalBorderStyle,b.verticalBorderColor)+";border-bottom:"+SP.JsGrid.Style.MakeBorderString(1,b.horizontalBorderStyle,b.horizontalBorderColor)+";color:"+a.textColor+(a.font!=null?";font-family:"+a.font:"")+";font-size:"+a.fontSize+";font-weight:"+a.fontWeight+";font-style:"+a.fontStyle+";text-align:"+a.textAlign}function ib(){ULSEWi:;f.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,X);f.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,S);eb(f.styleMgr);a=document.createElement("table");a.cellPadding=a.cellSpacing=0;a.style.cssText="table-layout:fixed;width:0px;border-collapse:collapse;background-color:"+f.styleMgr.defaultCellStyle.backgroundColor;a.id=hb+"_mainTable";o.appendChild(a)}function X(a){ULSEWi:;if(d.IsRecordOnScreen(a.recordKey))if(a.bCellCurrentlyHasError&&!(a.recordKey in b&&a.fieldKey in b[a.recordKey]))q(a.recordKey,a.fieldKey);else!a.bCellCurrentlyHasError&&E(a.recordKey,a.fieldKey)}function q(a,c,f){ULSEWi:;var d=j.GetCellByKey(a,c);if(d!=null){var e=d.GetTd();if(!(a in b))b[a]={};if(b[a][c]==null)b[a][c]=f?null:T(e);b[a][c]!=null&&R(e,b[a][c])}}function T(e){ULSEWi:;var d="position:absolute; top:0px; left:0px; width:0px; height:0px;",a={};a.Top=document.createElement("div");a.Right=document.createElement("div");a.Bottom=document.createElement("div");a.Left=document.createElement("div");for(var c in a){var b=a[c];b.style.cssText=d;b.style["border"+c]=SP.JsGrid.Style.MakeBorderString(1,"solid",f.styleMgr.gridPaneStyle.errorRectBorderColor);e.appendChild(b)}return a}function R(f,d){ULSEWi:;var a=j.GetTdCoords(f),c={Top:{left:a.left+1,top:a.top+1,width:a.width-2},Right:{left:a.right-2,top:a.top+1,height:a.height-2},Bottom:{left:a.left+1,top:a.bottom-2,width:a.width-2},Left:{left:a.left+1,top:a.top+1,height:a.height-2}};for(var b in d){var g=d[b];for(var e in c[b])g.style[e]=c[b][e]+"px"}}function Q(a){ULSEWi:;var c=b[a];if(c!=null){for(var d in c)K(a,d,false);delete b[a]}}function E(a,c){ULSEWi:;a in b&&c in b[a]&&K(a,c,true)}function K(a,c,f){ULSEWi:;for(var d in b[a][c])if(d!=null){var e=SP.Internal.DomElement.GetParentElement(b[a][c][d]);e!=null&&e.removeChild(b[a][c][d])}delete b[a][c];if(f)if(SP.Internal.JS.IsAssocArrayEmpty(b[a]))delete b[a]}function S(a){ULSEWi:;if(c&&d.IsRecordOnScreen(a.recordKey))if(a.rowHeaderState!=null)J(a.recordKey,a.rowHeaderState);else A(a.recordKey)}function J(a,b){ULSEWi:;m[a]!=null&&A(a);var f=j.GetRowHeaderByKey(a),e=f.GetTd(),d=b.GetOnClick(),c=b.GetImg().Render(b.GetTooltip(),d!=null?function(b){ULSEWi:;d(b,a);b.stopPropagation();b.preventDefault()}:null);e.innerHTML="";e.appendChild(c);m[a]=c}function A(a,b){ULSEWi:;if(a in m){var d=j.GetRowHeaderByKey(a),c=b==null?d.GetTd():b;N(c);c.removeChild(m[a]);delete m[a]}}function r(){ULSEWi:;return g-i}function x(a){ULSEWi:;return d.RelRowIdxToRowIdx(a-1)}function C(a){ULSEWi:;return d.RowIdxToRelRowIdx(a)+1}function w(a){ULSEWi:;return l+a-i}function t(a){ULSEWi:;return a-l+i}function M(v,m,u){ULSEWi:;var t,e=[],k=v+1,j=a.insertRow(k);j.style.height=z+"px";var r=m!=null&&m!=SP.JsGrid.Internal.LoadErrorState,d=r?m.key():null;j.recordKey=r?d.toString():null;p.OnInsertTableRow(j,m,x(k));if(c){var n=j.insertCell(-1);n.style.cssText=y+";padding-"+f.RTL.left+":4px";t=new h(k,0);p.OnInsertRowHeaderCell(n)}for(var b=i;b<g;b++){var n=j.insertCell(-1);n.style.cssText=y;e.push(new h(k,b));p.OnInsertGridCell(n)}fb(t,e);for(var o=false,b=0;b<e.length;b++){o=F(e[b])||o;if(d!=null)if(f.errorMgr.CellHasError(d,e[b].GetFieldKey())){q(d,e[b].GetFieldKey(),u);u&&SP.JsGrid.AsynchronousCellUpdater.RegisterCell(cb,d,e[b].GetFieldKey())}}var s;c&&(s=f.rowHeaderStateMgr.GetRowHeaderState(d))!=null&&J(d,s);if(!o&&SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7){var l=j.cells.length>0?j.cells[0]:null;if(l!=null&&l.innerHTML!=null&&l.innerHTML.length==0)l.innerHTML="&nbsp;"}}function N(c){ULSEWi:;$clearHandlers(c);for(var b=c.childNodes,a=0;a<b.length;a++)N(b[a])}function L(b){ULSEWi:;var d=a.rows[b+1].recordKey;c&&m[d]!=null&&A(d,a.rows[b+1].cells[0]);Q(d);var e=a.rows[b+1];db(e.recordKey);e.recordKey=null;a.deleteRow(b+1)}function H(b){ULSEWi:;for(var e=P.GetWidth(),c=j.GetRowHeaderWidth(),a=b;a<d.GetVirtualColumnCount()&&c<e;a++)c+=k[a].width;return a-b}function gb(){ULSEWi:;for(var b=j.GetRowHeaderWidth(),a=j.BeginColIdx();a<j.EndColIdx();a++)b+=k[a].width;return b}function D(d,m){ULSEWi:;for(var l=[],c=[],j=a.rows[0],b=0;b<m;b++){var i=document.createElement("th");d==j.cells.length?j.appendChild(i):j.insertBefore(i,j.cells[d]);g++;l.push(new h(0,d+b));p.OnInsertColHeaderCell(i);for(var k=0;k<e.length;k++){var n=a.rows[k+1].insertCell(d+b);n.style.cssText=y;c.push(new h(k+1,d+b));p.OnInsertGridCell(i)}}Y(l,c,s);for(var b=0;b<c.length;b++){F(c[b]);f.errorMgr.CellHasError(c[b].GetRecordKey(),c[b].GetFieldKey())&&q(c[b].GetRecordKey(),c[b].GetFieldKey())}}function u(i,m){ULSEWi:;var f=w(i);while(m-->0){for(var j=k[f].fieldKeys,d=e.length;d>=0;d--){var c=a.rows[d],l=c.cells[i];if(c.recordKey in b)for(var h=0;h<j.length;h++)E(c.recordKey,j[h]);d==0&&U(l,f);c.removeChild(l)}f++;g--}ab()}function B(){ULSEWi:;I();for(var d=null,g=[],l=-1,c=0;c<e.length;c++){var h=e[c]==null?1:e[c]==SP.JsGrid.Internal.LoadErrorState?2:0;if(h!=0)if(h!=l){d={type:h,startIdx:c,count:1};g.push(d)}else d.count++;l=h}if(g.length)for(var p=j.GetRowHeaderWidth(),t=f.RTL.bEnabled?Math.max(0,a.offsetLeft+1):p,r=Math.min(gb()-1,P.GetWidth())-p,k='<table cellpadding="0" cellspacing="0" style="height:100%;width:100%"><tr><td style="border:0px;text-align:center">',i="</td></tr></table>",q=k+G("LoadingMsg")+i,u=k+'<a href="#" tabIndex="-1" title="'+G("RecordFetchError")+'">'+G("RecordFetchError")+"</a>"+i,c=0;c<g.length;c++){var d=g[c],b=document.createElement("div");SP.Internal.DomElement.SetOpacity(b,.75);b.style.position="absolute";b.style.top=z*d.startIdx+s+2-o.offsetTop+"px";b.style.left=t+"px";b.style.width=r+"px";b.style.height=z*d.count-1+"px";b.style.zIndex=100;if(d.type==1){b.innerHTML=q;n.push({div:b})}else{b.innerHTML=u;var m=b.firstChild.firstChild.firstChild.firstChild.firstChild;$addHandler(m,"click",function(){ULSEWi:;bb();return false});n.push({div:b,anchor:m})}o.appendChild(b)}}function I(){ULSEWi:;for(var a=0;a<n.length;a++){n[a].anchor&&$clearHandlers(n[a].anchor);o.removeChild(n[a].div)}n=[]}function W(b,c){ULSEWi:;return b>=(c?1:0)&&b<a.rows.length}function V(a,b){ULSEWi:;return a>=(b&&c?1:0)&&a<g}function h(b,a,d,c){ULSEWi:;if(!d||W(b,c)&&V(a,c)){this.tableRowIdx=b;this.tableColIdx=a}else this.bIsInvalid=true}h.prototype={fieldKey:null,GetTr:function(){ULSEWi:;return a.rows[this.tableRowIdx]},GetTd:function(){ULSEWi:;return a.rows[this.tableRowIdx].cells[this.tableColIdx]},GetRecordKey:function(){ULSEWi:;if(this.tableRowIdx==0)return null;var a=e[this.tableRowIdx-1];return a!=null&&a.recordKey!=null?a.recordKey:this.GetTr().recordKey},GetRecord:function(){ULSEWi:;var a=this.tableRowIdx==0?null:e[this.tableRowIdx-1];return a==SP.JsGrid.Internal.LoadErrorState?null:a},GetFieldKey:function(){ULSEWi:;if(this.tableColIdx==0&&c||this.tableRowIdx==0)return null;if(!this.fieldKey)this.fieldKey=d.IdxToFieldKey(x(this.tableRowIdx),w(this.tableColIdx));return this.fieldKey},GetColumn:function(){ULSEWi:;return this.tableColIdx==0&&c?null:k[this.GetColIdx()]},GetColIdx:function(){ULSEWi:;return this.tableColIdx==0&&c?null:w(this.tableColIdx)},GetRowIdx:function(){ULSEWi:;return this.tableRowIdx==0?null:x(this.tableRowIdx)},Equals:function(a){ULSEWi:;return this.tableRowIdx==a.tableRowIdx&&this.tableColIdx==a.tableColIdx},GetCellType:function(){ULSEWi:;return this.tableColIdx==0&&c?this.tableRowIdx==0?j.CellType.SelectAllSquare:j.CellType.RowHeader:this.tableRowIdx==0?j.CellType.ColumnHeader:j.CellType.Cell}};ib()};SP.JsGrid.Internal.VersionManager=function(k,i,t,s,l,y){ULSEWi:;var b=[],c=[{key:new q(0),version:0}],a=0,f=0,x=1,e=new w,d=new v,g=new u;this.ChangeKeysOnPropUpdates=function(b,a){ULSEWi:;d.ChangeKeys(b,a)};this.GetEarliestPropChangeKeyForRecord=function(b){ULSEWi:;var a=d.GetEarliestChangeKeyForRecord(b);if(a!=null)a=this.GetChangeKeyForVersion(a);return a};this.AddPropChange=function(f,g,a,e,b,c){ULSEWi:;h(a,true)&&d.AddPropChange(f,g,a,e,b,c)};this.MarkPropUpdateInvalid=function(e,f,a,c){ULSEWi:;var b=false;if(h(a,true))b=d.MarkPropUpdateInvalid(e,f,a,c);return b};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;d.ClearAllPropChangesForRecord(a)};this.AddRowInsertChange=function(b,a){ULSEWi:;h(a,true)&&e.AddInsertChange(b,a)};this.AddRowDeleteChange=function(b,a){ULSEWi:;h(a,true)&&e.AddDeleteChange(b,a)};this.AddIndentLevelChange=function(d,c,b,a){ULSEWi:;h(a,true)&&g.AddLevelChange(d,c,b,a)};this.ApplyChangesToRecord=function(a){ULSEWi:;d.ApplyChangesToRecord(a)};this.ApplyChangeKey=function(b){ULSEWi:;this.OnSynchronizeChange!=null&&this.OnSynchronizeChange(b);e.ApplyAllRowInsertChanges(b);g.ApplyAllLevelChanges(b);d.SynchronizeToChange(b);e.ApplyAllRowDeleteChanges(b);a=b.GetVersionNumber()};this.UndoChangeKey=function(b){ULSEWi:;this.OnRollbackChange!=null&&this.OnRollbackChange(b);var c=r(b.GetVersionNumber());a=c.GetVersionNumber();e.UndoAllRowDeleteChanges(b);g.UndoAllLevelChanges(b);d.RollBackChange(b);e.UndoAllRowInsertChanges(b)};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForVersion(b,c,a.GetVersionNumber())};this.OnSynchronizeChange;this.OnRollbackChange;this.OnVacateChange;this.GetChange=function(j,a,b,h){ULSEWi:;var c=j.GetVersionNumber(),k=e.GetChange(c,a,b,h),l=g.GetChange(c,a,b),f=k.concat(l);if(!h)f=f.concat(d.GetChange(c,a,b));return f.sort(i);function i(a,b){ULSEWi:;return a.type-b.type}};this.GetCurrentVersion=function(){ULSEWi:;return a};this.GetCurrentChangeKey=function(){ULSEWi:;return o(a)};this.IsChangeKeyApplied=function(b){ULSEWi:;return b!=null&&b.GetVersionNumber()<=a};this.GetNextVersionKey=function(){ULSEWi:;var a=new q(x++);c.push({key:a,version:a.GetVersionNumber()});a.Reserve();return a};this.ForceReleaseChanges=function(d,e){ULSEWi:;var a,c=0;j(d.GetVersionNumber()+1,e.GetVersionNumber(),b,function(d,b){ULSEWi:;a=a==null?b:a;c++});b.splice(a,c);m()};this.GetChangeKeyForVersion=function(b){ULSEWi:;var a=o(b);return a!=null&&h(a,true)?a:null};this.Clear=function(){ULSEWi:;b=[];e.Clear();g.Clear();d.Clear()};this.ReleaseChanges=function(a,b){ULSEWi:;j(a.GetVersionNumber()+1,b.GetVersionNumber(),c,function(a){ULSEWi:;a.key.Release()});m()};this.ReserveChanges=function(a,b){ULSEWi:;j(a.GetVersionNumber()+1,b.GetVersionNumber(),c,function(a){ULSEWi:;a.key.Reserve()})};this.VacateChange=function(b){ULSEWi:;var a=b.GetVersionNumber();k.eventMgr.FireEvent(SP.JsGrid.EventType.OnVacateChange,new SP.JsGrid.EventArgs.VacateChange(b));this.OnVacateChange!=null&&this.OnVacateChange(b);d.VacateChange(a);e.VacateChange(a);g.VacateChange(a);n.VacateChange(a);p(a,a)};function p(d,e){ULSEWi:;var b=0,a;j(d,e,c,function(d,c){ULSEWi:;a=a==null?c:a;b++});c.splice(a,b)}function j(c,d,b,g){ULSEWi:;for(var e=c==null?0:SP.Internal.JS.LowerBound(b,c,"version"),f=d==null?b.length-1:SP.Internal.JS.LowerBound(b,d,"version"),a=e;a<=f;a++)b[a]!=null&&g(b[a],a)}function h(a){ULSEWi:;var b=a.GetVersionNumber();return !n.ChangeIsVacated(b)}var n=function(){ULSEWi:;var a=[];function b(c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c),d=a[b]!=null&&a[b]==c?a[b]:null;return {idx:b,item:d}}return {VacateChange:function(c){ULSEWi:;var d=b(c);a.splice(d.idx,0,c)},AdvanceBaseline:function(d){ULSEWi:;var c=b(d);a.splice(0,c.idx+(c.item!=null?1:0))},ChangeIsVacated:function(c){ULSEWi:;var a=b(c);return a.item!=null}}}();function q(a){ULSEWi:;this.Reserve=function(){ULSEWi:;var c=SP.Internal.JS.LowerBound(b,a,"version");if(b[c]==null||b[c].version!=a)b.splice(c,0,{version:a,count:1});else b[c].count++};this.Release=function(){ULSEWi:;var c=SP.Internal.JS.LowerBound(b,a,"version");if(b[c].count==1){b.splice(c,1);m()}else b[c].count--};this.GetVersionNumber=function(){ULSEWi:;return a};this.CompareTo=function(b){ULSEWi:;return a-b.GetVersionNumber()}}function r(d){ULSEWi:;for(var b=null,a=0;a<c.length&&c[a].version<d;a++)b=c[a];return b&&b.key}function o(a){ULSEWi:;var b=SP.Internal.JS.BinarySearch(c,a,"version");return c[b].key}function m(){ULSEWi:;var c=b.length>0?b[0]-1:a-1;if(c>f){d.AdvanceBaseline(c);e.AdvanceBaseline(c);g.AdvanceBaseline(c);n.AdvanceBaseline(c);p(f,c-1);f=c}}function u(){ULSEWi:;var b;this.Clear=function(){ULSEWi:;d()};this.AddLevelChange=function(h,f,e,g){ULSEWi:;var c=g.GetVersionNumber(),d=b[c];if(d==null)d=b[c]=[];d.push({recordKey:h,levelDelta:f,adoptedChildrenKeys:e});a>=c&&l(h,f,e,g)};this.ApplyAllLevelChanges=function(a){ULSEWi:;c(a,false)};this.UndoAllLevelChanges=function(a){ULSEWi:;c(a,true)};this.GetChange=function(i,e,g){ULSEWi:;var d;if(e!=null){d=new SP.Utilities.Set;d.AddArray(e)}var f=[],a=b[i];if(a!=null)for(var h=SP.JsGrid.Internal.VersionManager.ChangeType.Level,c=0;c<a.length;c++)if(d==null||d.Contains(a[c].recordKey)){var j=a[c].levelDelta*(g?-1:1);f.push({type:h,recordKey:a[c].recordKey,levelDelta:j,adoptedChildrenKeys:a[c].adoptedChildrenKeys})}return f};this.VacateChange=function(a){ULSEWi:;delete b[a]};this.AdvanceBaseline=function(b){ULSEWi:;for(var a=f;a<b;a++)this.VacateChange(a)};function d(){ULSEWi:;b={}}function c(d,e){ULSEWi:;var c=b[d.GetVersionNumber()];if(c!=null)if(e)for(var a=c.length-1;a>=0;a--)l(c[a].recordKey,-c[a].levelDelta,c[a].adoptedChildrenKeys,d);else for(var a=0;a<c.length;a++)l(c[a].recordKey,c[a].levelDelta,null,d)}d()}function w(){ULSEWi:;var c,b;this.Clear=function(){ULSEWi:;l()};this.AddInsertChange=function(b,a){ULSEWi:;g(b,a)};this.AddDeleteChange=function(b,a){ULSEWi:;f(b,a)};this.ApplyAllRowInsertChanges=function(a){ULSEWi:;d(g,c,a,false,false,true)};this.ApplyAllRowDeleteChanges=function(a){ULSEWi:;d(f,b,a,false,false,false)};this.UndoAllRowInsertChanges=function(a){ULSEWi:;d(f,c,a,true,true,false)};this.UndoAllRowDeleteChanges=function(a){ULSEWi:;d(g,b,a,true,true,true)};this.VacateChange=function(d){ULSEWi:;var a=SP.Internal.JS.BinarySearch(c,d,"version");a!=null&&c.splice(a,1);var a=SP.Internal.JS.BinarySearch(b,d,"version");a!=null&&b.splice(a,1)};this.AdvanceBaseline=function(){};this.GetChange=function(h,e,d,i){ULSEWi:;var a;if(e!=null){a=new SP.Utilities.Set;a.AddArray(e)}var g=k(c,h,a,d?SP.JsGrid.Internal.VersionManager.ChangeType.Delete:SP.JsGrid.Internal.VersionManager.ChangeType.Insert,i),f=k(b,h,a,d?SP.JsGrid.Internal.VersionManager.ChangeType.Insert:SP.JsGrid.Internal.VersionManager.ChangeType.Delete);return d?f.concat(g):g.concat(f)};function l(){ULSEWi:;c=[];b=[]}function k(c,j,g,f,i){ULSEWi:;var h=[],d=SP.Internal.JS.BinarySearch(c,j,"version");if(d!=null)for(var e=0;e<c[d].changes.length;e++){var a=c[d].changes[e];if(g==null||g.Contains(a.recordKey)){var b={type:f,recordKey:a.recordKey};if(f==SP.JsGrid.Internal.VersionManager.ChangeType.Insert){b.afterRecordKey=a.afterRecordKey;b.newOutlineLevel=a.newOutlineLevel}if(i)b.visualAfterRecordKey=a.visualAfterRecordKey==null?a.afterRecordKey:a.visualAfterRecordKey;h.push(b)}}return h}function d(m,b,j,g,i,k){ULSEWi:;var d=SP.Internal.JS.BinarySearch(b,j.GetVersionNumber(),"version");if(d!=null){var c=b[d].changes;if(!i)b[d]=new h(b[d].version);for(var f={},e=[],a=0;a<c.length;a++){f[c[a].recordKey]=c[a];e.push(c[a])}while(e.length>0)m(l(f,e),j,true,i,f)}function l(d,a){ULSEWi:;var b;if(k){b=g?a[a.length-1]:a[0];while(b.afterRecordKey in d)b=d[b.afterRecordKey];delete d[b.recordKey];for(var c=0;c<a.length;c++)if(b==a[c]){a.splice(c,1);break}}else b=g?a.pop():a.shift();return b}}function g(h,g,f,d,k){ULSEWi:;var b=g.GetVersionNumber();if(a>=b||f){var i=t(h,g,function(c){ULSEWi:;return j(c,f&&a<b?b:a)==1},k);i!=null&&!d&&e(c,b,i)}else!d&&e(c,b,h)}function f(h,m,l,k){ULSEWi:;var g=m.GetVersionNumber();if(a>=g||l){var d=s(h,m,function(b){ULSEWi:;return j(b,l&&a<g?g:a)==-1});if(d!=null){for(var f=new SP.Utilities.Set,c=0;c<d;c++)d[c].isbIsInView&&f.Add(d[c].recordKey);!f.IsEmpty()&&i(function(d,a){ULSEWi:;if(d)for(var c in a.recordKeys)f.Contains(c)&&f.Remove(c);if(f.IsEmpty())return false;for(var b=0;b<a.changes.length;b++)if(f.Contains(a.changes[b].afterRecordKey))a.changes[b].afterRecordKey=h.afterRecordKey;return true},g,false,true);if(!k)for(var c=0;c<d.length;c++)e(b,g,d[c])}}else!k&&e(b,g,h)}function j(c,b){ULSEWi:;var a=0;i(function(b,d){ULSEWi:;a=c in d.recordKeys?b?1:-1:a;return true},b,true,false);return a}function i(g,d,e,f){ULSEWi:;for(var a=0;a<b.length&&(f||b[a].version<=d)||a<c.length&&(f&&c[a].version<=d);a++){if(a<c.length&&(e||c[a].version>d))if(!g(true,c[a]))break;if(a<b.length&&(e||b[a].version>d))if(!g(false,b[a]))break}}function e(a,c,d){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c,"version");(b==a.length||a[b].version!=c)&&a.splice(b,0,h(c));var e=a[b];e.changes.push(d);e.recordKeys[d.recordKey]=null}function h(a){ULSEWi:;return {version:a,changes:[],recordKeys:{}}}l()}function v(){ULSEWi:;var b;this.Clear=function(){ULSEWi:;j()};this.GetChange=function(g,a,f){ULSEWi:;var e=[],c=a!=null?a:SP.Internal.JS.ConvertSetKeysToArray(b);for(var h in c){recordKey=c[h];d(recordKey,g,function(c,a){ULSEWi:;if(a.item!=null){var b=f?a.prevItem:a.item;e.push({type:SP.JsGrid.Internal.VersionManager.ChangeType.Prop,recordKey:recordKey,fieldKey:c,propUpdate:b.value,validationState:b.validationState==null?SP.JsGrid.ValidationState.Valid:b.validationState})}},true)}return e};this.TryReadPropForVersion=function(c,d,g){ULSEWi:;if(c in b&&d in b[c]){var a=e(b[c][d],g),f=a.item==null?a.prevItem:a.item;return f!=null?f.value:null}return null};this.ChangeKeys=function(a,c){ULSEWi:;b[c]=b[a];delete b[a]};this.GetEarliestChangeKeyForRecord=function(g){ULSEWi:;var a,c=b[g];if(c!=null)for(var h in c){var d=c[h],e=d[0].version!=f?d[0].version:d[1].version;a=a==null||e<a?e:a}return a};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;delete b[a]};this.MarkPropUpdateInvalid=function(h,j,f,c){ULSEWi:;var k=false,l=f.GetVersionNumber(),d=b[h][j];if(d!=null){var a=e(d,l);if(a.item!=null){if(a.item.validationState!=SP.JsGrid.ValidationState.Invalid){a.item.validationState=SP.JsGrid.ValidationState.Invalid;if(c!=null)a.item.optErrorMsg=c;i(h,j,a.item.value,f,SP.JsGrid.ValidationState.Invalid,false,null,c,g(d,a.idx,false))}k=true}}return k};this.AddPropChange=function(c,d,t,q,j,r){ULSEWi:;var p=t.GetVersionNumber(),w=p==f,k=null,h=null;if(!w){if(b[c]==null)b[c]={};var n=b[c][d];if(n==null){var v=y(c),u=null;if(v!=null)u=l(v,d);n=b[c][d]=[{version:f,value:u}]}var o=e(n,p);h=o.idx;if(o.item==null){m(c,d,q);var s={version:p,value:q};if(j!=SP.JsGrid.ValidationState.Valid)s.validationState=j;
if(r!=null)s.optErrorMsg=r;n.splice(h,0,s)}else k=o.item}else{var o=b[c]!=null&&b[c][d]!=null?e(b[c][d],p):null;if(o!=null){k=o.item;h=o.idx}}if(k!=null){k.value=q;if(j!=k.validationState)if(j==null||j==SP.JsGrid.ValidationState.Valid)delete k.validationState;else k.validationState=j}var n=h==null?null:b[c][d];a>=p&&(h==null||h==n.length-1||n[h+1].version>a)&&i(c,d,q,t,j,false,null,r,g(n,h,false))};function g(b,c,e){ULSEWi:;var d,a=e?c+1:c-1;if(a>=0&&a<b.length)d=b[a].value;return d}function l(b,a){ULSEWi:;var d=k.controller.GetPropType(b.key(),a),c=d&&SP.JsGrid.Internal.Property.GetUpdateTrackingMode(d,k.jsGridParams.tableViewParams.gridFieldMap[a]),f=b.HasDataValue(a)&&c!=SP.JsGrid.UpdateTrackingMode.PropLocalized?b.GetDataValue(a):SP.JsGrid.EmptyValue,e=b.HasLocalizedValue(a)&&c!=SP.JsGrid.UpdateTrackingMode.PropData?b.GetLocalizedValue(a):SP.JsGrid.EmptyValue;return new SP.JsGrid.Internal.PropertyUpdate(f,e)}function m(d,e,b){ULSEWi:;var a=k.controller.GetPropType(d,e),c=a&&a.GetUpdateTrackingMode&&a.GetUpdateTrackingMode();if(a!=null&&c!=null)if(c==SP.JsGrid.UpdateTrackingMode.PropLocalized&&b.data!=SP.JsGrid.EmptyValue)b.data=SP.JsGrid.EmptyValue;else if(c==SP.JsGrid.UpdateTrackingMode.PropData&&b.localized!=SP.JsGrid.EmptyValue)b.localized=SP.JsGrid.EmptyValue}this.ApplyChangesToRecord=function(e){ULSEWi:;e.key() in b&&d(e.key(),a,function(f,d){ULSEWi:;var j=b[e.key()][f],a=d.item==null?d.prevItem:d.item;if(a!=null&&e.GetProp(f)!=null){var h=SP.Internal.JS.LowerBound(c,d.version,"version");i(e.key(),f,a.value,c[h].key,a.validationState==null?SP.JsGrid.ValidationState.Valid:a.validationState,true,e,a.optErrorMsg,g(j,h,false))}},true)};this.VacateChange=function(c){ULSEWi:;for(var a in b)d(a,c,function(c,e){ULSEWi:;var d=b[a][c];if(d.length==2)h(a,c);else d.splice(e.idx,1)})};this.SynchronizeToChange=function(f,e){ULSEWi:;var j=f.GetVersionNumber(),h=e!=null?e:SP.Internal.JS.ConvertSetKeysToArray(b);for(var k in h){var c=h[k];d(c,j,function(h,e){ULSEWi:;var d=e.item==null?e.prevItem:e.item;d!=null&&d.version>a&&i(c,h,d.value,f,d.validationState==null?SP.JsGrid.ValidationState.Valid:d.validationState,false,null,d.optErrorMsg,g(b[c][h],e.idx,false))},true)}};this.RollBackChange=function(f,a){ULSEWi:;var h=f.GetVersionNumber(),e=a!=null?a:SP.Internal.JS.ConvertSetKeysToArray(b);for(var j in e){recordKey=e[j];d(recordKey,h,function(d,e){ULSEWi:;var a=b[recordKey][d][e.idx-1],f=SP.Internal.JS.LowerBound(c,a.version,"version"),h=c[f].key;i(recordKey,d,a.value,h,a.validationState==null?SP.JsGrid.ValidationState.Valid:a.validationState,false,null,a.optErrorMsg,g(b[recordKey][d],e.idx-1,true))})}};this.AdvanceBaseline=function(d){ULSEWi:;for(var c in b)for(var e in b[c]){for(var a=b[c][e],g=SP.Internal.JS.LowerBound(a,d,"version"),f=1;f<g;f++)a.shift();if(a.length==1)h(c,e);else a[0].version=d}};function j(){ULSEWi:;b={}}function h(a,c){ULSEWi:;delete b[a][c];if(SP.Internal.JS.IsAssocArrayEmpty(b[a]))delete b[a]}function d(h,i,g,f){ULSEWi:;var a=b[h];if(a!=null)for(var d in a){var c=e(a[d],i);(c.item!=null||f)&&g(d,c)}}function e(b,c){ULSEWi:;var a=SP.Internal.JS.LowerBound(b,c,"version"),e=b[a]!=null&&b[a].version==c?b[a]:null,d=a>0&&a<=b.length?b[a-1]:null;return {idx:a,item:e,prevItem:d}}j()}};SP.JsGrid.Internal.VersionManager.ChangeType={Insert:0,Level:1,Prop:2,Delete:3};SP.JsGrid.WebMethodDataSource=function(m,o,g,p,i,n){ULSEWi:;var a=this,d=null,s,r,b,f,c=null;this.recordFactory;this.tableCache;this.populatingWebMethod=m;this.initWebMethod=o;this.RefreshTableView=function(i,d,k){ULSEWi:;var f=new SP.JsGrid.JsGridControl.TableViewParameters,h=SP.JsGrid.DeserializationMode.TableView;return g[this.initWebMethod.name](e(this.initWebMethod,h),function(g){ULSEWi:;var e=new SP.JsGrid.Deserializer(g,h,b);c=e.recordKeyHash;if(!i){p.ClearTableView();a.tableCache.Clear()}j(e,f,true);d!=null&&d(f,e.additionalParams)},k)};this.RefreshRowView=function(i,d,j){ULSEWi:;var f=SP.JsGrid.DeserializationMode.RowView;return g[this.populatingWebMethod.name](e(this.populatingWebMethod,f),function(j){ULSEWi:;var e=new SP.JsGrid.Deserializer(j,f,b);c=e.recordKeyHash;var g=e.InitJsGridRowViewParams();!i&&a.tableCache.Clear();h(e,g);d!=null&&d(g,e.additionalParams)},j)};this.GetAutoFilterEntries=function(f,d,c){ULSEWi:;var a=SP.JsGrid.DeserializationMode.AutoFilter;return g[this.populatingWebMethod.name](e(this.populatingWebMethod,a,f),function(e){ULSEWi:;var c=new SP.JsGrid.Deserializer(e,a,b);d(c.autoFilterEntries)},c)};this.BeginFullLoad=function(i,h,l){ULSEWi:;var d=SP.JsGrid.DeserializationMode.Full;return g[this.initWebMethod.name](e(this.initWebMethod,d),function(g){ULSEWi:;var e=new SP.JsGrid.Deserializer(g,d);c=e.recordKeyHash;b=e.keyColumnName;f=e.InitJsGridParams(l);f.tableCache=a.tableCache=new SP.JsGrid.TableCache(q,k);a.tableCache.SetConvertAllBlobsToRecords(true);a.tableCache.SetKeepDataInBlobCache(false);a.tableCache.SetMaxRecordCount(1e3);j(e,f.tableViewParams,false);i(f,e.additionalParams)},h)};function j(c,d,e){ULSEWi:;e&&c.InitJsGridTableViewParams(d);if(b!=c.keyColumnName)b=c.keyColumnName;a.recordFactory=new SP.JsGrid.RecordFactory(c.gridFieldMap,b,n);h(c,d.rowViewParams)}function h(b){ULSEWi:;d!=null&&a.tableCache.ClearRecords(d);a.tableCache.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(b.data),b.data);d=b.viewDependentKeys;b.InitCellStyles(f.styleManager)}function e(h,e,d,f){ULSEWi:;var b=h.fnGenerateArgs(e),a=b.gridSerializerArgs==null?{}:b.gridSerializerArgs;if(a.PagingInfo==null)a.PagingInfo=GenerateXMLArray(f!=null?l(f):["FirstVisible:100"],"string");a.RequestType=e;if(c!=null)a.RememberedRecordKeyHash=c;if(d!=null)a.AutoFilterColumnKeys=GenerateXMLArray(d,"string");b.gridSerializerArgs=g(a);return b;function g(b){ULSEWi:;var c=[];for(var a in b)c.push("<",a,">",b[a],"</",a,">");return c.join("")}}function k(e,b){ULSEWi:;var f={};for(var c in b)if(b[c] in e){var d=e[b[c]];f[b[c]]=a.recordFactory.MakeRecord(d.data,d.localized)}return f}function q(k,f){ULSEWi:;function j(g){ULSEWi:;var a=new SP.JsGrid.Deserializer(g,SP.JsGrid.DeserializationMode.Slice,b);c=a.recordKeyHash;if(a.recordKeyOrderChanged){a=new SP.JsGrid.Deserializer(g,SP.JsGrid.DeserializationMode.RowView,b);var e=a.InitJsGridRowViewParams();h(a,e);i!=null&&i(e,a.additionalParams)}else if(a.viewDependentKeys!=null)d=d==null?a.viewDependentKeys:d.concat(a.viewDependentKeys);f([{data:a.data,keys:SP.Internal.JS.ConvertSetKeysToArray(a.data)}])}return g[a.populatingWebMethod.name](e(a.populatingWebMethod,SP.JsGrid.DeserializationMode.Slice,null,k),j,function(){ULSEWi:;f(null)})}function l(b){ULSEWi:;for(var c=[],a=0;a<b.length;a++)c.push(b[a].pos+","+b[a].count);return c}};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("jsgrid.js")function ULSEWi(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="JsGrid.js";return o;}
Type.registerNamespace("SP");Type.registerNamespace("SP.JsGrid");Type.registerNamespace("SP.JsGrid.Internal");Type.registerNamespace("SP.Internal");Type.registerNamespace("SP.Utilities");SP.JsGrid.Internal.ColumnConfigurationDialog=function(c,o,n,b,k){ULSEWi:;var r=false,a,f,e,i,g,d;function p(h,g){ULSEWi:;function e(){ULSEWi:;var b=[],d;this.InitFromColumnConfigGridData=function(g,i){ULSEWi:;for(var h=a.GetCheckSelectionManager().GetCheckedRecordKeys(),e=0;e<g.length;e++){var c=i.GetCachedRecord(g[e]),f=c.key() in h;d=d||f;b.push({fieldKey:c.key(),width:c.GetDataValue("ColWidth"),isVisible:f})}};this.InitFromCurrent=function(){ULSEWi:;for(var d=c.GetColumnArray(),a=0;a<d.length;a++)b.push({fieldKey:d[a].columnKey,width:d[a].width,isVisible:d[a].isVisible})};this.ApplyToCurrent=function(){ULSEWi:;var d=[];indicCol=c.GetColumnByKey(SP.JsGrid.RecordIndicatorCheckboxColumnKey);indicCol!=null&&d.push(indicCol);for(var a=0;a<b.length;a++){var e=c.GetColumnByKey(b[a].fieldKey);e.isVisible=b[a].isVisible;e.width=b[a].width;d.push(e)}return new SP.JsGrid.ColumnInfoCollection(d)};this.IsValidUpdate=function(){ULSEWi:;return d}}if(a.AnyErrors()){alert(SP.JsGrid.Res.columnConfigurationErrorsInGrid);return false}var d=new e,f=new e;d.InitFromColumnConfigGridData(h,g);if(!d.IsValidUpdate()){alert(SP.JsGrid.Res.invalidColumnConfigurationNoColumns);return false}f.InitFromCurrent();b.commandMgr.Execute({Apply:function(){ULSEWi:;k(d.ApplyToCurrent())},Undo:function(){ULSEWi:;k(f.ApplyToCurrent())}},"Column Configuration Update",SP.JsGrid.CommandManager.CommandType.Explicit);return true}function j(n,c){ULSEWi:;function m(){ULSEWi:;for(var b=new Array(c.view.length),a=0;a<b.length;a++)b[a]=c.view[a];return b}function l(b,e,f){ULSEWi:;for(var c=false,d=0;d<b.length;d++){a[e](b[0].keys[0],b[0].keys[b[0].keys.length-1],f||c);c=true}return c}var k=new SP.Utilities.Set;k.AddArray(a.GetSelectedRecordKeys());for(var d,f,b=0;b<c.view.length;b++)if(d==null&&k.Contains(c.view[b]))d=b;else if(d!=null&&f==null&&!k.Contains(c.view[b]))f=b-1;var e;if(d!=null)if(n&&d>0){e=m();SP.Internal.JS.MoveItemInArray(e,d-1,f==null?e.length-1:f)}else if(!n&&f!=null){e=m();SP.Internal.JS.MoveItemInArray(e,f+1,d)}if(e!=null){var p=a.GetSelectedRowRanges(),o=a.GetSelectedColumnRanges(),j=a.GetSelectedCellRanges(),q=a.GetTopRecordIndex();c.topViewIdx=q;c.view=e;a.SetRowView(c);var g=false;g=l(p,"SelectRowRangeByKey",g);g=l(o,"SelectColumnRangeByKey",g);for(var b=0;b<j.length;b++){var i=j[b].rowRange.keys,h=j[b].colRange.keys;a.SelectCellRangeByKey(i[0],i[i.length-1],h[0],h[h.length-1],g)}}}function m(d){ULSEWi:;d.tableCache=new SP.JsGrid.TableCache;for(var h=c.GetColumnArray(),j=[],i=[],k=new SP.JsGrid.RecordFactory(d.tableViewParams.gridFieldMap,"FieldKey"),g=[],f=[],e=0;e<h.length;e++){var b=h[e],a=b.columnKey;if(a!=SP.JsGrid.RecordIndicatorCheckboxColumnKey){j.push(a);i[a]=k.MakeRecord({FieldKey:a,ColWidth:b.width},{ColName:b.name,ColWidth:b.width.toString()},true);b.isVisible&&g.push(a);!b.isHidable&&f.push(a)}}d.tableCache.AddRecordsToCache(i);d.tableViewParams.checkSelectionCheckedRecordKeys=g;d.tableViewParams.checkSelectionCheckboxDisabledRecordKeys=f;d.tableViewParams.rowViewParams.view=j}function l(a){ULSEWi:;a.columns=new SP.JsGrid.ColumnInfoCollection([new SP.JsGrid.ColumnInfo(SP.JsGrid.Res.columnName,null,"ColName",170),new SP.JsGrid.ColumnInfo(SP.JsGrid.Res.columnWidth,null,"ColWidth",145)]);if(n)a.columns.GetColumnByKey("ColWidth").fnGetCellEditMode=function(a){ULSEWi:;return c.GetColumnByKey(a.key()).isResizable?SP.JsGrid.EditMode.ReadWrite:SP.JsGrid.EditMode.ReadOnly};else a.bEditingEnabled=false;a.gridFieldMap={FieldKey:new SP.JsGrid.GridField("FieldKey",true,false),ColName:new SP.JsGrid.GridField("ColName",false,true),ColWidth:new SP.JsGrid.GridField("ColWidth",true,true)};a.gridFieldMap["ColName"].SetEditMode(SP.JsGrid.EditMode.ReadOnly);a.gridFieldMap["ColName"].SetSingleValuePropType(SP.JsGrid.PropertyType.Utils.GetPropType("String"));var d=SP.JsGrid.Internal.Property.GetPropType("JSNumber"),b=SP.Internal.JS.object(d);b.ID="ColWidthJSNumber";b.BeginValidateNormalizeConvert=function(e,f,g,a,c,h){ULSEWi:;d.BeginValidateNormalizeConvert.apply(this,[e,f,g,a,b,h]);function b(a){ULSEWi:;a.isValid=a.isValid&&a.dataValue>0&&a.dataValue<=1e3;c(a)}};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(b,"JSNumber");a.gridFieldMap["ColWidth"].SetSingleValuePropType(b)}this.GetHeight=function(){ULSEWi:;return 360};this.GetWidth=function(){ULSEWi:;return 600};function h(b){ULSEWi:;try{a.Dispose()}catch(c){}$clearHandlers(f);$clearHandlers(e);$clearHandlers(i);$clearHandlers(g);$clearHandlers(d);b!=null&&b()}this.Close=function(){ULSEWi:;h()};this.Open=function(q,k){ULSEWi:;d=q;d.innerHTML='<div style="position:relative;overflow:auto;text-align:'+b.RTL.left+";padding:10px;height:"+(this.GetHeight()-20)+"px;width:"+(this.GetWidth()-20)+'px;"><table><tr><td><div id="'+b.gridId+'_ccGridParentElement" style="height:280px;width:400px;float:'+b.RTL.right+';"></div></td><td style="height:280px;padding-left:10px;vertical-align:middle;"><input id="'+b.gridId+'_ccUp" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.moveUp+'"><div style="height:15px;"></div><input id="'+b.gridId+'_ccDown" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.moveDown+'"></td></tr><tr style="padding-top:15px;"><td><input id="'+b.gridId+'_ccOK" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.ok+'" style="float:'+b.RTL.right+';"></td><td style="padding-left:10px;"><input id="'+b.gridId+'_ccCancel" class="ms-ButtonHeightWidth" type="button" value="'+SP.JsGrid.Res.cancel+'"></td></tr></table></div>';var n=$get(b.gridId+"_ccGridParentElement");f=$get(b.gridId+"_ccUp");e=$get(b.gridId+"_ccDown");f.disabled=e.disabled=!o;i=$get(b.gridId+"_ccOK");g=$get(b.gridId+"_ccCancel");a=new SP.JsGrid.JsGridControl(n,false);var c=new SP.JsGrid.JsGridControl.Parameters;c.name=SP.JsGrid.Res.columnConfigurationName;l(c.tableViewParams);m(c);c.tableViewParams.bEditingEnabled=true;c.tableViewParams.bRecordIndicatorCheckboxesEnabled=true;c.tableViewParams.operationalConstantsFieldKeyMap={};c.tableViewParams.bHidableColumns=false;c.tableViewParams.bSortableColumns=false;c.tableViewParams.bAutoFilterableColumns=false;c.tableViewParams.allowedSelectionTypes=SP.JsGrid.SelectionTypeFlags.SingleRowRange|SP.JsGrid.SelectionTypeFlags.SingleColRange|SP.JsGrid.SelectionTypeFlags.SingleCell;c.tableViewParams.messageOverrides={localizedConversionError:SP.JsGrid.Res.columnConfigurationInvalidColumnWidth};a.Init(c);setTimeout(function(){ULSEWi:;a.Focus()},0);$addHandler(f,"click",function(){ULSEWi:;j(true,c.tableViewParams.rowViewParams)});$addHandler(e,"click",function(){ULSEWi:;j(false,c.tableViewParams.rowViewParams)});$addHandler(i,"click",function(){ULSEWi:;if(p(c.tableViewParams.rowViewParams.view,c.tableCache))h(k);else a.Focus()});$addHandler(g,"click",function(){ULSEWi:;h(k)});$addHandler(d,"keydown",function(){ULSEWi:;var b=String.fromCharCode(event.keyCode).toUpperCase(),a=event.ctrlKey;if(a&&b=="Z")c.commandMgr.Undo();else a&&b=="Y"&&c.commandMgr.Redo()})}};SP.JsGrid.Internal.ColumnMenuManager=function(j,c,u,y,d){ULSEWi:;var k=this,h=u||{},f,g,x,a=j.delegateMgr,b=j.jsGridObj,q=false;function z(){ULSEWi:;c=c==null?{}:c;b.AttachEvent(SP.JsGrid.EventType.OnPropertyChanged,n);b.AttachEvent(SP.JsGrid.EventType.OnRecordInserted,o);b.AttachEvent(SP.JsGrid.EventType.OnRecordDeleted,p)}this.Dispose=function(){ULSEWi:;b.DetachEvent(SP.JsGrid.EventType.OnPropertyChanged,n);b.DetachEvent(SP.JsGrid.EventType.OnRecordInserted,o);b.DetachEvent(SP.JsGrid.EventType.OnRecordDeleted,p);q=true};this.SetAutoFilterState=function(a){ULSEWi:;c=a==null?{}:a;this.ClearCache()};this.SeedAutoFilterEntryCache=function(a){ULSEWi:;h=a||{}};this.ClearCache=function(){ULSEWi:;h={}};this.CanExpandMenu=function(b,f,e,c,d){ULSEWi:;return f||d||e&&a.DelegatePresent(SP.JsGrid.DelegateType.Sort)||c&&b.isAutoFilterable&&a.DelegatePresent(SP.JsGrid.DelegateType.GetAutoFilterEntries)&&a.DelegatePresent(SP.JsGrid.DelegateType.AutoFilter)&&a.DelegatePresent(SP.JsGrid.DelegateType.LaunchFilterDialog)||b.columnKey==SP.JsGrid.RecordIndicatorCheckboxColumnKey||a.DelegatePresent(SP.JsGrid.DelegateType.WillAddColumnMenuItems)&&a.Apply(SP.JsGrid.DelegateType.WillAddColumnMenuItems,columnKey)};this.ExpandMenu=function(n,o,A,C,B,z){ULSEWi:;var w=false;function u(){ULSEWi:;w=true;A()}var j=n.columnKey,k,y=SP.Internal.DomElement.GetLocation(b.parentNode);o.left-=y.x;o.top-=y.y;f=new SP.JsGrid.ContextMenu(b.parentNode,b.parentNode.id+"_columnmenuloading");g=k=new SP.JsGrid.ContextMenu(b.parentNode,b.parentNode.id+"_columnmenu");f.EnableCompactMode();g.EnableCompactMode();a.Apply(SP.JsGrid.DelegateType.AddColumnMenuItems,j,e,l);var p=false;if(C&&n.isHidable){i();e(d("HideColumn"),function(){ULSEWi:;b.HideColumn(j)},"/_layouts/Images/jsgrid-hide-column.png");p=true}!p&&i();s();if(B&&a.DelegatePresent(SP.JsGrid.DelegateType.Sort)&&n.isSortable){i();e(d("SortAsc"),function(){ULSEWi:;r(j,false)},"/_layouts/Images/sortaz.gif");e(d("SortDesc"),function(){ULSEWi:;r(j,true)},"/_layouts/Images/sortza.gif")}if(z&&n.isAutoFilterable&&a.DelegatePresent(SP.JsGrid.DelegateType.GetAutoFilterEntries)&&a.DelegatePresent(SP.JsGrid.DelegateType.AutoFilter)&&a.DelegatePresent(SP.JsGrid.DelegateType.LaunchFilterDialog)){i();e(d("ClearFilter"),function(){ULSEWi:;v(j)},"/_layouts/images/"+(j in c?"filteroff.gif":"filteroffdisabled.gif"),null,!(j in c));if(j in h)m(j);else{x=f.InsertMenuItem(d("LoadingMsg"),null,null,null,true);k=f;t(j,function(){ULSEWi:;if(!w&&!q){j in h&&m(j);f.SetOnMouseOut(null);f.Hide();g.Show(o,u)}})}}if(j==SP.JsGrid.RecordIndicatorCheckboxColumnKey){i();e(d("CheckAllRecords"),function(){ULSEWi:;b.GetCheckSelectionManager().CheckAllRecords()},null,null,false,false);e(d("ClearCheckedRecords"),function(){ULSEWi:;b.GetCheckSelectionManager().ClearCheckedRecords()},null,null,false,false)}!k.IsEmpty()&&k.Show(o,u);return !k.IsEmpty()};function s(){ULSEWi:;var a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(f){a="undefined"}var c=a&&SP.UI.ModalDialog.get_childDialog(),b=c&&c.get_url();(b==null||!document.URL.startsWith(b))&&e(d("ConfigureCols"),function(){ULSEWi:;j.paneMgr.ShowColumnConfigurationDialog()},"/_layouts/Images/configcolumns.png")}function m(b){ULSEWi:;function j(a){ULSEWi:;w(b,a.dataValue)}var f=h[b],k=c[b]===""?null:c[b];if(f.length!=0)for(var i=0;i<f.length;i++){var e=f[i];g.InsertMenuItem(e.displayString==null||e.displayString==""?SP.JsGrid.Res.autoFilterBlank:e.displayString,function(a){ULSEWi:;return function(){ULSEWi:;j(a)}}(e),null,null,false,b in c&&y[b].CompareSingleDataEqual(e.dataValue===""?null:e.dataValue,k))}else g.InsertMenuItem(d("FilterMenuItem"),function(){ULSEWi:;a.Apply(SP.JsGrid.DelegateType.LaunchFilterDialog,b)},"/_layouts/images/filter.gif")}function t(i,d){ULSEWi:;for(var f=j.jsGridObj.GetColumns(),e=[],b=0;b<f.length;b++){var g=f[b].columnKey;!(g in h)&&e.push(g)}a.Apply(SP.JsGrid.DelegateType.GetAutoFilterEntries,c,i,e,k,d);function k(a){ULSEWi:;for(var b in a)h[b]=a[b];d()}}function w(e,d){ULSEWi:;var b=SP.Internal.JS.CloneObj(c,false);b[e]=d;a.Apply(SP.JsGrid.DelegateType.AutoFilter,b);k.ClearCache()}function v(d){ULSEWi:;var b=SP.Internal.JS.CloneObj(c,false);delete b[d];a.Apply(SP.JsGrid.DelegateType.AutoFilter,b);k.ClearCache()}function n(a){ULSEWi:;delete h[a.fieldKey]}function o(){ULSEWi:;k.ClearCache()}function p(){ULSEWi:;k.ClearCache()}function e(h,a,e,b,c,d){ULSEWi:;f.InsertMenuItem(h,a,e,b,c,d);g.InsertMenuItem(h,a,e,b,c,d)}function l(){ULSEWi:;f.InsertSeparator();g.InsertSeparator()}function i(){ULSEWi:;!g.IsEmpty()&&l()}function r(c,b){ULSEWi:;a.Apply(SP.JsGrid.DelegateType.Sort,[{columnName:c,isDescending:b}])}z()};SP.JsGrid.CommandManager=function(o){ULSEWi:;var i=0,a=[],e=[],c=0,h=0,d=[],f=SP.JsGrid.CommandManager.CommandType,b,j,g=[];this.IsUndoEnabled=function(){ULSEWi:;return o>0};this.OpenGroup=function(){ULSEWi:;if(b)return;d.push([])};this.CloseGroup=function(f,g,c){ULSEWi:;if(b)return;var a=d.pop();if(a.length==0)return;var e=a.length==1?a[0]:new SP.JsGrid.CommandManager.AggregateCommand(a,c);m(e,f,g)};this.Execute=function(a,c,d){ULSEWi:;if(b){a.Apply();return}n();m(a,c,d);l();j=true;a.Apply();j=false};this.Undo=function(){ULSEWi:;if(i!=0||d.length>0||!c||b||j)return false;l();b=true;var g;do{g=a.pop();g.cmd.Undo();e.push(g)}while(g.type==f.Implicit);c--;h++;b=false;return true};this.Redo=function(){ULSEWi:;if(i!=0||d.length!=0||!h||b||j)return false;l();b=true;var g;do{g=e.pop();g.cmd.Apply();a.push(g)}while(g.type==f.Implicit);h--;c++;b=false;return true};this.CanUndo=function(){ULSEWi:;return c>0};this.CanRedo=function(){ULSEWi:;return h>0};this.GetUndoStack=function(){ULSEWi:;return a};this.GetRedoStack=function(){ULSEWi:;return e};this.ClearUndoStack=function(){ULSEWi:;p()};this.ClearRedoStack=function(){ULSEWi:;n()};this.Lock=function(){ULSEWi:;i++};this.Unlock=function(){ULSEWi:;i=Math.max(i-1,0)};this.AddPreExecuteNotifier=function(a){ULSEWi:;g.push(a)};this.RemovePreExecuteNotifier=function(c){ULSEWi:;for(var b=false,a=0;a<g.length;a++)if(g[a]==c){g.splice(a,1);a--;b=true;break}return b};function l(){ULSEWi:;for(var b=[].concat(g),a=0;a<b.length;a++)b[a]()}function p(){ULSEWi:;for(var b=0;b<a.length;b++)k(a[b].cmd,SP.JsGrid.CommandManager.DisposeState.Applied);a=[];c=0}function n(){ULSEWi:;if(e.length!=0){for(var a=e.length-1;a>=0;a--)k(e[a].cmd,SP.JsGrid.CommandManager.DisposeState.Unapplied);e=[];h=0}}function m(e,g,b){ULSEWi:;if(d.length!=0)d[d.length-1].push(e);else if(c!=0||b!=f.Implicit){a.push({cmd:e,name:g,type:b});c+=b!=f.Implicit?1:0;if(a.length>o){if(a[0].type!=f.Implicit)c--;k(a.shift().cmd,SP.JsGrid.CommandManager.DisposeState.Applied);while(a.length&&a[0].type==f.Implicit)k(a.shift().cmd,SP.JsGrid.CommandManager.DisposeState.Applied)}}}function k(a,b){ULSEWi:;a.Dispose!=null&&a.Dispose(b)}};SP.JsGrid.CommandManager.CommandType={Explicit:0,Implicit:1};SP.JsGrid.CommandManager.DisposeState={Applied:0,Unapplied:1};SP.JsGrid.CommandManager.AggregateCommand=function(b,a){ULSEWi:;this.cmdArray=b;this.bReverseOnUndo=a};SP.JsGrid.CommandManager.AggregateCommand.prototype={Apply:function(){ULSEWi:;for(var b=this.cmdArray.length,a=0;a<b;a++)this.cmdArray[a].Apply()},Undo:function(){ULSEWi:;var b=this.cmdArray.length,a;if(this.bReverseOnUndo)for(a=b-1;a>=0;a--)this.cmdArray[a].Undo();else for(a=0;a<b;a++)this.cmdArray[a].Undo()},Dispose:function(c){ULSEWi:;for(var d=this.cmdArray.length,a=0;a<d;a++){var b=this.cmdArray[a];b.Dispose!=null&&b.Dispose(c)}}};SP.JsGrid.DeserializationMode={Full:0,TableView:1,RowView:2,Slice:3,AutoFilter:4};SP.JsGrid.SelectionTypeFlags={NoRows:0,SingleRow:1,SingleRowRange:3,MultipleRowRanges:7,_RowMask:7,NoCols:0,SingleCol:8,SingleColRange:24,MultipleColRanges:56,_ColMask:56,NoCells:0,SingleCell:64,SingleCellRange:192,MultipleCellRanges:448,_CellMask:448};SP.JsGrid.LinkType={FinishFinish:0,FinishStart:1,StartFinish:2,StartStart:3};SP.JsGrid.ClickContext={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3,Gantt:4,Other:5};SP.JsGrid.SelectionType={None:0,CellRange:1,RowRange:2,ColumnRange:3};SP.JsGrid.EventType={OnCellFocusChanged:0,OnRowFocusChanged:1,OnCellEditBegin:2,OnCellEditCompleted:3,OnRightClick:4,OnPropertyChanged:6,OnRecordInserted:7,OnRecordDeleted:8,OnRecordChecked:9,OnCellErrorStateChanged:10,OnEntryRecordAdded:11,OnEntryRecordCommitted:13,OnEntryRecordPropertyChanged:14,OnRowErrorStateChanged:15,OnDoubleClick:16,OnBeforeGridDispose:17,OnSingleCellClick:18,OnInitialChangesForChangeKeyComplete:19,OnVacateChange:20,OnGridErrorStateChanged:21,OnSingleCellKeyDown:22};SP.JsGrid.Internal.EventType={OnRowHeaderStateChanged:0,OnGridDisposing:1,OnChangeKeyCreated:2,OnChangeKeyInitialUpdateFinished:3,OnBeforeRecordInserted:4,OnBeforeRecordDeleted:5};SP.JsGrid.DelegateType={ExpandColumnMenu:1,AddColumnMenuItems:2,Sort:3,Filter:4,InsertRecord:5,DeleteRecords:6,IndentRecords:7,OutdentRecords:8,IsRecordInsertInView:9,ExpandDelayLoadedHierarchyNode:10,AutoFilter:11,ExpandConflictResolution:12,GetAutoFilterEntries:13,LaunchFilterDialog:14,ShowColumnConfigurationDialog:15,GetRecordEditMode:16,GetGridRowStyleId:17,CreateEntryRecord:18,TryInsertEntryRecord:19,WillAddColumnMenuItems:20};SP.JsGrid.Internal.DelegateType={CallAsyncFn:0,GetLocalizedString:1,DoLargeTask:2};SP.JsGrid.Internal.LoadErrorState={};SP.JsGrid.OperationalConstants={HierarchyMain:0,HierarchyOutlineLevel:1,GroupingOutlineLevel:2,HierarchyDescendantCount:3,GroupingDescendantCount:4,GanttDependants:5,GanttBarStyleIds:6,GridRowStyleId:7,RecordEditMode:8};SP.JsGrid.Internal.MinColumnWidth=37;SP.JsGrid.Internal.RowHeaderWidth=25;SP.JsGrid.Internal.SplitterWidth=6;SP.JsGrid.RecordIndicatorCheckboxColumnKey="JsGridRecordIndicatorCheckboxes";SP.JsGrid.NewRowKeyPrefix="NewRowKey";SP.JsGrid.ErrorWidgetId="ErrorWidget";SP.JsGrid.RecordIndicatorControlId="DISP_RECORDINDICATORCHECKBOX";SP.JsGrid.HierarchyControlId="DISP_HIERARCHY";SP.JsGrid.TextDirection={Default:0,RightToLeft:1,LeftToRight:2};SP.JsGrid.PaneId={MainGrid:0,PivotedGrid:1,Gantt:2};SP.JsGrid.PaneLayout={GridOnly:0,GridAndGantt:1,GridAndPivotedGrid:2};SP.JsGrid.EditMode={ReadOnly:0,ReadWrite:1,ReadOnlyDefer:2,ReadWriteDefer:3,Defer:4};SP.JsGrid.GanttDrawBarFlags={LeftLink:1,RightLink:2};SP.JsGrid.GanttBarDateType={Start:0,End:1};SP.JsGrid.ValidationState={Valid:0,Pending:1,Invalid:2};SP.JsGrid.HierarchyMode={None:0,Standard:1,Grouping:2};SP.JsGrid.EditActorWriteType={Both:1,LocalizedOnly:2,DataOnly:3,Either:4};SP.JsGrid.EditActorReadType={Both:1,LocalizedOnly:2,DataOnly:3};SP.JsGrid.EditActorUpdateType={Committed:0,Uncommitted:1};SP.JsGrid.SortMode={Ascending:1,Descending:-1,None:0};SP.JsGrid.RowHeaderStyleId={Transfer:"Transfer",Conflict:"Conflict"};SP.JsGrid.RowHeaderAutoStyleId={Dirty:"Dirty",Error:"Error",NewRow:"NewRow"};SP.JsGrid.RowHeaderStatePriorities={Dirty:10,Transfer:30,CellError:40,Conflict:50,RowError:60,NewRow:90};SP.JsGrid.UpdateSerializeMode={Cancel:0,Default:1,PropDataOnly:2,PropLocalizedOnly:3,PropBoth:4};SP.JsGrid.UpdateTrackingMode={PropData:2,PropLocalized:3,PropBoth:4};SP.JsGrid.PostViewChangeType={Delete:4,Insert:5,Level:6};SP.JsGrid.ContextMenu=function(f,c){ULSEWi:;var b,a,e=0,d=[],g=this;this.GetMenuElement=function(){ULSEWi:;return a};this.EnableCompactMode=function(){ULSEWi:;a.setAttribute("CompactMode","true")};this.IsOpen=function(){ULSEWi:;return MenuHtc_isOpen(a)};this.IsEmpty=function(){ULSEWi:;return e==0};this.InsertMenuItem=function(g,h,k,f,i,j){ULSEWi:;d.push(h);var b=new SP.JsGrid.MenuItem(CAMOpt(a,g,c+"_onclick("+(d.length-1)+");",k,f!=null?f:g));b.Enable(!i);b.Check(j);e++;return b};this.InsertSeparator=function(){ULSEWi:;CAMSep(a)};this.Hide=function(){ULSEWi:;this.IsOpen()&&MenuHtc_hide()};this.SetOnMouseOut=function(b){ULSEWi:;a._onDestroy=function(){ULSEWi:;g.Dispose();b!=null&&b()}};this.Show=function(c,d){ULSEWi:;this.Hide();b.style.top=c.top+"px";b.style.left=c.left+"px";b.style.width=c.width+"px";b.style.height=c.height+"px";OMenu(a,b,false,false,0);NavigateToMenu(a);this.SetOnMouseOut(d)};this.Refresh=function(){ULSEWi:;this.IsOpen()&&OMenu(a,b,true,false,0)};this.Dispose=function(){ULSEWi:;this.Hide();a._onDestroy=null;if(b!=null&&SP.Internal.DomElement.GetParentElement(b)){b.parentNode.removeChild(b);b=null}if(a!=null&&SP.Internal.DomElement.GetParentElement(a)){a.parentNode.removeChild(a);a=null}window[c+"_onclick"]=null};function h(){ULSEWi:;a=CMenu(c);b=document.createElement("div");b.style.cssText="position:absolute;visibility:hidden";f.appendChild(b);window[c+"_onclick"]=function(a){ULSEWi:;setTimeout(d[a],0)}}h()};SP.JsGrid.MenuItem=function(a){ULSEWi:;this.Enable=function(b){ULSEWi:;a.setAttribute("enabled",b)};this.Check=function(b){ULSEWi:;a.setAttribute("checked",b)}};Type.registerNamespace("SP.JsGrid.DisplayControl");SP.JsGrid.DisplayControl=function(){ULSEWi:;function d(c,f,e,b,d){ULSEWi:;if(c==null)return null;var a=(new SP.JsGrid.Image(c,false)).Render(f,e);if(b)a.className=b;a.style.border="0px";return d?a:{elem:a,fnDispose:function(){ULSEWi:;if(a!=null&&a.Dispose!=null){a.Dispose();a=null}}}}function f(d,c,g,f,h){ULSEWi:;if(d==""||d==null||d==SP.JsGrid.EmptyValue||d==SP.JsGrid.InvalidValue)return null;var b=document.createElement("span"),a;if(c.fnClick!=null){a=document.createElement("a");a.style.cssText=h;b.appendChild(a);a.href="#";$addHandler(a,"click",function(a){ULSEWi:;c.fnClick(a)});$addHandler(a,"keydown",function(a){ULSEWi:;if(a.keyCode==Sys.UI.Key.enter){c.fnClick(a);SP.Internal.DomElement.StopEvent(a)}});a.tabIndex=-1}else a=b;SP.Internal.DomElement.SetTextNoBR(a,d);if(c.toolTip!=null)a.title=c.toolTip;if(f)b.className=f;if(g.textDirection!=SP.JsGrid.TextDirection.Default)b.dir=g.textDirection==SP.JsGrid.TextDirection.RightToLeft?"rtl":"ltr";var e=b;if(c.fnClick!=null)e={elem:b,fnDispose:function(){ULSEWi:;$clearHandlers(a);a=b=e=null}};return e}function e(d,e,c){ULSEWi:;var b=document.createElement("div");b.style.cssText="text-align:center";var a=document.createElement("input");a.type="checkbox";a.tabIndex=-1;b.appendChild(a);a.disabled=d;a.checked=e;if(c!=null){$addHandler(a,"mousedown",function(a){ULSEWi:;SP.Internal.DomElement.StopEvent(a)});$addHandler(a,"click",c)}b={elem:b};b.fnDispose=function(){ULSEWi:;b=null;$clearHandlers(a);a=null};return b}function a(e,c,f,b,g,a){ULSEWi:;if(b!=null&&b.bHyperlink)return function(){ULSEWi:;window.open(b.GetAddress(a))};var d=c.fnShouldLinkSingleValue!=null&&c.fnShouldLinkSingleValue(e,f.key,a,g)&&c.fnSingleValueClicked;return d?function(){ULSEWi:;d(e,f.key,a)}:null}function j(e,c,f,a,d){ULSEWi:;var b=c.fnGetSingleValueTooltip==null?null:c.fnGetSingleValueTooltip(e,f.key,d,a);return b==null?a:b}function b(e,d,f,g,b,c){ULSEWi:;var i=j(e,d,f,b,c),h=a(e,d,f,g,b,c);return {toolTip:i,fnClick:h}}function h(k,i,l,h,e,g,j,f){ULSEWi:;var a=b(k,i,l,h,e,g),c=d(j,a.toolTip,a.fnClick,f);return c==null?[]:[c]}function i(l,k,d,j,a,i,m,h,e){ULSEWi:;var g=b(l,k,d,j,a,i),c=f(a,g,d,h,e);return c==null?[]:[c]}function g(p,n,j,m,e,l,o,g,k){ULSEWi:;var a=b(p,n,j,m,e,l),h=d(o,a.toolTip,a.fnClick,g),i=f(e,a,j,g,k),c=[];h!=null&&c.push(h);i!=null&&c.push(i);return c}function c(d,g,k,l,a,p,h,m,o,i){ULSEWi:;var c=[],f=a.GetImageSource?a.GetImageSource(g,d.data):null,j=o.bEnabled?"jsgrid-control-text-rtl":"jsgrid-control-text";if(a.bMultiValue)for(var e=a.LocStrToLocStrArray(d.localized),b=0;b<e.length;b++){var n=b<e.length-1&&m?e[b]+a.separator:e[b];c=c.concat(h(g,k,l,a.singleValuePropType,n,d.data?d.data[b]:null,f?f[b]:null,j,i))}else c=h(g,k,l,a,d.localized,d.data,f,j,i);return c.length==1?c[0]:c.length==0?null:{multipleChildren:c}}return {ImageDisplayControl:{Id:"DISP_IMAGE",Render:function(g,d,b,e,a,f,j,i){ULSEWi:;return c(g,d,b,e,a,f,h,false,i)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},ImageTextDisplayControl:{Id:"DISP_IMAGETEXT",_styleForLinks:null,Render:function(h,d,b,e,a,f,j,i){ULSEWi:;return c(h,d,b,e,a,f,g,true,i,this._styleForLinks)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},TextDisplayControl:{Id:"DISP_TEXT",_styleForLinks:null,Render:function(g,d,b,e,a,f,j,h){ULSEWi:;return c(g,d,b,e,a,f,i,true,h,this._styleForLinks)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)},OnKeyDown:function(b,e,h,g,i,c){ULSEWi:;if(c.bMultiValue)return false;var f=b.ctrlKey&&!b.altKey&&!b.shiftKey;if(f&&b.keyCode==Sys.UI.Key.enter){var d=a(h,g,i,c,e.localized,e.data);if(d!=null){d(b);SP.Internal.DomElement.StopEvent(b);return true}}return false}},CheckboxDisplayControl:{Id:"DISP_CHECKBOX",Render:function(d,c,f,g,b,h,a){ULSEWi:;return a.IsGroupingRecordKey(c.key())?null:e(false,b.GetBool(d.data),null)},FocusNext:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)},FocusPrevious:function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}},RecordIndicatorCheckboxControl:function(f,a,d,b,c){ULSEWi:;this.Id=f+SP.JsGrid.RecordIndicatorControlId;this.Render=function(n,h){ULSEWi:;var f=h.key();function g(){ULSEWi:;a(f)}return d(f)?null:e(b(f),c(f),g)};this.OnKeyDown=function(b,g,c){ULSEWi:;if(b.keyCode==Sys.UI.Key.space||b.charCode==Sys.UI.Key.space){a(c.key());SP.Internal.DomElement.StopEvent(b);return true}return false};this.FocusNext=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)};this.FocusPrevious=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}},HierarchyDisplayControl:function(k,m,c,f,e,i,h){ULSEWi:;var b=SP.JsGrid.Internal.HierarchyManager.NodeType,g=13,l=4,j=4;this.Id=k+SP.JsGrid.HierarchyControlId;this.Render=function(A,o,q,r,y,w,x,s){ULSEWi:;var p=o.key(),k=c(o),z=k.nodeType==b.Expanded?"/_layouts/Images/minus.gif":k.nodeType==b.Collapsed?"/_layouts/Images/plus.gif":null,a=i(q,o,r.key,w,h(q,o,r.key));if(k.nodeType!=b.Leaf){var l=d(k.nodeType==b.Expanded?"/_layouts/Images/minus.gif":"/_layouts/Images/plus.gif",String.format(k.nodeType==b.Expanded?SP.JsGrid.Res.hierarchyExpanded:SP.JsGrid.Res.hierarchyCollapsed,(k.indent+1).toString()),k.nodeType==b.Expanded?t:u,null,true);l.style["margin"+s.Left]=g*k.indent+j+"px";l.width=9;l.height=9;var n=[{elem:l,fnDispose:v}];if(a!=null&&a.multipleChildren!=null)n=n.concat(a.multipleChildren);else a!=null&&n.push(a);return {multipleChildren:n}}else{if(a!=null){var m=a.multipleChildren!=null?a.multipleChildren[0]:a;if(m.elem!=null)m=m.elem;m.style["margin"+s.Left]=g*(k.indent+1)+"px"}return a}function v(){ULSEWi:;l.Dispose!=null&&l.Dispose();l=null;m=null;n=null}function u(){ULSEWi:;f(p)}function t(){ULSEWi:;e(p)}};this.OnKeyDown=function(d,j,g,m,n,i){ULSEWi:;function h(h){ULSEWi:;var a=c(g);if(h&&a.nodeType==b.Collapsed)f(g.key());else!h&&a.nodeType==b.Expanded&&e(g.key());SP.Internal.DomElement.StopEvent(d)}function k(){ULSEWi:;if(i.bMultiValue)return false;var c=d.ctrlKey&&!d.altKey&&!d.shiftKey;if(c&&d.keyCode==Sys.UI.Key.enter){var b=a(g,m,n,i,j.localized,j.data);if(b!=null){b(d);SP.Internal.DomElement.StopEvent(d);return true}}return false}var l=!d.ctrlKey&&d.altKey&&d.shiftKey;if(l)if(d.keyCode==SP.Internal.Key.plus||d.keyCode==SP.Internal.Key.numpad_plus){h(true);return true}else if(d.keyCode==SP.Internal.Key.minus||d.keyCode==SP.Internal.Key.numpad_minus){h(false);return true}return k()};this.FocusNext=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,true)};this.FocusPrevious=function(a,b){ULSEWi:;return SP.JsGrid.Utility.FocusElementInDOMCollection(a,b,false)}}}}();SP.JsGrid.DisplayControl.Type={Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX"};Type.registerNamespace("SP.JsGrid.EditControl");SP.JsGrid.EditControl={ProxyControl:function(a){ULSEWi:;var b=SP.Internal.JS.object(a),g=false,d=false,c=false,e=false;function f(){ULSEWi:;e=true}b.Dispose=function(){ULSEWi:;e=false;a.Dispose.apply(this,arguments)};b.BindToCell=function(){ULSEWi:;d=true;a.BindToCell.apply(this,arguments)};b.Unbind=function(){ULSEWi:;d=false;a.Unbind.apply(this,arguments)};b.OnBeginEdit=function(){ULSEWi:;c=true;a.OnBeginEdit.apply(this,arguments)};b.OnEndEdit=function(){ULSEWi:;c=false;a.OnEndEdit.apply(this,arguments)};f();return b},EditBoxEditControl:function(c,f){ULSEWi:;var n="jsgrid_editbox",a,k=this,l=c.parentNode,d=f!=null,e=false,b;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;function m(){ULSEWi:;if(d)a=f;else{a=document.createElement("input");a.id=n;a.type="text";a.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;";a.className="jsgrid-control-editbox";a.tabIndex=-1;l.appendChild(a)}a.style.direction=c.RTL.ltr}this.Dispose=function(){ULSEWi:;!d&&$clearHandlers(a)};this.Focus=function(e){ULSEWi:;try{if(e==null){a.focus();a.value=a.value}else if(d){c.OnActivateActor();(e.type=="mousedown"||e.type=="keydown"&&e.keyCode==SP.Internal.Key.F2)&&f()}else{a.focus();if(e.type=="mousedown"||e.type=="keydown"&&e.keyCode==SP.Internal.Key.F2)f();else if(SP.JsGrid.Utility.IsChar(e)){a.value=String.fromCharCode(e.charCode);b.SetCurrentValue({localized:a.value})}}}catch(g){}function f(){ULSEWi:;var c=b.originalValue.localized;a.value=c==null||c==SP.JsGrid.EmptyValue?"":c}};this.BindToCell=function(c){ULSEWi:;b=c;i();if(b.field.textDirection!=SP.JsGrid.TextDirection.Default)a.style.direction=b.field.textDirection==SP.JsGrid.TextDirection.RightToLeft?"rtl":"ltr";a.value=""};this.OnBeginEdit=function(c){ULSEWi:;b.Show(a);e=true;g(true);if(c.type=="mousedown"&&!d)setTimeout(function(){ULSEWi:;k.Focus(c)},0);else k.Focus(c)};this.Unbind=function(){ULSEWi:;a.value=""};this.OnEndEdit=function(){ULSEWi:;var c=b.originalValue.localized;c=c==null||c==SP.JsGrid.EmptyValue?"":c;a.value!=c&&b.SetCurrentValue({localized:a.value});g(false);b.Hide(a);e=false};this.OnCellMove=function(){ULSEWi:;i();e&&b.Show(a)};this.OnValueChanged=function(b){ULSEWi:;a.value=b.localized==null||b.localized==SP.JsGrid.EmptyValue?"":b.localized};function g(b){ULSEWi:;if(b){$addHandler(a,"focus",c.OnActivateActor);$addHandler(a,"blur",c.OnDeactivateActor);!d&&$addHandler(a,"keydown",c.OnKeyDown);$addHandler(a,"keyup",j);$addHandler(a,"mousedown",h)}else{$removeHandler(a,"focus",c.OnActivateActor);$removeHandler(a,"blur",c.OnDeactivateActor);!d&&$removeHandler(a,"keydown",c.OnKeyDown);$removeHandler(a,"keyup",j);$removeHandler(a,"mousedown",h)}}function j(){ULSEWi:;b.SetCurrentValue({localized:a.value})}function i(){ULSEWi:;a.style.width=b.cellWidth-8+"px";a.style.height=b.cellHeight-4+"px"}function h(a){ULSEWi:;a.stopPropagation()}m()},ComboBoxEditControl:function(c){ULSEWi:;var p="jsgrid_combobox",b,d,i=this,k="sentinel",g,j,n=c.parentNode,a,t=true,h,l=[],e;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;function x(){ULSEWi:;d=document.createElement("div");d.id=p;d.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;left:0px;background-color:transparent;";d.style.direction=c.RTL.ltr;n.appendChild(d)}this.Dispose=function(){ULSEWi:;n.removeChild(d)};this.BindToCell=function(g){ULSEWi:;a=g;var e=new SP.UI.ComboBox.SPComboInfo;e.set_itemFocusCallback(r);e.set_multipleSelect(a.propType.bMultiValue);e.set_allowMultiEdits(true);e.set_limitToList(a.propType.bMultiValue||a.propType.GetIsLimitedToList!=null&&a.propType.GetIsLimitedToList());e.set_RTL(c.RTL.bEnabled);e.set_getDataCallback(w);e.set_separatorCharacters(a.propType.separator+" ");e.set_columnCount(2);e.set_columnWidths("0px;1px");e.set_expandSpace(a.cellExpandSpace);e.set_listMaxWidth(200);b=SP.UI.ComboBox.ComboBox.createComboBox(p,k,e);e.set_dropdownStateCallback(q);b.add_valueUpdatedEvent(u);b.add_focusEvent(c.OnActivateActor);b.add_blurEvent(c.OnDeactivateActor);m();f(a.originalValue);$addHandler(d,"keydown",o)};this.Unbind=function(){ULSEWi:;i.OnEndEdit();$removeHandler(d,"keydown",o);a.Hide(d);h=false;b.dispose();while(l.length>0)l.shift()();e=null};this.Expand=function(){ULSEWi:;b.openDropdown();b.get_focusElement().focus()};this.Collapse=function(){ULSEWi:;b.closeDropdown()};this.OnBeginEdit=function(a){ULSEWi:;if(a!=null)if(SP.JsGrid.Utility.IsChar(a)){j=true;i.Expand();b.set_displayText(String.fromCharCode(a.charCode))}else if(a.type=="keydown")if(a.keyCode==SP.Internal.Key.F2){i.Expand();b.set_displayText(b.get_displayText())}else if(a.keyCode==SP.Internal.Key.IMEInput){i.Expand();b.set_displayText("")}};this.OnEndEdit=function(){ULSEWi:;b.commit();b.closeDropdown()};this.OnCellMove=function(){ULSEWi:;b.closeDropdown();m()};this.OnValueChanged=function(a){ULSEWi:;f(a)};function m(){ULSEWi:;d.style.width=a.cellWidth+"px";d.style.height=a.cellHeight+"px";b.get_comboInfo().set_listMaxWidth(Math.max(200,a.cellWidth));a.Show(d);b.notifySetLayout()}function o(d){ULSEWi:;if(d.keyCode==Sys.UI.Key.esc){g=true;setTimeout(function(){ULSEWi:;c.OnKeyDown(d);b.set_currentValue(k);f(a.originalValue);g=false},0)}else c.OnKeyDown(d)}function u(){ULSEWi:;if(g)return;var b=s();if(b){a.SetCurrentValue(b);h=true}}function q(b){ULSEWi:;if(g)return;t=!b;c.bLightFocus=!b;if(b)a.NotifyExpandControl();else if(h){a.NotifyEditComplete();h=false}}function r(b,c){ULSEWi:;var a;if(b!=null){a=b.childNodes[b.childNodes.length-1].firstChild;a.style.backgroundColor=a.origBackgroundColor||""}if(c!=null){a=c.childNodes[c.childNodes.length-1].firstChild;var d=a.origBackgroundColor?SP.JsGrid.Internal.Color.HexStringToColor(a.origBackgroundColor):SP.JsGrid.Internal.Color.MakeColor(1,1,1),e=SP.JsGrid.Internal.Color.MakeAlphaColor(.4,.55,.69,.87);a.style.backgroundColor=SP.JsGrid.Internal.Color.ColorToHexString(SP.JsGrid.Internal.Color.RemoveAlphaChannel(SP.JsGrid.Internal.Color.AlphaBlend(e,d)))}}function v(b,d){ULSEWi:;var c={};if(b.HasDataValue(d))c.data=b.GetData(d);if(b.HasLocalizedValue(d))c.localized=b.GetLocalized(d);if(b.propType!=null&&b.propType.GetDisplayValue!=null)c.localized=b.propType.GetDisplayValue(a.record,c.data,c.localized);return c}function w(b){ULSEWi:;e=[];a.propType.GetItems(g);function d(a,b){ULSEWi:;if(a.fnDispose!=null){l.push(a.fnDispose);a=a.elem}b.appendChild(a)}function g(m){ULSEWi:;if(m==null)b(null,null,false,true);else{var i=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(a.propType);if(a.propType.IsComboBoxTextOnly)i=SP.JsGrid.Internal.Property.GetDisplayControl(SP.JsGrid.DisplayControl.Type.Text);else if(i.Id==SP.JsGrid.DisplayControl.Type.Image)i=SP.JsGrid.Internal.Property.GetDisplayControl(SP.JsGrid.DisplayControl.Type.ImageText);for(var s=a.propType.singleValuePropType||a.propType,o=[],q=[],l=0;l<m.length;l++){var k=v(m[l],a.fieldKey),p=document.createElement("div"),g=document.createElement("div");g.style.cssText="white-space:nowrap;padding:4px";p.appendChild(g);var h=i.Render(k,a.record,a.column,a.field,s,{},c.jsGridObj,c.RTL);if(h!=null)if(h.multipleChildren!=null){c.RTL.bEnabled&&h.multipleChildren.reverse();for(var n=0;n<h.multipleChildren.length;n++)d(h.multipleChildren[n],g)}else d(h,g);if(a.propType.GetStyleId!=null){var r=a.propType.GetStyleId(k.data);if(r!=null){SP.JsGrid.Style.ApplyCellStyle(g,c.styleManager.GetCellStyle(r));g.origBackgroundColor=SP.Internal.DomElement.GetComputedStyle(g,"backgroundColor","background-color")}}e.push(k);o.push([l+1,k.localized]);q.push([document.createElement("div"),p])}b(o,q,false,false)}if(!j)f(a.originalValue);else j=false}}function s(){ULSEWi:;var c=b.get_currentValue();if(c==k)return null;if(a.propType.bMultiValue){if(c!=null);for(var i=[],g=[],h=c.split(";#"),f=0;f<h.length;f++){var d=h[f];if(d!=""){i.push(e[d-1].data);g.push(e[d-1].localized)}}return {data:i,localized:g.join(a.propType.separator)}}else if(c==null||c==""){var j=b.get_displayText();return {localized:j}}else{var d=c;return {data:e[d-1].data,localized:e[d-1].localized}}}function f(c){ULSEWi:;if(e==null){b.set_displayText(c.localized==null?"":c.localized);return}var h=[],d=c.data!=SP.JsGrid.EmptyValue,l=a.propType.bMultiValue?a.propType.singleValuePropType:a.propType,f;if(a.propType.bMultiValue){var g=d?c.data:a.propType.LocStrToLocStrArray(c.localized);if(g!=null)for(var i=0;i<g.length;i++)h.push(j(g[i]))}else{var k=j(d?c.data:c.localized);if(k!=null)h.push(k);else f=c.localized}b.set_currentValue(h.join(";#"));f!=null&&b.set_displayText(f);function j(a){ULSEWi:;var b;if(a!=null)b=SP.Internal.JS.FindInArray(e,d?f:c);return b==null?null:b+1;function f(b){ULSEWi:;var c=l.IsDataEqual;return c==null?b.data==a:c(b.data,a)}function c(b){ULSEWi:;return b.localized==a}}}x()},CheckboxEditControl:function(d){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.DataOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.DataOnly;var l=this,j=d.parentNode,b,c,a,g=false,e=null,h=false;function k(){ULSEWi:;d.bLightFocus=true;c=document.createElement("div");c.style.cssText="position:absolute;top:0px;left:0px;visibility:hidden;text-align:center;background-color:#ffffff;";j.appendChild(c);a=document.createElement("input");a.type="checkbox";a.tabIndex=-1;c.appendChild(a);$addHandler(a,"focus",d.OnActivateActor);$addHandler(a,"blur",d.OnDeactivateActor);$addHandler(document.body,"mouseup",function(i){ULSEWi:;if(g&&!h&&e!=null){var d=SP.Internal.DomElement.GetLocation(a),c=SP.Internal.DomElement.GetEventLocation(i);if(SP.Internal.DomElement.PointInDomElem(c.x,c.y,a,d)&&SP.Internal.DomElement.PointInDomElem(e.x,e.y,a,d)){a.checked=!b.propType.GetBool(b.originalValue.data);f()}}h=false});$addHandler(document.body,"mousedown",function(b){ULSEWi:;var a=SP.Internal.DomElement.GetEventLocation(b);e={x:a.x,y:a.y}});$addHandler(c,"mousedown",function(){ULSEWi:;h=true});$addHandler(c,"focus",function(){ULSEWi:;a.focus()})}this.Dispose=function(){ULSEWi:;$clearHandlers(c);$clearHandlers(a);j.removeChild(c)};this.BindToCell=function(c){ULSEWi:;b=c;g=true;i();a.checked=b.propType.GetBool(b.originalValue.data);$addHandler(a,"keydown",d.OnKeyDown);$addHandler(a,"click",f)};this.OnCellMove=function(){ULSEWi:;i()};function i(){ULSEWi:;c.style.width=b.cellWidth+"px";var d=Math.floor((b.cellHeight-a.clientHeight)/2);c.style.padding=d+"px 0px 0px 0px";c.style.height=b.cellHeight-d+"px";b.Show(c)}this.Unbind=function(){ULSEWi:;g=false;$removeHandler(a,"keydown",d.OnKeyDown);$removeHandler(a,"click",f);b.Hide(c)};this.OnEndEdit=function(){};this.OnValueChanged=function(){ULSEWi:;a.checked=b.propType.GetBool(b.originalValue.data)};this.OnKeyDown=function(b){ULSEWi:;if(b.keyCode==Sys.UI.Key.space||b.charCode==Sys.UI.Key.space){a.checked=!a.checked;f();SP.Internal.DomElement.StopEvent(b);return true}return false};this.OnBeginEdit=function(){ULSEWi:;a.focus()};this.OnEndEdit=function(){};function f(){ULSEWi:;b.SetCurrentValue({data:a.checked});b.NotifyEditComplete()}k()}};SP.JsGrid.EditControl.Type={EditBox:"EDIT_EDITBOX",ComboBox:"EDIT_COMBOBOX",Checkbox:"EDIT_CHECKBOX"};Type.registerNamespace("SP.JsGrid.WidgetControl");SP.JsGrid.WidgetControl={DemoWidget:function(d){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;var g=this,e=d.parentNode,b,a,c;function f(){ULSEWi:;a=document.createElement("div");a.id="mainDiv";a.style.cssText="position:absolute; top:0px;left:0px; visibility:hidden; font-size:10; background-color:#ffffff; line-height:100px; border:4px solid:#333333; height:100px; width:200px; overflow-x:hidden;";e.appendChild(a)}this.Dispose=function(){ULSEWi:;$clearHandlers(a);e.removeChild(a)};this.BindToCell=function(d){ULSEWi:;b=d;a.innerText=b.originalValue.localized==SP.JsGrid.EmptyValue?"":b.originalValue.localized;c=a.offsetHeight};this.Unbind=function(){};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error")).Render(SP.JsGrid.Res.openErrorWidget)};this.Collapse=function(){ULSEWi:;a.style.visibility="hidden";b.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;b.NotifyExpandWidget();var e=b.cellRect;a.style.top=(b.cellExpandSpace.bottom>c||b.cellExpandSpace.top<c?e.y+e.height+3:e.y-c-3)+"px";a.style.left=e.x-(d.RTL.bEnabled?a.offsetWidth-e.width:2)+"px";a.style.visibility=""};this.OnValueChanged=function(b){ULSEWi:;a.innerText=b.localized};f()},ErrorWidget:function(e,i){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var g=SP.JsGrid.ErrorWidgetId,k=this,h=e.parentNode,b,a,c,f,d;function j(){ULSEWi:;e.bLightFocus=true;a=document.createElement("div");a.id=g+"_mainDiv";a.style.cssText="z-index:1;visibility:hidden; font-size:10; position:absolute; top:0px;left:0px; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important";h.appendChild(a);c=document.createElement("input");c.id=g+"_focuselem";c.style.cssText="position:fixed;top:0px;left:-10px;height:0px;width:0px;";c.setAttribute("role","presentation");a.appendChild(c);f=document.createElement("span");f.id=g+"_errorSpan";a.appendChild(f)}this.Dispose=function(){ULSEWi:;h.removeChild(a)};this.BindToCell=function(c){ULSEWi:;b=c;$addHandler(a,"keydown",e.OnKeyDown)};this.Unbind=function(){ULSEWi:;$clearHandlers(a)};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error")).Render(SP.JsGrid.Res.openErrorWidget)};this.Collapse=function(){ULSEWi:;a.style.visibility="hidden";b.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;SP.Internal.DomElement.SetText(f,i.GetMessageForCell(b.record.key(),b.fieldKey));d=a.offsetHeight;var g=b.cellRect;a.style.top=(b.cellExpandSpace.bottom>d||b.cellExpandSpace.top<d?g.y+g.height+3:g.y-d-3)+"px";a.style.left=g.x-(e.RTL.bEnabled?a.offsetWidth-g.width:2)+"px";b.NotifyExpandWidget();a.style.visibility="";c.focus()};this.OnValueChanged=function(){};j()},DateWidget:function(h){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=SP.JsGrid.EditActorReadType.LocalizedOnly;var e=h.parentNode,c,a,d,b,g=200,k=this,f;function l(){ULSEWi:;a=document.createElement("input");a.id="datewidgetinput-"+e.id;a.style.cssText="display:none;position:absolute;top:0px;left:0px";a.onvaluesetfrompicker=j;a.tabIndex=-1;e.appendChild(a);d=document.createElement("div");d.id=a.id+g_strDatePickerImageID;d.style.cssText="position:absolute;background:transparent;visibility:hidden;height:0px;z-index:-1";e.appendChild(d);b=document.createElement("iframe");b.id=a.id+g_strDatePickerFrameID;b.src="/_layouts/images/blank.gif";b.frameBorder="0";b.scrolling="no";b.title=SP.JsGrid.Res.calendarTitle;b.style.cssText="display:none;position:absolute;width:200px;z-index:1";b.tabIndex=-1;e.appendChild(b);if(window.g_strDateTimeControlIDs==null)g_strDateTimeControlIDs=[];g_strDateTimeControlIDs["JsGridDatePicker"]=a.id}this.Dispose=function(){ULSEWi:;a.onvaluesetfrompicker=null;e.removeChild(a);e.removeChild(d);e.removeChild(b)};this.BindToCell=function(a){ULSEWi:;c=a;f=c.originalValue.localized==SP.JsGrid.EmptyValue?"":c.originalValue.localized};this.Unbind=function(){ULSEWi:;f=null};this.Expand=function(){ULSEWi:;var e=c.cellRect;if(e!=null){d.style.width=e.width+"px";d.style.top=(c.cellExpandSpace.bottom>g||c.cellExpandSpace.top<g?e.y+e.height+3:e.y-g-3)+"px";d.style.left=e.x-(h.RTL.bEnabled?d.offsetWidth-e.width:2)+"px";d.style.visibility="";a.value=f!=null?f:"";c.NotifyExpandWidget();clickDatePicker(a.id,i(),a.value);var j=b.resultfunc;b.resultfunc=function(a){ULSEWi:;a==null&&c.NotifyEditComplete(true);k.Collapse();j(a)}}};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/calendar.gif")).Render(SP.JsGrid.Res.openCalendar)};this.Collapse=function(){ULSEWi:;b.style.display="none";c.NotifyCollapseWidget()};this.OnValueChanged=function(a){ULSEWi:;f=a.localized};function j(){ULSEWi:;c.SetCurrentValue({localized:a.value});c.NotifyEditComplete()}function i(){ULSEWi:;return [SP.Utilities.Utility.getLayoutsPageUrl("iframe.aspx?"),"&cal=",_spRegionalSettings.calendarType,"&lcid=",_spRegionalSettings.localeId,"&langid=",_spPageContextInfo.currentLanguage,"&tz=",_spRegionalSettings.timeZoneOffset,"&ww=",_spRegionalSettings.workDays,"&fdow=",_spRegionalSettings.firstDayOfWeek,"&fwoy=",_spRegionalSettings.firstWeekOfYear,"&hj=",_spRegionalSettings.adjustHijriDays,"&swn=",_spRegionalSettings.showWeeks,"&minjday=109207","&maxjday=2666269","&date="].join("")}l()},AddressBookWidget:function(){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var b,f=this,a;function d(){}this.Dispose=function(){};this.BindToCell=function(a){ULSEWi:;_cellContext=a;b=_cellContext.originalValue.localized==SP.JsGrid.EmptyValue?"":_cellContext.originalValue.localized};this.Unbind=function(){};this.Expand=function(){ULSEWi:;_cellContext.NotifyExpandWidget();var e=(_cellContext.propType.bMultiValue?_cellContext.propType.singleValuePropType:_cellContext.propType).GetPeoplePickerUrl,d=e(_cellContext.fieldKey),b="resizable: yes; status: no; scroll: no; help: no; center: yes; dialogWidth: 575px; dialogHeight: 500px;";commonShowModalDialog(d,b,c);a=true};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/addressbook.gif")).Render(SP.JsGrid.Res.openAddressBook)};this.Collapse=function(){};this.OnValueChanged=function(a){ULSEWi:;b=a.localized==SP.JsGrid.EmptyValue?"":a.localized};function c(e){ULSEWi:;a=false;if(e==null)_cellContext.NotifyEditComplete(true);else{for(var h=SP.Internal.DomElement.GetXmlDomObj(e),d=h.documentElement.childNodes,b=[],f=[],c=0;c<d.length;c++){var g=d[c];b.push(g.getAttribute("DisplayText"));f.push("-1;#"+g.getAttribute("Key"))}b.length!=0&&_cellContext.SetCurrentValue({localized:b.join("; "),data:f.join(";#")});_cellContext.NotifyEditComplete()}_cellContext.NotifyCollapseWidget()}d()},HyperlinkWidget:function(f){ULSEWi:;this.SupportedWriteMode=SP.JsGrid.EditActorWriteType.Either;this.SupportedReadMode=SP.JsGrid.EditActorReadType.Both;var j="HyperlinkWidgetControl",z=this,t=f.parentNode,a,b,e,c,h,i,d,o,m,p,q,n,g,k,l;function A(){ULSEWi:;b=document.createElement("div");b.id="mainDiv";b.style.cssText="z-index:1; visibility:hidden; position:absolute; top:0px;left:0px; width:290px; background-color:white; border:solid 1px #53A9FF; direction:"+f.RTL.ltr+";";t.appendChild(b);m=String.format("{0}_{1}",j,"addressInput");p=String.format("{0}_{1}",j,"verifyButton");o=String.format("{0}_{1}",j,"displayInput");q=String.format("{0}_{1}",j,"okButton");n=String.format("{0}_{1}",j,"cancelButton");var s=String.format('<DIV style="margin:3px 10px 0px 10px; text-align:{0};"><img src="{1}" alt="{2}" title="{2}" id="{3}" tabIndex="-1" style="cursor:pointer;"/></DIV>',f.RTL.Right,"/_layouts/Images/closexon.png",SP.JsGrid.Res.close,n),A=String.format('<a href="javascript:;" id="{0}" title="{1}" style="float:{2};">{1}</a>',p,SP.JsGrid.Res.testHyperlink,f.RTL.Right),a='<DIV style="margin:3px 10px 9px 10px;"><LABEL for={0}>{1}</LABEL>{3}<DIV style="margin-top:3px;"><INPUT id={0} style="width:268px; padding:0px;" maxLength="1024" type="text"></DIV><DIV style="margin-top:3px;">{2}</DIV></DIV>',g=String.format(a,m,SP.JsGrid.Res.hyperlinkAddress,SP.JsGrid.Res.hyperlinkAddressExample,A),k=String.format(a,o,SP.JsGrid.Res.hyperlinkDisplay,SP.JsGrid.Res.hyperlinkDisplayExample,""),z=String.format('<DIV style="padding:3px 10px 3px 10px; background-color: #53A9FF; text-align:{0}"><a href="javascript:;" title="{1}" id="{2}" style="font-weight:bold; color:#F7F7F7">{1}</a></DIV>',f.RTL.Right,SP.JsGrid.Res.ok,q);b.innerHTML=[s,g,k,z].join("");l=b.offsetHeight;c=$get(m);h=$get(p);e=$get(o);i=$get(q);d=$get(n);$addHandler(e,"keyup",w);$addHandler(i,"click",v);$addHandler(d,"click",r);$addHandler(h,"click",u);$addHandler(b,"keydown",y);$addHandler(b,"mousedown",x)}this.Dispose=function(){ULSEWi:;$clearHandlers(e);$clearHandlers(i);$clearHandlers(d);$clearHandlers(h);$clearHandlers(b);t.removeChild(b)};this.BindToCell=function(b){ULSEWi:;a=b;g=a.originalValue.localized!=SP.JsGrid.EmptyValue?a.originalValue.localized:a.propType.GetAddress(a.originalValue.data);k=a.originalValue.data!=SP.JsGrid.EmptyValue?a.propType.GetAddress(a.originalValue.data):a.originalValue.localized};this.Unbind=function(){};this.GetIcon=function(){ULSEWi:;return (new SP.JsGrid.Image("/_layouts/Images/link.gif")).Render(SP.JsGrid.Res.editHyperlink)};this.Collapse=function(){ULSEWi:;b.style.visibility="hidden";a.NotifyCollapseWidget()};this.Expand=function(){ULSEWi:;var d=a.cellRect;b.style.top=(a.cellExpandSpace.bottom>l||a.cellExpandSpace.top<l?d.y+d.height+3:d.y-l-3)+"px";b.style.left=d.x-(f.RTL.bEnabled?b.offsetWidth-d.width:2)+"px";g=a.originalValue.localized!=SP.JsGrid.EmptyValue?a.originalValue.localized:a.propType.GetAddress(a.originalValue.data);k=a.originalValue.data!=SP.JsGrid.EmptyValue?a.propType.GetAddress(a.originalValue.data):a.originalValue.localized;e.value=g;c.value=k;a.NotifyExpandWidget();b.style.visibility="";c.focus();c.value=c.value};this.OnValueChanged=function(b){ULSEWi:;g=b.localized==null||b.localized==SP.JsGrid.EmptyValue?"":b.localized;k=b.data==null||b.data==SP.JsGrid.EmptyValue?g:a.propType.GetAddress(b.data)};function w(){ULSEWi:;s()}function v(){ULSEWi:;s();a.NotifyEditComplete();z.Collapse()}function r(){ULSEWi:;a.NotifyEditComplete(true)}function u(){ULSEWi:;window.open(c.value||"about:blank")}function s(){ULSEWi:;a.SetCurrentValue({localized:e.value,data:{address:c.value,display:e.value}})}function y(a){ULSEWi:;var b=!a.ctrlKey&&!a.altKey&&!a.shiftKey;if(c())SP.Internal.DomElement.StopEvent(a);else a.stopPropagation();function c(){ULSEWi:;switch(a.keyCode){case Sys.UI.Key.esc:r();return true;case Sys.UI.Key.enter:if(a.target==d)r();else if(a.target==h)u();else v();return true;case Sys.UI.Key.tab:if(b){if(a.target==i){d.focus();return true}}else if(a.shiftKey)if(a.target==d){i.focus();return true}else if(a.target==h){d.focus();return true}}return false}}function x(a){ULSEWi:;a.stopPropagation()}A()}};SP.JsGrid.WidgetControl.Type={Demo:"WIDGET_DEMO",Date:"WIDGET_DATE",AddressBook:"WIDGET_ADDRESSBOOK",Hyperlink:"WIDGET_HYPERLINK"};SP.JsGrid.Internal.MVCController=function(a,e,H){ULSEWi:;var b,m,l=this,f,C,Q=this,d=a.versionMgr=new SP.JsGrid.Internal.VersionManager(a,F,J,I,E,O),p=new SP.JsGrid.Internal.CheckSelectionManager(a),A=a.pendingChangeMgr=new SP.JsGrid.Internal.PendingChangesManager(a),M=new SP.JsGrid.Internal.PropertyUpdateManager(a);a.tableCache.fnApplyUpdatesToNewRecord=function(a){ULSEWi:;d.ApplyChangesToRecord(a)};var i=H?L():null,R=a.editUtil=new N,P=false,k,c,g,o,B,h,n,j={},q={OnPropertiesChanged:function(b,d,c,a){ULSEWi:;l.UpdateProperties(b,d,c,a)},OnNodeExpanded:function(a){ULSEWi:;l.ExpandNode(a)},OnNodeCollapsed:function(a){ULSEWi:;l.CollapseNode(a)},OnFocusedCellChanged:function(a){ULSEWi:;G(a)}};this.GetCurrentDataValue=function(c,e){ULSEWi:;var b=d.GetCurrentValue(c,e);if(b==SP.JsGrid.EmptyValue){var f=a.tableCache.GetCachedRecord(c);b=f!=null?f.GetDataValue(e):null}else b=b.GetData();return b};this.ChangeKeysInVersionMgr=function(b,a){ULSEWi:;d.ChangeKeysOnPropUpdates(b,a)};this.GetEarliestChangeKeyForRecord=function(a){ULSEWi:;return d.GetEarliestPropChangeKeyForRecord(a)};this.GetCurrentLocalizedValue=function(c,e){ULSEWi:;var b=d.GetCurrentValue(c,e);if(b==SP.JsGrid.EmptyValue){var f=a.tableCache.GetCachedRecord(c);b=f!=null?f.GetLocalizedValue(e):null}else b=b.GetLocalized();return b};this.GetPropType=function(e,b){ULSEWi:;var d=a.tableCache.GetCachedRecord(e),c;if(d!=null&&d.GetProp(b)!=null)c=d.GetProp(b).propType;else if(a.entryRecordMgr.IsEntryRecordKey(e)&&a.jsGridParams.tableViewParams.gridFieldMap[b]!=null)c=a.jsGridParams.tableViewParams.gridFieldMap[b].GetPropType();else if(b==SP.JsGrid.RecordIndicatorCheckboxColumnKey)c=SP.JsGrid.Internal.Property.GetPropType("RecordIndicatorCheckBoxBoolean");return c};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;d.ClearAllPropChangesForRecord(a)};this.NotifyDataAvailable=function(){ULSEWi:;a.paneMgr.RefreshAllRows(0)};this.NotifySave=function(){ULSEWi:;i!=null&&i.Clear()};this.ClearChanges=function(){ULSEWi:;a.commandMgr.ClearUndoStack();i!=null&&i.Clear();d!=null&&d.Clear()};this.GetViewEventSinks=function(){ULSEWi:;return q};this.ClearTableView=function(){ULSEWi:;a.entryRecordMgr.NotifyTableViewCleared();a.paneMgr.ClearView()};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForChangeKey(b,c,a)};this.SetTableView=function(b,J,E,v,A,t,H,F,w,m,l,z,q,x,s,j,n,I,G,r,D,h,d,i){ULSEWi:;c=F;g=w;o=J;B=v;k=E;C=A;f=t;y(b,false);p.SetTableView(h,d,i);a.columnMenuMgr!=null&&a.columnMenuMgr.Dispose();a.columnMenuMgr=new SP.JsGrid.Internal.ColumnMenuManager(a,b.autoFilterState,b.autoFilterEntries,k,e);a.paneMgr.SetView(c,o,k,b.topViewIdx,g,H,m,l,z,q,x,s,j,n,I,G,r,D,b.sortState);u(b.sortState,b.filterState,b.autoFilterState)};this.SetRowView=function(b){ULSEWi:;y(b,true);a.columnMenuMgr.SetAutoFilterState(b.autoFilterState);a.columnMenuMgr.SeedAutoFilterEntryCache(b.autoFilterEntries)};function u(e,c,d){ULSEWi:;a.paneMgr.SetSortState(e);var b=new SP.Utilities.Set(d);if(c!=null)b=b.Union(c);a.paneMgr.SetFilterState(b.ToArray())}function y(b,c){ULSEWi:;a.tableCache.SetView(b.view);h=b.hierarchyMode;if(h==SP.JsGrid.HierarchyMode.None)z();else K(h==SP.JsGrid.HierarchyMode.Grouping?b.groupingLevel:null,h==SP.JsGrid.HierarchyMode.Grouping?b.groupingRecordKeyPrefix:null,b.unfilteredHierarchyMgr,b.hierarchyDelayLoadKeys,b.hierarchyState,b.filteredDescCounts);if(c){a.paneMgr.NotifyNewRowStateChanged(true);a.paneMgr.RefreshAllRows(b.topViewIdx);u(b.sortState,b.filterState,b.autoFilterState)}}this.GetHierarchyManager=function(){ULSEWi:;return b};this.GetOutlineLevel=function(a){ULSEWi:;return b.GetOutlineLevel(a)};this.GetDiffTracker=function(){ULSEWi:;return i!=null?i.ExternalAPI:null};this.UpdateProperties=function(f,e,b,d){ULSEWi:;var c;if(b==null){a.commandMgr.OpenGroup();c=this.CreateDataUpdateCmd();b=c.GetChangeKey()}d!=null&&d(b);M.ApplyPropUpdates(f,b);if(c!=null){a.commandMgr.Execute(c,e,SP.JsGrid.CommandManager.CommandType.Explicit);a.commandMgr.CloseGroup(e,SP.JsGrid.CommandManager.CommandType.Explicit,true)}return b};this.InsertHiddenRecord=function(d,c,b){ULSEWi:;if(b!=null&&a.entryRecordMgr.IsEntryRecordKey(b)){alert(e("NoInsertAfterEntryRow"));return null}return x(t(d,false,b,false,false),c)};this.InsertRecordAfter=function(b,c,i,h,d,g,f){ULSEWi:;if(a.entryRecordMgr.IsEntryRecordKey(b)){alert(e("NoInsertAfterEntryRow"));return null}a.tableCache.SeedInsertedRecord(c);return x(t(c.key(),true,b,h,d,g,f),i)};function x(g,c){ULSEWi:;var f;if(g.bIsInView&&h==SP.JsGrid.HierarchyMode.Grouping&&b.GetUnfilteredHierarchyMgr()!=null){alert(e("NoInsertWhenGrouped"));return null}if(c==null){f=l.CreateDataUpdateCmd();c=f.GetChangeKey()}d.AddRowInsertChange(g,c);f!=null&&a.commandMgr.Execute(f,"Insert Record",SP.JsGrid.CommandManager.CommandType.Explicit);return c}this.InsertRecordBefore=function(f,j,i,h){ULSEWi:;var d,e;if(f==null)d=c.RecordIdxToRecordKey(a.tableCache.GetRecordCount()-1);else{var g=c.RecordKeyToRecordIdx(f);e=g==0?null:c.RecordIdxToRecordKey(g-1);if(b!=null&&!b.IsGrouped())d=b.GetAfterKeyFromBeforeKey(f);else d=e}return this.InsertRecordAfter(d,j,i,h,false,e,d!=e)};this.DeleteRecords=function(f,g){ULSEWi:;var h;if(SP.Internal.JS.FindInArray(f,function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)})!=null){alert(e("OpNotSupportedOnEntryRow"));return null}if(r())for(var i=b.GetUnfilteredHierarchyMgr(),c=0;c<f.length;c++){if(b.IsGroupingRecord(f[c])){alert(e("NoDeletingGroupingRow"));return null}if(i!=null&&i.IsKeyPresent(f[c])){alert(e("NoDeletingGroupedHierarchicalRows"));return null}}if(g==null){h=this.CreateDataUpdateCmd();g=h.GetChangeKey()}for(var c=0;c<f.length;c++)d.AddRowDeleteChange(s(f[c]),g);h!=null&&a.commandMgr.Execute(h,"Delete Record",SP.JsGrid.CommandManager.CommandType.Explicit);return g};this.ExpandNode=function(b){ULSEWi:;if(n.Contains(b))a.delegateMgr.Apply(SP.JsGrid.DelegateType.ExpandDelayLoadedHierarchyNode,b);else{var d=c.RecordKeyToRecordIdx(b);a.commandMgr.Execute(v("expand",d),"Expand Node",SP.JsGrid.CommandManager.CommandType.Implicit)}};this.CollapseNode=function(d){ULSEWi:;var b=c.RecordKeyToRecordIdx(d);a.commandMgr.Execute(v("collapse",b),"Collapse Node",SP.JsGrid.CommandManager.CommandType.Implicit)};this.AdjustRecordsIndentLevel=function(c,g,i){ULSEWi:;if(h==SP.JsGrid.HierarchyMode.Grouping){alert(e("NoIndentOutdentWhenGrouped"));return null}if(SP.Internal.JS.FindInArray(c,function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)})!=null){alert(e("OpNotSupportedOnEntryRow"));return null}var k=b.ValidateAndMinimizeKeyList(c);if(k.bLevelZeroFound){alert(e("OutlineLevelChangeNotSupportedOnTopLevel"));return null}c=k.minimizedKeys;for(var f=0;f<c.length;f++){if(g==-1&&!b.CanOutdent(c[f])){alert(e("CannotOutdentFurther"));return null}if(g==1&&!b.CanIndent(c[f]))return null}a.commandMgr.OpenGroup();var l=this.CreateDataUpdateCmd();i=l.GetChangeKey();var j=b!=null&&b.GetUnfilteredHierarchyMgr();if(j!=null&&c.length>1)c=j.GetKeysInOrder(c);for(var f=0;f<c.length;f++){var m=g==1?b.EnsureIndentPreconditionsMet(c[f]):b.EnsureOutdentPreconditionsMet(c[f]);d.AddIndentLevelChange(c[f],g,m,i)}a.commandMgr.Execute(l,null,SP.JsGrid.CommandManager.CommandType.Explicit);a.commandMgr.CloseGroup(g==1?"Indent":"Outdent",SP.JsGrid.CommandManager.CommandType.Explicit,true);return i};this.EnableEditing=function(){ULSEWi:;if(!f){f=true;a.entryRecordMgr.EnsureLastEntryRowExists();a.paneMgr.NotifyNewRowStateChanged();a.paneMgr.NotifyCanEditUpdated();a.ariaMgr.EnableGridEditing(true)}};this.DisableEditing=function(){ULSEWi:;if(f){a.paneMgr.StopEditing(true);a.paneMgr.UnbindEditing(function(){ULSEWi:;a.entryRecordMgr.ClearUncommittedEntryRecords();a.paneMgr.NotifyNewRowStateChanged();a.paneMgr.NotifyCanEditUpdated();a.ariaMgr.EnableGridEditing(false);f=false})}};this.FinalizeEditing=function(b,c){ULSEWi:;if(f){a.paneMgr.StopEditing(false);A.WaitForPendingUpdates(function(){ULSEWi:;if(a.errorMgr.AnyErrors()){c();return}a.entryRecordMgr.TryCommitFirstEntryRecords(function(){ULSEWi:;if(a.entryRecordMgr.AnyUncomittedEntryRecords()){c();return}A.WaitForAllChangeKeysToComplete(b)})})}else b()};this.NotifyHide=function(){ULSEWi:;this.FinalizeEditing(function(){},function(){})};this.MarkPropUpdateInvalid=function(c,e,b,a){ULSEWi:;return d.MarkPropUpdateInvalid(c,e,b,a)};this.GetCurrentChangeKey=function(){ULSEWi:;return d.GetCurrentChangeKey()};this.IsChangeKeyApplied=function(a){ULSEWi:;return d.IsChangeKeyApplied(a)};this.GetChangeKeyForVersion=function(a){ULSEWi:;return d.GetChangeKeyForVersion(a)};this.GetCheckSelectionManager=function(){ULSEWi:;return p!=null?p.ExternalAPI:null};function r(){ULSEWi:;return b!=null&&b.IsGrouped()}function N(){ULSEWi:;this.ValidateAndExpandKeyList=function(a){ULSEWi:;return b&&b.GetUnfilteredHierarchyMgr()&&b.ValidateAndExpandKeyList(a)};this.IsEditingEnabled=function(){ULSEWi:;return f};this.IsNewRowEnabled=function(){ULSEWi:;return C&&f&&!r()};this.GetFieldValueForCopy=function(b,d){ULSEWi:;var c=b.HasLocalizedValue(d)?b.GetLocalizedValue(d):null,a;if(d!=SP.JsGrid.RecordIndicatorCheckboxColumnKey){var f=b.GetProp(d);a=f&&f.propType}else a=SP.JsGrid.Internal.Property.GetPropType("RecordIndicatorCheckBoxBoolean");if(a.GetDisplayValue!=null||a.GetCopyValue!=null){var e=b.HasDataValue(d)?b.GetDataValue(d):null;if(a.GetDisplayValue!=null)c=a.GetDisplayValue(b,e,c);else if(a.GetCopyValue!=null)c=a.GetCopyValue(b,e,c)}return c!=null?c:""};this.CanBindToField=function(c,b,a){ULSEWi:;return this.CanEditField(c,b,a)&&!(a!=null&&a==SP.JsGrid.RecordIndicatorCheckboxColumnKey)};this.CanEditField=function(c,h,d){ULSEWi:;if(!f||c==null)return false;if(!c.bIsNewRow&&g.GetValue(c,SP.JsGrid.OperationalConstants.GroupingOutlineLevel)!=null)return false;if(d!=null&&d==SP.JsGrid.RecordIndicatorCheckboxColumnKey)return true;var e=h!=null&&h.fnGetCellEditMode!=null?h.fnGetCellEditMode(c,d):null;e=e==null?SP.JsGrid.EditMode.Defer:e;var b=c.bIsNewRow?SP.JsGrid.EditMode.ReadWriteDefer:a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.GetRecordEditMode)?a.delegateMgr.Apply(SP.JsGrid.DelegateType.GetRecordEditMode,c):null;b=b==null?g.GetValue(c,SP.JsGrid.OperationalConstants.RecordEditMode):b;b=b==null?SP.JsGrid.EditMode.Defer:b;var j=d!=null&&k[d].GetEditMode()!=null?k[d].GetEditMode():SP.JsGrid.EditMode.Defer,i=Math.min(Math.min(Math.min(b,j),e),B);return i==SP.JsGrid.EditMode.ReadWrite||i==SP.JsGrid.EditMode.ReadWriteDefer||i==SP.JsGrid.EditMode.Defer}}function L(){ULSEWi:;var b=new SP.JsGrid.Internal.DiffTracker(a,function(e,b,a,c){ULSEWi:;return d.GetChange(e,b,a,c)});d.OnSynchronizeChange=function(a){ULSEWi:;return b.NotifySynchronizeToChange(a)};d.OnRollbackChange=function(a){ULSEWi:;return b.NotifyRollbackChange(a)};d.OnVacateChange=function(a){ULSEWi:;return b.NotifyVacateChange(a)};return b}function K(k,j,e,d,f,i){ULSEWi:;z();n=new SP.Utilities.Set;d!=null&&n.AddArray(d);b=new SP.JsGrid.Internal.HierarchyManager(a,c,g,k,j,e,function(a){ULSEWi:;l.ExpandNode(a)},function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)},n,i);f!=null&&b.SetState(f,e);var h=o.GetColumnByKey(g.GetFieldKey(SP.JsGrid.OperationalConstants.HierarchyMain));m=h.fnGetDisplayControlName;if(a.gridControls[SP.JsGrid.HierarchyControlId]==null){a.gridControls[SP.JsGrid.HierarchyControlId]=new SP.JsGrid.DisplayControl.HierarchyDisplayControl(a.gridId,c,function(a){ULSEWi:;return b.GetNodeInfo(a)},q.OnNodeExpanded,q.OnNodeCollapsed,function(d,e,c,f,b){ULSEWi:;return a.paneMgr.GetGridPane().GetContentForCell(d,e,c,f,b)},function(c,b,a){ULSEWi:;return m&&m(b,a)});SP.JsGrid.PropertyType.Utils.RegisterDisplayControl(a.gridControls[SP.JsGrid.HierarchyControlId].Id,a.gridControls[SP.JsGrid.HierarchyControlId],[])}h.fnGetDisplayControlName=function(){ULSEWi:;return a.gridControls[SP.JsGrid.HierarchyControlId].Id};c.SetHierarchyMgrObj(b)}function z(){ULSEWi:;if(b!=null){o.GetColumnByKey(g.GetFieldKey(SP.JsGrid.OperationalConstants.HierarchyMain)).fnGetDisplayControlName=m;c.SetHierarchyMgrObj(null);b=null}}function G(b){ULSEWi:;var c=b.oldRecordKey;b.newRecordKey!=c&&a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowFocusChanged,new SP.JsGrid.EventArgs.RowFocusChanged(b.newRecordKey,b.oldRecordKey));a.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellFocusChanged,b)}this.AttachUndoActionToChangeKey=function(b,c){ULSEWi:;var a=b.GetVersionNumber();if(j[a]==null)j[a]=[];j[a].push(c)};this.CreateDataUpdateCmd=function(e){ULSEWi:;var c=false,b=d.GetNextVersionKey();a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyCreated,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b));b.Reserve();return {Apply:function(){ULSEWi:;a.paneMgr.ClearAllChangeIndications();d.ApplyChangeKey(b);!c&&!e&&a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b));c=true},Undo:function(){ULSEWi:;a.paneMgr.ClearAllChangeIndications();d.UndoChangeKey(b);var c=j[b.GetVersionNumber()];if(c!=null)for(var e=c.length-1;e>=0;e--)c[e]();j[b.GetVersionNumber()]=null},Dispose:function(a){ULSEWi:;a==SP.JsGrid.CommandManager.DisposeState.Unapplied&&d.VacateChange(b);b.Release()},GetChangeKey:function(){ULSEWi:;return b},NotifyInitialUpdateComplete:function(){ULSEWi:;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,new SP.JsGrid.Internal.EventArgs.ChangeKeyStageUpdated(b))}}};function v(g,d){ULSEWi:;function e(){ULSEWi:;var f=c.RecordIdxToRecordKey(d),g=b.NotifyCollapse(d,f),e=c.RecordIdxToViewIdx(d);a.paneMgr.NotifyChangedRows(e,1);a.paneMgr.NotifyDeleteRows(e+1,g);a.paneMgr.ScrollCellIntoView(e,null);a.cutcopypasteMgr.CancelMode()}function f(){ULSEWi:;var f=c.RecordIdxToRecordKey(d),g=b.NotifyExpand(d,f),e=c.RecordIdxToViewIdx(d);a.paneMgr.NotifyChangedRows(e,1);a.paneMgr.NotifyInsertRows(e+1,g,true);a.paneMgr.ScrollCellIntoView(e,null);a.cutcopypasteMgr.CancelMode()}return g=="collapse"?{Apply:e,Undo:f}:{Apply:f,Undo:e}}function F(d,f,b,j,h,o,l,k,i){ULSEWi:;a.cutcopypasteMgr.CancelMode();var c=null,n=l!=null?l:a.entryRecordMgr.IsEntryRecordKey(d)?a.entryRecordMgr.GetEntryRecord(d):a.tableCache.GetCachedRecord(d);if(b==null)b=new SP.JsGrid.Internal.PropertyUpdate(null,"");var g=new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.EmptyValue,SP.JsGrid.EmptyValue);if(n!=null){var m=true;c=n.GetProp(f);if(c!=null){g.localized=c.HasLocalizedValue()?c.GetLocalized():SP.JsGrid.EmptyValue;g.data=c.HasDataValue()?c.GetData():SP.JsGrid.EmptyValue;if(g.data!=b.data||g.localized!=b.localized)c.Update(b.data,b.localized);else m=false}m&&a.paneMgr.NotifyUpdateProperty(d,f,true,b,h,j)}a.errorMgr.ClearAllErrorsOnCell(d,f);var q=SP.JsGrid.Internal.MakeCellKey(d,f);if(h==SP.JsGrid.ValidationState.Invalid){var p=k!=null?k:b.localized!=SP.JsGrid.EmptyValue?String.format(e("LocalizedConversionError"),b.localized):e("GeneralConversionError");a.errorMgr.SetCellError(d,f,p)}if(!o)if(!a.entryRecordMgr.IsEntryRecordKey(d))a.eventMgr.FireEvent(SP.JsGrid.EventType.OnPropertyChanged,new SP.JsGrid.EventArgs.PropertyChanged(d,f,i==null?g:i,b,c&&c.propType,j,h));else a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,new SP.JsGrid.EventArgs.PropertyChanged(d,f,i==null?g:i,b,c&&c.propType,j,h))}function E(g,i,e){ULSEWi:;a.cutcopypasteMgr.CancelMode();for(var f=i==1?b.NotifyIndent(g,e&&e[0]):b.NotifyOutdent(g),d=0;d<f.length;d++){var h=f[d];a.paneMgr.NotifyChangedRows(c.RecordKeyToViewIdx(h.startingRecordKey),h.count)}}function D(c,b,e){ULSEWi:;var d=false,a=null;if("visualAfterRecordKey" in c){d=true;a=c.visualAfterRecordKey;while(a!=null&&b!=null&&b[a]!=null){a=b[a].visualAfterRecordKey;if(e(a))a=null}}return w(c.afterRecordKey,a,d)}function J(d,j,g,i){ULSEWi:;a.cutcopypasteMgr.CancelMode();if(g(d.recordKey))return null;var e=null;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordInserted,new SP.JsGrid.Internal.EventArgs.RecordInserted(d.recordKey));if(d.bIsInView){var e=D(d,i,g),f;if(b!=null)f=b.NotifyInsertRowAfter(d.afterRecordKey,e,d.recordKey,d.newOutlineLevel);a.tableCache.InsertRecord(e,d.recordKey);if(!d.bDoNotUpdatePaneOnFirstInsert)a.paneMgr.NotifyInsertRows(c.RecordIdxToViewIdx(e),1,d.bUpdateFocusPos,h);else{delete d.bDoNotUpdatePaneOnFirstInsert;h()}}a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordInserted,new SP.JsGrid.EventArgs.RecordInserted(d.recordKey,e,d.afterRecordKey,j));return d;function h(){ULSEWi:;if(f!=null){var b=c.RecordKeyToViewIdx(f);b!=null&&a.paneMgr.NotifyChangedRows(b,1)}}}function I(h,q,p){ULSEWi:;a.cutcopypasteMgr.CancelMode();var o=[],f=[h.recordKey];if(p(h.recordKey))return null;if(b!=null&&b.GetUnfilteredHierarchyMgr()!=null&&h.bIsInView){var i=b.ValidateAndExpandKeyList(f);if(i.bGroupingRowFound){alert(e("NoDeletingGroupingRow"));return null}if(i.bLevelZeroFound){alert(e("DeleteNotSupportedOnTopLevel"));return null}if(!i.bAllChildKeysInView){alert(e("NoDeletingParentWithMissingChildren"));return null}f=i.expandedKeys;f.sort(function(a,b){ULSEWi:;return c.RecordKeyToRecordIdx(b)-c.RecordKeyToRecordIdx(a)})}for(var k=0;k<f.length;k++){var d=f[k],m=d==h.recordKey?h:s(d),j,g=null;a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordDeleted,new SP.JsGrid.Internal.EventArgs.RecordDeleted(d));if(m.bIsInView){g=c.RecordKeyToRecordIdx(d);var n=c.RecordIdxToViewIdx(g);if(b!=null){var l=b.GetParentKey(d);j=l&&c.RecordKeyToViewIdx(l);b.NotifyDeleteRow(d,g)}a.tableCache.IsKeyInView(d)&&a.tableCache.DeleteRecord(g);n!=null&&a.paneMgr.NotifyDeleteRows(n,1);j!=null&&a.paneMgr.NotifyChangedRows(j,1)}a.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordDeleted,new SP.JsGrid.EventArgs.RecordDeleted(d,g,q));o.push(m)}return o}function s(e){ULSEWi:;var f=a.tableCache.IsKeyInView(e),j=f?c.RecordKeyToRecordIdx(e):null,d=null,i=0,h,g;if(f){d=j==0?null:c.RecordIdxToRecordKey(j-1);if(b!=null&&b.GetUnfilteredHierarchyMgr()!=null){var k=b.GetInsertAfterInfoForDelete(e);g=true;h=d;d=k.insertAfterKey;i=k.outlineLevel}}var l=new SP.JsGrid.Internal.RowUpdate(e,d,i,f,true,false,h,g);return l}function t(j,f,a,i,h,d,e){ULSEWi:;var g=0;if(f&&b!=null&&!b.IsGrouped())g=b.GetInsertAfterInfoForInsert(a,c.RecordIdxToRecordKey(w(a,d,e)));return new SP.JsGrid.Internal.RowUpdate(j,a,g,f,i,h,d,e)}function O(b){ULSEWi:;return a.tableCache.GetCachedRecord(b)}function w(d,h,g){ULSEWi:;var e=!g?d:h,a=e==null?null:c.RecordKeyToRecordIdx(e);if(g&&e!=null&&a==null)a=d==null?null:c.RecordKeyToRecordIdx(d);var f=a==null?0:a+1;if(r())f=b.GetNextNonGroupingIdx(f);return f}};SP.JsGrid.Internal.RowUpdate=function(h,g,f,c,b,a,d,e){ULSEWi:;this.recordKey=h;this.afterRecordKey=g;this.newOutlineLevel=f;if(c)this.bIsInView=c;if(b)this.bUpdateFocusPos=b;if(a)this.bDoNotUpdatePaneOnFirstInsert=a;if(e)this.visualAfterRecordKey=d};SP.JsGrid.Internal.CheckSelectionManager=function(b){ULSEWi:;b.checkSelMgr=this;var a=new SP.Utilities.Set,e,c=new SP.Utilities.Set,d=new SP.Utilities.Set,k=this;function p(){ULSEWi:;e=0;var a=b.gridControls[SP.JsGrid.RecordIndicatorControlId]=new SP.JsGrid.DisplayControl.RecordIndicatorCheckboxControl(b.gridId,m,h,g,k.IsRecordIndicatorCheckboxChecked);SP.JsGrid.PropertyType.Utils.RegisterDisplayControl(a.Id,a,[])}function h(c){ULSEWi:;if(d.Contains(c))return true;var a=b.controller.GetHierarchyManager();return a!=null&&a.IsGroupingRecord(c)}function g(a){ULSEWi:;return c.Contains(a)}function o(b){ULSEWi:;!a.Contains(b)&&j(b)}function n(b){ULSEWi:;a.Contains(b)&&j(b)}function i(c,g){ULSEWi:;b.commandMgr.Execute({Apply:function(){ULSEWi:;d(g)},Undo:function(){ULSEWi:;d(!g)}},"ChangeIndicatorCheckBox",SP.JsGrid.CommandManager.CommandType.Explicit);function d(g){ULSEWi:;if(g){for(var d in c.GetCollection())if(!a.Contains(d)){a.Add(d);++e}}else for(var d in c.GetCollection())if(a.Contains(d)){a.Remove(d);--e}f(null);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordChecked,new SP.JsGrid.EventArgs.RecordChecked(c,g))}}function j(c){ULSEWi:;b.commandMgr.Execute({Apply:d,Undo:d,Dispose:function(){ULSEWi:;d=null}},"ChangeIndicatorCheckBox",SP.JsGrid.CommandManager.CommandType.Explicit);function d(){ULSEWi:;if(h(c)||g(c))return;var d=!k.IsRecordIndicatorCheckboxChecked(c);if(d){a.Add(c);++e}else{a.Remove(c);--e}f(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRecordChecked,new SP.JsGrid.EventArgs.RecordChecked((new SP.Utilities.Set).AddArray([c]),d))}}function m(d){ULSEWi:;j(d);if(k.IsRecordIndicatorCheckboxChecked(d)){var b=l(SP.JsGrid.RecordIndicatorCheckboxColumnKey);if(b.Contains(d)){for(var c in b)(a.Contains(c)||h(c)||g(c))&&b.Remove(c);i(b,true)}}}function l(f){ULSEWi:;for(var g=b.jsGridObj.GetSelectedRowRanges(),e=b.jsGridObj.GetSelectedColumnRanges(),d=b.jsGridObj.GetSelectedCellRanges(),c=new SP.Utilities.Set,a=0;a<e.length;a++)if(SP.Internal.JS.FindInArray(e[a].keys,function(a){ULSEWi:;return a==f})!=null){c.AddArray(b.tableCache.GetView());break}if(c.IsEmpty()){for(var a=0;a<g.length;a++)c.AddArray(g[a].keys);for(var a=0;a<d.length;a++)SP.Internal.JS.FindInArray(d[a].colRange.keys,function(a){ULSEWi:;return a==f})!=null&&c.AddArray(d[a].rowRange.keys)}return c}function f(a){ULSEWi:;b.paneMgr.NotifyUpdateProperty(a,SP.JsGrid.RecordIndicatorCheckboxColumnKey,false,null)}this.IsRecordIndicatorCheckboxChecked=function(b){ULSEWi:;return a.Contains(b)};this.SetTableView=function(g,f,b){ULSEWi:;d=new SP.Utilities.Set;d.AddArray(g);c=new SP.Utilities.Set;c.AddArray(f);a=new SP.Utilities.Set;a.AddArray(b);e=b.length};this.ExternalAPI={CheckAllRecords:function(){ULSEWi:;for(var f=b.tableCache.GetView(),e=new SP.Utilities.Set,d=0;d<f.length;d++){var c=f[d];!a.Contains(c)&&!h(c)&&!g(c)&&e.Add(c)}i(e,true)},ClearCheckedRecords:function(){ULSEWi:;var b=a.Clone();i(b,false)},EnableRecordCheckbox:function(a){ULSEWi:;if(c.Contains(a)){c.Remove(a);f(a)}},DisableRecordCheckbox:function(a){ULSEWi:;if(!c.Contains(a)){c.Add(a);f(a)}},ShowRecordCheckbox:function(a){ULSEWi:;if(d.Contains(a)){d.Remove(a);f(a)}},HideRecordCheckbox:function(a){ULSEWi:;if(!d.Contains(a)){d.Add(a);f(a)}},CheckRecord:o,UncheckRecord:n,AnyRecordsChecked:function(){ULSEWi:;return !a.IsEmpty()},GetCheckedRecordKeys:function(){ULSEWi:;return a.GetCollection()},GetCheckedRecordCount:function(){ULSEWi:;return e},GetHiddenCheckboxRecordKeys:function(){ULSEWi:;return d.GetCollection()},GetDisabledCheckboxRecordKeys:function(){ULSEWi:;return c.GetCollection()}};p()};SP.JsGrid.Internal.CutCopyPasteManager=function(a,c){ULSEWi:;var m=SP.JsGrid.SelectionType,b,e=new SP.JsGrid.Internal.ClipboardManager,f=this;this.GetLastOperation=function(){ULSEWi:;return b&&{gridPane:b.gridPane,rowRange:b.rowRange,colRange:b.colRange,opType:b.opType}};this.CheckClipboard=function(){ULSEWi:;b!=null&&!g()&&this.CancelMode()};this.IsSelectionCopyable=function(b){ULSEWi:;return a.selectionMgr.GetRowRanges(b).length+a.selectionMgr.GetColumnRanges(b).length+a.selectionMgr.GetCellRanges(b).length==1};this.CancelMode=function(){ULSEWi:;var a=b&&b.gridPane;b=null;a!=null&&a.NotifyCopyOperationUpdated()};this.OnCopy=function(e){ULSEWi:;var b=a.selectionMgr.GetLastSelectionRangeNormalized();if(b==null)return;var d=b.rowRange,g=b.colRange,f=e.GetGridPaneConverter(),c;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return c=f.GetRecordsInvolved(d.begin,d.Size(),function(b){ULSEWi:;c=b;a()})},function(){ULSEWi:;h(e,c,d,g,"copy",false)})};this.OnCut=function(e){ULSEWi:;if(!a.editUtil.IsEditingEnabled()){alert(c("GridNotEditable"));return}var g=a.selectionMgr.GetLastSelectionRangeNormalized();if(g==null)return;var b=g.rowRange,o=g.colRange,i=e.GetGridPaneConverter(),p=a.editUtil.IsNewRowEnabled()&&b.end==i.GetVirtualRowCount()-a.entryRecordMgr.GetEntryRecords().length,n=i.GetRecordKeysInvolved(b.begin,b.Size()),d;if(p){alert(c("OpNotSupportedOnEntryRow"));return}var f=a.selectionMgr.GetLastSelectionType()==m.RowRange&&a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.DeleteRecords);if(f){if(e.Id!=SP.JsGrid.PaneId.MainGrid){alert(c("NoCuttingRowsInPane"));return}var j=a.editUtil.ValidateAndExpandKeyList(n);if(j!=null){if(!j.bAllChildKeysInView){alert(c("NoDeletingParentWithMissingChildren"));return}if(j.expandedKeys.length!=n.length){alert(c("NoCuttingParentWithoutChildren"));return}}}a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return d=i.GetRecordsInvolved(b.begin,b.Size(),function(b){ULSEWi:;d=b;a()})},function(){ULSEWi:;if(f){if(l(d)){alert(c("NoCuttingReadOnlyRows"));return}}else if(k(e,d,b,o)){alert(c("NoCuttingReadOnlyCells"));return}h(e,d,b,o,"cut",f)})};this.OnPaste=function(l){ULSEWi:;if(!a.editUtil.IsEditingEnabled()){alert(c("GridNotEditable"));return}if(!this.IsSelectionCopyable(l)){alert(c("MultipleSelections"));return false}var h=j();if(h==null)return;var e=a.selectionMgr.GetLastSelectionRangeNormalized();if(e==null)return;var m=0,v=0,d;if(b!=null&&b.opType=="cut"&&g()){d={gridPane:b.gridPane,rowRange:b.rowRange,colRange:b.colRange,causesRowDelete:b.bCutCausesRowDelete};if(d.causesRowDelete){m=d.gridPane==l&&d.rowRange.begin<e.rowRange.begin?d.rowRange.Size():0;v=d.rowRange.Size();if(l.Id!=SP.JsGrid.PaneId.MainGrid){alert(c("NoPastingRowsInPane"));return}var D=new SP.Utilities.Range(e.rowRange.begin,e.rowRange.begin+d.rowRange.Size()-1);if(D.Overlaps(d.rowRange)){alert(c("CutPasteRowOverlap"));return}}}var u=e.colRange.Size(),t=e.rowRange.Size(),r=l.GetGridPaneConverter(),n,p=r.GetVirtualRowCount();if(a.editUtil.IsNewRowEnabled()){var w=a.entryRecordMgr.GetEntryRecords().length;n=e.rowRange.begin==p-w;p-=w}if(e.colRange.begin+h.width>r.GetVirtualColumnCount()||!n&&e.rowRange.begin-m+h.height>p-v){alert(c("NoRoomToPaste"));return}var A=u%h.width==0,B=t%h.height==0,F=d==null&&A&&(B||t<h.height)?u:h.width,E=d==null&&B&&(A||u<h.widfth)?t:h.height,k=new SP.Utilities.Range(e.rowRange.begin,e.rowRange.begin+E-1),s=new SP.Utilities.Range(e.colRange.begin,e.colRange.begin+F-1);a.commandMgr.OpenGroup();var o,q;if(d!=null)C(function(){ULSEWi:;x(function(){ULSEWi:;z(y)})});else x(function(){ULSEWi:;z(y)});function C(b){ULSEWi:;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return o=d.gridPane.GetGridPaneConverter().GetRecordsInvolved(d.rowRange.begin,d.rowRange.Size(),function(b){ULSEWi:;o=b;a()})},b)}function x(b){ULSEWi:;if(!n)a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return q=r.GetRecordsInvolved(k.begin,k.Size(),function(b){ULSEWi:;q=b;a()})},b);else b()}function z(b){ULSEWi:;f.CancelMode();if(d!=null)if(d.causesRowDelete){a.jsGridObj.DeleteRecords(SP.Internal.JS.ConvertSetKeysToArray(o));k.begin-=m;k.end-=m}else a.jsGridObj.UpdateProperties(i(d.gridPane,o,d.rowRange,d.colRange),"");l.PutData(h,q,"","TL",k,s,b,n)}function y(b){ULSEWi:;a.selectionMgr.SelectRange(l,k.begin,k.begin+Math.min(b,k.end-k.begin),s.begin,s.end,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true,false);a.commandMgr.CloseGroup(d!=null?"Cut/Paste":"Paste",SP.JsGrid.CommandManager.CommandType.Explicit,true)}};function h(d,m,h,j,o,l){ULSEWi:;if(!f.IsSelectionCopyable(d)){alert(c("MultipleSelections"));return false}for(var n=d.GetData(m,h,j),i=new Array(h.Size()),g=0;g<i.length;g++)i[g]=n.matrix[g].join("\t");f.CancelMode();var k=i.join("\r\n");if(e.SetData(k)){b={clipboardText:k,rowRange:h,colRange:j,selType:a.selectionMgr.GetLastSelectionType(),gridPane:d,opType:o,bCutCausesRowDelete:l};d.NotifyCopyOperationUpdated();return true}else return false}function j(){ULSEWi:;var h=e.GetData();if(h==null||h=="")return null;var a=d(h).split("\n");a.length>1&&a[a.length-1]==""&&a.pop();for(var f=a.length,g,b=0;b<f;b++){a[b]=a[b].split("\t");if(g==null)g=a[b].length;else if(g!=a[b].length){if(b==f-1&&a[b].length==1&&a[b][0]==""){f--;break}break}}if(b!=f){alert(c("ClipboardDataNotSquare"));return null}return {matrix:a,width:g,height:f}}function k(i,h,f,e){ULSEWi:;for(var d=i.GetGridPaneConverter(),c=f.begin;c<=f.end;c++)for(var b=e.begin;b<=e.end;b++){var g=d.IdxToKey(c,b);if(!a.editUtil.CanEditField(h[g.recordKey],d.GetColumnByIdx(b),g.fieldKey))return true}return false}function l(b){ULSEWi:;for(var c in b)if(!a.editUtil.CanEditField(b[c],null,null))return true;return false}function i(h,j,b,a){ULSEWi:;for(var g=h.GetGridPaneConverter(),e=new Array(b.Size()*a.Size()),i=0,c=b.begin;c<=b.end;c++)for(var d=a.begin;d<=a.end;d++){var f=g.IdxToKey(c,d);e[i++]=SP.JsGrid.CreateUnvalidatedPropertyUpdate(f.recordKey,f.fieldKey,"",true)}return e}function d(a){ULSEWi:;return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}function g(){ULSEWi:;var c=false,a=e.GetData();if(b.clipboardText==null)c=a==null;else c=(a&&d(a))==d(b.clipboardText);return c}};SP.JsGrid.Internal.ClipboardManager=function(){ULSEWi:;var a=c(),b;this.SetData=function(c){ULSEWi:;if(window.clipboardData&&window.clipboardData.setData)window.clipboardData.setData(a,c);else if(window.Components){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(g){alert(SP.JsGrid.Res.browserPermissionDenied);return false}var e=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),d=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);d.addDataFlavor(a);var f=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);e.data=c;d.setTransferData(a,e,c.length*2);f.setData(d,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}else{b={};b[a]=c}return true};this.GetData=function(){ULSEWi:;if(window.clipboardData!=null&&window.clipboardData.getData!=null)return window.clipboardData.getData(a);else if(window.Components){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(g){alert(SP.JsGrid.Res.browserPermissionDenied);return null}var f=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),d=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);d.addDataFlavor(a);var c={},e={};f.getData(d,Components.interfaces.nsIClipboard.kGlobalClipboard);d.getTransferData(a,c,e);c=c&&c.value.QueryInterface(Components.interfaces.nsISupportsString);return c&&c.data.substring(0,e.value/2)}else return b&&b[a]};function c(){ULSEWi:;if(Sys.Browser.agent==Sys.Browser.Safari||Sys.Browser.agent==Sys.Browser.AppleWebKit)return "text/plain";else if(Sys.Browser.agent==Sys.Browser.Firefox)return "text/unicode";else return "text"}};SP.JsGrid.Deserializer=function(b,c,i){ULSEWi:;this.recordKeyHash;this.recordKeyOrderChanged;this.columns;this.pivotedColumns;this.gridFieldMap;this.view;this.viewDependentKeys;this.isGanttEnabled;this.isHierarchyEnabled;this.groupingLevel;this.isGrouped;this.isSorted;this.data;this.operationalConstantsFieldKeyMap;this.keyColumnName=i;this.unfilteredHierarchyMgr;this.additionalParams;this.autoFilterState;this.hierarchyState;this.sortState;this.autoFilterEntries;this.ganttInfo;this.cellStyles;this.groupingGridRowStyleIds;this.bAutoFilterableColumns;var a=this;this.InitJsGridParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.Parameters;a.tableViewParams=this.InitJsGridTableViewParams(a.tableViewParams);return a};this.InitJsGridTableViewParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.TableViewParameters;a.operationalConstantsFieldKeyMap=this.operationalConstantsFieldKeyMap;a.gridFieldMap=this.gridFieldMap;a.paneLayout=this.paneLayout;a.keyFieldName=this.keyColumnName;a.bAutoFilterableColumns=this.bAutoFilterableColumns;if(this.columns!=null)a.columns=new SP.JsGrid.ColumnInfoCollection(this.columns);if(this.pivotedColumns!=null){a.pivotedGridParams=new SP.JsGrid.JsGridControl.PivotedGridParameters;a.pivotedGridParams.columns=new SP.JsGrid.ColumnInfoCollection(this.pivotedColumns)}if(this.isGanttEnabled)a.ganttParams=this.InitJsGridGanttParams(a.ganttParams);a.rowViewParams=this.InitJsGridRowViewParams(a.rowViewParams);return a};this.InitJsGridRowViewParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.RowViewParameters;a.hierarchyMode=this.isGrouped?SP.JsGrid.HierarchyMode.Grouping:this.isHierarchyEnabled?SP.JsGrid.HierarchyMode.Standard:SP.JsGrid.HierarchyMode.None;a.groupingLevel=this.groupingLevel;a.groupingRecordKeyPrefix=this.groupingPrefix;a.view=this.view;a.autoFilterState=this.autoFilterState;a.unfilteredHierarchyMgr=this.unfilteredHierarchyMgr;a.hierarchyState=this.hierarchyState;a.sortState=this.sortState;a.autoFilterEntries=this.autoFilterEntries;return a};this.InitJsGridGanttParams=function(b){ULSEWi:;var a=b!=null?b:new SP.JsGrid.JsGridControl.GanttParameters;a.dateRange=[this.ganttInfo.StartDate,this.ganttInfo.FinishDate];a.ganttBarStyles=this.ganttInfo.Styles.barStyles;a.fieldKeyRedrawFilter=this.ganttInfo.Styles.fieldKeyRedrawFilter;return a};this.InitCellStyles=function(a){ULSEWi:;if(this.cellStyles!=null)for(var c in this.cellStyles)a.RegisterCellStyle(c,SP.JsGrid.Style.CreateStyle(SP.JsGrid.Style.Type.Cell,this.cellStyles[c]));if(this.groupingGridRowStyleIds!=null){for(var d=[],b=0;b<this.groupingGridRowStyleIds.length;b++)d.push(a.GetCellStyle(this.groupingGridRowStyleIds[b]));a.groupingStyles=d}};function k(){ULSEWi:;if(c==SP.JsGrid.DeserializationMode.Full)j();else if(c==SP.JsGrid.DeserializationMode.TableView)e();else if(c==SP.JsGrid.DeserializationMode.RowView)g();else if(c==SP.JsGrid.DeserializationMode.Slice)d();else c==SP.JsGrid.DeserializationMode.AutoFilter&&h()}function j(){ULSEWi:;e(b)}function e(){ULSEWi:;var f=b.MultiValueSeparator;b.LookupTableInfo!=null&&c(b.LookupTableInfo);h(b.Fields);e(b.Columns);b.PivotedColumns!=null&&d(b.PivotedColumns);a.paneLayout=b.PaneLayout;a.ganttInfo=b.GanttInfo;a.bAutoFilterableColumns=b.AutoFilterableColumns;g();function h(e){ULSEWi:;a.gridFieldMap={};for(var d=0;d<e.length;d++){var b=e[d],c=new SP.JsGrid.GridField(b.fieldKey,b.hasDataValue,b.hasLocalizedValue,b.textDirection,b.defaultCellStyleId,b.editMode);b.multiValue&&c.SetIsMultiValue(f);c.SetSingleValuePropType(b.propertyTypeId!=null?SP.JsGrid.Internal.Property.GetPropType(b.propertyTypeId):null);a.gridFieldMap[c.key]=c}}function e(e){ULSEWi:;a.columns=[];for(var d=0;d<e.length;d++){var b=e[d],c=new SP.JsGrid.ColumnInfo(b.name,b.imgSrc,b.columnKey,b.width);c.isVisible=b.isVisible;c.isHidable=b.isHidable;c.isResizable=b.isResizable;c.isSortable=b.isSortable;c.isAutoFilterable=b.isAutoFilterable;a.columns.push(c)}}function d(d){ULSEWi:;a.pivotedColumns=[];for(var c=0;c<d.length;c++){var b=d[c],e=new SP.JsGrid.PivotedColumnInfo(b.name,b.imgSrc,b.columnKey,b.fieldKeys,b.width);a.pivotedColumns.push(e)}}function c(b){ULSEWi:;for(var a=0;a<b.length;a++)SP.JsGrid.PropertyType.RegisterNewLookupPropType(b[a].id,b[a].lookup,b[a].showImage&&b[a].showText?SP.JsGrid.DisplayControl.Type.ImageText:b[a].showImage?SP.JsGrid.DisplayControl.Type.Image:SP.JsGrid.DisplayControl.Type.Text,b[a].limitToList)}}function g(){ULSEWi:;a.view=b.ViewInfo;a.autoFilterState=b.AutoFilterState;a.sortState=b.SortState;a.hierarchyState=b.HierarchyState;a.cellStyles=b.CellStyles;a.groupingGridRowStyleIds=b.GroupingGridRowStyleIds;if(b.UnfilteredHierarchy!=null)a.unfilteredHierarchyMgr=new SP.JsGrid.UnfilteredHierarchyManager(b.UnfilteredHierarchy);a.autoFilterEntries=b.AutoFilterEntries;d()}function d(){ULSEWi:;f(b.MetaData);if(b.LocalizedTable!=null&&b.UnlocalizedTable!=null){var e=b.LocalizedTable,d=b.UnlocalizedTable;a.viewDependentKeys=b.ViewDepKeys;a.data={};for(var c=0;c<d.length;c++)a.data[d[c][a.keyColumnName]]={data:d[c],localized:e[c]}}a.additionalParams=b.AdditionalParams}function h(){ULSEWi:;f(b.MetaData);a.autoFilterEntries=b.AutoFilterEntries}function f(b){ULSEWi:;switch(c){case SP.JsGrid.DeserializationMode.Full:case SP.JsGrid.DeserializationMode.TableView:a.isGanttEnabled=b.IsGanttEnabled;a.operationalConstantsFieldKeyMap=b.GridOperationalConstantsFieldKeyMap;a.keyColumnName=b.KeyColumnName;case SP.JsGrid.DeserializationMode.RowView:a.isHierarchyEnabled=b.IsHierarchyEnabled;a.groupingLevel=b.GroupingLevel;a.groupingPrefix=b.GroupingPrefix;a.isGrouped=a.groupingLevel!=0;a.isSorted=b.IsSorted;default:a.recordKeyHash=b.RecordKeyHash;a.recordKeyOrderChanged=b.RecordKeyOrderChanged}}k()};SP.JsGrid.Deserializer.DeserializeFromJson=function(b,a){ULSEWi:;if(a==null)a={};if(!("guid" in a))a["guid"]=function(a){ULSEWi:;return SP.JsGrid.GuidManager.GetIndexForGuid(a)};for(var c in a)b=SP.JsGrid.Deserializer.EvalFunctionCallsInJson(b,c,a[c]);return Sys.Serialization.JavaScriptSerializer.deserialize(b)};SP.JsGrid.Deserializer.EvalFunctionCallsInJson=function(jsonText,prefix,fn){ULSEWi:;var unescapedQuoteRegEx='([^\\\\])\\"',regEx=unescapedQuoteRegEx+Escape(prefix)+"<;>(.+?)"+unescapedQuoteRegEx;return jsonText.replace(eval("/"+regEx+"/g"),function(e,b,c,d){ULSEWi:;var a=fn.apply(null,DeserializeEncodedArray(c+d));return b+(a==null?"":a)});function DeserializeEncodedArray(c){ULSEWi:;for(var b=c.split("<;>"),a=0;a<b.length-1;a++)b[a]=Unescape(b[a]);return b}function Unescape(a){ULSEWi:;return a.replace(/;;/g,";")}function Escape(a){ULSEWi:;return a.replace(/;/g,";;")}};SP.JsGrid.Internal.DiffTracker=function(g,f){ULSEWi:;var a=new k,b={};function k(){ULSEWi:;var a=[];this.AddChange=function(e,d,b){ULSEWi:;var c={changeKey:e,bSynchronized:d};if(b!=null)c.events=b;a.push(c)};this.RemoveChange=function(d){ULSEWi:;var c=b(d);return c!=null?a.splice(c,1):null};this.ContainsKey=function(a){ULSEWi:;return b(a)!=null};this.GetItem=function(d){ULSEWi:;var c=d!=null?b(changeKey):a.length-1;return c!=-1&&c!=null?a[c].changeKey:null};this.AddEvent=function(e,d){ULSEWi:;var c=b(e);if(c!=null){if(a[c].events==null)a[c].events=[];a[c].events.push(d)}};this.RemoveEvent=function(f,e){ULSEWi:;var c=b(f);if(c!=null&&a[c].events!=null)for(var d=0;d<a[c].events.length;d++)if(a[c].events[d]==e){a[c].events.splice(d,1);break}};this.Length=function(){ULSEWi:;return a.length};this.Clear=function(){ULSEWi:;a=[]};this.GetChanges=function(c){ULSEWi:;var e,f;if(c.sliceBeginInfo!=null){e=g(c.sliceBeginInfo);if(e==null&&c.sliceBeginInfo.bCancelQueryIfMissing)return [];else if(e!=null&&!c.sliceBeginInfo.bInclusive)e++}if(c.sliceEndInfo!=null){f=g(c.sliceEndInfo,e==null?null:e+1);if(f==null&&c.sliceEndInfo.bCancelQueryIfMissing)return [];else if(f!=null&&c.sliceEndInfo.bInclusive)f++}return a.slice(e==null?0:e,f==null?a.length:f);function g(a,e){ULSEWi:;var c;if(a.event!=null)c=d(a.event,a.bFindLastOccurence,e);else if(a.changeKey!=null)c=b(a.changeKey,a.bCancelQueryIfMissing);return c}};function b(f,e){ULSEWi:;for(var d=null,c,b=a.length-1;b>=0;b--){c=a[b].changeKey.CompareTo(f);if(c==0){d=b;break}else if(c<0){if(e&&b!=a.length-1)d=b+1;break}}return d}function d(f,h,d){ULSEWi:;for(var e=null,g=d!=null?d:0,b=g;b<a.length;b++)if(c(a[b],f)){e=b;if(!h)break}return e}function c(a,d){ULSEWi:;var c=false;if(a.events!=null)for(var b=0;b<a.events.length;b++)if(a.events[b]==d){c=true;break}return c}}function c(){ULSEWi:;this.sliceBeginInfo=null;this.sliceEndInfo=null;this.recordKeys=null;this.bIncludeInvalidPropUpdates=false}function l(){ULSEWi:;this.event=null;this.bFindLastOccurence=false;this.bInclusive=true;this.bCancelQueryIfMissing=false}function j(){ULSEWi:;this.changeKey=null;this.bInclusive=true;this.bCancelQueryIfMissing=false}this.ExternalAPI={RegisterEvent:function(c,b){ULSEWi:;a.AddEvent(c,b)},UnregisterEvent:function(c,b){ULSEWi:;a.RemoveEvent(c,b)},GetChanges:function(f,g,l,i,j,k,h,e){ULSEWi:;var b=new c;if(f!=null)b.sliceBeginInfo={event:f,bFindLastOccurence:!i,bInclusive:j,bCancelQueryIfMissing:false};if(g!=null)b.sliceEndInfo={event:g,bFindLastOccurence:e,bInclusive:k,bCancelQueryIfMissing:true};return d(a.GetChanges(b),false,null,l,h,e)},GetChangesAsJson:function(b,f,g){ULSEWi:;if(b==null)b=new c;var e=d(a.GetChanges(b),true,f,b.recordKeys,b.bIncludeInvalidPropUpdates,g);return e==null||e.length==0?null:Sys.Serialization.JavaScriptSerializer.serialize(e)},AnyChanges:function(){ULSEWi:;return a.Length()>0},GetUniquePropertyChanges:function(b,e){ULSEWi:;if(b==null)b=new c;return h(e,d(a.GetChanges(b),false,null,b.recordKeys,b.bIncludeInvalidPropUpdates))},ChangeQuery:c,EventSliceInfo:l,ChangeKeySliceInfo:j};this.Clear=function(){ULSEWi:;a.Clear();b={}};this.NotifySynchronizeToChange=function(a){ULSEWi:;e(a,true)};this.NotifyRollbackChange=function(a){ULSEWi:;e(a,false)};this.NotifyVacateChange=function(c){ULSEWi:;if(a.ContainsKey(c))b[c.GetVersionNumber()]=f(c,null,true,false,true)};function e(b,d){ULSEWi:;var c=a.GetItem();if(c!=null&&c==b)c.bWasSynchronized!=d&&a.RemoveChange(b);else a.AddChange(b,d)}function d(p,r,m,n,q,j){ULSEWi:;var e=[];rIdx=0;for(var l=0;l<p.length;l++){e.push(SP.Internal.JS.CloneObj(p[l],false));var k=e[rIdx].changeKey.GetVersionNumber(),c=e[rIdx].updates=k in b?i(b[k],n,j):f(e[rIdx].changeKey,n,!e[rIdx].bSynchronized,j);delete e[rIdx].bSynchronized;delete e[rIdx].events;if(!q&&!j)for(var a=c.length-1;a>=0;a--)if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop&&c[a].validationState!=SP.JsGrid.ValidationState.Valid)c.splice(a,1);else delete c[a].validationState;if(j)for(var a=0;a<c.length;a++)if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete)c[a].type=SP.JsGrid.PostViewChangeType.Delete;else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Insert)c[a].type=SP.JsGrid.PostViewChangeType.Insert;else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Level)c[a].type=SP.JsGrid.PostViewChangeType.Level;if(r){for(var a=0;a<c.length;a++){if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop){var d={};if(c[a].propUpdate.data!=SP.JsGrid.EmptyValue){d.dataValue=SP.Internal.JS.CloneObj(c[a].propUpdate.data,true);d.hasDataValue=true}if(c[a].propUpdate.localized!=SP.JsGrid.EmptyValue){d.localizedValue=c[a].propUpdate.localized;d.hasLocalizedValue=true}c[a].newProp=d;delete c[a].propUpdate}else if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete)delete c[a].afterRecordKey;var s=c[a].recordKey,h=m!=null?m(e[rIdx].changeKey,c[a]):SP.JsGrid.UpdateSerializeMode.Default;if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop&&h==SP.JsGrid.UpdateSerializeMode.Default){var o=c[a].fieldKey,t=g.jsGridParams.tableViewParams.gridFieldMap[o];h=SP.JsGrid.Internal.Property.GetUpdateSerializeMode(g.controller.GetPropType(s,o),t)}if(h==SP.JsGrid.UpdateSerializeMode.Cancel){c.splice(a,1);a--;continue}if(c[a].type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop){var d=c[a].newProp;if(h==SP.JsGrid.UpdateSerializeMode.PropDataOnly){delete d.localizedValue;delete d.hasLocalizedValue}if(h==SP.JsGrid.UpdateSerializeMode.PropLocalizedOnly){delete d.dataValue;delete d.hasDataValue}if("dataValue" in d)d.dataValue=d.dataValue!=null?Sys.Serialization.JavaScriptSerializer.serialize(d.dataValue):null;if("localizedValue" in d)d.localizedValue=escape(d.localizedValue)}}e[rIdx].changeNumber=k;delete e[rIdx].changeKey}if(e[rIdx].updates.length==0)e.splice(rIdx,1);else rIdx++}return e}function i(a,d){ULSEWi:;var c;if(d==null)c=a;else{var e=new SP.JsGrid.Internal.Set;e.AddArray(d);c=[];for(var b=0;b<a.length;b++)e.Contains(a[b])&&c.push(a[b])}}function h(e,f){ULSEWi:;for(var h=SP.JsGrid.Internal.VersionManager.ChangeType.Prop,b={},c=0;c<f.length;c++)for(var g=f[c].updates,d=0;d<g.length;d++){var a=g[d];if(a.type==h)if(e==null||e(a.recordKey,a.fieldKey)){if(b[a.recordKey]==null)b[a.recordKey]={};b[a.recordKey][a.fieldKey]=a.propUpdate}}return b}};SP.JsGrid.Internal.EditActorsRegistrationManager=function(c,i,f,d,h){ULSEWi:;var b={},a={};this.RegisterEditControl=function(a){ULSEWi:;!(a in b)&&g(a);return b[a]};this.RegisterWidgetControl=function(b){ULSEWi:;!(b in a)&&e(b);return a[b]};this.GetEditControlAPI=function(a){ULSEWi:;return b[a]};this.GetWidgetControlAPI=function(b){ULSEWi:;return a[b]};this.GetActorAPI=function(c){ULSEWi:;return b[c]||a[c]};this.IsActorWidget=function(b){ULSEWi:;return b in a};this.GetEditAndWidgetControlsAPI=function(g,f,d,e){ULSEWi:;var c={editControlAPI:null,widgetControlsAPI:[]},a=SP.JsGrid.Internal.Property.GetEditAndWidgetControlNamesForProperty(g,f,d,e);c.editControlAPI=this.RegisterEditControl(a.editControlName);for(var b=0;b<a.widgetControlNames.length;b++)c.widgetControlsAPI.push(this.RegisterWidgetControl(a.widgetControlNames[b]));return c};this.Dispose=function(){ULSEWi:;for(var c in b)b[c].actor.Dispose();for(var c in a)a[c].actor.Dispose()};function g(a){ULSEWi:;var d=f(a),g=[d.GetGridContext()],e=c.focusMgr.GetFocusElementForTextInput(a);e!=null&&g.push(e);d.actor=SP.JsGrid.Internal.Property.GetEditControl(a,g);b[a]=d}function e(b){ULSEWi:;var e=d(b),f=[e.GetGridContext()];b==SP.JsGrid.ErrorWidgetId&&f.push(c.errorMgr);e.actor=SP.JsGrid.Internal.Property.GetWidgetControl(b,f);h(b,e.actor);a[b]=e}};SP.JsGrid.Internal.EditManager=function(d,rb,xb){ULSEWi:;var Ab=d.jsGridObj,Bb=d.styleMgr,cb=d.errorMgr,g={Inited:1,Bound:2,Editing:3},j=this,J=d.parentNode,m=g.Inited,h,D,e,s,z,u,l,t,A,L,c,b,a,n,r,f,q,R,o={},i=tb(),E,v,k,w,I,K,y=new nb,p=new SP.JsGrid.Internal.EditActorsRegistrationManager(d,J,eb,db,ib);d.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,X);function U(a){ULSEWi:;this.jsGridObj=d.jsGridObj;this.parentNode=J;this.styleManager=d.styleMgr;this.RTL=d.RTL;this.emptyValue=SP.JsGrid.EmptyValue;this.bLightFocus=false;this.OnKeyDown=function(b){ULSEWi:;j.OnActorKeyDown(b,a)}}function T(a){ULSEWi:;this.propType;this.originalValue;this.record;this.column;this.field;this.fieldKey;this.cellExpandSpace;this.SetCurrentValue=function(b){ULSEWi:;j.SetCurrentValue(a,b)}}function W(c,f,e,d){ULSEWi:;var b=e(),a=d();this.name=c;this.actor=f;this.SetCellInfo=function(){ULSEWi:;zb(a,p.IsActorWidget(c))};this.UpdateOriginalValue=function(b){ULSEWi:;a.originalValue=b};this.IsLightFocus=function(){ULSEWi:;return b.bLightFocus};this.NotifyEditComplete=function(b){ULSEWi:;a.NotifyEditComplete(b)};this.GetGridContext=function(){ULSEWi:;return b};this.GetCellContext=function(){ULSEWi:;return a}}function gb(a){ULSEWi:;return new U(a)}function fb(b){ULSEWi:;var a=new T(b);a.NotifyExpandWidget=function(){ULSEWi:;j.NotifyExpandWidget(b)};a.NotifyCollapseWidget=function(){ULSEWi:;j.NotifyCollapseWidget(b)};a.NotifyEditComplete=function(a){ULSEWi:;if(a)j.NotifyWidgetEditCancel(b);else M(a)};return a}function db(a,b){ULSEWi:;return new W(a,b,function(){ULSEWi:;return gb(a)},function(){ULSEWi:;return fb(a)})}function lb(a){ULSEWi:;var b=new U(a);b.OnActivateActor=function(){ULSEWi:;P(a)};b.OnDeactivateActor=function(){ULSEWi:;N(a)};return b}function kb(b){ULSEWi:;var a=new T(b);a.NotifyExpandControl=function(){ULSEWi:;j.NotifyExpandControl(b)};a.NotifyEditComplete=function(a){ULSEWi:;M(a)};a.Show=function(a){ULSEWi:;a.style.position="absolute";a.style.left=l.x+1+"px";a.style.top=l.y+1+"px";s.ClipElementToTableViewport(a);a.style.visibility="inherit"};a.Hide=function(a){ULSEWi:;if(!d.focusMgr.ChangeTextInputElementToFocusElement())a.style.visibility="hidden"};return a}function eb(a,b){ULSEWi:;return new W(a,b,function(){ULSEWi:;return lb(a)},function(){ULSEWi:;return kb(a)})}function M(a){ULSEWi:;if(j.IsEditing()||y.GetCurrentEndingState()==g.Editing)y.HandleStateTransition(g.Bound,true,null,[a]);else if(j.IsBound()){C();if(!a){d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditBegin,new SP.JsGrid.EventArgs.CellEditBegin(h.key(),e.key));var b=S();d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditCompleted,new SP.JsGrid.EventArgs.CellEditCompleted(h.key(),e.key,b,a))}d.focusMgr.Focus()}n=null}function zb(a,b){ULSEWi:;a.propType=z;a.originalValue=q;a.record=h;a.column=D;a.field=e;a.fieldKey=e.key;a.cellExpandSpace=A;if(!b){a.cellWidth=l.width-2;a.cellHeight=l.height-2;a.cellStyle=L}else a.cellRect=l}function ib(c,b){ULSEWi:;var a=document.createElement("div");a.className="jsgrid-widget-cell";a.appendChild(b.GetIcon());o[c]=a;i.appendChild(a)}function nb(){ULSEWi:;function k(b,a){ULSEWi:;this.fn=b;this.bArgsRequired=a}var K=[[g.Inited,{promote:new k(J,true)}],[g.Bound,{demote:new k(F,false),promote:new k(y,true)}],[g.Editing,{demote:new k(E,false)}]],v=SP.Internal.JS.ConvertTableToMap(K,"0","1"),j=[];function F(){ULSEWi:;for(var d=0;d<a.length;d++)x(a[d].name);i.style.display="none";for(var d=0;d<i.childNodes.length;d++)i.childNodes[d].style.visibility="hidden";w=null;for(var d=0;d<c.length;d++)c[d].actor.Unbind();h=null;D=null;e=null;s=null;c=null;b=null;a=null;z=null;u=null;l=null;A=null;t=null;L=null;n=null;r={};f={};q=null;w=null}function E(c){ULSEWi:;var a;b.actor.OnEndEdit();C();if(!c)a=S();I=false;r={};f={};d.focusMgr.Focus();d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditCompleted,new SP.JsGrid.EventArgs.CellEditCompleted(h.key(),e.key,a,c))}function J(n,g,o,d,j,m,k){ULSEWi:;h=g;D=o;e=j[d];s=n;z=g.GetProp(d)!=null?g.GetProp(d).propType:j[d].GetPropType();q=H();c=p.GetEditAndWidgetControlsAPI(h,D,e.key,z);b=c.editControlAPI;a=c.widgetControlsAPI;Y(g.key(),d);c=[b].concat(a);r={};f={};if(m!=null)u=m.GetTd();if(k!=null)L=k;l=Z();t=O();A=bb(l,t);b.SetCellInfo();b.actor.BindToCell(b.GetCellContext());for(var i in a){a[i].SetCellInfo();a[i].actor.BindToCell(a[i].GetCellContext())}B()}function y(a){ULSEWi:;n=SP.JsGrid.EmptyValue;G(H());d.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellEditBegin,new SP.JsGrid.EventArgs.CellEditBegin(h.key(),e.key));b.actor.OnBeginEdit(a);b.actor.OnKeyDown!=null&&(a.type=="keypress"||a.type=="keydown")&&b.actor.OnKeyDown(a)}var o=[];this.HandleStateTransition=function(a,e,d,g){ULSEWi:;var c=j.length>0?j[0].newState:m;if(e&&c<=a||!e&&c>=a)i(a,d,g);else{for(var f=Math.abs(c-a),b=1;b<=f;b++){var a=c+b*(e?-1:1),l=b==1&&g!=null?g:o,k=d!=null&&f==b?[d]:o;j.unshift({newState:a,args:l,callbacks:k})}j.length==f&&h()}function h(){ULSEWi:;while(j.length>0){var a=j[j.length-1],c=m<a.newState?v[m].promote.fn:v[m].demote.fn;c.apply(null,a.args);m=a.newState;j.pop();for(var b=0;b<a.callbacks.length;b++)a.callbacks[b]()}}function i(d,b,c){ULSEWi:;for(var a=0;a<j.length;a++)if(j[a]==d){b!=null&&j[a].callbacks.push(b);if(c!=null)j[a].args=c;return}b!=null&&b()}};this.GetCurrentEndingState=function(){ULSEWi:;return j.length>0?j[0].newState:m}}function Z(){ULSEWi:;var a=u.parentNode!=null?s.GetTdCoordsRelativeToParentNode(u):null;return a!=null?{x:a.left,y:a.top,width:a.width,height:a.height}:null}function O(){ULSEWi:;return s.GetTableViewportRelativeToParentNode()}function bb(a,b){ULSEWi:;return {top:a.y-b.top,right:b.right-a.x-a.width,bottom:b.bottom-a.y-a.height,left:a.x-b.left}}function S(){ULSEWi:;var d,a=pb(),c=ub();if(a||c){var b;if(a&&c)b=SP.JsGrid.CreateValidatedPropertyUpdate(h.key(),e.key,f.data,f.localized);else b=SP.JsGrid.CreateUnvalidatedPropertyUpdate(h.key(),e.key,a?f.localized:f.data,a);f={};d=rb([b],"User Edit",null,function(a){ULSEWi:;K=a});X();G(H())}else f={};return d}function pb(){ULSEWi:;var a=false;if(q.localized!=SP.JsGrid.EmptyValue&&"localized" in f){var b=q.localized!=null?q.localized:"";a=b!=f.localized}return a}function ub(){ULSEWi:;var a=false;if(q.data!=SP.JsGrid.EmptyValue&&"data" in f)a=!e.CompareSingleDataEqual(f.data,q.data);return a}function X(){ULSEWi:;if(m>=g.Bound){var c=a.length>0&&a[0].name==SP.JsGrid.ErrorWidgetId;if(c&&!cb.CellHasError(h.key(),e.key)){var b=a[0];b.name==k&&x(b.name);b.actor.Unbind();a.splice(0,1);if(B())o[b.name].style.visibility="hidden"}else if(!c)if(Y(h.key(),e.key)){var b=p.GetWidgetControlAPI(SP.JsGrid.ErrorWidgetId);b.SetCellInfo();b.actor.BindToCell(b.GetCellContext());B()}}}function G(c){ULSEWi:;q=c;b.UpdateOriginalValue(c);for(var d in a)a[d].UpdateOriginalValue(c)}function tb(){ULSEWi:;var a=document.createElement("div");a.className="jsgrid-widget-dock";a.style.display="none";J.appendChild(a);E=SP.Internal.DomElement.SetMouseHover(a,wb,hb,vb);$addHandler(a,"click",sb);$addHandler(a,"mousedown",qb);return a}function sb(c){ULSEWi:;if(c.button==Sys.UI.MouseButton.leftButton)for(var d=SP.Internal.DomElement.GetEventLocation(c),b=0;b<a.length;b++){var e=o[a[b].name];if(SP.Internal.DomElement.PointInDomElem(d.x,d.y,e)){SP.Internal.DomElement.StopEvent(c);if(k!=a[b].name)F(a[b].actor);else x(k);break}}}function qb(a){ULSEWi:;a.stopPropagation()}function wb(){ULSEWi:;i.style.borderColor="#768290"}function hb(){ULSEWi:;if(k==null)i.style.borderColor="";for(var b=0;b<a.length;b++){var c=[];if(a[b].name!=k)o[a[b].name].style.backgroundColor=""}v=null}function vb(e){ULSEWi:;for(var c=SP.Internal.DomElement.GetEventLocation(e),b=0;b<a.length;b++){var d=o[a[b].name];if(SP.Internal.DomElement.PointInDomElem(c.x,c.y,d)){if(v!=a[b].name){if(v!=null&&v!=k)o[v].style.backgroundColor="";v=a[b].name;if(a[b].name!=k)d.style.backgroundColor="#C4C9CF"}break}}}function B(){ULSEWi:;if(l!=null&&t!=null){var b=l,h=t;if(a.length>0){for(var f=5,g=20,m=22,c=g*a.length,k=d.RTL.bEnabled?b.x-(c+2)>=h.left:b.x+b.width+f+(c+2)>h.right,p=b.y+Math.floor((b.height-m)/2),n=k?b.x-(c+2+f):b.x+f+b.width,e=0;e<a.length;e++){var j=o[a[e].name];j.style.left=e*g+"px";j.style.visibility=""}i.style.top=p+"px";i.style.left=n+"px";i.style.width=c+"px";i.style.display="block"}else i.style.display="none";return true}else return false}function H(){ULSEWi:;return xb(h,e.key,z)}function Y(c,d){ULSEWi:;var b=false;if(cb.CellHasError(c,d)){a.unshift(p.RegisterWidgetControl(SP.JsGrid.ErrorWidgetId));b=true}return b}function yb(a){ULSEWi:;if(p.IsActorWidget(a.name))return F(a.actor);else return ob(a.actor)}function mb(a){ULSEWi:;R=r;C(a);if(k!=null&&k!=a)o[k].style.backgroundColor="";o[a].style.backgroundColor="#8C8F93";k=w=a}function x(a){ULSEWi:;V(a);p.GetWidgetControlAPI(a).actor.Collapse()}function V(a){ULSEWi:;if(a==k){o[a].style.backgroundColor="";k=null}}function F(a){ULSEWi:;if(a.Expand!=null){a.Expand();return true}return false}function jb(a){ULSEWi:;C(a);w=a}function ob(a){ULSEWi:;if(a.Expand!=null){a.Expand();return true}return false}function C(d){ULSEWi:;for(var c=0;c<a.length;c++)a[c].name!=d&&x(a[c].name);if(b.actor.Collapse!=null)b.name!=d&&b.actor.Collapse()}function Q(a,d,e){ULSEWi:;f={};if("localized" in a&&a.localized!=SP.JsGrid.EmptyValue){r.localized=a.localized;if(d==SP.JsGrid.EditActorUpdateType.Uncommitted)f.localized=a.localized}if("data" in a&&a.data!=SP.JsGrid.EmptyValue){r.data=a.data;if(d==SP.JsGrid.EditActorUpdateType.Uncommitted)f.data=a.data}for(var b=0;b<c.length;b++)e!=c[b].name&&c[b].actor.OnValueChanged(r,d)}function P(a){ULSEWi:;ab(true,a)}function N(a){ULSEWi:;setTimeout(function(){ULSEWi:;ab(false,a)},0)}function ab(a,b){ULSEWi:;if(!a&&n!=null&&b==n)j.StopEditing(false);else if(a)n=b}this.Unbind=function(a){ULSEWi:;y.HandleStateTransition(g.Inited,true,a)};this.StopEditing=function(c){ULSEWi:;var a=p.GetActorAPI(n)||b;a!=null&&a.NotifyEditComplete(c)};this.BindToCell=function(f,i,h,e,a,c,b,d){ULSEWi:;y.HandleStateTransition(g.Bound,false,d,[f,i,h,e,a,c,b])};this.BeginEdit=function(a,b){ULSEWi:;I=a.type=="keypress";y.HandleStateTransition(g.Editing,false,b,[a])};this.IsBoundToCell=function(c,a,b){ULSEWi:;return m>=g.Bound&&s==c&&h.key()==a&&e.key==b};this.IsBound=function(){ULSEWi:;return m>=g.Bound};this.IsEditing=function(){ULSEWi:;return m>=g.Editing};this.NotifyMove=function(i){ULSEWi:;if(i!=null&&i!=s)return;if(m>=g.Bound){var c=s.GetFocusedCell(),f=c&&c.GetTd();if(f!=null&&u!=null&&h.key()==c.GetRecordKey()&&e.key==c.GetFieldKey()){u=f;l=Z();if(l!=null){t=O();A=bb(l,t);b.SetCellInfo();b.actor.OnCellMove();for(var d=0;d<a.length;d++){x(a[d].name);a[d].SetCellInfo()}B()}}else f==null&&u!=null&&j.Unbind()}};this.NotifyUpdateProperty=function(f,d,e,a,c){ULSEWi:;if(this.IsBoundToCell(f,d,e)){var b={};if(a.HasDataValue())b.data=a.data;if(a.HasLocalizedValue())b.localized=a.localized;G(b);(K==null||c!=null&&c.CompareTo(K)!=0)&&Q(b,SP.JsGrid.EditActorUpdateType.Committed,null)}};this.ExpandWidget=function(c){ULSEWi:;var b=SP.Internal.JS.FindInArray(a,function(a){ULSEWi:;return a.name==c});b!=null&&F(a[b].actor)};this.ExpandNextActor=function(){ULSEWi:;function d(e){ULSEWi:;if(c.length==0||c[0].actor.Expand==null&&c.length==1)return null;var d,b=c[0].actor.Expand!=null?0:1;if(w==null)d=c[b];else for(var a=b;a<c.length;a++)if(c[a].name==w){d=e?a==c.length-1?c[b]:c[a+1]:a==b?c[c.length-1]:c[a-1];break}return d}if(m>=g.Bound&&(b.actor.Expand!=null||a.length)){var e=d(true);return yb(e)}return false};this.NotifyExpandWidget=function(a){ULSEWi:;P(a);mb(a)};this.NotifyCollapseWidget=function(a){ULSEWi:;N(a);V(a)};this.NotifyWidgetEditCancel=function(a){ULSEWi:;r=R;n=null;x(a);if(this.IsEditing())b.actor.Focus();else d.focusMgr.Focus()};this.NotifyExpandControl=function(a){ULSEWi:;jb(a)};this.SetCurrentValue=function(a,b){ULSEWi:;Q(b,SP.JsGrid.EditActorUpdateType.Uncommitted,a)};this.OnActorKeyDown=function(a,c){ULSEWi:;if(!i(a))if(m==g.Bound&&c==b.name)j.BeginEdit(a);else{var f=false,e=c==b.name?b:p.GetWidgetControlAPI(c);if(e.actor.OnKeyDown!=null)f=e.actor.OnKeyDown(a);var h=I||e.IsLightFocus();if(!f&&h)if(d.focusMgr.HandleKeyDown(a))n!=null&&n==c&&j.StopEditing(false)}else SP.Internal.DomElement.StopEvent(a);function i(){ULSEWi:;var b=false;if(a.keyCode==Sys.UI.Key.tab||a.keyCode==Sys.UI.Key.enter){j.StopEditing(false);d.focusMgr.HandleKeyDown(a);b=true}else if(a.keyCode==Sys.UI.Key.esc){j.StopEditing(true);b=true}return b}};this.GetCurrentEditControlName=function(){ULSEWi:;return b.name};this.Dispose=function(){ULSEWi:;this.Unbind(function(){ULSEWi:;p.Dispose();E!=null&&E();$clearHandlers(i);i.innerHTML="";i=null})}};SP.JsGrid.Internal.ErrorType={Row:1,Cell:2};SP.JsGrid.Internal.RecordErrorCollection=function(d){ULSEWi:;function c(){ULSEWi:;this._errors=[]}c.prototype={AddError:function(b,a){ULSEWi:;this._errors.unshift({id:b,msg:a})},RemoveError:function(b){ULSEWi:;var a=SP.Internal.JS.FindInArray(this._errors,function(a){ULSEWi:;return b==a.id});if(a!=null){this._errors.splice(a,1);return true}return false},AnyErrors:function(){ULSEWi:;return this._errors.length!=0},GetTopMessage:function(){ULSEWi:;return this._errors.length>0?this._errors[0].msg:null},GetTopId:function(){ULSEWi:;return this._errors.length>0?this._errors[0].id:null},GetMinError:function(c){ULSEWi:;for(var d=null,b=this._errors.length-1;b>=0;b--){var a=this._errors[b];if(c==null||c(a.id))d={message:a.msg,id:a.id}}return d},ContainsError:function(a){ULSEWi:;return SP.Internal.JS.FindInArray(this._errors,function(b){ULSEWi:;return a==b.id})!=null}};var b=new c,a={};this.AddRowError=function(c,a){ULSEWi:;b.AddError(c,a)};this.AddCellError=function(b,e,d){ULSEWi:;if(!(b in a))a[b]=new c;a[b].AddError(e,d)};this.ClearRowError=function(a){ULSEWi:;return b.RemoveError(a)};this.ClearCellError=function(b,c){ULSEWi:;if(b in a&&a[b].RemoveError(c)){if(!a[b].AnyErrors())delete a[b];return true}return false};this.ClearAllErrorsOnCell=function(b){ULSEWi:;if(b in a)delete a[b]};this.ClearAllErrorsOnRow=function(){ULSEWi:;b=new c};this.AnyErrors=function(){ULSEWi:;return b.AnyErrors()||!SP.Internal.JS.IsAssocArrayEmpty(a)};this.AnyErrorsOnCell=function(b){ULSEWi:;return b in a&&a[b].AnyErrors()};this.AnyErrorsOnRow=function(){ULSEWi:;return b.AnyErrors()};this.GetMessageForCell=function(b){ULSEWi:;return b in a?a[b].GetTopMessage(b):null};this.GetMessageForRow=function(){ULSEWi:;return b.GetTopMessage()};this.GetIdForCell=function(b){ULSEWi:;return b in a?a[b].GetTopId():null};this.GetIdForRow=function(){ULSEWi:;return b.GetTopId()};this.GetMinError=function(e){ULSEWi:;var c=b.GetMinError(e!=null?function(a){ULSEWi:;return e(d,null,a)}:null);if(c!=null)c.type=SP.JsGrid.Internal.ErrorType.Row;for(var g in a){var f=a[g].GetMinError(e!=null?function(a){ULSEWi:;return e(d,g,a)}:null);if(f!=null&&(c==null||f.id<c.id)){c=f;c.fieldKey=g;c.type=SP.JsGrid.Internal.ErrorType.Cell}}return c}};SP.JsGrid.Internal.ErrorManager=function(b){ULSEWi:;var e=0,a={},j=null,f=this,c=new SP.Utilities.Set;b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordInserted,h);b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnBeforeRecordDeleted,i);this.SetRowError=function(c,d){ULSEWi:;var g=this.AnyErrors();if(a[c]==null)a[c]=new SP.JsGrid.Internal.RecordErrorCollection(c);var f=e++;d=d!=null?d:SP.JsGrid.Res.defaultRowMessage;var h=g&&a[c].AnyErrorsOnRow();a[c].AddRowError(f,d);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,true,true,h,f,d));!g&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true));return f};this.ClearRowError=function(c,e){ULSEWi:;if(a[c]!=null&&a[c].ClearRowError(e)){d(c);var f=c in a&&a[c].AnyErrorsOnRow();b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,false,f,true,e));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false));return true}return false};this.SetCellError=function(c,d,i){ULSEWi:;var h=this.AnyErrors();if(a[c]==null)a[c]=new SP.JsGrid.Internal.RecordErrorCollection(c);var g=a[c].AnyErrorsOnCell(d),f=e++;a[c].AddCellError(d,f,i);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,d,true,true,g,f));!h&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true));return f};this.ClearCellError=function(c,e,f){ULSEWi:;if(a[c]!=null&&a[c].ClearCellError(e,f)){d(c);var g=c in a&&a[c].AnyErrorsOnCell(e);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,e,false,g,true,f));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false));return true}return false};this.ClearAllErrorsOnRow=function(c){ULSEWi:;var e=false;if(c in a){e=true;a[c].ClearAllErrorsOnRow();d(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,new SP.JsGrid.EventArgs.OnRowErrorStateChanged(c,false,false,-1));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}return e};this.ClearAllErrorsOnCell=function(c,e){ULSEWi:;var f=false;if(c in a&&a[c].AnyErrorsOnCell(e)){f=true;var g=a[c].GetIdForCell(e);a[c].ClearAllErrorsOnCell(e);d(c);b.eventMgr.FireEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,new SP.JsGrid.EventArgs.OnCellErrorStateChanged(c,e,false,false,g));!this.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}return f};this.CellHasError=function(b,d){ULSEWi:;return b in a&&!c.Contains(b)&&a[b].AnyErrorsOnCell(d)};this.GetMessageForCell=function(b,d){ULSEWi:;return b in a&&!c.Contains(b)?a[b].GetMessageForCell(d):null};this.GetMessageForRow=function(b){ULSEWi:;return b in a&&!c.Contains(b)?a[b].GetMessageForRow():null};this.AnyErrors=function(){ULSEWi:;var b=false;for(var d in a)if(!c.Contains(d)){b=true;break}return b};this.AnyErrorsInRow=function(b){ULSEWi:;return b in a&&!c.Contains(b)&&a[b].AnyErrors()};this.GetNextError=function(c,b){ULSEWi:;var a=null;if(this.AnyErrors()){if(c!=null&&c<e)a=g(function(d,e,a){ULSEWi:;return a>c&&(b==null||b(d,e,a))});if(a==null)a=g(b)}return a};this.GetNextErrorForRecord=function(g,d,f){ULSEWi:;var b=null;if(d in a&&!c.Contains(d)){if(g!=null&&g<e)b=a[d].GetMinError(function(b,c,a){ULSEWi:;return a>g&&(f==null||f(b,c,a))});if(b==null)b=a[d].GetMinError(f);if(b!=null)b.recordKey=d}return b};this.ChangeKeys=function(b,d){ULSEWi:;if(c.Contains(b)){c.Remove(b);c.Add(d)}if(b in a){a[d]=a[b];delete a[b]}};function g(e){ULSEWi:;var b=null;for(var d in a){var c=a[d].GetMinError(e);if(c!=null&&(b==null||c.id<b.id)){b=c;b.recordKey=d}}return b}function h(d){ULSEWi:;var a=f.AnyErrors();c.Remove(d.recordKey);!a&&f.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(true))}function i(d){ULSEWi:;var a=f.AnyErrors();c.Add(d.recordKey);a&&!f.AnyErrors()&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,new SP.JsGrid.EventArgs.GridErrorStateChanged(false))}function d(b){ULSEWi:;if(!a[b].AnyErrors())delete a[b]}};SP.JsGrid.Internal.ErrorNotificationManager=function(){ULSEWi:;var a=null,b,c,d=null;function e(d){ULSEWi:;if(d.bAnyErrors&&a==null)a=addNotification('<div class="jsgrid-error-notification" style="cursor:hand" onclick="'+(c+"_onclick()")+'" >'+String.format(SP.JsGrid.Res.gridErrorNotification,b.jsGridObj.name)+"</div>",true);else if(!d.bAnyErrors&&a!=null){removeNotification(a);a=null}}return {Init:function(f,a){ULSEWi:;b=a;b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnGridErrorStateChanged,e);c=f;window[c+"_onclick"]=function(){ULSEWi:;d=b.jsGridObj.ScrollToAndExpandNextError(d)}}}}();SP.JsGrid.GridField=function(f,e,c,d,b,a){ULSEWi:;this.key=f;this.hasDataValue=e;this.hasLocalizedValue=c;this.textDirection=d;this._defaultCellStyleId=b;this._editMode=a==null?SP.JsGrid.EditMode.Defer:a;this._propType=null;this._multiValue=false};SP.JsGrid.GridField.prototype={GetEditMode:function(){ULSEWi:;return this._editMode},SetEditMode:function(a){ULSEWi:;this._editMode=a},GetDefaultCellStyleId:function(){ULSEWi:;return this._defaultCellStyleId},CompareSingleDataEqual:function(a,b){ULSEWi:;var c=this.GetSingleValuePropType().IsDataEqual;return c==null?a==b:c(a,b)},GetPropType:function(){ULSEWi:;return this._propType},GetSingleValuePropType:function(){ULSEWi:;return this._multiValue?this._propType.singleValuePropType:this._propType},GetMultiValuePropType:function(){ULSEWi:;return this._multiValue?this._propType:null},SetSingleValuePropType:function(a){ULSEWi:;if(this._multiValue&&a!=null){var b=new SP.JsGrid.PropertyType.MultiValuePropType(a.ID,this._listSeparator);SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(b,a.ID);this._propType=b}else this._propType=a},SetIsMultiValue:function(a){ULSEWi:;if(!this._multiValue){this._listSeparator=a;this._multiValue=true;this.SetSingleValuePropType(this._propType)}},GetIsMultiValue:function(){ULSEWi:;return this._multiValue}};SP.JsGrid.ColumnInfo=function(d,b,a,c){ULSEWi:;this.name=d;this.imgSrc=b;this.columnKey=a;this.fieldKeys=[a];this.width=c};SP.JsGrid.ColumnInfo.prototype={ColumnType:function(){ULSEWi:;return "column"},isVisible:true,isHidable:true,isResizable:true,isSortable:true,isAutoFilterable:true,fnShouldLinkSingleValue:null,fnSingleValueClicked:null,fnGetCellEditMode:null,fnGetDisplayControlName:null,fnGetEditControlName:null,fnGetWidgetControlNames:null,fnGetCellStyleId:null,fnGetSingleValueTooltip:null};SP.JsGrid.PivotedColumnInfo=function(e,c,a,b,d){ULSEWi:;this.name=e;this.imgSrc=c;this.columnKey=a;this.fieldKeys=b;this.width=d};SP.JsGrid.PivotedColumnInfo.prototype={ColumnType:function(){ULSEWi:;return "pivotedColumn"},isVisible:true,isHidable:false,isResizable:false,isSortable:false,isAutoFilterable:false,fnShouldLinkSingleValue:null,fnSingleValueClicked:null,fnGetCellEditMode:null,fnGetDisplayControlName:null,fnGetEditControlName:null,fnGetWidgetControlNames:null,fnGetCellStyleId:null,fnGetSingleValueTooltip:null};SP.JsGrid.ColumnInfoCollection=function(a){ULSEWi:;var b={};c();this.GetColumnByKey=function(a){ULSEWi:;return b[a]};this.GetColumnArray=function(d){ULSEWi:;var c=[];if(d)for(var b=0;b<a.length;++b)a[b].isVisible&&c.push(a[b]);else c=a;return c};this.GetColumnMap=function(){ULSEWi:;return b};this.InsertColumnAt=function(d,b){ULSEWi:;a.splice(d,0,b);c()};this.RemoveColumn=function(e){ULSEWi:;var f=b[e],d=SP.Internal.JS.FindKey(a,function(a){ULSEWi:;return a==f});d!=null&&a.splice(d,1);c()};this.GetColumnPosition=function(d){ULSEWi:;for(var c=0,b=0;b<a.length;++b)if(a[b].isVisible){if(a[b].columnKey==d)return c;c++}return null};function c(){ULSEWi:;for(var c=0;c<a.length;++c)b[a[c].columnKey]=a[c]}};SP.JsGrid.Internal.FillDownManager=function(k,m){ULSEWi:;var i,d,b,g,a,c,e,f;this.OnMouseDown=function(c,n,k,e,o,j){ULSEWi:;c.preventDefault();i=o;d=j;b=n;g=k;f=SP.Internal.DomElement.GetEventLocation(c);a=document.createElement("div");a.style.cssText="position:absolute;visibility:hidden;overflow:hidden;top:0px;left:0px";a.style.border=SP.JsGrid.Style.MakeBorderString(3,"solid",m.gridPaneStyle.fillRectBorderColor);g.appendChild(a);SP.Internal.DomElement.SetCapture(e,h,l);h(c)};function h(k){ULSEWi:;var h=d.GetLastSelectionRangeNormalized(),j=i.GetRowIdxColIdxFromCoord(k);if(j.rowIdx==null||j.colIdx==null)return;var l=SP.Internal.DomElement.GetEventLocation(k);e=Math.abs(l.x-f.x)>Math.abs(l.y-f.y);var g;if(e){c=new SP.Utilities.Range(Math.min(h.colRange.begin,j.colIdx),Math.max(h.colRange.end,j.colIdx));g=b.GetCellRangeBorderDrawingInfo(h.rowRange,c)}else{c=new SP.Utilities.Range(Math.min(h.rowRange.begin,j.rowIdx),Math.max(h.rowRange.end,j.rowIdx));g=b.GetCellRangeBorderDrawingInfo(c,h.colRange)}if(g==null){a.style.visibility="hidden";return}a.style.left=g.left-1+"px";a.style.top=g.top-1+"px";a.style.width=g.width-2+"px";a.style.height=g.height-2+"px";a.style.visibility="";b.ClipElementToTableViewport(a)}function l(){ULSEWi:;if(c==null)return;var b=j();n(b.repeatOrigin,b.srcRowRange,b.srcColRange,b.destRowRange,b.destColRange,b.trimmedDestRowRange,b.trimmedDestColRange);g.removeChild(a);a=null}function j(){ULSEWi:;var f=d.GetLastSelectionRangeNormalized(),l,n,m,b,a,j,i;if(e){n=b=j=f.rowRange;a=c;var k=f.colRange.begin!=a.begin;l=k?"TR":"TL";var g=f.colRange.Size();m=k?new SP.Utilities.Range(a.end-g+1,a.end):new SP.Utilities.Range(a.begin,a.begin+g-1);i=k?new SP.Utilities.Range(a.begin,a.end-g):new SP.Utilities.Range(a.begin+g,a.end)}else{m=a=i=f.colRange;b=c;var o=f.rowRange.begin!=b.begin;l=o?"BL":"TL";var h=f.rowRange.Size();n=o?new SP.Utilities.Range(b.end-h+1,b.end):new SP.Utilities.Range(b.begin,b.begin+h-1);j=o?new SP.Utilities.Range(b.begin,b.end-h):new SP.Utilities.Range(b.begin+h,b.end)}return {repeatOrigin:l,srcRowRange:n,srcColRange:m,destRowRange:b,destColRange:a,trimmedDestRowRange:j,trimmedDestColRange:i}}function n(l,g,f,a,e,i,h){ULSEWi:;if(g.Size()==a.Size()&&f.Size()==e.Size())return;var j=b.GetGridPaneConverter(),c;k.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(b){ULSEWi:;return c=j.GetRecordsInvolved(a.begin,a.Size(),function(a){ULSEWi:;c=a;b()})},function(){ULSEWi:;var k=b.GetData(c,g,f);b.PutData(k,c,"Fill",l,i,h,j);function j(){ULSEWi:;d.SelectRange(b,a.begin,a.end,e.begin,e.end,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true,false)}})}};SP.JsGrid.Internal.FocusManager=function(k,b,e,o,u,H,c,f,I,G,C){ULSEWi:;var m=this,g={anchor:0,input:1,parentNode:2},j=g.input,x,a,t=e.parentNode,i,A=true,d,p,h,l,v,K=SP.JsGrid.Internal.SelectionManager.SelectOp;this.SetView=function(c,d,a,b){ULSEWi:;p=c;h=d;l=a;v=b;x.NotifyViewChange()};this.Dispose=function(){ULSEWi:;$clearHandlers(i);$removeHandler(a,"focus",y);$removeHandler(a,"keydown",q);$removeHandler(a,"keypress",w);$removeHandler(a,"keyup",z);a=i=null};this.Focus=function(){ULSEWi:;try{f.IsEditing()&&f.StopEditing(false);r();a.focus()}catch(b){}};this.GetFocusElementForTextInput=function(b){ULSEWi:;if(A&&j==g.input&&b==SP.JsGrid.EditControl.Type.EditBox)return a;else return null};this.ChangeTextInputElementToFocusElement=function(){ULSEWi:;if(n()){a.blur();r();return true}return false};this.HandleKeyDown=function(a){ULSEWi:;var w=a.ctrlKey&&!a.altKey&&!a.shiftKey,x=!a.ctrlKey&&a.altKey&&!a.shiftKey,s=!a.ctrlKey&&!a.altKey&&a.shiftKey,y=!a.ctrlKey&&a.altKey&&a.shiftKey,t=a.ctrlKey&&!a.altKey&&a.shiftKey,r=!a.ctrlKey&&!a.altKey&&!a.shiftKey,i=c.GetFocus();if(!u()||i==null)return false;var k=i.gridPane,n=k.GetGridPaneConverter();if(B()){SP.Internal.DomElement.StopEvent(a);return true}if(J())return true;var M=L()||H()||z()||D()||E()||A();if(M){SP.Internal.DomElement.StopEvent(a);return true}F();return false;function F(){ULSEWi:;!f.IsEditing()&&c.IsOneCellSelected(c.GetLastSelectionRangeNormalized())&&b.eventMgr.FireEvent(SP.JsGrid.EventType.OnSingleCellKeyDown,new SP.JsGrid.EventArgs.SingleCellKeyDown(a,i.recordKey,i.fieldKey))}function J(){ULSEWi:;if(a.keyCode==SP.Internal.Key.IMEInput)return k.TryBeginEdit(a);return false}function L(){ULSEWi:;if(a.keyCode==Sys.UI.Key.esc){b.cutcopypasteMgr.CancelMode();return true}return false}function H(){ULSEWi:;function h(){ULSEWi:;function h(a){ULSEWi:;var c=a.GetColumn(),d=a.GetRecord(),b=a.GetFieldKey();if(d!=null){var e=d.GetProp(b),f=e==null?v[b].GetPropType():e.propType;return SP.JsGrid.Internal.Property.GetDisplayControlForProperty(f,c.fnGetDisplayControlName&&c.fnGetDisplayControlName(c,d,b))}else return null}k.ScrollCellIntoView(i.rowIdx,i.colIdx);var c=k.GetCellByIdx(i.rowIdx,i.colIdx);if(c!=null){var a=h(c),b=c.GetTd().childNodes;if(b&&a&&a.FocusNext&&a.FocusPrevious){var f=a.FocusNext(b,null);if(f!=null){d={};d.displayControl=a;d.displayControlContent=b;d.DOMElement=f;j==g.input&&$addHandler(e,"keydown",q)}}}}function l(){ULSEWi:;var a=b.tableCache.GetCachedRecord(i.recordKey);if(a!=null&&b.editUtil.CanEditField(a,n.GetColumnByIdx(i.colIdx),i.fieldKey)){var c=SP.JsGrid.CreateUnvalidatedPropertyUpdate(i.recordKey,i.fieldKey,null,true);b.jsGridObj.UpdateProperties([c],"User Edit")}}switch(a.keyCode){case Sys.UI.Key.del:if(r||w){if(b.editUtil.IsEditingEnabled())if(r)l();else b.delegateMgr.Apply(SP.JsGrid.DelegateType.DeleteRecords);else alert(o("GridNotEditable"));return true}break;case SP.Internal.Key.insert:if(r){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.InsertRecord);else alert(o("GridNotEditable"));return true}break;case Sys.UI.Key.down:if(x){k.ScrollCellIntoView(i.rowIdx,i.colIdx);var c=k.GetCellByIdx(i.rowIdx,i.colIdx);c!=null&&c.GetRecord()!=null&&f.IsBound()&&f.ExpandNextActor();return true}break;case Sys.UI.Key.up:if(x){h();return true}break;case Sys.UI.Key.right:if(y){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.IndentRecords);else alert(o("GridNotEditable"));return true}break;case Sys.UI.Key.left:if(y){if(b.editUtil.IsEditingEnabled())b.delegateMgr.Apply(SP.JsGrid.DelegateType.OutdentRecords);else alert(o("GridNotEditable"));return true}break;case SP.Internal.Key.comma:if(t)return k.TryShiftColumnSelectionGroup(i.rowIdx,i.colIdx,-1);break;case SP.Internal.Key.dot:if(t)return k.TryShiftColumnSelectionGroup(i.rowIdx,i.colIdx,1);break;case SP.Internal.Key.back_slash:if(x)return k.ExpandColumnMenu(i.colIdx);else if(t){G();return true}break;case SP.Internal.Key.F2:if(r)return k.TryBeginEdit(a)}return false}function z(){ULSEWi:;function f(c,d){ULSEWi:;switch(a.keyCode){case Sys.UI.Key.enter:if(r){if(c!=null)c++}else if(s){if(c!=null)--c}else return null;break;case Sys.UI.Key.down:if(r||s||w||t){if(a.ctrlKey)c=n.GetVirtualRowCount()-1;else if(c!=null)c++}else return null;break;case Sys.UI.Key.up:if(r||s||w||t){if(a.ctrlKey)c=0;else if(c!=null)c--}else return null;break;case Sys.UI.Key.pageDown:if(r||s){if(c!=null){var e=n.RowIdxToRelRowIdx(c),f=n.GetWholeRowDisplayCapacity()-1;e=e!=f?f:f*2;c=n.RelRowIdxToRowIdx(e)}}else return null;break;case Sys.UI.Key.pageUp:if(r||s){if(c!=null){var e=n.RowIdxToRelRowIdx(c),f=n.GetWholeRowDisplayCapacity()-1;e=e!=0?0:-f;c=n.RelRowIdxToRowIdx(e)}}else return null;break;case Sys.UI.Key.home:if(r||s||w||t){d=0;if(a.ctrlKey)c=0}else return null;break;case Sys.UI.Key.end:if(r||s||w||t){d=n.GetVirtualColumnCount()-1;if(a.ctrlKey)c=n.GetVirtualRowCount()-1}else return null;break;case Sys.UI.Key.right:if(r||s){if(d!=null)d=d+(b.RTL.bEnabled?-1:1)}else return null;break;case Sys.UI.Key.left:if(r||s){if(d!=null)d=d-(b.RTL.bEnabled?-1:1)}else return null;break;case SP.Internal.Key.six:if(t){d=0;c=n.GetVirtualRowCount()-1}else return null;break;default:return null}var g;if(c!=null)c=Math.max(0,Math.min(n.GetVirtualRowCount()-1,c));if(d!=null)d=Math.max(0,Math.min(n.GetVirtualColumnCount()-1,d));return {rowIdx:c,colIdx:d}}function g(c,b){ULSEWi:;if(!a.shiftKey){if(++b==n.GetVirtualColumnCount()){b=0;if(++c==n.GetVirtualRowCount())return null}}else if(--b==-1){b=n.GetVirtualColumnCount()-1;if(--c==-1)return null}return {rowIdx:c,colIdx:b}}if(w||x||s||y||r||t)if(a.keyCode==Sys.UI.Key.tab){var d=g(i.rowIdx,i.colIdx);if(d!=null){c.SetFocusByPos(k,d.rowIdx,d.colIdx);return true}}else if(!a.shiftKey||s&&a.keyCode==Sys.UI.Key.enter){var d=f(i.rowIdx,i.colIdx);if(d!=null){c.SetFocusByPos(k,d.rowIdx,d.colIdx);return true}}else{var e=c.GetLastSelectionEndpoints(),d=f(e.rowIdx2,e.colIdx2);if(d!=null){d.rowIdx!=null&&C(d.rowIdx);d.colIdx!=null&&k.ScrollColumnIntoViewHorizontally(d.colIdx);c.SelectRange(k,e.rowIdx1,d.rowIdx,e.colIdx1,d.colIdx,K.Set,false,false);return true}}return false}function D(){ULSEWi:;var b=h.GetGridPaneConverter();if(a.keyCode==Sys.UI.Key.tab){if(p==SP.JsGrid.PaneLayout.GridAndPivotedGrid)if(r){if(k.Id==SP.JsGrid.PaneId.MainGrid){c.SetFocusByPos(l,0,0);return true}}else if(s&&k.Id==SP.JsGrid.PaneId.PivotedGrid){var e=b.GetVirtualRowCount()-1,d=b.GetVirtualColumnCount()-1;c.SetFocusByPos(h,e,d);return true}k.ShowFocus(false)}else if(a.keyCode==SP.Internal.Key.F6)if(p==SP.JsGrid.PaneLayout.GridAndPivotedGrid)if(k.Id==SP.JsGrid.PaneId.MainGrid){c.SetFocusByPos(l,l.GetGridPaneConverter().GetTopRowIdxForKey(i.recordKey),0);return true}else if(k.Id==SP.JsGrid.PaneId.PivotedGrid){c.SetFocusByPos(h,b.GetTopRowIdxForKey(i.recordKey),0);return true}return false}function B(){ULSEWi:;if(d==null)return false;if(a.target==d.DOMElement&&(a.keyCode==Sys.UI.Key.tab||a.keyCode==SP.Internal.Key.shift)){if(a.keyCode==Sys.UI.Key.tab){if(r)d.DOMElement=d.displayControl.FocusNext(d.displayControlContent,d.DOMElement);else if(s)d.DOMElement=d.displayControl.FocusPrevious(d.displayControlContent,d.DOMElement);d.DOMElement==null&&m.Focus()}return true}m.Focus();return false}function E(){ULSEWi:;var c=b.cutcopypasteMgr;if(a.ctrlKey&&!a.altKey&&!a.shiftKey)switch(String.fromCharCode(a.keyCode).toUpperCase()){case "X":c.OnCut(k);return true;case "C":c.OnCopy(k);return true;case "V":c.OnPaste(k);return true}return false}function A(){ULSEWi:;var c=k.GetCellByIdx(i.rowIdx,i.colIdx);if(c!=null){var b=c.GetRecord();if(b!=null){var e=c.GetColumn(),d=c.GetFieldKey(),h=v[d],j=b.GetProp(d),f=j==null?h.GetPropType():j.propType,g=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(f,e.fnGetDisplayControlName&&e.fnGetDisplayControlName(e,b,d));if(g.OnKeyDown!=null)return g.OnKeyDown(a,I(b,d,f),b,e,h,f)}}return false}};function n(){ULSEWi:;return f.IsEditing()&&m.GetFocusElementForTextInput(f.GetCurrentEditControlName())!=null}function y(){ULSEWi:;if(n())return;if(H()){var b=c.GetFocus();if(b==null){var a=h.GetGridPaneConverter();if(a.GetVirtualRowCount()==0)return;else c.SetFocusByPos(h,a.GetTopRowIdx(),h.GetLeftMostColumnIdx())}else b.gridPane.ShowFocus(true);if(d!=null){d=null;j==g.input&&$removeHandler(e,"keydown",q)}}}function q(a){ULSEWi:;if(n())f.OnActorKeyDown(a,f.GetCurrentEditControlName());else if(f.IsEditing())if(j==g.input){f.StopEditing();m.HandleKeyDown(a)}else return;else m.HandleKeyDown(a)}function w(a){ULSEWi:;if(f.IsEditing())return;var b=c.GetFocus();if(!u()||b==null)return;var e=b.gridPane;function d(){ULSEWi:;if(SP.JsGrid.Utility.IsChar(a)&&!a.altKey&&!a.ctrlKey)e.TryBeginEdit(a)&&!n()&&SP.Internal.DomElement.StopEvent(a)}d()}function z(){ULSEWi:;if(f.IsEditing())return;if(j==g.input)a.value=""}function F(){ULSEWi:;switch(j){case g.anchor:a=D();s(a,a);break;case g.input:a=E();r();s(e,e);break;case g.parentNode:a=B();s(e,e)}}function D(){ULSEWi:;var a=document.createElement("a");a.id=k+"_focusElement";a.href="#";t.insertBefore(a,e);a.appendChild(e);return a}function E(){ULSEWi:;var a=document.createElement("input");a.id=k+"_focusElement";a.className="jsgrid-control-editbox";e.insertBefore(a,e.firstChild);return a}function r(){ULSEWi:;var b=a.style;b.position="fixed";b.top="0px";b.left="-10000px";a.value=""}function B(){ULSEWi:;e.tabIndex=0;return e}function s(b,d){ULSEWi:;var a=document.createElement("a");a.href="#";a.className="ms-skip";a.onclick=function(){ULSEWi:;this.href="#"+k+"_skippedGridContent"};SP.Internal.DomElement.SetText(a,SP.JsGrid.Res.skipGridContent);t.insertBefore(a,b);i=document.createElement("a");i.id=k+"_skippedGridContent";i.href="#";t.insertBefore(i,d.nextSibling);$addHandler(i,"keydown",e);function e(d){ULSEWi:;if(d.shiftKey&&d.keyCode==Sys.UI.Key.tab){var g=c.GetFocus();if(g==null){var b=p==SP.JsGrid.PaneLayout.GridAndPivotedGrid?l:h,a=b.GetGridPaneConverter(),f=a.GetVirtualRowCount()-1,e=a.GetVirtualColumnCount()-1;c.SetFocusByPos(b,f,e)}}}}function L(){ULSEWi:;F();x=b.ariaMgr=new J;$addHandler(a,"focus",y);$addHandler(a,"keydown",q);$addHandler(a,"keypress",w);$addHandler(a,"keyup",z)}function J(){ULSEWi:;var d=this;function f(){ULSEWi:;a.setAttribute("role",b.controller.GetHierarchyManager()==null?"grid":"treegrid");var c=document.createElement("label");c.id=a.id+"_labelFor";c.setAttribute("for",a.id);c.appendChild(document.createTextNode(b.jsGridObj.name));c.style.cssText="display:none;";e.appendChild(c);a.setAttribute("aria-label",b.jsGridObj.name);a.setAttribute("aria-labelledby",a.id+"_labelFor");a.setAttribute("aria-multiselectable","true");j==g.input&&a.setAttribute("aria-owns",k)}this.NotifyViewChange=function(){ULSEWi:;d.EnableGrid(u());d.EnableGridEditing(b.editUtil.IsEditingEnabled())};this.EnableGrid=function(b){ULSEWi:;a.setAttribute("aria-disabled",(!b).toString())};this.EnableGridEditing=function(b){ULSEWi:;a.setAttribute("aria-readonly",(!b).toString())};this.OnFocusCell=function(i,j,g,c,f){ULSEWi:;if(j!=null){var e=j.GetTd();e.removeAttribute("id");e.removeAttribute("aria-describedby");d.SetSelected(e,false);if(g!=null){var n=g.GetTd();n.removeAttribute("id")}}if(c!=null){var e=c.GetTd(),l=String.format("{0}_{1}_{2}_{3}",k,i,c.GetRowIdx(),c.GetColIdx());e.setAttribute("id",l);a.setAttribute("aria-activedescendant",l);d.SetSelected(e,true);var m=c.GetRecord(),o=m!=null&&b.editUtil.CanEditField(m,c.GetColumn(),c.GetFieldKey());e.setAttribute("aria-readonly",(!o).toString());if(f!=null){var n=f.GetTd(),h=String.format("{0}_{1}_{2}",k,i,f.GetColIdx());n.setAttribute("id",h);e.setAttribute("aria-describedby",h)}}else a.removeAttribute("aria-activedescendant")};this.OnInsertTableRow=function(e,a,h){ULSEWi:;e.setAttribute("role","row");if(a==null&&h==-1)return;var g=a!=null&&a!=SP.JsGrid.Internal.LoadErrorState,j=g?a.key():null;if(!g)e.setAttribute("aria-busy",a==null?"true":"error");else if(b.controller.GetHierarchyManager()!=null&&!b.entryRecordMgr.IsEntryRecordKey(j)){var f=b.controller.GetHierarchyManager().GetNodeInfo(a);if(f.nodeType==SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed)e.setAttribute("aria-expanded","false");else f.nodeType==SP.JsGrid.Internal.HierarchyManager.NodeType.Expanded&&e.setAttribute("aria-expanded","true");e.setAttribute("aria-level",(f.indent+1).toString())}var k=c.GetFocusedPane(),i=c.IsRowSelected(k,h);d.SetSelected(e,i)};this.OnInsertRowHeaderCell=function(a){ULSEWi:;a.setAttribute("role","presentation")};this.OnInsertColHeaderCell=function(a){ULSEWi:;a.setAttribute("scope","col");a.setAttribute("role","columnheader")};this.OnInsertGridCell=function(a){ULSEWi:;a.setAttribute("role","gridcell")};this.SetSelected=function(b,a){ULSEWi:;b.setAttribute("aria-selected",a.toString())};f()}L()};SP.JsGrid.Internal.GridPane=function(t,c,Hb,hb,U,d,Z,j,R,Yb,l,Tb,Zb,Rb,K){ULSEWi:;var ic=c.intEventMgr,g=c.styleMgr,ec=c.jsGridObj,T=c.delegateMgr,hc=c.intDelegateMgr,db=c.ariaMgr,kb="#B0B5BA",sb="#B0B5BA",i,k=K.selDragHandle,u=K.selFrames,E=K.focusFrames,A=K.copyFrames,Ub,h,s,C,Y=false,m,ac,gc,z,n,r,j,e,y,b=this,wb,D,X,Q,G,P,H,M,tb,f,a,S,w,B=SP.JsGrid.Internal.SelectionManager.SelectOp,p,F,Ab=false,mb,jb,J,o,Bb,ab={width:-1,height:-1},x={};this.Id=SP.JsGrid.PaneId.MainGrid;this.SetEventSinks=function(a){ULSEWi:;ac=a};this.GetLeftMostColumnIdx=function(){ULSEWi:;return m.GetTopItemIdx()};this.Dispose=function(){ULSEWi:;J!=null&&SP.JsGrid.AsynchronousCellUpdater.FlushJob(J);b.ClearView();$clearHandlers(t);$clearHandlers(i);f.Dispose();a.Dispose();m.Dispose();l.Dispose();S.Dispose();i=k=u=E=A=Ub=h=h.textDiv=s=t=null;Ab=true};this.ClearView=function(){ULSEWi:;q();S.ClearHeaderEvents();a.ClearTable()};this.SetView=function(s,q,f,r,h,p,k,o,n,e,j){ULSEWi:;var b=Math.max(0,l.GetHeight()-fb());i.style.height=b+"px";wb=q;X=h;Q=p;G=k;P=o;H=n;M=e;tb=j;D=r;a.SetPosConverterObj(s);var c=a.InitTable(tb);c!=null&&SP.JsGrid.Style.ApplyCornerHeaderBorderStyle(c.GetTd(),g.columnHeaderStyleCollection.normal,g.rowHeaderStyleCollection.normal);cb(f,true);var d=l.GetWidth();m.Update({physicalViewportSize:d-a.GetRowHeaderWidth(),scrollbarSize:d,topItemIdx:0,bScrollNotifiy:false});eb(b);S.SetupHeaderEvents()};this.GetGridPaneConverter=function(){ULSEWi:;return e};this.ShowFocus=function(a){ULSEWi:;W(!a)};this.OnResize=function(){ULSEWi:;var c={width:l.GetWidth(),height:l.GetHeight()};if(c.width!=ab.width||c.height!=ab.height){a.OptimizeTableColumns();yb();var d=l.GetWidth();m.Update({physicalViewportSize:d-a.GetRowHeaderWidth(),scrollbarSize:d});q();j.NotifyMove(b);ab=c}};this.SetRowHeight=function(b){ULSEWi:;Bb=b;a.SetRowHeight(Bb)};this.GetMinRowHeight=function(){ULSEWi:;return 21};this.SpliceRows=function(b,c,e,f,d){ULSEWi:;a.SpliceRows(b,c,e,f);if(r!=null&&r>=b&&r<=b+c-1)r=null;if(d)bb();else q()};this.SetSortState=function(a){ULSEWi:;f.SetSortState(a)};this.SetFilterState=function(a){ULSEWi:;f.SetFilterState(a)};this.NotifyCanEditUpdated=function(){ULSEWi:;vb();W(false)};this.NotifyCopyOperationUpdated=function(){ULSEWi:;ub()};this.UpdateFocusAfterInsertOrDeleteRows=function(c,e,f){ULSEWi:;var a=d.GetFocusForPane(b);if(a!=null)if(f)a.rowIdx>=c&&d.SetFocusByPos(b,a.rowIdx+e,a.colIdx);else if(a.rowIdx>=c&&a.rowIdx<c+e)d.SetFocusByPos(b,Math.max(c-1,0),a.colIdx);else a.rowIdx>=c+e&&d.SetFocusByPos(b,a.rowIdx-e,a.colIdx)};this.ChangeKeys=function(c,b){ULSEWi:;a.ChangeKeys(c,b)};this.RenderRows=function(b){ULSEWi:;a.RenderRows(b)};this.NotifyChangeIndicatorsClearing=function(){ULSEWi:;for(var d=a.GetAllDataCells(),c=0;c<d.length;c++){var b=d[c];if(b.GetRecord()!=null)Z.IsCellIn(b.GetRecordKey(),b.GetFieldKey())&&I(b,true,false)}};this.Select=function(f,g,c,e,a){ULSEWi:;d.SelectRange(b,f,g,c,e,a?B.Append:B.Set,true,false)};this.SelectByKey=function(c,d,a,b,j){ULSEWi:;var h,i,f,g;if(c!=null&&d!=null){h=a!=null?e.KeyToIdx(c,a).rowIdx:e.GetTopRowIdxForKey(c);i=b!=null?e.KeyToIdx(d,b).rowIdx:e.GetTopRowIdxForKey(d)}if(a!=null&&b!=null){f=e.FieldKeyToColIdx(a);g=e.FieldKeyToColIdx(b)}this.Select(h,i,f,g,j)};this.NotifySelectionUpdating=function(){ULSEWi:;var c={rowRange:new SP.Utilities.Range(a.BeginRowIdx(),a.EndRowIdx()-1),colRange:new SP.Utilities.Range(a.BeginColIdx(),a.EndColIdx()-1)},e=d.GetComponentsWithin(b,c.rowRange,c.colRange);return {visibleRanges:c,clearedCells:e,oldFocus:d.GetFocusForPane(b)}};this.ScrollCellIntoView=function(e,d){ULSEWi:;var c=Hb(e),a=b.ScrollColumnIntoViewHorizontally(d);return c||a};this.GetCellByIdx=function(c,b){ULSEWi:;return a.GetCellByIdx(c,b)};this.NotifySelectionUpdated=function(c,l){ULSEWi:;var e=d.GetFocusForPane(b),o=d.GetComponentsWithin(b,c.visibleRanges.rowRange,c.visibleRanges.colRange);m(c.clearedCells,o,c.oldFocus,e);p();var g=false;if(e&&l)g=b.ScrollCellIntoView(e.rowIdx,e.colIdx);!g&&q();vb();var k,i,j,h;if(c.oldFocus!=null){k=a.GetCellByIdx(c.oldFocus.rowIdx,c.oldFocus.colIdx);i=a.GetColumnHeader(c.oldFocus.colIdx)}if(e!=null){j=a.GetCellByIdx(e.rowIdx,e.colIdx);h=a.GetColumnHeader(e.colIdx)}db.OnFocusCell(this.Id,k,i,j,h);function m(i,h,c,b){ULSEWi:;var d=i.SymmetricDifference(h);if(c!=null){d.Remove(SP.JsGrid.Internal.MakeCellKey(c.rowIdx,c.colIdx));e(c)}if(b!=null){d.Remove(SP.JsGrid.Internal.MakeCellKey(b.rowIdx,b.colIdx));e(b)}for(var j in d.GetCollection()){var f=SP.JsGrid.Internal.CrackCellKey(j),g=a.GetCellByIdx(f.rowIdx,f.colIdx);g!=null&&I(g,false,true)}function e(b){ULSEWi:;var c=a.GetCellByIdx(b.rowIdx,b.colIdx);if(c!=null)I(c,false,true);else L(b.recordKey,b.fieldKey,null,false)}}function p(){ULSEWi:;for(var e=a.GetColumnHeaders(),c=0;c<e.length;c++)f.ApplyHeaderStyle(e[c].GetTd(),v(e[c].GetColIdx(),false),e[c].GetColIdx()==n);e=a.GetRowHeaders();for(var c=0;c<e.length;c++){var g=e[c].GetTd();SP.JsGrid.Style.ApplyRowHeaderStyle(g,v(e[c].GetRowIdx(),true),N,e[c].GetRowIdx()==r);var h=d.IsRowSelected(b,e[c].GetRowIdx());db.SetSelected(g.parentNode,h)}}};this.GetMinHeaderHeight=function(){ULSEWi:;return 31};this.SetHeaderHeight=function(b){ULSEWi:;a.SetHeaderHeight(b)};this.ScrollColumnIntoViewHorizontally=function(b){ULSEWi:;if(b<=a.BeginColIdx())return m.Update({topItemIdx:b});else{var f=a.GetColumnHeader(b),d=f&&f.GetTd(),h=d&&(c.RTL.bEnabled?a.GetTdCoords(d).left<0:a.GetTdCoords(d).right>l.GetWidth());if(!d||h){for(var i=a.GetSelectAllSquare()?a.GetSelectAllSquare().GetTd().offsetWidth:0,g=l.GetWidth()-i-e.GetColumnByIdx(b).width;b>0&&(g-=e.GetColumnByIdx(b-1).width,g>=0);b--);return m.Update({topItemIdx:b})}}return false};this.NotifyUpdateProperty=function(b,c,f,d,g,h){ULSEWi:;f&&Z.AddCell(b,c);var e=a.GetCellByKey(b,c);if(e!=null){d!=null&&g==SP.JsGrid.ValidationState.Valid&&j.NotifyUpdateProperty(this,b,c,d,h);a.RefreshCell(e)}};this.BeginRowIdx=function(){ULSEWi:;return a.BeginRowIdx()};this.BeginColIdx=function(){ULSEWi:;return a.BeginColIdx()};this.ShowColumn=function(a,b){ULSEWi:;e.GetColumnByKey(a)==null&&dc(w.GetColumnByKey(a),b)};this.HideColumn=function(b){ULSEWi:;var a=e.GetColumnByKey(b);a!=null&&bc(a)};this.UpdateColumns=function(a){ULSEWi:;cb(a,false)};this.GetVisibleColumns=function(){ULSEWi:;for(var c=[],a=0;a<e.GetVirtualColumnCount();a++){var b=e.GetColumnByIdx(a);c.push({columnKey:b.columnKey,width:b.width})}return c};this.GetAllColumns=function(){ULSEWi:;return w};this.GetColumns=function(){ULSEWi:;for(var c=[],b=w.GetColumnArray(),a=0;a<b.length;a++)c.push(b[a]);return c};this.GetFocusedCell=function(){ULSEWi:;var c=d.GetFocusForPane(b),e=c&&a.GetCellByIdx(c.rowIdx,c.colIdx);return e!=null&&e.GetCellType()==a.CellType.Cell?e:null};this.GetData=function(j,b,a){ULSEWi:;for(var h=new Array(b.Size()),d=b.begin;d<=b.end;d++){for(var g=new Array(a.Size()),f=a.begin;f<=a.end;f++){var i=e.IdxToKey(d,f);g[f-a.begin]=c.editUtil.GetFieldValueForCopy(j[i.recordKey],i.fieldKey)}h[d-b.begin]=g}return {matrix:h,height:b.Size(),width:a.Size()}};this.PutData=function(j,u,r,d,b,a,s,h){ULSEWi:;var m=new Array(b.Size()*a.Size()),i=j.height,k=j.width,v=-b.begin+(d=="TL"||d=="TR"?0:i-b.Size()%i),t=-a.begin+(d=="TL"||d=="BL"?0:k-a.Size()%k),l=c.controller.CreateDataUpdateCmd(true),n=l.GetChangeKey();c.commandMgr.Execute(l,null,SP.JsGrid.CommandManager.CommandType.Explicit);var g=writeRowIdx=b.begin,w=b.Size()*a.Size(),p=100,f=0;c.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.DoLargeTask,w,p,q,o,SP.JsGrid.AsynchronousTaskManager.Priority.SuperHigh);function q(o,q){ULSEWi:;var p;while(g<=b.end){p=false;for(var l=a.begin;l<=a.end;l++){var d=e.IdxToKey(writeRowIdx,l);if(c.editUtil.CanEditField(h?c.entryRecordMgr.GetEntryRecord(d.recordKey):u[d.recordKey],e.GetColumnByIdx(l),d.fieldKey)){m[f++]=SP.JsGrid.CreateUnvalidatedPropertyUpdate(d.recordKey,d.fieldKey,j.matrix[(g+v)%i][(l+t)%k],true);h&&d.recordKey==c.entryRecordMgr.GetLastEntryKey()&&c.entryRecordMgr.CreateEntryRows(1,false,n);p=true}}if(!h||p)writeRowIdx++;g++;o+=a.Size();if(o>=q)break}return o}function o(){ULSEWi:;f>0&&c.controller.UpdateProperties(m.slice(0,f),r,n);l.NotifyInitialUpdateComplete();s(writeRowIdx-b.begin)}};this.FieldKeyToColumnKey=function(c){ULSEWi:;for(var b=w.GetColumnArray(),a=0;a<b.length;a++)if(SP.Internal.JS.FindInArray(b[a].fieldKeys,function(a){ULSEWi:;return a==c})!=null)return b[a].columnKey;return null};function fc(){ULSEWi:;f=new SP.JsGrid.Internal.HeaderManager(c,g);jb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(L);mb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(Lb);J=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(Sb);Gb();Fb();a=new SP.JsGrid.Internal.TableManager(i,t.id,l,Zb,c,Vb,Ob,j,d,h,Qb,Rb,Wb);e=a.GetGridPaneConverter();S=new Jb(b);function j(){ULSEWi:;lb();if(F==null)F=setTimeout(pb,0)}function d(a){ULSEWi:;f.DisposeHeader(a)}function h(a){ULSEWi:;f.UpdateHeaderHeights(a)}t.style.backgroundColor=g.gridPaneStyle.backgroundColor}function Gb(){ULSEWi:;t.style.verticalAlign="top";i=document.createElement("div");i.style.cssText="overflow:hidden;position:relative;text-align:"+c.RTL.left;t.appendChild(i);C=document.createElement("div");C.style.height=SP.Internal.ScrollBar.GetSystemScrollBarThickness()+"px";t.appendChild(C);m=new SP.JsGrid.Internal.ScrollBar(SP.JsGrid.Internal.ScrollBar.BarType.Horizontal,C,false,{itemSize:100},g.scrollBarStyle,c.RTL.bEnabled);m.SetOnScroll(Mb);hb!=null&&m.SetOnVisibilityChanged(Eb,true)}function fb(){ULSEWi:;return C.style.display=="none"?0:SP.Internal.ScrollBar.GetSystemScrollBarThickness()}function Eb(a){ULSEWi:;C.style.display=a?"":"none";yb();hb(a)}function yb(){ULSEWi:;var a=Math.max(0,l.GetHeight()-fb());i.style.height=a+"px";eb(a)}function Mb(c){ULSEWi:;a.ScrollColumns(c.topIdx);q();j.NotifyMove(b)}function cb(k,h){ULSEWi:;var l=d.GetFocusForPane(b);w=k;var i=w.GetColumnArray();p=[];for(var e=[],g=0;g<i.length;g++){var c=i[g];if(c.isVisible){f.AdjustColumnWidth(c);p.push(c.width);e.push(c)}}m.Update({itemCount:e.length,itemSizes:p});a.SetColumns(e,h);if(!h){V(l);q();j.NotifyMove(b)}}function Xb(b){ULSEWi:;r!=null&&zb();r=b;SP.JsGrid.Style.ApplyRowHeaderStyle(a.GetRowHeader(b).GetTd(),v(b,true),N)}function zb(){ULSEWi:;if(r!=null){var b=r;r=null;var c=a.GetRowHeader(b);c!=null&&SP.JsGrid.Style.ApplyRowHeaderStyle(c.GetTd(),v(b,true),N)}}function xb(b){ULSEWi:;if(n!=b){O();n=b;f.ApplyHeaderStyle(a.GetColumnHeader(b).GetTd(),v(b,false),true)}f.ShowMenuOnColumn(a.GetColumnHeader(b).GetTd())}function O(){ULSEWi:;if(n!=null&&(z==null||n!=z)){var b=n;n=null;var c=a.GetColumnHeader(b);c!=null&&f.ApplyHeaderStyle(c.GetTd(),v(b,false));f.HideMenuOnColumn()}}function Fb(){ULSEWi:;h=document.createElement("table");h.style.cssText="position:absolute; visibility:hidden; table-layout:fixed;z-index:1;padding-"+c.RTL.left+":7px;";i.appendChild(h);h.cellPadding=h.cellSpacing=0;var a=h.insertRow(-1).appendChild(document.createElement("th")),b=g.columnHeaderStyleCollection.normal;a.style.borderLeft=a.style.borderRight=SP.JsGrid.Style.MakeBorderString(1,"solid",b.innerBorderColor);a.style.borderTop=SP.JsGrid.Style.MakeBorderString(1,"solid",b.outerBorderColor);h.textDiv=a.appendChild(document.createElement("div"));h.textDiv.style.cssText="text-overflow:none; overflow:hidden; width:100%; margin-"+c.RTL.left+":-1px;";s=document.createElement("div");s.style.cssText="visibility:hidden; width:3px; background-color:"+g.gridPaneStyle.columnDropIndicatorColor+"; position:absolute";i.appendChild(s)}function Sb(c,d,b){ULSEWi:;for(var a=0;a<b.length;a++)b[a]()}function Lb(f,e,k){ULSEWi:;var b=a.GetCellByKey(f,e);if(b==null||!c.editUtil.IsEditingEnabled())return;if(!c.editUtil.CanEditField(b.GetRecord(),b.GetColumn(),e)&&(o==null||o.rk!=f||o.fk!=e)){var d=SP.JsGrid.Style.MergeCellStyles(k,g.readOnlyCellStyle);if(d.backgroundColor!=null){var h=b.GetTd(),j=SP.Internal.DomElement.GetComputedStyle(h,"backgroundColor","background-color"),i=h.computedBackgroundColor;h.computedBackgroundColor=d.backgroundColor;if(i!=j){L(f,e,b);delete d.backgroundColor}SP.JsGrid.Style.ApplyCellStyle(b.GetTd(),d)}else SP.JsGrid.Style.ApplyCellStyle(b.GetTd(),d)}}function L(l,m,w,x){ULSEWi:;var f,j=w==null?a.GetCellByKey(l,m):w;if(j!=null)f=j.GetTd();var h;if(o!=null&&o.rk==l&&o.fk==m){h=o;o=null}if(f==null||j==null)return;var u=Z.IsCellIn(l,m),i=e.KeyToIdx(l,m),q=d.GetFocusForPane(b),t=i!=null&&d.IsCellSelected(b,i.rowIdx,i.colIdx),v=i!=null&&q!=null&&i.rowIdx==q.rowIdx&&i.colIdx==q.colIdx,r=t&&!v,s=null;if(f.computedBackgroundColor==null&&v&&c.editUtil.IsEditingEnabled()&&!c.editUtil.CanEditField(j.GetRecord(),j.GetColumn(),j.GetFieldKey())){o={rk:l,fk:m,textColor:h!=null?h.textColor:f.style.color,backgroundColor:h!=null?h.backgroudColor:f.style.backgroundColor};f.style.color="#4D4E53";f.style.backgroundColor="#E2E2E2";s=true}else if(h!=null){f.style.color=h.textColor;f.style.backgroundColor=h.backgroundColor}if(!s&&(u||r)){var p=f.computedBackgroundColor,k=SP.JsGrid.Internal.Color.HexStringToColor(p=="transparent"||p==null?g.defaultCellStyle.backgroundColor!=null?g.defaultCellStyle.backgroundColor:SP.JsGrid.Style.GetCellStyleDefaultBackgroundColor():p);if(u&&!x){var n=g.gridPaneStyle.changeHighlightCellBgColor;if(n!=null)k=SP.JsGrid.Internal.Color.AlphaBlend(n,k)}if(r){var n=g.gridPaneStyle.selectedCellBgColor;if(n!=null)k=SP.JsGrid.Internal.Color.AlphaBlend(n,k)}f.style.backgroundColor=SP.JsGrid.Internal.Color.ColorToHexString(SP.JsGrid.Internal.Color.RemoveAlphaChannel(k))}db.SetSelected(f,t);return}function Kb(b,m,d,p){ULSEWi:;var a={};if(p)a=SP.JsGrid.Style.MergeCellStyles(g.defaultCellStyle,a);var h=b==null,f;if(h)f=D[d].GetPropType();else{var n=b.GetProp(d);f=n!=null?n.propType:null}if(f!=null&&f.GetStyleId!=null){var i=f.GetStyleId(h?null:b.GetDataValue(d));if(i!=null)a=SP.JsGrid.Style.MergeCellStyles(g.GetCellStyle(i),a)}if(!h){if(c.jsGridParams.tableViewParams.rowViewParams.hierarchyMode==SP.JsGrid.HierarchyMode.Grouping&&g.groupingStyles!=null&&g.groupingStyles.length>0){var j=c.controller.GetHierarchyManager();if(j.IsGroupingRecord(b.key()))a=SP.JsGrid.Style.MergeCellStyles(g.groupingStyles[j.GetNodeIndentLevel(b)%g.groupingStyles.length],a)}var e=X&&X(b);e=e!=null?e:wb.GetValue(b,SP.JsGrid.OperationalConstants.GridRowStyleId);if(e!=null){var k=g.GetCellStyle(e);if(k!=null)a=SP.JsGrid.Style.MergeCellStyles(k,a)}}var l=D[d].GetDefaultCellStyleId();if(l!=null)a=SP.JsGrid.Style.MergeCellStyles(g.GetCellStyle(l),a);if(m.fnGetCellStyleId!=null&&!h){var o=m.fnGetCellStyleId(b,d,b.HasDataValue(d)?b.GetDataValue(d):null);if(o!=null){var i=g.GetCellStyle(o);if(i!=null)a=SP.JsGrid.Style.MergeCellStyles(i,a)}}return a}function I(b,i,j){ULSEWi:;var h=b.GetRecord(),k=b.GetColumn(),d=b.GetFieldKey(),f=b.GetTd(),e=h!=null?h.recordKey:b.GetRecordKey();if(f.style.backgroundColor!="")f.style.backgroundColor="";var a=Kb(h,k,d,false);if(!SP.Internal.JS.IsAssocArrayEmpty(a)){SP.JsGrid.Style.ApplyCellStyle(f,a);if(o!=null&&o.rk==e&&o.fk==d){o.textColor=a.textColor!=null?a.textColor:g.defaultCellStyle.textColor!=null?g.defaultCellStyle.textColor:"";o.backgroundColor=a.backgroundColor!=null?a.backgroundColor:g.defaultCellStyle.backgroundColor!=null?g.defaultCellStyle.backgroundColor:""}}f.computedBackgroundColor=a.backgroundColor;if(j)L(e,d,b,i);else SP.JsGrid.AsynchronousCellUpdater.RegisterCell(jb,e,d);c.editUtil.IsEditingEnabled()&&SP.JsGrid.AsynchronousCellUpdater.RegisterCell(mb,e,d,a);return a}function bb(){ULSEWi:;var a=d.GetFocusForPane(b);a!=null&&d.SelectRange(b,a.rowIdx,a.rowIdx,a.colIdx,a.colIdx,B.Set,false,false)}function vb(){ULSEWi:;var h=d.GetFocusForPane(b);if(h!=null){var e=a.GetCellByIdx(h.rowIdx,h.colIdx);if(e!=null&&e.GetCellType()==a.CellType.Cell){var f=e.GetRecord(),k=e.GetColumn(),g=e.GetFieldKey();if(j.IsBound()&&(f==null||!j.IsBoundToCell(b,f.key(),g)))j.Unbind(function(){ULSEWi:;i(e,f,k,g)});else i(e,f,k,g)}}function i(f,a,e,d){ULSEWi:;!j.IsBound()&&a!=null&&c.editUtil.CanBindToField(a,e,d)&&j.BindToCell(b,a,e,d,D,f,I(f,false,true))}}this.TryShiftColumnSelectionGroup=function(p,j,l){ULSEWi:;var s=false;if(Q){var q=d.GetRowRanges(b),g=d.GetColumnRanges(b),f=d.GetCellRanges(b),t=q==null||q.length==0,c=g==null||g.length==0,m=f==null||f.length==0;if(t&&(c||m)&&(c||g.length==1)&&(m||f.length==1)){var a=c?f[0].colRange:g[0],h=l>0?a.end+1:a.begin-1;if(h>=0&&h<e.GetVirtualColumnCount()){for(var o=c?SP.JsGrid.SelectionType.CellRange:SP.JsGrid.SelectionType.ColumnRange,k=[nb(p,j,c?f[0]:g[0],o,true,false)],r=a.begin;r<=a.end;r++){var n=h+(l>0?-1:1);k.push(qb(h,n));h=n}var i=l>0?1:-1;a.begin+=i;a.end+=i;j+=i;k.push(nb(p,j,c?f[0]:g[0],o,false,true));U.Execute(new SP.JsGrid.CommandManager.AggregateCommand(k,true),"Column Reorder",SP.JsGrid.CommandManager.CommandType.Explicit);s=true}}}return s};function nb(m,l,a,i,j,k){ULSEWi:;var g,h,c,e;if(i==SP.JsGrid.SelectionType.ColumnRange){c=a.begin;e=a.end}if(i==SP.JsGrid.SelectionType.CellRange){c=a.colRange.begin;e=a.colRange.end;g=a.rowRange.begin;h=a.rowRange.end}function f(){ULSEWi:;d.SetFocusByPos(b,m,l);d.SelectRange(b,g,h,c,e,SP.JsGrid.Internal.SelectionManager.SelectOp.Set,true)}return {Apply:!j?f:function(){},Undo:!k?f:function(){}}}function eb(d){ULSEWi:;y={left:1+l.GetLeftOffset(),top:1+a.GetHeaderHeight(),right:1+l.GetLeftOffset()+l.GetWidth(),bottom:1+d};var b=a.GetRowHeaderWidth()?a.GetRowHeaderWidth():0;if(c.RTL.bEnabled)y.right-=b;else y.left+=b}this.GetTdCoordsRelativeToParentNode=function(c){ULSEWi:;var b;if(c.parentNode!=null){b=a.GetTdCoords(c);b.left+=1+l.GetLeftOffset();b.right+=1+l.GetLeftOffset();b.top+=1;b.bottom+=1}return b};this.GetTableViewportRelativeToParentNode=function(){ULSEWi:;return y};this.ClipElementToTableViewport=function(a){ULSEWi:;var e=y.top-a.offsetTop+"px",c=y.right-a.offsetLeft+"px",b=y.bottom-a.offsetTop+"px",d=y.left-a.offsetLeft+"px";a.style.clip=["rect(",e,c,b,d,")"].join(" ")};this.GetCellRangeBorderDrawingInfo=function(e,d){ULSEWi:;var b={},g=a.BeginRowIdx(),i=a.EndRowIdx()-1,f=a.BeginColIdx(),h=a.EndColIdx()-1;b.bBeginsBeforeColumnHeader=e.begin<g;var m=e.begin>i;b.bBeginsBeforeRowHeader=d.begin<f;var n=d.begin>h,r=e.end<g,p=e.end>i,q=d.end<f;if(m||n||r||q)return null;var s=a.GetCellByIdx(Math.max(g,e.begin),c.RTL.bEnabled?Math.min(h,d.end):Math.max(f,d.begin)),o=a.GetCellByIdx(Math.min(i,e.end),c.RTL.bEnabled?Math.max(f,d.begin):Math.min(h,d.end)),k=this.GetTdCoordsRelativeToParentNode(s.GetTd()),j=this.GetTdCoordsRelativeToParentNode(o.GetTd());b.left=k.left;b.top=k.top;b.right=j.right;b.bottom=p?b.top+l.GetHeight()+1:j.bottom;b.width=b.right-b.left-2;b.height=b.bottom-b.top-2;return b};function q(){ULSEWi:;W(false);Pb();ub();a.UpdateErrorFrames()}function W(t){ULSEWi:;function s(){ULSEWi:;k.style.backgroundColor=sb;for(var a in u)u[a].style.borderColor=sb}function m(){ULSEWi:;k.style.visibility="hidden";for(var a in u)u[a].style.visibility="hidden"}if(t){s();return}if(d.GetFocusForPane(b)==null||!e.GetVirtualRowCount()||!e.GetVirtualColumnCount()||!R.IsSelectionCopyable(b)){m();return}var j=d.GetLastSelectionRangeNormalized();if(j==null){m();return}var n=false;if(c.editUtil.IsEditingEnabled()&&d.IsOneCellSelected(j)){var l=a.GetCellByIdx(j.rowRange.begin,j.colRange.begin);if(l!=null&&!c.editUtil.CanEditField(l.GetRecord(),l.GetColumn(),l.GetFieldKey()))n=true}var f=b.GetCellRangeBorderDrawingInfo(j.rowRange,j.colRange);if(f==null){m();return}var p=f.width+2+2,o=f.height+2+2,h={Top:{left:f.left-1,top:f.top-1,width:p,visibility:""},Right:{left:f.right-2,top:f.top-1,height:o,visibility:""},Bottom:{left:f.left-1,top:f.bottom-2,width:p,visibility:""},Left:{left:f.left-1,top:f.top-1,height:o,visibility:""}},r=d.GetLastSelectionType();if(f.bBeginsBeforeRowHeader)h[c.RTL.Left].visibility="hidden";if(f.bBeginsBeforeColumnHeader)h.Top.visibility="hidden";k.style.visibility="hidden";if(c.editUtil.IsEditingEnabled()&&c.jsGridParams.tableViewParams.bFillControlEnabled){k.style.backgroundColor=n?kb:g.gridPaneStyle.selectionRectBorderColor;if(r==SP.JsGrid.SelectionType.RowRange){k.style.visibility="";k.style.top=f.bottom-3+"px";h[c.RTL.Left].height-=5;h.Bottom.width-=9;if(c.RTL.bEnabled)k.style.left=f.right-7+"px";else{k.style.left=f.left+2+"px";h.Bottom.left+=9}}else if(r!=SP.JsGrid.SelectionType.ColumnRange){k.style.visibility="";k.style.top=f.bottom-3+"px";h[c.RTL.Right].height-=5;h.Bottom.width-=5;if(c.RTL.bEnabled){k.style.left=f.left-2+"px";h.Bottom.left+=5}else k.style.left=f.right-3+"px"}}b.ClipElementToTableViewport(k);for(var i in u){u[i].style.visibility=h[i].visibility;delete h[i].visibility;for(var q in h[i])u[i].style[q]=h[i][q]+"px";u[i].style["border"+i]=SP.JsGrid.Style.MakeBorderString(3,"solid",n?kb:g.gridPaneStyle.selectionRectBorderColor);b.ClipElementToTableViewport(u[i])}}function ub(){ULSEWi:;function k(){ULSEWi:;for(var a in A)for(var b in A[a])A[a][b].style.visibility="hidden"}var g=R.GetLastOperation(),a=g!=null&&g.gridPane==b?b.GetCellRangeBorderDrawingInfo(g.rowRange,g.colRange):null;if(a==null){k();return}var j=a.width+2,i=a.height+2,d={Top:{left:a.left,top:a.top,width:j,visibility:""},Right:{left:a.right-2,top:a.top,height:i,visibility:""},Bottom:{left:a.left,top:a.bottom-2,width:j,visibility:""},Left:{left:a.left,top:a.top,height:i,visibility:""}};if(a.bBeginsBeforeRowHeader)d[c.RTL.Left].visibility="hidden";if(a.bBeginsBeforeColumnHeader)d.Top.visibility="hidden";for(var h in A)for(var e in A[h]){for(var f in d[e])A[h][e].style[f]=f=="visibility"?d[e][f]:d[e][f]+"px";b.ClipElementToTableViewport(A[h][e])}}function Pb(){ULSEWi:;function f(){ULSEWi:;for(var a in E)E[a].style.visibility="hidden"}var c=d.GetFocusForPane(b);if(c==null||R.IsSelectionCopyable(b)){f();return}var l=(new SP.Utilities.Range(c.rowIdx,c.rowIdx)).Normalize(),k=(new SP.Utilities.Range(c.colIdx,c.colIdx)).Normalize(),a=b.GetCellRangeBorderDrawingInfo(l,k);if(a==null){f();return}var i=a.width,h=a.height,g={Top:{left:a.left+1,top:a.top+1,width:i},Right:{left:a.right-2,top:a.top+1,height:h},Bottom:{left:a.left+1,top:a.bottom-2,width:i},Left:{left:a.left+1,top:a.top+1,height:h}};for(var e in E){for(var j in g[e])E[e].style[j]=g[e][j]+"px";E[e].style.visibility=""}}function ib(h,c,a){ULSEWi:;a=a!=null?a:e.ColKeyToColIdx(c.columnKey);function f(){ULSEWi:;var e=d.GetFocusForPane(b);Cb(c,a);V(e);q();j.NotifyMove(b)}function g(){ULSEWi:;var e=d.GetFocusForPane(b);Db(c,a);V(e);b.ScrollColumnIntoViewHorizontally(a);q();j.NotifyMove(b)}return h=="hide"?{Apply:f,Undo:g}:{Apply:g,Undo:f}}function V(a){ULSEWi:;if(a!=null)if(e.KeyToIdx(a.recordKey,a.fieldKey)!=null)d.SetFocusByKey(b,a.recordKey,a.fieldKey);else{var c=a.colIdx>=e.GetVirtualColumnCount()?e.GetVirtualColumnCount()-1:a.colIdx;d.Clear();d.SetFocusByPos(b,a.rowIdx,c)}}function Cb(c,b){ULSEWi:;bb();a.RemoveColumns(b,1);p.splice(b,1);m.Update({itemCount:p.length,itemSizes:p});c.isVisible=false}function Db(d,c){ULSEWi:;c<e.GetVirtualColumnCount()&&b.ScrollColumnIntoViewHorizontally(c);bb();f.AdjustColumnWidth(d);a.InsertColumns(c,[d]);p.splice(c,0,d.width);m.Update({itemCount:p.length,itemSizes:p});d.isVisible=true}function Ib(c,b){ULSEWi:;for(var d=w.GetColumnArray(),a=0;a<d.length;a++){if(a>c&&a>b)break;if(!d[a].isVisible){if(a<=c)c++;if(a<=b)b++}}SP.Internal.JS.MoveItemInArray(d,c,b)}function qb(c,a){ULSEWi:;function f(a,f){ULSEWi:;if(a!=f){var c=d.GetFocusForPane(b),h=m.GetTopItemIdx(),g=e.GetColumnByIdx(a);Cb(g,a);Db(g,f);c!=null&&d.SetFocusByKey(b,c.recordKey,c.fieldKey);q();m.Update({topItemIdx:h});Ib(a,f);j.NotifyMove(b)}}return {Apply:function(){ULSEWi:;f(c,a)},Undo:function(){ULSEWi:;f(a,c)}}}function dc(e,c){ULSEWi:;if(c==null)for(var d=0,b=w.GetColumnArray(),a=0;a<b.length;a++){if(b[a]==e){c=a-d;break}if(!b[a].isVisible)d++}U.Execute(ib("show",e,c),"Show Column",SP.JsGrid.CommandManager.CommandType.Implicit)}function bc(a){ULSEWi:;e.GetVirtualColumnCount()!=1&&U.Execute(ib("hide",a,null),"Hide Column",SP.JsGrid.CommandManager.CommandType.Implicit)}function cc(b,a){ULSEWi:;var c=b<a?a-1:a;U.Execute(qb(b,c),"Move Column",SP.JsGrid.CommandManager.CommandType.Explicit)}function ob(a){ULSEWi:;function d(){ULSEWi:;z=null;f.SetColumnMenuCollapsed(a);O();c.focusMgr.Focus()}if(z==null){var b=f.GetColumnMenuElementPosition(a);if(b==null)return false;var g=e.GetColumnByKey(a);z=e.ColKeyToColIdx(a);if(T.DelegatePresent(SP.JsGrid.DelegateType.ExpandColumnMenu)){T.Apply(SP.JsGrid.DelegateType.ExpandColumnMenu,a,b,d);f.SetColumnMenuExpanded(a)}else c.columnMenuMgr.ExpandMenu(g,b,d,P,H,M)&&f.SetColumnMenuExpanded(a);return true}else return false}function Nb(b,a){ULSEWi:;ob(a)&&SP.Internal.DomElement.StopEvent(b)}this.ExpandColumnMenu=function(a){ULSEWi:;if(c.columnMenuMgr.CanExpandMenu(e.GetColumnByIdx(a),P,H,M,G)){b.ScrollColumnIntoViewHorizontally(a);xb(a);return ob(e.ColIdxToColKey(a))}else return false};this.GetColumnConfigurationDialog=function(){ULSEWi:;return new SP.JsGrid.Internal.ColumnConfigurationDialog(w,Q,G,c,function(a){ULSEWi:;cb(a,false)})};this.ShowColumnConfigurationDialog=function(){ULSEWi:;function c(){ULSEWi:;var a=b.GetColumnConfigurationDialog(),c=document.createElement("div");options={};options.title=SP.JsGrid.Res.columnConfigurationName;options.html=c;options.width=a.GetWidth();options.height=a.GetHeight();options.dialogReturnValueCallback=function(){ULSEWi:;a.Close();a=null;Y=false};var d=SP.UI.ModalDialog.showModalDialog(options);a.Open(c,function(){ULSEWi:;d.close(SP.UI.DialogResult.Cancel)})}if(T.DelegatePresent(SP.JsGrid.DelegateType.ShowColumnConfigurationDialog))T.Apply(SP.JsGrid.DelegateType.ShowColumnConfigurationDialog);else if(!Y){var a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(d){a="undefined"}Y=true;EnsureScript("SP.UI.Dialog.js",a,c)}};function Vb(a){ULSEWi:;a!=null&&SP.JsGrid.Style.ApplyRowHeaderStyle(a.GetTd(),a.GetRecord()!=null?v(a.GetRowIdx(),true):g.rowHeaderStyleCollection.normal,N)}function Ob(b,h,g){ULSEWi:;for(var a=0;a<b.length;a++){var e=c.columnMenuMgr.CanExpandMenu(b[a].GetColumn(),P,H,M,G),d=b[a].GetTd();f.CreateTableHeaderCell(b[a].GetColumn(),d,g,Q,G,H,true,e?Nb:null,rb);f.ApplyHeaderStyle(d,v(b[a].GetColIdx(),false))}lb();if(F==null)F=setTimeout(pb,0)}function pb(){ULSEWi:;if(!Ab){var b=a.GetColumnHeader(a.BeginColIdx());b!=null&&f.NotifyColumnHeaderOrderSet(b.GetTd())}F=null}function lb(){ULSEWi:;var b=a.GetColumnHeader(a.BeginColIdx());b!=null&&f.ApplyHeaderStyle(b.GetTd(),v(b.GetColIdx(),false))}function gb(i,d,a,j,g){ULSEWi:;var f=d.GetProp(a),b=f==null?D[a].GetPropType():f.propType,e=SP.JsGrid.Internal.Property.GetDisplayControlForProperty(b,g),h=e.Render(Tb(d,a,b),d,i,D[a],b,j,ec,c.RTL);return {content:h,displayControl:e}}this.GetContentForCell=function(c,d,b,e,a){ULSEWi:;return gb(c,d,b,e,a).content};function Qb(c){ULSEWi:;var f=c.GetRecord(),a,j,l;if(f!=null){var e=c.GetColumn(),d=c.GetFieldKey(),k=e.fnGetDisplayControlName&&e.fnGetDisplayControlName(e,f,d),h=gb(e,f,d,I(c),k);a=h.content;l=h.displayControl}if(a!=null){j=c.GetTd();var b=f.key();if(a.multipleChildren!=null)for(var g=0;g<a.multipleChildren.length;g++)i(a.multipleChildren[g]);else i(a);return true}return false;function i(a){ULSEWi:;if(a.fnDispose!=null){if(x[b]==null)x[b]={};if(x[b][d]==null)x[b][d]=[];x[b][d].push(a.fnDispose);a=a.elem}j.appendChild(a);setTimeout(function(){},0)}}function Wb(a){ULSEWi:;if(a in x){for(var b in x[a])SP.JsGrid.AsynchronousCellUpdater.RegisterCell(J,a,b,x[a][b]);delete x[a]}}this.TryBeginEdit=function(c){ULSEWi:;var a=d.GetFocusForPane(b);if(a==null)return false;b.ScrollCellIntoView(a.rowIdx,a.colIdx);if(j.IsBound()){R.CancelMode();j.BeginEdit(c);return true}return false};function rb(a,b){ULSEWi:;return b?a.previousSibling:a.nextSibling}function N(b,c){ULSEWi:;var a=c?b.parentNode.previousSibling:b.parentNode.nextSibling;return a&&a.firstChild}function v(j,f){ULSEWi:;for(var a=f?g.rowHeaderStyleCollection:g.columnHeaderStyleCollection,e=j==(f?r:n),i=f?[d.GetRowRanges(b),d.GetColumnRanges(b)]:[d.GetColumnRanges(b),d.GetRowRanges(b)],c=0;c<i[0].length;c++)if(i[0][c].Contains(j))return e?a.allSelectedHover:a.allSelected;if(i[1].length!=0)return e?a.partSelectedHover:a.partSelected;for(var h=d.GetCellRanges(b),c=0;c<h.length;c++)if((f?h[c].rowRange:h[c].colRange).Contains(j))return e?a.partSelectedHover:a.partSelected;return e?a.normalHover:a.normal}function Jb(g){ULSEWi:;var o=null,v=null,y=false,A,H,G,r,w=false,b={cellType:null,recordKey:null,fieldKey:null,bPendingClick:false,bPendingDoubleClick:false},u;$addHandler(i,"mousedown",T);$addHandler(i,"mousemove",U);$addHandler(i,"mouseup",V);$addHandler(i,"dblclick",S);$addHandler(k,"mousedown",R);i.oncontextmenu=function(){ULSEWi:;return false};this.SetupHeaderEvents=function(){ULSEWi:;if(!w){r=a.GetColumnHeaderTr();$addHandler(r,"mousedown",N);$addHandler(document.body,"mousemove",D);$addHandler(r,"mouseout",Q)}w=true};this.ClearHeaderEvents=function(){ULSEWi:;if(w){$clearHandlers(r);$removeHandler(document.body,"mousemove",D)}w=false};this.Dispose=function(){ULSEWi:;this.ClearHeaderEvents();$clearHandlers(i);$clearHandlers(k);r=null};function F(i,f){ULSEWi:;var c=f.GetCellType(),h=i.ctrlKey?B.ReplaceLast:B.Set,e=d.GetFocusForPane(g);if(e!=null)if(b.cellType==a.CellType.RowHeader&&(c==a.CellType.RowHeader||c==a.CellType.Cell))d.SelectRange(g,e.rowIdx,f.GetRowIdx(),null,null,h,false,true);else if(b.cellType==a.CellType.ColumnHeader&&(c==a.CellType.ColumnHeader||c==a.CellType.Cell))d.SelectRange(g,null,null,e.colIdx,f.GetColIdx(),h,false,true);else b.cellType==a.CellType.Cell&&c==a.CellType.Cell&&d.SelectRange(g,e.rowIdx,f.GetRowIdx(),e.colIdx,f.GetColIdx(),h,false,true)}function R(b){ULSEWi:;b.button==Sys.UI.MouseButton.leftButton&&d.GetFocusedPane()==g&&Yb.OnMouseDown(b,g,c.parentNode,k,a,d)}function S(c){ULSEWi:;var b=a.GetCellByChildElement(c.target),d=b&&b.GetCellType();d==a.CellType.ColumnHeader&&P();E(c,b,SP.JsGrid.EventType.OnDoubleClick)}function T(e){ULSEWi:;var c=a.GetCellByChildElement(e.target);b={cellType:null,recordKey:null,fieldKey:null,bPendingClick:false,bPendingDoubleClick:false};if(e.button==Sys.UI.MouseButton.leftButton){if(c&&c.GetRowIdx()==null&&!y)return;y=false;f()}else e.button==Sys.UI.MouseButton.rightButton&&E(e,c,SP.JsGrid.EventType.OnRightClick);return;function f(){ULSEWi:;if(c!=null){b.cellType=c.GetCellType();b.recordKey=c.GetRecordKey();b.fieldKey=c.GetFieldKey();var j=d.GetFocusForPane(g);if(b.cellType!=a.CellType.SelectAllSquare){e.preventDefault();u=c;SP.Internal.DomElement.SetCapture(i,M,null)}if(e.shiftKey)F(e,c);else{var h=c.GetRowIdx(),f=c.GetColIdx(),k=e.ctrlKey?B.Append:B.Set;if(b.cellType==a.CellType.RowHeader)d.SelectRange(g,h,h,null,null,k,true,false);else if(b.cellType==a.CellType.ColumnHeader)d.SelectRange(g,null,null,f,f,k,true,false);else b.cellType==a.CellType.Cell&&d.SelectRange(g,h,h,f,f,k,true,false);u=c=a.GetCellByKey(b.recordKey,b.fieldKey);b.bPendingClick=b.bPendingDoubleClick=true}if(b.cellType==a.CellType.Cell&&j!=null&&j.recordKey==b.recordKey&&j.fieldKey==b.fieldKey)g.TryBeginEdit(e)&&e.stopPropagation()}}}function V(f){ULSEWi:;if(b.bPendingClick){var e=a.GetCellByChildElement(f.target);e!=null&&!j.IsEditing()&&d.IsOneCellSelected(d.GetLastSelectionRangeNormalized())&&e.GetCellType()==a.CellType.Cell&&b.recordKey==e.GetRecordKey()&&b.fieldKey==e.GetFieldKey()&&c.eventMgr.FireEvent(SP.JsGrid.EventType.OnSingleCellClick,new SP.JsGrid.EventArgs.SingleCellClick(f,b.recordKey,b.fieldKey));b.bPendingClick=false}}function E(f,d,g){ULSEWi:;var e=d&&d.GetCellType(),k=d&&d.GetRecord(),h=k&&k.key(),i=d&&d.GetFieldKey(),j=e==a.CellType.SelectAllSquare?SP.JsGrid.ClickContext.SelectAllSquare:e==a.CellType.RowHeader?SP.JsGrid.ClickContext.RowHeader:e==a.CellType.ColumnHeader?SP.JsGrid.ClickContext.ColumnHeader:e==a.CellType.Cell?SP.JsGrid.ClickContext.Cell:SP.JsGrid.ClickContext.Other;if(g==SP.JsGrid.EventType.OnRightClick||j!=SP.JsGrid.ClickContext.Cell||b.bPendingDoubleClick&&b.cellType==e&&b.recordKey==h&&b.fieldKey==i){c.eventMgr.FireEvent(g,new SP.JsGrid.EventArgs.Click(f,j,h,i));b.bPendingDoubleClick=false}SP.Internal.DomElement.StopEvent(f)}function M(c){ULSEWi:;var b=a.GetCellByChildElement(c.target);if(b!=null&&(u==null||!u.Equals(b))){F(c,b);u=b}}function U(c){ULSEWi:;var b=a.GetCellByChildElement(c.target);if(b&&b.GetCellType()==a.CellType.RowHeader)Xb(b.GetRowIdx());else zb()}function L(c){ULSEWi:;var a=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"colAction"),b=null;if(a!=null)b=SP.Internal.DomElement.FindAncestorWithProperty(a.elem,"thColumnKey");return {colAction:a!=null?SP.Internal.DomElement.GetCustomAttribute(a.elem,"colAction"):null,thElem:b!=null?b.elem:null}}function N(c){ULSEWi:;if(c.button!=Sys.UI.MouseButton.leftButton)return;j.StopEditing(false);f.HeaderMouseDown(c);var l=SP.Internal.DomElement.GetEventLocation(c);A=l.x;if(z==null){var b=L(c);if(b.colAction=="resize"||b.colAction=="resize-current"){c.preventDefault();var a=b.colAction=="resize"?rb(b.thElem,true):b.thElem;if(a!=null&&a.thColumnKey!=null){SP.Internal.DomElement.SetCapture(r,I,J);o=e.ColKeyToColIdx(a.thColumnKey);H=parseInt(e.GetColumnByKey(a.thColumnKey).width,10);f.SetColumnResizing(a.thColumnKey)}}else if(b.colAction=="move"){c.preventDefault();var a=b.thElem,d=SP.Internal.DomElement.GetLocation(a),m=SP.Internal.DomElement.GetLocation(i),k=SP.Internal.DomElement.GetLocation(t),g=e.GetColumnByKey(a.thColumnKey);G=d.x-k.x;h.style.top=d.y-m.y+"px";h.style.width=a.offsetWidth+1+"px";h.style.height=a.offsetHeight+"px";h.style.backgroundColor=a.style.backgroundColor;SP.Internal.DomElement.SetText(h.textDiv,g.name);SP.Internal.DomElement.SetOpacity(h,.6);h.style.visibility="";s.style.top=h.style.top;s.style.height=h.style.height;s.style.visibility="";SP.Internal.DomElement.SetCapture(r,C,K);v=e.ColKeyToColIdx(a.thColumnKey);f.SetColumnMoving(a.thColumnKey);C(c)}else if(b.colAction=="select")y=true}}function I(i){ULSEWi:;var n=SP.Internal.DomElement.GetLocation(t).x,k=SP.Internal.DomElement.GetEventLocation(i),m=Math.max(n,k.x),h=(m-A)*(c.RTL.bEnabled?-1:1),b=Math.min(Math.max(H+h,SP.JsGrid.Internal.MinColumnWidth),l.GetWidth()-SP.JsGrid.Internal.RowHeaderWidth),d=a.GetColumnHeader(o).GetTd();e.GetColumnByKey(d.thColumnKey).width=b;f.ResizeColumn(d,b);p[o]=b;q();j.NotifyMove(g)}function J(){ULSEWi:;if(o!=null){var b=a.GetColumnHeader(o).GetTd();f.SetColumnResized(b.thColumnKey);a.OptimizeTableColumns();m.Update({itemSizes:p});o=null}}function P(){ULSEWi:;if(n!=null&&n!=z){var c=e.GetColumnByIdx(n);if(c.isResizable){f.SetColumnResizing(c.columnKey);var d=a.GetColumnHeader(n).GetTd(),b=Math.max(f.GetColumnHeaderAutoResizeWidth(d),a.GetColumnAutoResizeWidth(n));if(b!=c.width){c.width=b;f.ResizeColumn(d,b);p[n]=b;q();j.NotifyMove(g);a.OptimizeTableColumns();m.Update({itemSizes:p})}f.SetColumnResized(d.thColumnKey)}}}function C(f){ULSEWi:;var k=SP.Internal.DomElement.GetEventLocation(f),j=k.x-A;h.style.left=G+j+"px";var d=x(f),l=SP.Internal.DomElement.GetLocation(i),e;if(d.insertColIdx==a.EndColIdx()){var b=a.GetColumnHeader(d.insertColIdx-1).GetTd(),g=SP.Internal.DomElement.GetLocation(b);e=g.x+(c.RTL.bEnabled?0:b.offsetWidth)}else{var b=a.GetColumnHeader(d.insertColIdx).GetTd(),g=SP.Internal.DomElement.GetLocation(b);e=g.x+(c.RTL.bEnabled?b.offsetWidth:0)}s.style.left=e-l.x-2+"px";s.style.visibility=""}function K(b){ULSEWi:;h.style.visibility=s.style.visibility="hidden";var c=a.GetColumnHeader(v).GetTd();f.SetColumnMoved(c.thColumnKey);cc(v,x(b).insertColIdx);v=null}function D(b){ULSEWi:;if(o!=null||v!=null)return;var a=x(b,true);if(a.colIdx!=null&&a.bInVertical&&z==null){xb(a.colIdx);f.HeaderMouseMove(b)}else n!=null&&O()}function Q(a){ULSEWi:;var b=x(a);if(!b.bInVertical||b.colIdx==null){f.HeaderMouseOut(a);O()}}function x(w,x){ULSEWi:;var m=SP.Internal.DomElement.GetLocation(i),p=SP.Internal.DomElement.GetEventLocation(w),d=p.x,k=p.y,b=a.GetColumnHeaders(),l=b.length>0&&(k>=m.y&&k<=m.y+b[0].GetTd().offsetHeight),u=l&&k-m.y<f.constEyeBrowHeight,j,e,h,n,q=!u?(f.constResizeWidth+2)*(c.RTL.bEnabled?-1:1):0;if(!x||l&&SP.Internal.DomElement.PointInDomElem(d,k,t)){for(var g=0;g<b.length;g++){e=b[g].GetTd();h=SP.Internal.DomElement.GetLocation(e);if(d>=h.x+(g!=0?q:0)&&d<h.x+e.offsetWidth+(g!=b.length?q:0)){j=b[g].GetColIdx();break}}var r=0;if(e!=null){var v=d-h.x,s=h.x+e.offsetWidth-d;r=s<v?c.RTL.bEnabled?0:1:c.RTL.bEnabled?1:0}var o=SP.Internal.DomElement.GetLocation(b[0].GetTd());n=j!=null?j+r:c.RTL.bEnabled?d>o.x+e.offsetWidth:d<o.x?a.BeginColIdx():a.EndColIdx()}return {colIdx:j,insertColIdx:n,bInVertical:l}}}fc()};SP.JsGrid.Internal.GridPaneConverter=function(h){ULSEWi:;var b,c,a,e,f,d,i=this;this.SetPosConverterObj=function(a){ULSEWi:;b=a};this.SetView=function(a){ULSEWi:;g(a,true)};this.NotifyColumnsChanged=function(a){ULSEWi:;g(a,false)};this.IdxToKey=function(e,d){ULSEWi:;return {recordKey:b.ViewIdxToRecordKey(Math.floor(e/a)),fieldKey:this.IdxToFieldKey(e,d),columnKey:c[d].columnKey}};this.IdxToFieldKey=function(d,b){ULSEWi:;return c[b].fieldKeys[d%a]};this.KeyToIdx=function(h,c){ULSEWi:;var g=f[c];if(g!=null){var i=b.RecordKeyToViewIdx(h)*a+g,d=e[c];if(d!=null)return {rowIdx:i,colIdx:d}}return null};this.GetTopRowIdxForKey=function(c){ULSEWi:;return b.RecordKeyToViewIdx(c)*a};this.GetTopRowIdx=function(){ULSEWi:;return b.GetTopViewIdx()*a};this.RowIdxToViewIdx=function(b){ULSEWi:;return Math.floor(b/a)};this.RowIdxToRelRowIdx=function(c){ULSEWi:;return c-b.GetTopViewIdx()*a};this.RowIdxToRecordKey=function(a){ULSEWi:;return b.ViewIdxToRecordKey(this.RowIdxToViewIdx(a))};this.RelRowIdxToRowIdx=function(c){ULSEWi:;return c+b.GetTopViewIdx()*a};this.ColKeyToColIdx=function(a){ULSEWi:;return d[a]};this.ColIdxToColKey=function(a){ULSEWi:;return c[a].columnKey};this.ColKeyToFieldKeys=function(a){ULSEWi:;return c[d[a]].fieldKeys};this.FieldKeyToColIdx=function(a){ULSEWi:;return e[a]};this.GetWholeRowDisplayCapacity=function(){ULSEWi:;return b.GetWholeRowDisplayCapacity()*a};this.GetRowMultiple=function(){ULSEWi:;return a};this.GetRecordsInvolved=function(c,f,d){ULSEWi:;function g(){ULSEWi:;var a=i.GetRecordsInvolved(c,f,d);a!=null&&d(a)}function j(b){ULSEWi:;for(var c={},a=0;a<b.length;a++)c[b[a].key()]=b[a];return c}var k=(c-c%a)/a,h=Math.ceil((f+c%a)/a),e=b.GetViewRecords(k,h,g);return e.recordSetComplete?j(e.records):null};this.IsRecordOnScreen=function(a){ULSEWi:;return b.IsRecordOnScreen(a)};this.GetRecordKeysInvolved=function(d,h){ULSEWi:;for(var g=(d-d%a)/a,e=Math.ceil((h+d%a)/a),f=new Array(e),c=0;c<e;c++)f[c]=b.ViewIdxToRecordKey(g+c);return f};this.GetVirtualRowCount=function(){ULSEWi:;return (b.GetViewRecordCount()+h.entryRecordMgr.GetEntryRecords().length)*a};this.GetVirtualColumnCount=function(){ULSEWi:;return c.length};this.GetColumnByIdx=function(a){ULSEWi:;return c[a]};this.GetColumnByKey=function(b){ULSEWi:;var a=d[b];return a==null?null:c[a]};function g(h,j){ULSEWi:;c=h;e={};f={};d={};for(var b=0;b<h.length;b++){d[h[b].columnKey]=b;var i=h[b].fieldKeys;if(j)a=i.length;for(var g=0;g<a;g++){e[i[g]]=b;f[i[g]]=g}}}};SP.JsGrid.EmptyValue={};SP.JsGrid.InvalidValue={};SP.JsGrid.GuidManager=function(){ULSEWi:;var a=[],b=[];return {GetIndexForGuid:function(e){ULSEWi:;var d=SP.Internal.JS.LowerBound(a,e,"guid"),c;if(a[d]!=null&&a[d].guid==e)c=a[d].idx;else{c=b.length;b.push({guid:e,idx:c});a.splice(d,0,b[c])}return c},LookupIndexForGuid:function(c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c,"guid"),d=null;if(a[b]!=null&&a[b].guid==c)d=a[b].idx;return d},LookupGuidForIndex:function(a){ULSEWi:;return b[a]!=null?b[a].guid:null}}}();SP.JsGrid.AsynchronousTaskManager=function(){ULSEWi:;var d=[10,75,150,500],a={},e=this,b=0;function c(c,f,i){ULSEWi:;var h=f==null?SP.JsGrid.AsynchronousTaskManager.Priority.High:f,b=i,g=setInterval(function(){ULSEWi:;b in a&&!c(b)&&e.ClearTask(b)},d[h]);b=b!=null?b:g;a[b]={intervalId:g,priority:h,fn:c};return b}this.RegisterTask=function(a,b){ULSEWi:;return c(a,b)};this.SetTaskPriority=function(b,e){ULSEWi:;var d=a[b];this.ClearTask(b);c(d.fn,e,b)};this.GetTaskPriority=function(b){ULSEWi:;return a[b]&&a[b].priority};this.TaskRegistered=function(b){ULSEWi:;return b in a};this.ClearTask=function(c){ULSEWi:;var b=a[c];if(b!=null){clearInterval(b.intervalId);delete a[c]}};this.Stop=function(){ULSEWi:;for(var c in a)clearInterval(a[c].intervalId);b++};this.Resume=function(){ULSEWi:;if(b==1){var e={};for(var d in a)e[d]=a[d];a={};for(var d in e)c(e[d].fn,e[d].priority,d)}b=Math.min(b-1,0)}};SP.JsGrid.AsynchronousTaskManager=new SP.JsGrid.AsynchronousTaskManager;SP.JsGrid.AsynchronousTaskManager.Priority={Low:3,Medium:2,High:1,SuperHigh:0};SP.JsGrid.AsynchronousCellUpdater=function(){ULSEWi:;var b={},c=10,h=0,g=5,f=20,a=SP.JsGrid.AsynchronousTaskManager;function e(c){ULSEWi:;var d=c.cells.length-c.lastCellCount,b=a.GetTaskPriority(c.token)==a.Priority.SuperHigh;if(!b&&d<g){a.SetTaskPriority(c.token,a.Priority.SuperHigh);b=true}else if(b&&d>f){a.SetTaskPriority(c.token,a.Priority.Medium);b=false}return b}function d(h,i){ULSEWi:;var a=b[h],d;if(!i){var g=e(a);d=Math.min(g?c*7:c,a.cells.length)}else d=a.cells.length;for(var l=0,k=false,j=[],f=0;f<d;f++)a.fn.apply(null,a.cells[f]);a.cells.splice(0,d);a.lastCellCount=a.cells.length;return a.cells.length!=0}this.RegisterCell=function(d){ULSEWi:;var c=b[d];if(c.token==null||!a.TaskRegistered(c.token))c.token=a.RegisterTask(c.fnProcess,a.Priority.Medium);c.cells[c.cells.length]=Array.prototype.slice.apply(arguments,[1,arguments.length])};this.ChangeRecordKeys=function(f,e){ULSEWi:;for(var d in b)for(var c=b[d].cells,a=0;a<c.length;a++)if(c[a][0]==f)c[a][0]=e};this.RegisterJob=function(c){ULSEWi:;var a=h++;b[a]={fn:c,cells:[],fnProcess:function(){ULSEWi:;return d(a)},lastCellCount:0};return a};this.FlushJob=function(a){ULSEWi:;a in b&&d(a,true)}};SP.JsGrid.AsynchronousCellUpdater=new SP.JsGrid.AsynchronousCellUpdater;SP.JsGrid.Internal.Color=function(){ULSEWi:;var a={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,A:10,B:11,C:12,D:13,E:14,F:15},b="0123456789ABCDEF";return {MakeColor:function(c,b,a){ULSEWi:;return SP.JsGrid.Internal.Color.MakeAlphaColor(1,c,b,a)},MakeAlphaColor:function(a,d,c,b){ULSEWi:;return {a:a,r:d*a,g:c*a,b:b*a}},RemoveAlphaChannel:function(a){ULSEWi:;return a.a<1?SP.JsGrid.Internal.Color.MakeColor(a.r/a.a,a.g/a.a,a.b/a.a):a},HexStringToColor:function(b){ULSEWi:;function c(b){ULSEWi:;return (a[b.charAt(0)]*16+a[b.charAt(1)])/255}var f;if(b.charAt(0)=="#"){var e=b.toUpperCase();f=SP.JsGrid.Internal.Color.MakeColor(c(e.substr(1,2)),c(e.substr(3,2)),c(e.substr(5,2)))}else if(b.indexOf("rgb(")==0||b.indexOf("RGB(")==0){var d=b.substr(4,b.length-5).split(",");f=SP.JsGrid.Internal.Color.MakeColor(d[0]/255,d[1]/255,d[2]/255)}return f},ColorToHexString:function(c){ULSEWi:;function a(a){ULSEWi:;a=Math.floor(a*255);return b.charAt(Math.floor(a/16))+b.charAt(a%16)}return "#"+a(c.r)+a(c.g)+a(c.b)},AlphaBlend:function(a,b){ULSEWi:;var c=1-a.a;return SP.JsGrid.Internal.Color.MakeAlphaColor(a.a+b.a*c,a.r+c*b.r,a.g+c*b.g,a.b+c*b.b)}}}();SP.Internal.JS={object:function(b){ULSEWi:;function a(){}a.prototype=b;return new a},ConvertTableToMap:function(b,e,c){ULSEWi:;for(var d={},a=0;a<b.length;a++)d[b[a][e]]=c!=null?b[a][c]:b[a];return d},ConvertTableColumnToArray:function(b,d){ULSEWi:;for(var c=[],a=0;a<b.length;a++)c.push(b[a][d]);return c},ConvertSetKeysToArray:function(c){ULSEWi:;var a=[];for(var b in c)a.push(b);return a},ConvertSetDataToArray:function(a){ULSEWi:;var b=[];for(var c in a)b.push(a[c]);return b},ConvertArrayToSet:function(b,d){ULSEWi:;for(var c={},a=0;a<b.length;a++)c[b[a][d]]=b[a];return c},EncodeString:function(a){ULSEWi:;return '"'+a+'"'},MoveItemInArray:function(a,b,d){ULSEWi:;var c=a.splice(b,1);a.splice(d,0,c[0])},GetFirstElement:function(a){ULSEWi:;for(var b in a)return a[b];return undefined},IsAssocArrayEmpty:function(a){ULSEWi:;for(var b in a)return false;return true},GetAssocArraySize:function(b){ULSEWi:;var a=0;for(var c in b)a++;return a},CloneObj:function(a,d){ULSEWi:;if(a==null)return null;if(a.clone!=null&&d)return a.clone();if(a.Clone!=null&&d)return a.Clone();if(a instanceof Array){for(var b=[],e=0;e<a.length;e++)b.push(d?SP.Internal.JS.CloneObj(a[e],true):a[e]);return b}if(a instanceof Date){b=new Date(a.getTime());return b}if(a instanceof Function)return a;if(a instanceof Object){var f=true;for(var c in a)f=f&&!(a[c]instanceof Function);if(f){var b={};for(var c in a)if(!(c in b))b[c]=d?SP.Internal.JS.CloneObj(a[c],true):a[c]}return b}return a},BinarySearch:function(a,d,c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,d,c);return b===a.length||(c?a[b][c]:a[b])!==d?null:b},LowerBound:function(a,c,b){ULSEWi:;return SP.Internal.JS.LowerBoundCompare(a,c,function(d,e){ULSEWi:;var c=b?a[d][b]:a[d];return e>c?1:c>e?-1:0})},LowerBoundCompare:function(d,f,e){ULSEWi:;var c=-1,b=d.length,a;while(b-c>1){a=c+b>>>1;e(a,f)>0?(c=a):(b=a)}return b},UpperBound:function(c,g,e){ULSEWi:;var d=-1,b=c.length,a;while(b-d>1){a=d+b>>>1;var f=e?c[a][e]:c[a];g>=f?(d=a):(b=a)}return b},Compose:function(a,b){ULSEWi:;return function(d){ULSEWi:;var c=b?b(d):d;return a?a(c):c}},FindInArray:function(b,d,e){ULSEWi:;for(var c,a=0;a<b.length;a++)if(d(b[a])){c=a;if(!e)break}return c},Find:function(a,c,d){ULSEWi:;var b=SP.Internal.JS.FindKey(a,c,d);return b==null?null:a[b]},FindKey:function(a,d,e){ULSEWi:;var c=undefined;for(var b in a)if(d(a[b])){c=b;if(!e)break}return c},RoundTo:function(a,c){ULSEWi:;var b=Math.pow(10,c);return a==0?a:Math.round(a*b)/b},_shutUpKeys:null,CoalesceFunctionCalls:function(b,e,c){ULSEWi:;if(this._shutUpKeys==null)this._shutUpKeys=new SP.Utilities.Set;var a=this._shutUpKeys;if(!a.Contains(b)){a.Add(b);setTimeout(d,c==null?0:c)}function d(){ULSEWi:;a.Remove(b);e()}},Flatten2LevelArray:function(a){ULSEWi:;var c=[];for(var b in a)for(var d in a[b])c.push(a[b][d]);return c},TokenizeString:function(a,f){ULSEWi:;var d=[];if(a!=null&&a!=SP.JsGrid.EmtpyValue)for(var c=a.split(f),b=0;b<c.length;b++){var e=c[b].replace(/^\s+|\s+$/g,"");e!=""&&d.push(e)}return d},JoinStrings:function(a,d){ULSEWi:;if(a==null)return null;for(var c=[],b=0;b<a.length;b++)a[b]!=""&&a[b]!=null&&c.push(a[b]);return c.join(d)},ProfilerMark:function(a){ULSEWi:;window.msWriteProfilerMark&&window.msWriteProfilerMark(a)}};SP.JsGrid.EventArgs={CellFocusChanged:function(a,c,b,d){ULSEWi:;return {newRecordKey:a,newFieldKey:c,oldRecordKey:b,oldFieldKey:d}},RowFocusChanged:function(a,b){ULSEWi:;return {newRecordKey:a,oldRecordKey:b}},CellEditBegin:function(a,b){ULSEWi:;return {recordKey:a,fieldKey:b}},CellEditCompleted:function(c,d,b,a){ULSEWi:;return {recordKey:c,fieldKey:d,changeKey:b,bCancelled:a}},Click:function(a,d,b,c){ULSEWi:;return {eventInfo:a,context:d,recordKey:b,fieldKey:c}},PropertyChanged:function(c,d,g,f,e,b,a){ULSEWi:;return {recordKey:c,fieldKey:d,oldProp:g,newProp:f,propType:e,changeKey:b,validationState:a}},RecordInserted:function(d,c,a,b){ULSEWi:;return {recordKey:d,recordIdx:c,afterRecordKey:a,changeKey:b}},RecordDeleted:function(c,b,a){ULSEWi:;return {recordKey:c,recordIdx:b,changeKey:a}},RecordChecked:function(a,b){ULSEWi:;return {recordKeySet:a,bChecked:b}},OnCellErrorStateChanged:function(d,e,c,a,b,f){ULSEWi:;return {recordKey:d,fieldKey:e,bAddingError:c,bCellCurrentlyHasError:a,bCellHadError:b,errorId:f}},OnRowErrorStateChanged:function(d,b,a,c,e,f){ULSEWi:;return {recordKey:d,bAddingError:b,bErrorCurrentlyInRow:a,bRowHadError:c,errorId:e,message:f}},OnEntryRecordAdded:function(a){ULSEWi:;return {recordKey:a}},OnEntryRecordCommitted:function(a,c,b){ULSEWi:;return {originalRecordKey:a,recordKey:c,changeKey:b}},SingleCellClick:function(a,b,c){ULSEWi:;return {eventInfo:a,recordKey:b,fieldKey:c}},PendingChangeKeyInitiallyComplete:function(a){ULSEWi:;return {changeKey:a}},VacateChange:function(a){ULSEWi:;return {changeKey:a}},GridErrorStateChanged:function(a){ULSEWi:;return {bAnyErrors:a}},SingleCellKeyDown:function(a,b,c){ULSEWi:;return {eventInfo:a,recordKey:b,fieldKey:c}}};SP.JsGrid.Internal.EventArgs={OnRowHeaderStateChanged:function(b,a){ULSEWi:;return {recordKey:b,rowHeaderState:a}},ChangeKeyStageUpdated:function(a){ULSEWi:;return {changeKey:a}},RecordInserted:function(a){ULSEWi:;return {recordKey:a}},RecordDeleted:function(a){ULSEWi:;return {recordKey:a}}};SP.JsGrid.Image=function(d,c,a,b){ULSEWi:;this.imgSrc=d;this.bIsClustered=c;this.outerCssNames=a;this.imgCssNames=b};SP.JsGrid.Image.prototype={Render:function(d,b){ULSEWi:;if(this.imgSrc==null)return null;var a=document.createElement("img");a.style.border=0;a.src=this.imgSrc;if(d!=null){a.title=d;a.alt=a.title=d}else a.alt="";if(this.imgCssNames!=null)a.className=this.imgCssNames;if(this.bIsClustered){var c=document.createElement("div");c.className=this.outerCssNames;c.appendChild(a);a=c}if(b!=null){$addHandler(a,"mousedown",b);$addHandler(a,"keydown",function(a){ULSEWi:;if(a.keyCode==Sys.UI.Key.enter){b(a);SP.Internal.DomElement.StopEvent(a)}});a.style.cursor="pointer";a.tabIndex=-1}if(b!=null)a.Dispose=function(){ULSEWi:;$clearHandlers(a);b=null;c=null;a.Dispose=null;a=null};return a}};SP.JsGrid.ApplyServerChangesToGrid=function(i,h,p,u,q,l){ULSEWi:;var g;if(h!=null)for(var j=0;j<h.length;j++){for(var c=h[j],b=[],d=[],m=[],k=0;k<c.updates.length;k++){var a=c.updates[k];if(a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Prop)b.push(r(a.recordKey,a.fieldKey,a.newProp));else if(a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Insert)m.push(a);else a.type==SP.JsGrid.Internal.VersionManager.ChangeType.Delete&&d.push(a.recordKey)}t(m);o(b);s(d);n()}function r(c,d,a){ULSEWi:;var b;if(a.hasLocalizedValue&&a.hasDataValue)b=SP.JsGrid.CreateValidatedPropertyUpdate(c,d,a.dataValue,a.localizedValue);else b=SP.JsGrid.CreateUnvalidatedPropertyUpdate(c,d,a.hasDataValue?a.dataValue:a.localizedValue,!a.hasDataValue);return b}function f(){ULSEWi:;var a=g;if(a==null&&!q)if(c.changeNumber!=-1)a=i.GetChangeKeyForVersion(c.changeNumber);return a}function e(a){ULSEWi:;g=a}function n(){ULSEWi:;g=null;optChangeKey=null}function t(b){ULSEWi:;for(var a=0;a<b.length;a++){var c=p(b[a].afterRecordKey,b[a].recordKey,f());e(c)}}function o(){ULSEWi:;if(b.length>0){var a=i.UpdateProperties(b,null,f());l!=null&&l(b,a);e(a)}}function s(){ULSEWi:;if(d.length>0){var a=i.DeleteRecords(d,f());e(a)}}};SP.JsGrid.EventManager=function(){ULSEWi:;var a={};this.FireEvent=function(d,c){ULSEWi:;var b=a[d];if(b!=null)for(var e in b)b[e](c)};this.AttachEvent=function(b,c){ULSEWi:;if(a[b]==null)a[b]=[];a[b].push(c)};this.DetachEvent=function(b,d){ULSEWi:;if(a[b]!=null){var c=SP.Internal.JS.FindInArray(a[b],function(a){ULSEWi:;return a==d});c!=null&&a[b].splice(c,1)}}};SP.JsGrid.DelegateManager=function(){ULSEWi:;var a={};this.SetDelegate=function(b,c){ULSEWi:;if(c!=null)a[b]=c;else delete a[b]};this.DelegatePresent=function(b){ULSEWi:;return b in a};this.GetDelegate=function(b){ULSEWi:;return a[b]};this.Apply=function(){ULSEWi:;var b=a[arguments[0]];if(b!=null)return b.apply(null,Array.prototype.slice.call(arguments,1))}};SP.JsGrid.MakeShapeStyle=function(b,a){ULSEWi:;return {shape:b,color:a}};SP.JsGrid.MakeBarStyle=function(f,e,d,a,b,c){ULSEWi:;return {shape:f,color:e,pattern:d,start:a,end:b,strokeWeight:c}};SP.JsGrid.Internal.EmptyFunction=function(){};SP.JsGrid.Internal.CrackCellKey=function(b){ULSEWi:;var a=b.split(",");return {rowIdx:a[0],colIdx:a[1]}};SP.JsGrid.Internal.MakeCellKey=function(b,a){ULSEWi:;return [b,a].join()};Type.registerNamespace("SP.Internal.DomElement");SP.Internal.DomElement=function(){ULSEWi:;var f=1,a,d,e,k,g;function h(b){ULSEWi:;if(a!=null&&b.button==Sys.UI.MouseButton.leftButton)d!=null&&d(g?b:o(b))}function i(b){ULSEWi:;if(a!=null&&b.button==Sys.UI.MouseButton.leftButton){e!=null&&e(g?b:o(b));l()}}function b(a){ULSEWi:;a.stopPropagation();a.preventDefault()}function o(a){ULSEWi:;return new Sys.UI.DomEvent(a)}function q(f,b,c){ULSEWi:;g=true;a=f;d=b;e=c;$addHandler(document,"mousemove",h);$addHandler(document,"mouseup",i);a.setCapture(true)}function p(j,c,f){ULSEWi:;g=false;a=j;d=c;e=f;k=document.body.style.cursor;document.body.style.cursor=SP.Internal.DomElement.GetComputedStyle(a,"cursor","cursor");document.addEventListener("mousemove",h,true);document.addEventListener("mouseup",i,true);document.addEventListener("mouseover",b,true);document.addEventListener("mouseenter",b,true);document.addEventListener("mouseleave",b,true)}function l(){ULSEWi:;if(a!=null){if(g){a.releaseCapture();$removeHandler(document,"mousemove",h);$removeHandler(document,"mouseup",i)}else{document.body.style.cursor=k;document.removeEventListener("mousemove",h,true);document.removeEventListener("mouseup",i,true);document.removeEventListener("mouseover",b,true);document.removeEventListener("mouseenter",b,true);document.removeEventListener("mouseleave",b,true)}a=null;d=null;e=null;k=null}}function j(){ULSEWi:;if(c.BrowserIsIE){var a,b;if((a=$get("__iezoomtest1"))==null||(b=$get("__iezoomtest2"))==null){a=document.createElement("div");b=document.createElement("div");a.style.cssText="position:absolute;top:0px;left:0px";b.style.cssText="position:absolute;top:0px;left:200px";a.appendChild(b);a.id="__iezoomtest1";b.id="__iezoomtest2";document.body.appendChild(a)}var d=Sys.UI.DomElement.getLocation(a),e=Sys.UI.DomElement.getLocation(b);f=(e.x-d.x)/200;if(f==0)f=1}}function r(a,c){ULSEWi:;var b=a.rawEvent;a.wheelDelta=Math.round(b.wheelDelta!=null?b.wheelDelta/-40:b.detail);c(a)}for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c={PointInDomElem:function(d,e,b,c){ULSEWi:;var a=c==null?SP.Internal.DomElement.GetLocation(b):c;return a.x<=d&&a.x+b.offsetWidth>=d&&a.y<=e&&a.y+b.offsetHeight>=e},ReleaseCapture:l,StopEvent:b,ForceIEZoomFactorRecomputation:j,GetLocation:function(a){ULSEWi:;return SP.Internal.DomElement.AdjustCoordsForIEZoom(Sys.UI.DomElement.getLocation(a))},GetEventLocation:function(a){ULSEWi:;var b=SP.Internal.DomElement.GetScreenOffsets();return SP.Internal.DomElement.AdjustCoordsForIEZoom({x:a.clientX+b.left,y:a.clientY+b.top})},GetNextElement:function(b){ULSEWi:;do var a=b.nextSibling;while(a&&a.nodeType!=1);return a},GetPrevElement:function(b){ULSEWi:;do var a=b.previousSibling;while(a&&a.nodeType!=1);return a},GetFirstChildElement:function(b){ULSEWi:;var a=b.firstChild;while(a&&a.nodeType!=1)a=b.nextSibling;return a},AddMouseWheelHandler:function(a,c){ULSEWi:;var b=function(a){ULSEWi:;r(a,c)};if(a._mouseWheelFnInfo==null)a._mouseWheelFnInfo=[];a._mouseWheelFnInfo.push({usrFn:c,wheelFn:b});$addHandler(a,"mousewheel",b);$addHandler(a,"DOMMouseScroll",b)},RemoveMouseWheelHandler:function(a,c){ULSEWi:;var b=SP.Internal.JS.FindInArray(a._mouseWheelFnInfo,function(a){ULSEWi:;return a.usrFn==c});if(b!=null){$removeHandler(a,"mousewheel",a._mouseWheelFnInfo[b].wheelFn);$removeHandler(a,"DOMMouseScroll",a._mouseWheelFnInfo[b].wheelFn);if(a._mouseWheelFnInfo.length==1)a._mouseWheelFnInfo=null;else a._mouseWheelFnInfo.splice(b,1)}},GetCustomAttribute:function(b,c){ULSEWi:;var a=b.getAttribute!=null?b.getAttribute(c):null;return a==null||a==""?b[c]:a},GetParentElement:function(b){ULSEWi:;var a=b.parentNode;return a&&a.nodeType!=1?null:a},SetOpacity:function(a,b){ULSEWi:;a.style.opacity=b;a.style["-moz-opacity"]=b;a.style.filter="alpha(opacity="+b*100+")"},RemoveOpacity:function(a){ULSEWi:;a.style.opacity="";a.style["-moz-opacity"]=1;a.style.filter=""},ForEachElementChild:function(a,c,d){ULSEWi:;!d&&c(a);for(var b=0;b<a.childNodes.length;b++)SP.Internal.DomElement.ForEachElementChild(a.childNodes[b],c,false)},FindAncestorWithProperty:function(a,b,c){ULSEWi:;return a==null?null:this.GetCustomAttribute(a,b)!==undefined?{elem:a,child:c}:SP.Internal.DomElement.FindAncestorWithProperty(a.parentNode,b,a)},FindFirstAncestorWithAnyPropertyValue:function(a,c,b,d){ULSEWi:;return a==null?null:this.GetCustomAttribute(a,c) in b?{elem:a,child:d}:SP.Internal.DomElement.FindFirstAncestorWithAnyPropertyValue(a.parentNode,c,b,a)},GetChildrenWithCustomAttribute:function(d,c){ULSEWi:;var b={},a=this;a.ForEachElementChild(d,function(e){ULSEWi:;var d=a.GetCustomAttribute(e,c);if(d!=null)b[d]=e});return b},FindChildrenWithProperty:function(e,b){ULSEWi:;var c=[],d=this;function a(g){ULSEWi:;for(var f=0;f<g.childNodes.length;f++){var e=g.childNodes[f];d.GetCustomAttribute(e,b)!=null&&c.push(e);a(e,b)}}a(e);return c},ComputeMaximumSizeForWebPart:function(b,e){ULSEWi:;var d={},a=$get("MSO_ContentTable"),f=SP.Internal.DomElement.GetLocation(b),g=SP.Internal.DomElement.GetLocation(a);if(!e)b.style.display="none";var c=f.y-g.y;d.height=a.offsetHeight-c;c=f.x-g.x;d.width=a.offsetWidth-c;if(!e)b.style.display="block";return d},SetMouseHover:function(a,i,h,g){ULSEWi:;$addHandler(a,"mousemove",d);$addHandler(a,"mouseout",e);var c=true,b=false;function e(){ULSEWi:;b=true;setTimeout(f,0)}function d(a){ULSEWi:;c&&i!=null&&i();g!=null&&g(a);c=b=false}function f(){ULSEWi:;if(!c&&b){h!=null&&h();c=true;b=false}}return function(){ULSEWi:;$removeHandler(a,"mouseout",e);$removeHandler(a,"mousemove",d);e=null;d=null;f=null;a=null}},DashNameFromCamelName:function(a){ULSEWi:;return a.replace(/[A-Z]/g,function(a){ULSEWi:;return "-"+a.toLowerCase()})},CamelNameFromDashName:function(a){ULSEWi:;return a.replace(/-(\w)/g,function(b,a){ULSEWi:;return a.toUpperCase()})},GetXmlDomObj:function(b){ULSEWi:;var a;if(document.implementation&&document.implementation.createDocument)a=document.implementation.createDocument("","",null);else try{var c=document.createElement("xml");document.body.appendChild(c);a=c.XMLDocument;document.body.removeChild(c)}catch(d){a=new ActiveXObject("Microsoft.XMLDOM")}if(b!=null)if("loadXML" in a){a.async=false;a.loadXML(b)}else{parser=new DOMParser;a=parser.parseFromString(b,"text/xml")}return a},BrowserIsIE:Sys.Browser.agent==Sys.Browser.InternetExplorer,BrowserIsIEAndRenderingModeIs7:Sys.Browser.agent==Sys.Browser.InternetExplorer&&(document.documentMode==null||document.documentMode==7),SetTextNoBR:function(a,b){ULSEWi:;a.innerHTML="";a.appendChild(document.createTextNode(b))}},n=[{name:"SetText",selector:function(){ULSEWi:;return document.body.innerText!=null?function(a,b){ULSEWi:;a.innerText=b}:function(a,b){ULSEWi:;a.textContent=b}}},{name:"SetCapture",selector:function(){ULSEWi:;return document.body.setCapture!=null?q:p}},{name:"GetScreenOffsets",selector:function(){ULSEWi:;return "pageYOffset" in window?function(){ULSEWi:;return {top:window.pageYOffset,left:window.pageXOffset}}:function(){ULSEWi:;return {top:document.documentElement.scrollTop,left:document.documentElement.scrollLeft}}}},{name:"GetXmlHttpObj",selector:function(){ULSEWi:;return window.XMLHttpRequest?function(){ULSEWi:;return new XMLHttpRequest}:function(){ULSEWi:;return new ActiveXObject("Microsoft.XMLHTTP")}}},{name:"GetComputedStyle",selector:function(){ULSEWi:;return document.body.currentStyle!=null?function(b,a){ULSEWi:;return b.currentStyle[a]}:function(b,c,a){ULSEWi:;return document.defaultView.getComputedStyle(b,null).getPropertyValue(a)}}},{name:"AdjustCoordsForIEZoom",selector:function(){ULSEWi:;if(c.BrowserIsIE){j();$addHandler(window,"resize",j)}return function(a){ULSEWi:;return {x:Math.round(a.x/f),y:Math.round(a.y/f)}}}},{name:"GetOuterHTML",selector:function(){ULSEWi:;return document.body.outerHTML!=null?function(a){ULSEWi:;return a.outerHTML}:function(c){ULSEWi:;var b=c.ownerDocument,d=c.cloneNode(true),a=b.createElement("div");b.documentElement.appendChild(a);a.appendChild(d);var e=a.innerHTML;b.documentElement.removeChild(a);return e}}}],m=0;m<n.length;m++)s(n[m]);return c;function s(a){ULSEWi:;c[a.name]=function(){ULSEWi:;c[a.name]=a.selector();return c[a.name].apply(c,arguments)}}}();SP.GetSingleStopBreakpoint=function(){ULSEWi:;var a;return function(b){ULSEWi:;if(a==null)a=b!=null?b:1;if(a==1)debugger;if(a>0)--a}};var bpt=SP.GetSingleStopBreakpoint();SP.Internal.Timer=function(){ULSEWi:;this.Reset()};SP.Internal.Timer.prototype={ElapsedMs:function(){ULSEWi:;return (new Date).getTime()-this.start},Reset:function(){ULSEWi:;this.start=(new Date).getTime()},toString:function(f){ULSEWi:;var g=this.ElapsedMs(),e=new Date(g),a=Math.floor(g/3.6e6),b=e.getUTCMinutes(),d=e.getUTCSeconds()+e.getUTCMilliseconds()/1e3;if(f=="M"){b+=a*60;a=0}else if(f=="S"){d+=(a*60+b)*60;a=b=0}var c=[];a&&c.push(a);a+b&&c.push((b<10?"0":"")+b);c.push((d<10?"0":"")+d.toFixed(3));return c.join(":")}};SP.Internal.CallAsyncFn=function(d,a,c,b){ULSEWi:;if(d(function(){ULSEWi:;a!=null&&a();b!=null&&b()}))a();else c!=null&&c()};SP.ElementCover=function(a,e,g){ULSEWi:;var b,c,d,h=this;this.Show=function(){ULSEWi:;$addHandler(a,"resize",f);a.appendChild(b);a.appendChild(d);this.RefreshLayout()};this.Hide=function(){ULSEWi:;$removeHandler(a,"resize",f);a.removeChild(b);a.removeChild(d)};this.Dispose=function(){ULSEWi:;b=c=d=null};this.RefreshLayout=function(){ULSEWi:;d.style.height=b.style.height=Math.max(0,a.offsetHeight-2)+"px";d.style.width=b.style.width=Math.max(0,a.offsetWidth-2)+"px";c.style.left=Math.max((a.offsetWidth-c.offsetWidth)/2,50)+"px";c.style.marginTop=(a.offsetHeight-c.offsetHeight)/2+"px"};function f(){ULSEWi:;h.RefreshLayout()}function i(){ULSEWi:;b=document.createElement("div");b.style.cssText="z-index:5; position:absolute; top:0px; left:0px; background-color:#ffffff;border:1px solid #999999;";SP.Internal.DomElement.SetOpacity(b,.85);if(g!=null)b.id=g;d=document.createElement("div");d.style.cssText="z-index:6; position:absolute; top:0px; left:0px; background-color:transparent;";c=document.createElement("div");c.style.cssText="position:absolute; vertical-align:middle; top:0px; left:0px; padding-left:20px; padding-right:20px; background-color:#ffffff; border:1px solid #EBEEF2; white-space:nowrap;";for(var a=0;a<e.length;a++)c.appendChild(e[a]);d.appendChild(c)}i()};SP.LoadingBanner=function(d,e){ULSEWi:;var g,b,a,c;this.Show=function(d){ULSEWi:;if(d==null){a.alt=a.title="";b.style.display="none"}else{SP.Internal.DomElement.SetText(b,d);a.alt=a.title=d;b.style.display=""}c.Show()};this.Hide=function(){ULSEWi:;c.Hide()};this.UpdateText=function(a){ULSEWi:;SP.Internal.DomElement.SetText(b,a);c.RefreshLayout()};this.Dispose=function(){ULSEWi:;c.Dispose();b=a=d=null};function f(){ULSEWi:;a=document.createElement("img");a.src="/_layouts/Images/progress-circle-24.gif";a.style.cssText="vertical-align:middle;margin:30px 10px 30px 10px";b=document.createElement("span");b.style.cssText="vertical-align:middle; margin:30px 10px 30px 10px; color:black; text-align:center; white-space:nowrap; overflow:hidden";c=new SP.ElementCover(d,[a,b],e)}f()};SP.ErrorBanner=function(c,d){ULSEWi:;var b,a;this.Show=function(c){ULSEWi:;SP.Internal.DomElement.SetText(b,c);a.Show()};this.Hide=function(){ULSEWi:;a.Hide()};this.UpdateText=function(c){ULSEWi:;SP.Internal.DomElement.SetText(b,c);a.RefreshLayout()};this.Dispose=function(){ULSEWi:;a.Dispose();b=c=null};function e(){ULSEWi:;var e=document.createElement("table");b=e.insertRow().insertCell();b.style.cssText="align:middle; vertical-align:middle; color:#AA0000;text-align:center; padding:20px;";a=new SP.ElementCover(c,[e],d)}e()};SP.Internal.Key={shift:16,insert:45,six:54,numpad_plus:107,numpad_minus:109,F2:113,F6:117,plus:Sys.Browser.agent==Sys.Browser.InternetExplorer?187:61,comma:188,minus:Sys.Browser.agent==Sys.Browser.InternetExplorer?189:109,dot:190,back_slash:220,IMEInput:229};SP.JsGrid.Utility={IsChar:function(a){ULSEWi:;return a.type=="keypress"&&(a.rawEvent.which==null||a.rawEvent.which>0&&a.rawEvent.charCode>0)},FocusElementInDOMCollection:function(d,c,g){ULSEWi:;var a=[];function f(a){ULSEWi:;var b;if(a.hasAttribute!=null)b=a.hasAttribute("tabIndex")&&a.getAttribute("tabIndex")==-1;else b=a.tabIndex!=null&&a.tabIndex==-1;return b}function b(e){ULSEWi:;for(var d=0;d<e.length;d++){var c=e[d];f(c)&&a.push(c);b(c.childNodes)}}function e(){ULSEWi:;if(a.length==0)return null;var d;if(c==null)d=a[0];else for(var b=0;b<a.length;b++){if(a[b]!=c)continue;d=g?b==a.length-1?a[0]:a[b+1]:b==0?a[a.length-1]:a[b-1];break}if(d!=null)try{d.focus()}catch(e){}return d}b(d);return e()},CloneObj:function(b,a){ULSEWi:;return SP.Internal.JS.CloneObj(b,a)},GetDocumentDirection:function(){ULSEWi:;return document.documentElement.getAttribute("dir")}};SP.JsGrid.Internal.HeaderManager=function(c,I){ULSEWi:;var p={menu:c.RTL.Left,resize:c.RTL.Right,eyeBrow:"Bottom"},i={Normal:1,Hover:2,Clicked:3},a={},l={},b={},g={},h={},m={},k={},e=null,j=this,f,d,o,n,y,r=15,C=2;this.constEyeBrowHeight=5;this.constResizeWidth=5;J();function F(e,a,d){ULSEWi:;e.style.width=a.move.style.width=d-1+"px";a.eyeBrow.style.width=d-1+"px";var b=d-j.constResizeWidth-j.constResizeWidth;a.content.style.width=b+"px";if(a.sort!=null)a.sort.style[c.RTL.left]=Math.round((b-6)/2)+"px";a.coreContent.style.width=b-C+"px"}function q(b,c){ULSEWi:;var a=parseInt(SP.Internal.DomElement.GetComputedStyle(b,"width","width"));if(!isNaN(a))b.style.width=a+c+"px"}function v(a){ULSEWi:;q(a.content,-r);q(a.coreContent,-r)}function A(a){ULSEWi:;q(a.content,r);q(a.coreContent,r)}function J(){ULSEWi:;var a=I.columnHeaderStyleCollection.normal,e=a.font!=null?"font-family:"+a.font+";":"";y=String.format("text-align:{0};padding-{0}:{1}px;{2}font-size:{3};font-weight:{4};",c.RTL.left,C,e,a.fontSize,a.fontWeight);var b=document.createElement("table");b.style.cssText="position:absolute;visibility:hidden;top:0px;left:0px;width:0px;height:0px;";b.insertRow(-1);var d=document.createElement("th");b.rows[0].appendChild(d);n=document.createElement("div");n.className="jsgrid-header-core-content";n.style.cssText=y;d.appendChild(n);c.parentNode.appendChild(b)}function K(a){ULSEWi:;var b=SP.Internal.DomElement.GetChildrenWithCustomAttribute(a,"colid");b.th=a;return b}this.CreateTableHeaderCell=function(b,g,v,p,t,u,r,i,s){ULSEWi:;var q=u&&b.isSortable,n=t&&b.isResizable,x=I.columnHeaderStyleCollection.normal,f=['<div colid="eyeBrow" class="jsgrid-header-eyebrow" colAction="select" style="border-bottom:1px solid transparent;"></div>','<div colid="move" '+(p?'colAction="move"':"")+' style="position:relative;">'];f.push('<div colid="resize" class="jsgrid-header-expand" style="float:'+c.RTL.left+';"></div>');f.push('<div colid="content" class="jsgrid-header-content" style="float:'+c.RTL.left+';"><div colid="coreContent" class="jsgrid-header-core-content" style="'+y+"cursor:"+(p?"move":"default")+';"></div>');q&&f.push('<div colid="sort" class="clip9x6"><img colid="sortImg" class="jsgridcluster_jsgrid-down-arrow" src="/_layouts/Images/jsgridcluster.png"/></div>');f.push("</div>");i!=null&&f.push('<div colid="menu" class="jsgrid-header-menu" colAction="menu" style="float:'+c.RTL.left+";width:14px;border-"+c.RTL.left+':1px solid transparent;"><div style="padding-'+c.RTL.left+':4px;"><div colid="menuImg" class="clip9x6" ><img class="jsgridcluster_jsgrid-down-arrow"  src="/_layouts/Images/jsgridcluster.png" alt="'+SP.JsGrid.Res.openMenu+'" title="'+SP.JsGrid.Res.openMenu+'"/></div></div></div>');f.push('<div colid="filterState" class="jsgrid-header-filter-state" style="float:'+c.RTL.left+";width:14px;border-"+c.RTL.left+':1px solid transparent;"><div style="padding-'+c.RTL.left+':3px;"><div colid="filterStateImg" class="clip11x11" ><img class="jsgridcluster_jsgrid-header-filter-icon"  src="/_layouts/Images/jsgridcluster.png" title="'+SP.JsGrid.Res.filterIndicator+'"/></div></div></div>');f.push('<div colid="resizeRight" class="jsgrid-header-expand"'+(n?'colAction="resize-current"':"")+'style="float:'+c.RTL.left+";cursor:"+(n?"w-resize":"default")+';"></div>');f.push("</div>");g.innerHTML=f.join("");var d=b.columnKey,h=a[d]=K(g);l[d]={selection:r,move:p,resize:n};q&&D(d,m[d]);i!=null&&$addHandler(h.menu,"click",function(a){ULSEWi:;i(a,d)});if(b.imgSrc!=null){h.coreContent.className="jsgrid-header-core-img-content";h.coreContent.innerHTML='<img style="border:0px; padding-top:2px" src="'+b.imgSrc+'"/>'}else b.name!=null&&SP.Internal.DomElement.SetText(h.coreContent,b.name);if(b.name!=null)g.title=b.name;o=s;j.UpdateHeaderHeights(v);F(g,h,b.width);g.thColumnKey=d;if(e!=null&&e.thColumnKey==d)e=null;g=h=null;d in k&&w(d);return g};function O(d,c){ULSEWi:;var b=a[d.thColumnKey].resize;if(c!=null&&l[c.thColumnKey].resize){b.colAction="resize";b.style.cursor="w-resize"}else if(l[d.thColumnKey].move){b.colAction="move";b.style.cursor="move"}else{b.colAction=null;b.style.cursor="default"}}this.NotifyColumnHeaderOrderSet=function(c){ULSEWi:;var a=c,b=null;while(a!=null){O(a,b);b=a;a=o(a,false)}};this.DisposeHeader=function(c){ULSEWi:;if(f!=null&&f.columnKey==c.thColumnKey)f=null;if(d!=null&&d.key==c.thColumnKey)d=null;var e=a[c.thColumnKey]&&a[c.thColumnKey].menu;e!=null&&$clearHandlers(e);delete a[c.thColumnKey];delete g[c.thColumnKey];delete b[c.thColumnKey];delete l[c.thColumnKey];delete h[c.thColumnKey];c.thColumnKey=null};this.Dispose=function(){ULSEWi:;var b=[];for(var g in a)b.push(a[g].th);for(var c=b.length-1;c>=0;c--){delete m[b[c].thColumnKey];this.DisposeHeader(b[c])}e=a=d=f=h=l=m=j=null};this.ApplyHeaderStyle=function(e,f,n){ULSEWi:;var h=a[e.thColumnKey];if(d!=null&&d.key==e.thColumnKey){d.curStyle=f;return}if(e.headerStyleType!=f.type){b[e.thColumnKey]={};e.style["border"+c.RTL.Right]=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.outerBorderColor);if(f.font!=null)h.coreContent.style.fontFamily=f.font;h.coreContent.style.fontSize=f.fontSize;h.coreContent.style.fontWeight=f.fontWeight;h.coreContent.style.color=f.textColor;e.style.backgroundColor=h.resize.style.backgroundColor=h.content.style.backgroundColor=f.backgroundColor;h.resize.style["border"+c.RTL.Right]=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.backgroundColor);b[e.thColumnKey].eyeBrow={};b[e.thColumnKey].eyeBrow.bg=h.eyeBrow.style.backgroundColor=f.eyeBrowColor;b[e.thColumnKey].eyeBrow.border=h.eyeBrow.style["border"+p.eyeBrow+"Color"]=f.eyeBrowBorderColor;h.move.style.borderBottom=SP.JsGrid.Style.MakeBorderString(1,"solid ",f.outerBorderColor);b[e.thColumnKey].move=h.move.style.backgroundColor=f.backgroundColor;if(h.menu!=null){b[e.thColumnKey].menu={};b[e.thColumnKey].menu.bg=h.menu.style.backgroundColor=f.menuColor;b[e.thColumnKey].menu.border=h.menu.style["border"+p.menu+"Color"]=f.menuBorderColor}else delete b[e.thColumnKey].menu;h.resizeRight.style.backgroundColor=h.menu!=null&&h.menu.style.display=="block"?f.menuColor:f.backgroundColor;g[e.thColumnKey]=f}e.headerStyleType=f.type;e.headerStyleBorderString=SP.JsGrid.Style.MakeBorderString(1,"solid",f.outerBorderColor);var k=o(e,true);if(k!=null)k.style["border"+c.RTL.Right]=m(k,e).headerStyleBorderString;if(l[e.thColumnKey].resize){var i=o(e,false);if(i!=null&&a[i.thColumnKey]!=null){e.style["border"+c.RTL.Right]=m(i,e).headerStyleBorderString;var j=a[i.thColumnKey].resize;if(!n){b[i.thColumnKey].resize={};b[i.thColumnKey].resize=j.style.backgroundColor=j.style["border"+p.resize+"Color"]=g[i.thColumnKey].backgroundColor}else{b[i.thColumnKey].resize={};b[i.thColumnKey].resize.bg=j.style.backgroundColor=g[i.thColumnKey].resizeColor;b[i.thColumnKey].resize.border=j.style["border"+p.resize+"Color"]=g[i.thColumnKey].resizeBorderColor}}}function m(a,b){ULSEWi:;return a.headerStyleType==null?b:b.headerStyleType==null?a:a.headerStyleType>b.headerStyleType?a:b}};this.GetColumnHeaderAutoResizeWidth=function(c){ULSEWi:;var b=a[c.thColumnKey];if(b.coreContent!=null)return c.offsetWidth+Math.max(b.coreContent.scrollWidth-b.coreContent.offsetWidth,0);return c.offsetWidth};this.AdjustColumnWidth=function(a){ULSEWi:;if(a.width==null||a.width<=0){a.width=SP.JsGrid.Internal.MinColumnWidth;if(a.name!=null){SP.Internal.DomElement.SetText(n,a.name);a.width=n.scrollWidth+j.constResizeWidth+j.constResizeWidth}}a.width=Math.max(a.width,SP.JsGrid.Internal.MinColumnWidth)};this.ResizeColumn=function(d,e){ULSEWi:;var c=d.thColumnKey;F(d,a[c],e);if(c in k){var b=a[c];b!=null&&b.filterState!=null&&b.filterState.style.display=="block"&&v(b)}};this.ShowMenuOnColumn=function(b){ULSEWi:;if(e!=b&&b.thColumnKey!=null){var c=a[b.thColumnKey];if(c.menu!=null){this.HideMenuOnColumn();b.thColumnKey in k&&B(b.thColumnKey);c.resizeRight.style.backgroundColor=g[b.thColumnKey].menuColor;c.menu.style.display="block";v(c);e=b}}};this.HideMenuOnColumn=function(){ULSEWi:;if(e!=null&&e.thColumnKey!=null){var c=e.thColumnKey,b=a[c];if(b.menu!=null){b.resizeRight.style.backgroundColor=g[e.thColumnKey].backgroundColor;b.menu.style.display="none";A(b);e=null;c in k&&w(c)}}};this.GetColumnMenuElementPosition=function(e){ULSEWi:;var b=a[e].menu;if(b==null)return null;var d=a[e].resizeRight,f=SP.Internal.DomElement.GetLocation(b),g=SP.Internal.DomElement.GetLocation(d);return {left:Math.min(f.x,g.x),width:b.offsetWidth+d.offsetWidth,top:f.y+(c.RTL.bEnabled?4:0),height:b.offsetHeight}};this.UpdateHeaderHeights=function(c){ULSEWi:;for(var d in a){var b=a[d];b.move.style.height=c-5+"px";if(b.menuImg!=null)b.menuImg.style.marginTop=Math.floor((c-5-6)/2)+"px";if(b.filterStateImg!=null)b.filterStateImg.style.marginTop=Math.floor((c-5-11)/2)+"px";b.coreContent.style.lineHeight=b.coreContent.style.height=c-12+"px"}};function E(b){ULSEWi:;return b in a}function x(c,d){ULSEWi:;var b=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"thColumnKey");if(b!=null&&E(b.thColumnKey)){var a=SP.Internal.DomElement.FindAncestorWithProperty(c.target,"colid");if(a!=null)if(s(b.elem.thColumnKey,a.elem,d))return a.elem}return null}function s(c,f,e){ULSEWi:;var d=SP.Internal.DomElement.GetCustomAttribute(f,"colid");if(SP.Internal.DomElement.GetCustomAttribute(f,"colAction")=="move")return false;else if(d=="resizeRight"){var j=o(a[c].th,false);if(j!=null){d="resize";c=j.thColumnKey}else d="menu"}if(d!=null&&c in b&&d in b[c]&&!(c in h&&d in h[c]))if(d!="eyeBrow"||l[c].selection)if(e==i.Normal)z(c,d,b[c][d].bg,b[c][d].border);else if(e==i.Hover)z(c,d,g[c][d+"HoverColor"],g[c][d+"HoverBorderColor"]);else e==i.Clicked&&z(c,d,g[c].elementClickColor,g[c].elementClickBorderColor);return true}function z(c,b,d,e){ULSEWi:;if(d!=null){a[c][b].style.backgroundColor=d;if(b=="menu")a[c]["resizeRight"].style.backgroundColor=d}if(e!=null)a[c][b].style["border"+p[b]+"Color"]=e}function H(b){ULSEWi:;delete m[b];if(a[b]!=null&&a[b].sortImg!=null)a[b].sortImg.style.display="none"}function G(a,b,c){ULSEWi:;if(a.sortImg!=null){a.sortImg.className=b;a.sortImg.style.display="";a.sortImg.alt=a.sortImg.title=c}}function D(b,c){ULSEWi:;delete m[b];if(c==SP.JsGrid.SortMode.Ascending||c==SP.JsGrid.SortMode.Descending){m[b]=c;var d=a[b];if(d!=null)if(c==SP.JsGrid.SortMode.Ascending)G(d,"jsgridcluster_jsgrid-up-arrow",SP.JsGrid.Res.sortedAsc);else G(d,"jsgridcluster_jsgrid-down-arrow",SP.JsGrid.Res.sortedDesc)}else H(b)}function L(a){ULSEWi:;delete k[a];B(a)}function M(a){ULSEWi:;k[a]=null;w(a)}function B(c){ULSEWi:;var b=a[c];if(b!=null&&b.filterState!=null&&b.filterState.style.display=="block"){b.filterState.style.display="none";A(b)}}function w(c){ULSEWi:;var b=a[c];if(b!=null&&b.filterState!=null&&b.filterState.style.display!="block"&&!(e!=null&&e.thColumnKey==c)){b.filterState.style.display="block";v(b)}}this.SetSortState=function(a){ULSEWi:;for(var c in m)H(c);if(a!=null)for(var b=0;b<a.length;b++)D(a[b].fieldKey,a[b].isDescending?SP.JsGrid.SortMode.Descending:SP.JsGrid.SortMode.Ascending)};this.SetFilterState=function(a){ULSEWi:;for(var c in k)L(c);if(a!=null)for(var b=0;b<a.length;b++)M(a[b])};this.HeaderMouseDown=function(a){ULSEWi:;x(a,i.Clicked)};this.HeaderMouseUp=function(a){ULSEWi:;x(a,i.Normal)};this.HeaderMouseMove=function(b){ULSEWi:;var a=x(b,i.Hover),c=f!=null?f.elem:null;if(c!=a){j.HeaderMouseOut(b);if(c!=a&&a!=null)f={elem:a,columnKey:SP.Internal.DomElement.FindAncestorWithProperty(b.target,"thColumnKey").elem.thColumnKey}}};this.HeaderMouseOut=function(){ULSEWi:;if(f!=null){s(f.columnKey,f.elem,i.Normal);f=null}};this.SetColumnSelected=function(a){ULSEWi:;u(a,"eyebrow")};this.SetColumnUnselected=function(){ULSEWi:;t(columnKey,"eyebrow")};this.SetColumnMenuExpanded=function(a){ULSEWi:;u(a,"menu")};this.SetColumnMenuCollapsed=function(a){ULSEWi:;t(a,"menu")};this.SetColumnMoving=function(a){ULSEWi:;this.HideMenuOnColumn();u(a,"move",true)};this.SetColumnMoved=function(a){ULSEWi:;t(a,"move",true)};this.SetColumnResizing=function(a){ULSEWi:;this.HideMenuOnColumn();u(a,"resize",true)};this.SetColumnResized=function(a){ULSEWi:;t(a,"resize",true)};function P(a){ULSEWi:;if(d!=null);d={};d.key=a}function N(){ULSEWi:;if(d!=null){var b=d;d=null;b.curStyle!=null&&j.ApplyHeaderStyle(a[b.key].th,b.curStyle)}}function u(b,c,d){ULSEWi:;s(b,a[b][c],i.Clicked);if(h[b]==null)h[b]={};h[b][c]="";d&&P(b)}function t(b,c){ULSEWi:;delete h[b][c];if(SP.Internal.JS.IsAssocArrayEmpty(h[b]))delete h[b];d!=null&&d.key==b&&N();E(b)&&s(b,a[b][c],a[b][c]==f?i.Hover:i.Normal)}};SP.JsGrid.Internal.HierarchyManager=function(n,y,l,k,v,B,p,C,D,j){ULSEWi:;var b=[],g=new SP.Utilities.Set,i=0,c,q={},a=B,h=this,f={},z=n.jsGridObj,d=n.tableCache,H=n.commandMgr,G=n.delegateMgr;if(j==null)j={};if(a!=null)c=new w(a);this.GetState=function(g){ULSEWi:;var d=[],c=[],a=[];f(b);return {recordKeys:d,recordIdxs:c,recordDescendantCounts:a};function f(i){ULSEWi:;for(var b=0;b<i.length;b++){f(i[b].collapsedChildren);var j=i[b].recordKey;d.push(g&&!h.IsGroupingRecord(j)?SP.JsGrid.GuidManager.LookupGuidForIndex(j):j);c.push(i[b].recordIdx);a.push(e(j))}}};this.SetState=function(e,f){ULSEWi:;b=[];g=new SP.Utilities.Set;i=0;if(f!=null){a=f;c=new w(a)}if(e!=null){q={};for(var d=0;d<e.recordIdxs.length;d++)q[e.recordKeys[d]]=e.recordDescendantCounts[d];for(var d=0;d<e.recordIdxs.length;d++)this.NotifyCollapse(e.recordIdxs[d],e.recordKeys[d])}};this.GetUnfilteredHierarchyMgr=function(){ULSEWi:;return a};this.GetViewRecords=function(b,c,a){ULSEWi:;return d.GetRecords(E(b,c),a)};this.GetViewRecordCount=function(){ULSEWi:;return d.GetRecordCount()-i};this.SetTableView=function(d,c,b,a){ULSEWi:;y=d;l=c;k=b;v=a;f={}};this.ConvertViewIdxToRecordIdx=function(c){ULSEWi:;var d=SP.Internal.JS.UpperBound(b,c,"viewIdx");if(!d)return c;var a=b[d-1];return a.viewIdx==c?a.recordIdx:a.recordIdx+(c-a.viewIdx)+e(a.recordKey)};this.ConvertRecordIdxToViewIdx=function(c){ULSEWi:;var f=SP.Internal.JS.UpperBound(b,c,"recordIdx");if(!f)return c;var a=b[f-1];if(a.recordIdx==c)return a.viewIdx;else{var d=c-a.recordIdx-e(a.recordKey);return d<=0?null:a.viewIdx+d}};this.IsGroupingRecord=function(a){ULSEWi:;return this.IsGrouped()&&a.constructor==String&&a.indexOf(v)==0};this.GetNodeInfo=function(a){ULSEWi:;return {nodeType:this.GetNodeType(a.key()),indent:this.GetNodeIndentLevel(a)}};this.GetNodeType=function(a){ULSEWi:;if(D.Contains(a))return SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed;else if(z.IsEntryRecordKey(a)||e(a)==0)return SP.JsGrid.Internal.HierarchyManager.NodeType.Leaf;else if(g.Contains(a))return SP.JsGrid.Internal.HierarchyManager.NodeType.Collapsed;else return SP.JsGrid.Internal.HierarchyManager.NodeType.Expanded};this.GetNodeIndentLevel=function(a){ULSEWi:;if(z.IsEntryRecordKey(a.key()))return 0;else if(this.IsGrouped()){var b=l.GetValue(a,SP.JsGrid.OperationalConstants.GroupingOutlineLevel);return b==null?k:b}else return u(a)};this.GetInsertAfterInfoForInsert=function(g,e){ULSEWi:;var b=null,c=g;while((c=a.GetParent(c))!=null)if(!m(c))b=null;else if(b==null&&d.IsKeyInView(c))b=c;var f=Math.max(b!=null?a.GetOutlineLevel(b)+1:0,1);return C(e)?f:Math.max(f,a.GetOutlineLevel(e))};this.GetAfterKeyFromBeforeKey=function(b){ULSEWi:;return a.GetPrevNode(b)};this.GetInsertAfterInfoForDelete=function(b){ULSEWi:;return {insertAfterKey:a.GetPrevNode(b),outlineLevel:a.GetOutlineLevel(b)}};this.NotifyCollapse=function(c,d){ULSEWi:;var m=h.ConvertRecordIdxToViewIdx(c),k=e(d);g.Add(d);var a=k,j=0;s(c,k,function(c,b){ULSEWi:;a-=e(b);j++});var f=SP.Internal.JS.LowerBound(b,c,"recordIdx"),l=b.splice(f,j,{recordIdx:c,recordKey:d,viewIdx:m});b[f].collapsedChildren=l;r(f+1,-a,b);i+=a;return a};this.NotifyExpand=function(j,h){ULSEWi:;g.Remove(h);var d=SP.Internal.JS.BinarySearch(b,j,"recordIdx"),a=b[d],c=e(h),k=a.recordIdx-a.viewIdx;for(var l in a.collapsedChildren){var f=e(a.collapsedChildren[l].recordKey);c-=f;k+=f}Array.prototype.splice.apply(b,[d,1].concat(a.collapsedChildren));r(d+a.collapsedChildren.length,c,b);i-=c;return c};this.GetNextNonGroupingIdx=function(a){ULSEWi:;while(this.IsGroupingRecord(d.RecordIdxToKey(a))){if(a==d.GetRecordCount()-1)return a;a++}return a};this.NotifyInsertRowAfter=function(l,j,i,k){ULSEWi:;function h(a){ULSEWi:;if(a!=null)for(var c=0;c<a.length;c++){var b=a[c];b.recordIdx++;b.viewIdx++;h(b.collapsedChildren)}}var d=null;if(a!=null){var g=A(l,k);d=g.parentKey;!m(d)&&p(d);a.Insert(i,g.parentKey,g.previousSiblingKey,false);a.ForEachAncestor(i,false,function(a){ULSEWi:;c.AdjustCount(a,1)})}else if(this.IsGrouped()){var e=o(j);if(f[e]==null)f[e]=0;f[e]++}var n=SP.Internal.JS.LowerBound(b,j,"recordIdx");h(b.slice(n));return d};this.ValidateAndMinimizeKeyList=function(b){ULSEWi:;for(var c=0;c<b.length;c++)if(a.GetParent(b[c])==null)return {bLevelZeroFound:true};return {bLevelZeroFound:false,minimizedKeys:x(b).ToArray()}};this.ValidateAndExpandKeyList=function(b){ULSEWi:;for(var c=0;c<b.length;c++){if(!a.IsKeyPresent(b[c]))return {bGroupingRowFound:true};if(a.GetParent(b[c])==null)return {bLevelZeroFound:true}}function e(g){ULSEWi:;function c(g){ULSEWi:;for(var f=a.GetChildren(g),e=f.length-1;e>=0;e--){if(!d.IsKeyInView(f[e])||!c(f[e]))return false;b.push(f[e])}return true}var e=true,b=[];for(var f in g.GetCollection()){if(!c(f)){e=false;break}b.push(f)}return {bAllChildKeysInView:e,bGroupingRowFound:false,bLevelZeroFound:false,expandedKeys:b}}return e(x(b))};this.CanDelete=function(b){ULSEWi:;return a.GetChildren(b).length==0};this.NotifyDeleteRow=function(e,d){ULSEWi:;function l(a){ULSEWi:;if(a!=null)for(var c=0;c<a.length;c++){var b=a[c];b.recordIdx--;if(!k)b.viewIdx--;l(b.collapsedChildren)}}g.Remove(e);var k=this.ConvertRecordIdxToViewIdx(d)==null;if(k)i--;if(a!=null){var m=a.GetParent(e);a.Delete(e);c.Delete(e);a.ForEachAncestor(m,true,function(a){ULSEWi:;c.AdjustCount(a,-1)})}else if(this.IsGrouped()){var j=o(d);if(f[j]==null)f[j]=0;f[j]--}var h=SP.Internal.JS.LowerBound(b,d,"recordIdx");b[h]!=null&&b[h].recordIdx==d&&b.splice(h,1);l(b.slice(h))};this.CanIndent=function(b){ULSEWi:;return a.GetPrevSibling(b)!=null};this.EnsureIndentPreconditionsMet=function(d){ULSEWi:;var b=a.GetPrevSibling(d);c.GetCount(b)!=0&&!m(b)&&p(b);return null};this.NotifyIndent=function(b,h){ULSEWi:;var g=a.GetPrevSibling(b),j=c.GetCount(b),f=h==null?[]:[].concat(a.GetSiblingSlice(h,false,true));a.Move(b,g,null,true);for(var i=0,e=0;e<f.length;e++){i+=(d.IsKeyInView(f[e])?1:0)+c.GetCount(f[e]);a.Move(f[e],g,null,true)}c.AdjustCount(b,-i);c.AdjustCount(g,1+j);return [{startingRecordKey:g,count:1},{startingRecordKey:b,count:1+t(b)}]};this.CanOutdent=function(c){ULSEWi:;var b=a.GetParent(c);return b!=null&&a.GetParent(b)!=null};this.EnsureOutdentPreconditionsMet=function(b){ULSEWi:;var d=a.GetParent(b),c=a.GetSiblingSlice(b,false,false);c.length!=0&&!m(b)&&p(b);return c.length==0?null:c};this.NotifyOutdent=function(b){ULSEWi:;var g=a.GetParent(b),i=t(b),f=[].concat(a.GetSiblingSlice(b,false,false));a.Move(b,a.GetParent(g),g,false);for(var h=0,e=0;e<f.length;e++){h+=(d.IsKeyInView(f[e])?1:0)+c.GetCount(f[e]);a.Move(f[e],b,null,true)}c.AdjustCount(b,h);c.AdjustCount(g,-1*(1+c.GetCount(b)));return [{startingRecordKey:g,count:1},{startingRecordKey:b,count:1+i}]};this.IsGrouped=function(){ULSEWi:;return k!=0&&k!=null};this.GetOutlineLevel=function(a){ULSEWi:;return u(a)};this.GetParentKey=function(c,b){ULSEWi:;return a!=null?a.GetParent(c):this.IsGrouped()?o(b):null};function o(e){ULSEWi:;var b=null,a=e-1;while(b==null&&a>=0){var c=d.RecordIdxToKey(a);if(h.IsGroupingRecord(c))b=c;a--}return b}function E(d,g){ULSEWi:;for(var e=[],c=h.ConvertViewIdxToRecordIdx(d),b={pos:c,count:1},a,f=d+1;f<d+g;f++){a=h.ConvertViewIdxToRecordIdx(f);if(a==c+1)b.count++;else{e.push(b);b={pos:a,count:1}}c=a}e.push(b);return e}function t(b){ULSEWi:;if(g.Contains(b))return 0;var a=e(b),c=y.RecordKeyToRecordIdx(b);s(c,a,function(c,b){ULSEWi:;a-=e(b)});return a}function s(c,d,f){ULSEWi:;var e=c+d,a=SP.Internal.JS.UpperBound(b,c,"recordIdx");while(a<b.length&&b[a].recordIdx<=e){f(b[a].recordIdx,b[a].recordKey);a++}}function r(d,c,b){ULSEWi:;for(var a=d;a<b.length;a++){b[a].viewIdx+=c;r(0,c,b[a].collapsedChildren)}}function u(b){ULSEWi:;return a!=null?a.GetOutlineLevel(b.key()):l.GetValue(b,SP.JsGrid.OperationalConstants.HierarchyOutlineLevel)}function e(b){ULSEWi:;var e,g=h.IsGrouped();if(a!=null&&!g)e=c.GetCount(b);else if(!g&&b in j)e=j[b];else{var i=d.GetCachedRecord(b);if(i==null)e=q[b];else e=l.GetValue(i,g?SP.JsGrid.OperationalConstants.GroupingDescendantCount:SP.JsGrid.OperationalConstants.HierarchyDescendantCount)||0;if(g&&h.IsGroupingRecord(b)&&b in f)e+=f[b]}return e}function x(f){ULSEWi:;var c=new SP.Utilities.Set,d=new SP.Utilities.Set;c.AddArray(f);for(var e in c.GetCollection()){for(var b=a.GetParent(e);b!=null;b=a.GetParent(b))if(c.Contains(b))break;b==null&&d.Add(e)}return d}function m(a){ULSEWi:;return !g.Contains(a)}function A(c,d){ULSEWi:;var e,f=a.GetOutlineLevel(c);if(d==f+1)e={parentKey:c,previousSiblingKey:null};else{var b=c;while(d!=f){b=a.GetParent(b);d++}e={parentKey:a.GetParent(b),previousSiblingKey:b}}return e}function w(b){ULSEWi:;var e=this,a={};this.Clear=function(){ULSEWi:;a={}};this.Delete=function(b){ULSEWi:;delete a[b]};this.GetCount=function(b){ULSEWi:;c(b);return a[b]||0};this.AdjustCount=function(b,c){ULSEWi:;if(b in a)a[b]+=c};function c(f){ULSEWi:;if(!(f in a)){for(var i=b.GetChildren(f),c=0,g=0;g<i.length;g++){var h=i[g];c+=(d.IsKeyInView(h)?1:0)+e.GetCount(h)}if(c!=0)a[f]=c}}}};SP.JsGrid.Internal.HierarchyManager.NodeType={Leaf:0,Expanded:1,Collapsed:2};SP.JsGrid.UnfilteredHierarchyManager=function(b){ULSEWi:;var a={},d,c=this;g();this.GetUnfilteredHierarchyMap=function(){ULSEWi:;return a};this.GetTopNodeKey=function(){ULSEWi:;return d};this.GetLastNodeKey=function(){ULSEWi:;var c=d;while(true){var b=a[c].childKeys;if(b.length>0)c=b[b.length-1];else break}return c};this.Hydrate=function(b,c){ULSEWi:;a=b;d=c};this.IsKeyPresent=function(b){ULSEWi:;return b in a};this.GetParent=function(b){ULSEWi:;return a[b].parentKey};this.GetChildren=function(b){ULSEWi:;return a[b].childKeys};this.GetSiblingSlice=function(d,c,b){ULSEWi:;var a=e(d);return c?a.siblingKeys.slice(0,a.siblingIdx+(b?1:0)):a.siblingKeys.slice(a.siblingIdx+(b?0:1))};this.GetFirstChild=function(b){ULSEWi:;var a=this.GetChildren(b);return a.length?a[0]:null};this.GetLastChild=function(b){ULSEWi:;var a=this.GetChildren(b);return a.length?a[a.length-1]:null};this.GetNextSibling=function(b){ULSEWi:;var a=e(b);return a.siblingIdx==a.siblingKeys.length-1?null:a.siblingKeys[a.siblingIdx+1]};this.GetPrevSibling=function(b){ULSEWi:;var a=e(b);return a.siblingIdx==0?null:a.siblingKeys[a.siblingIdx-1]};this.GetNextNode=function(a){ULSEWi:;for(var b=this.GetFirstChild(a);b==null&&a!=null;b=this.GetNextSibling(a),a=this.GetParent(a));return b};this.GetPrevNode=function(d){ULSEWi:;var c=this.GetPrevSibling(d);if(c==null)return this.GetParent(d);var b=c,a;while(a=this.GetLastChild(b),a!=null)b=a;return b};this.ForEachAncestor=function(a,b,c){ULSEWi:;if(!b)a=this.GetParent(a);for(;a!=null;a=this.GetParent(a))c(a)};this.ForEachChild=function(d,c){ULSEWi:;for(var b=this.GetChildren(d),a=0;a<b.length;a++)c(b[a])};this.GetAllNodes=function(){ULSEWi:;var b=[];a(d);return b;function a(d){ULSEWi:;b.push(d);c.ForEachChild(d,a)}};this.GetKeysInOrder=function(b){ULSEWi:;var h=b,a,g=0;if(b.length>1){h=[];for(var a=b[0],e=1;e<b.length;e++)k(b[e]);var f=i(a,0);f=[a].concat(f);for(var j=(new SP.Utilities.Set).AddArray(b),e=0;e<f.length;e++)if(j.Contains(f[e])){h.push(f[e]);if(h.length==b.length)break}}return h;function i(f,e){ULSEWi:;var b=c.GetChildren(f),a;if(e+1<g&&b.length>0){a=[];for(var d=0;d<b.length;d++){a.push(b[d]);Array.prototype.splice.apply(a,[a.length,0].concat(i(b[d],e+1)))}}return a||b}function k(b){ULSEWi:;var e=new SP.Utilities.Set,f=0;while(b!=null&&b!=a){e.Add(b);b=c.GetParent(b);f++}if(b!=null)g=Math.max(f,g);else{while(!e.Contains(a)&&a!=null){a=c.GetParent(a);g++}if(a==null)a=d}}};this.GetOutlineLevel=function(d){ULSEWi:;for(var b=a[d],c=0;b.parentKey!=null;c++)b=a[b.parentKey];return c};this.Insert=function(b,e,d,c){ULSEWi:;a[b]={parentKey:null,childKeys:[]};this.Move(b,e,d,c)};this.Delete=function(b){ULSEWi:;f(b);delete a[b]};this.Move=function(d,i,h,g){ULSEWi:;f(d);var c,b;if(h==null){b=this.GetChildren(i);c=g?b.length:0}else{var j=e(h);b=j.siblingKeys;c=j.siblingIdx+(g?0:1)}b.splice(c,0,d);a[d].parentKey=i};function e(b){ULSEWi:;var a=c.GetParent(b),d=a!=null?c.GetChildren(a):[b],e=SP.Internal.JS.FindInArray(d,function(a){ULSEWi:;return a==b});return {siblingKeys:d,siblingIdx:e,parentKey:a}}function f(b){ULSEWi:;if(c.GetParent(b)!=null){var a=e(b);a.siblingKeys.splice(a.siblingIdx,1)}}function g(){ULSEWi:;if(b.length>0){d=b[0].Key;for(var c=0;c<b.length;c++){var g=b[c].Key,f=b[c].Parent,e=f!=null?b[f].Key:null;a[g]={parentKey:e,childKeys:[]};e!=null&&a[e].childKeys.push(g)}}b=null}};SP.JsGrid.Internal.ChangeHighlightManager=function(){ULSEWi:;var a;this.AddCell=function(c,d){ULSEWi:;var e=b(c,d);a.Add(e)};this.Clear=function(){ULSEWi:;a=new SP.Utilities.Set};this.IsCellIn=function(c,d){ULSEWi:;return a.Contains(b(c,d))};function b(a,b){ULSEWi:;return [a,b].join()}this.Clear()};SP.JsGrid.JsGridControl=function(c,t){ULSEWi:;G();c.style.position="relative";var b,d,l,s,x,y,r=0,j,v=false,m=false,e,n=new SP.JsGrid.EventManager,h=new SP.JsGrid.DelegateManager,p=new SP.JsGrid.DelegateManager,q=new SP.LoadingBanner(c,c.id+"_disable_banner"),a={},k,g={Start:0,Finish:1},f=this;this.parentNode=c;c.jsgrid=this;t&&o(false);this.IsInitialized=function(){ULSEWi:;return v};this.Init=function(k){ULSEWi:;var f=k;e=c.jsgridparams=f;c.jsgridtableviewparams=f.tableViewParams;c.jsgridrowviewparams=f.tableViewParams&&f.tableViewParams.rowViewParams;i(g.Start);this.name=f.name!=null?f.name:"";D();j=f.tableCache;l=f.commandMgr;l.IsUndoEnabled()&&l.AddPreExecuteNotifier(A);a.RTL={bEnabled:f.isRTL,left:f.isRTL?"right":"left",Left:f.isRTL?"Right":"Left",right:f.isRTL?"left":"right",Right:f.isRTL?"Left":"Right",ltr:f.isRTL?"rtl":"ltr"};SP.JsGrid.Style.SetRTL(a.RTL);p.SetDelegate(SP.JsGrid.Internal.DelegateType.CallAsyncFn,E);p.SetDelegate(SP.JsGrid.Internal.DelegateType.GetLocalizedString,u);p.SetDelegate(SP.JsGrid.Internal.DelegateType.DoLargeTask,F);a.jsGridObj=this;a.jsGridParams=e;a.gridId=c.id;a.eventMgr=n;a.intEventMgr=new SP.JsGrid.EventManager;a.intDelegateMgr=p;a.commandMgr=f.commandMgr;a.delegateMgr=h;a.styleMgr=f.styleManager;a.tableCache=f.tableCache;a.errorMgr=new SP.JsGrid.Internal.ErrorManager(a);a.rowHeaderStateMgr=new SP.JsGrid.Internal.RowHeaderStateManager(a.intEventMgr);a.rowHeaderStates=new SP.JsGrid.RowHeaderStates(a);a.rowHeaderAutoStates=new SP.JsGrid.AutoRowHeaderStates(f.enabledRowHeaderAutoStates,a);a.entryRecordMgr=new SP.JsGrid.Internal.EntryRecordManager(a);a.parentNode=c;a.gridControls={};var m="{cursor:hand} :link {color:"+a.styleMgr.gridPaneStyle.linkColor+"} :visited {color: "+a.styleMgr.gridPaneStyle.visitedLinkColor+"}";SP.JsGrid.DisplayControl.ImageTextDisplayControl._styleForLinks=m;SP.JsGrid.DisplayControl.TextDisplayControl._styleForLinks=m;f.bNotificationsEnabled&&SP.JsGrid.Internal.ErrorNotificationManager.Init(a.gridId,a);a.controller=d=new SP.JsGrid.Internal.MVCController(a,u,f.bEnableDiffTracking);a.paneMgr=b=new SP.JsGrid.Internal.PaneManager(c.id,a,u,c,f.minHeaderHeight,f.minRowHeight,function(){ULSEWi:;return r==0});b.SetEventSinks(d.GetViewEventSinks());k.tableViewParams!=null&&z(k.tableViewParams);$addHandler(window,"unload",w);v=true;i(g.Finish)};function D(){ULSEWi:;e.fnCreateNewRecords!=null&&h.SetDelegate(SP.JsGrid.DelegateType.CreateRecords,e.fnCreateNewRecords);e.fnExpandColumnMenu!=null&&h.SetDelegate(SP.JsGrid.DelegateType.ExpandColumnMenu,e.fnExpandColumnMenu);e.fnSort!=null&&h.SetDelegate(SP.JsGrid.DelegateType.Sort,e.fnSort)}function w(){ULSEWi:;$removeHandler(window,"unload",w);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnBeforeGridDispose);a.intEventMgr.FireEvent(SP.JsGrid.Internal.EventType.OnGridDisposing);q.Dispose();b.Dispose();c.innerHTML="";c=c.jsgrid=c.jsgridparams=c.jsgridtableviewparams=c.jsgridrowviewparams=null;delete f.parentNode;a.parentNode=null;v=m=false;l.RemovePreExecuteNotifier(A)}this.Dispose=w;this.NotifyDataAvailable=function(){ULSEWi:;d.NotifyDataAvailable()};this.NotifySave=function(){ULSEWi:;d.NotifySave()};this.NotifyHide=function(){ULSEWi:;d.NotifyHide()};this.NotifyResize=function(){ULSEWi:;b.NotifyResize()};this.ClearTableView=function(){ULSEWi:;if(m){d.ClearTableView();m=false}};this.HideInitialLoadingBanner=function(){ULSEWi:;if(t){o(true);t=false}};this.ShowInitialGridErrorMsg=function(a){ULSEWi:;this.HideInitialLoadingBanner();errorBanner=new SP.ErrorBanner(c,c.id+"_initial_error_banner");errorBanner.Show(a)};this.ShowGridErrorMsg=function(a){ULSEWi:;this.HideInitialLoadingBanner();errorBanner=new SP.ErrorBanner(c,c.id+"_error_banner");errorBanner.Show(a)};this.LaunchPrintPreview=function(k,m,l,f,g,p,i,h,o,n){ULSEWi:;var d=null;if(f==null)f="test";b.GetRecordMap(function(){ULSEWi:;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return d=j.GetRecords([{pos:0,count:j.GetRecordCount()}],function(b){ULSEWi:;d=b;a()})},function(){ULSEWi:;e.tableViewParams.rowViewParams.view=j.GetView();if(g)SP.JsGrid.FinishLaunchPrintPreview(d.records[0],e,k,m,l,i,h,f,g,p,c.clientWidth-a.paneMgr.GetSplitterPosition()-SP.JsGrid.Internal.SplitterWidth,a.paneMgr.GetGanttZoomLevel(),o,n);else SP.JsGrid.FinishLaunchPrintPreview(d.records[0],e,k,m,l,i,h,f,g,null,0,0,null,null)})})};this.GetAllDataJson=function(c,a){ULSEWi:;b.GetAllDataJson(c,a)};this.SetTableView=function(a){ULSEWi:;e.tableViewParams=c.jsgridtableviewparams=a;c.jsgridrowviewparams=a.rowViewParams;i(g.Start);z(a);i(g.Finish)};function z(b){ULSEWi:;m&&f.ClearTableView();m=true;f.HideInitialLoadingBanner();if(h.DelegatePresent(SP.JsGrid.DelegateType.GetGridRowStyleId))b.fnGetGridRowStyleId=h.GetDelegate(SP.JsGrid.DelegateType.GetGridRowStyleId);k!=null&&n.DetachEvent(SP.JsGrid.EventType.OnRightClick,k);k=b.fnOnRightClick==null?null:function(a){ULSEWi:;b.fnOnRightClick(a.eventInfo,a.context,a.recordKey,a.fieldKey)};k!=null&&n.AttachEvent(SP.JsGrid.EventType.OnRightClick,k);s=new SP.JsGrid.Internal.PositionConverter(j,a);if(b.operationalConstantsFieldKeyMap!=null){x=b.operationalConstantsFieldKeyMap;y=B()}d.SetTableView(b.rowViewParams,b.columns,b.gridFieldMap,b.defaultEditMode,b.bNewRowEnabled,b.bEditingEnabled,b.splitterPos,s,y,b.fnGetGridRowStyleId,b.allowedSelectionTypes,b.bMovableColumns,b.bResizableColumns,b.bHidableColumns,b.bSortableColumns,b.bAutoFilterableColumns,b.bRowHeadersEnabled,b.paneLayout,b.ganttParams,b.pivotedGridParams,b.bRecordIndicatorCheckboxesEnabled,b.checkSelectionCheckboxHiddenRecordKeys,b.checkSelectionCheckboxDisabledRecordKeys,b.checkSelectionCheckedRecordKeys)}this.SetRowView=function(a){ULSEWi:;e.tableViewParams.rowViewParams=c.jsgridrowviewparams=a;i(g.Start);d.SetRowView(a);i(g.Finish)};this.Enable=function(){ULSEWi:;o(true)};this.Disable=function(a){ULSEWi:;o(false,a)};this.EnableEditing=function(){ULSEWi:;d.EnableEditing()};this.DisableEditing=function(){ULSEWi:;d.DisableEditing()};this.FinalizeEditing=function(a,b){ULSEWi:;d.FinalizeEditing(a,b)};this.ShowColumnConfigurationDialog=function(){ULSEWi:;b.ShowColumnConfigurationDialog()};this.GetDiffTracker=function(){ULSEWi:;return d.GetDiffTracker()};this.Focus=function(){ULSEWi:;b.Focus()};this.TryCommitFirstEntryRecords=function(b){ULSEWi:;a.entryRecordMgr.TryCommitFirstEntryRecords(b)};this.ClearUncommittedEntryRecords=function(){ULSEWi:;a.entryRecordMgr.ClearUncommittedEntryRecords()};this.AnyUncomittedEntryRecords=function(){ULSEWi:;return a.entryRecordMgr.AnyUncomittedEntryRecords()};this.GetEntryRecord=function(b){ULSEWi:;return a.entryRecordMgr.GetEntryRecord(b)};this.IsEntryRecordKey=function(b){ULSEWi:;return a.entryRecordMgr.IsEntryRecordKey(b)};this.IsCellEditable=function(d,c,a){ULSEWi:;return b.IsCellEditable(d,c,a)};this.AddBuiltInRowHeaderState=function(c,b){ULSEWi:;this.AddRowHeaderState(c,a.rowHeaderStates[b])};this.AddRowHeaderState=function(c,b){ULSEWi:;a.rowHeaderStateMgr.AddRowHeaderState(c,b)};this.RemoveRowHeaderState=function(c,b){ULSEWi:;a.rowHeaderStateMgr.RemoveRowHeaderState(c,b)};this.GetCheckSelectionManager=function(){ULSEWi:;return d.GetCheckSelectionManager()};this.UpdateProperties=function(a,c,b){ULSEWi:;var e=d.UpdateProperties(a,c,b,null);return e};this.InsertRecordAfter=function(a,c,b){ULSEWi:;return d.InsertRecordAfter(a,c,b,true)};this.InsertRecordBefore=function(a,c,b){ULSEWi:;return d.InsertRecordBefore(a,c,b,true)};this.InsertHiddenRecord=function(c,b,a){ULSEWi:;return d.InsertHiddenRecord(c,b,a)};this.DeleteRecords=function(b,a){ULSEWi:;return d.DeleteRecords(b,a)};this.IndentRecords=function(b,a){ULSEWi:;return d.AdjustRecordsIndentLevel(b,1,a)};this.OutdentRecords=function(b,a){ULSEWi:;return d.AdjustRecordsIndentLevel(b,-1,a)};this.AttachEvent=function(a,b){ULSEWi:;n.AttachEvent(a,b)};this.DetachEvent=function(a,b){ULSEWi:;n.DetachEvent(a,b)};this.SetDelegate=function(a,b){ULSEWi:;h.SetDelegate(a,b)};this.GetDelegate=function(a){ULSEWi:;return h.GetDelegate(a)};this.RefreshRow=function(a){ULSEWi:;b.NotifyChangedRows(s.RecordKeyToViewIdx(a),1)};this.RefreshAllRows=function(a){ULSEWi:;b.RefreshAllRows(a)};this.ClearChanges=function(){ULSEWi:;d.ClearChanges()};this.GetGanttZoomLevel=function(){ULSEWi:;return b.GetGanttZoomLevel()};this.SetGanttZoomLevel=function(a){ULSEWi:;b.SetGanttZoomLevel(a)};this.ScrollGanttToDate=function(a){ULSEWi:;b.ScrollGanttToDate(a)};this.ScrollCellIntoView=function(d,c,a){ULSEWi:;b.ScrollCellIntoView(d,c,a)};this.GetTopRecordIndex=function(){ULSEWi:;return s.GetTopViewIdx()};this.GetTopRowIndex=function(a){ULSEWi:;return b.GetTopRowIndex(a)};this.GetLeftColumnIndex=function(a){ULSEWi:;return b.GetLeftColumnIndex(a)};this.GetOutlineLevel=function(a){ULSEWi:;return d.GetOutlineLevel(a)};this.ShowColumn=function(a,c){ULSEWi:;b.ShowColumn(a,c)};this.HideColumn=function(a){ULSEWi:;b.HideColumn(a)};this.UpdateColumns=function(a){ULSEWi:;b.UpdateColumns(a)};this.GetColumns=function(a){ULSEWi:;return b.GetColumns(a)};this.GetSplitterPosition=function(){ULSEWi:;return b.GetSplitterPosition()};this.SetSplitterPosition=function(a){ULSEWi:;b.SetSplitterPosition(a)};this.AnyErrors=function(){ULSEWi:;return a.errorMgr.AnyErrors()};this.AnyErrorsInRecord=function(b){ULSEWi:;return a.errorMgr.AnyErrorsInRow(b)};this.SetCellError=function(c,d,b){ULSEWi:;return a.errorMgr.SetCellError(c,d,b)};this.SetRowError=function(c,b){ULSEWi:;return a.errorMgr.SetRowError(c,b)};this.ClearCellError=function(b,c,d){ULSEWi:;a.errorMgr.ClearCellError(b,c,d)};this.ClearRowError=function(b,c){ULSEWi:;a.errorMgr.ClearRowError(b,c)};this.ClearAllErrorsOnRow=function(b){ULSEWi:;return a.errorMgr.ClearAllErrorsOnRow(b)};this.GetRowErrorMessage=function(b){ULSEWi:;return a.errorMgr.GetMessageForRow(b)};this.GetCellErrorMessage=function(b,c){ULSEWi:;return a.errorMgr.GetMessageForCell(b,c)};this.ScrollToAndExpandNextError=function(c,b){ULSEWi:;return a.paneMgr.ScrollToAndExpandNextError(c,null,b)};this.ScrollToAndExpandNextErrorOnRecord=function(d,b,c){ULSEWi:;return a.paneMgr.ScrollToAndExpandNextError(d,b,c)};this.GetFocusedItem=function(){ULSEWi:;return b.GetFocusedItemInfo()};this.JumpToEntryRecord=function(){ULSEWi:;b.JumpToEntryRecord()};this.SelectRowRange=function(d,e,c,a){ULSEWi:;b.Select(d,e,null,null,c,a)};this.SelectColumnRange=function(d,e,c,a){ULSEWi:;b.Select(null,null,d,e,c,a)};this.SelectCellRange=function(f,g,d,e,c,a){ULSEWi:;b.Select(f,g,d,e,c,a)};this.SelectRowRangeByKey=function(d,e,c,a){ULSEWi:;b.SelectByKey(d,e,null,null,c,a)};this.SelectColumnRangeByKey=function(d,e,c,a){ULSEWi:;b.SelectByKey(null,null,d,e,c,a)};this.SelectCellRangeByKey=function(a,c,f,g,e,d){ULSEWi:;b.SelectByKey(a,c,f,g,e,d)};this.GetSelectedRowRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.RowRange)};this.GetSelectedColumnRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.ColumnRange)};this.GetSelectedCellRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,SP.JsGrid.SelectionType.CellRange)};this.GetSelectedRanges=function(a){ULSEWi:;return b.GetOrderedSelections(a,null)};this.MarkPropUpdateInvalid=function(c,e,b,a){ULSEWi:;return d.MarkPropUpdateInvalid(c,e,b,a)};this.GetCurrentChangeKey=function(){ULSEWi:;return d.GetCurrentChangeKey()};this.GetChangeKeyForVersion=function(a){ULSEWi:;return d.GetChangeKeyForVersion(a)};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForChangeKey(b,c,a)};this.GetHierarchyState=function(b){ULSEWi:;var a=d.GetHierarchyManager();return a&&a.GetState(b)};this.IsGroupingRecordKey=function(b){ULSEWi:;var a=d.GetHierarchyManager();return a&&a.IsGroupingRecord(b)};this.GetSelectedRecordKeys=function(a){ULSEWi:;return C(a)};this.CutToClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnCut(b)};this.CopyToClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnCopy(b)};this.PasteFromClipboard=function(){ULSEWi:;var b=a.selectionMgr.GetFocusedPane();b!=null&&a.cutcopypasteMgr.OnPaste(b)};this.GetUndoManager=function(){ULSEWi:;return l};this.GetVisibleRecordCount=function(){ULSEWi:;return a.paneMgr.GetVisibleRecordCount()};this.GetRecordIndicatorCheckBoxColumnIndex=function(){ULSEWi:;return a.paneMgr.GetRecordIndicatorCheckBoxColumnIndex()};function A(){ULSEWi:;a.paneMgr.StopEditing(false)}function C(g){ULSEWi:;var d=f.GetSelectedRowRanges(),h=f.GetSelectedColumnRanges(),c=f.GetSelectedCellRanges(),b;if(h.length!=0)b=j.GetView();else if(g){b=[];for(var a=0;a<d.length;a++)b=b.concat(d[a].keys);for(var a=0;a<c.length;a++)b=b.concat(c[a].rowRange.keys)}else{for(var e=new SP.Utilities.Set,a=0;a<d.length;a++)e.AddArray(d[a].keys);for(var a=0;a<c.length;a++)e.AddArray(c[a].rowRange.keys);b=e.ToArray()}return b}function G(){ULSEWi:;if(!SP.JsGrid.JsGridControl._bStaticInit){SP.JsGrid.Internal.Property=new SP.JsGrid.Internal.Property;SP.JsGrid.JsGridControl._bStaticInit=true}}function B(){ULSEWi:;function a(a){ULSEWi:;return x[a]}return {GetFieldKey:a,GetProp:function(d,c){ULSEWi:;var b=a(c);return {fieldKey:b,prop:d.GetProp(b)}},GetValue:function(c,b){ULSEWi:;return c.GetDataValue(a(b))}}}function E(b,a){ULSEWi:;return SP.Internal.CallAsyncFn(b,a,function(){ULSEWi:;f.Disable()},function(){ULSEWi:;f.Enable()})}function F(c,b,d,e,g){ULSEWi:;var a=0;if(c>b){f.Disable();SP.JsGrid.AsynchronousTaskManager.RegisterTask(h,g)}else{d(0,c);e()}function h(){ULSEWi:;var g=(Math.floor(a/b)+1)*b;a=d(a,g);if(a<c)return true;else{f.Enable();e();return false}}}function u(a){ULSEWi:;a=a.charAt(0).toLowerCase()+a.substr(1);var b=e.tableViewParams.messageOverrides;return b&&b[a]||SP.JsGrid.Res[a]}function i(a){ULSEWi:;if(c.fireEvent)switch(a){case g.Start:c.fireEvent("onbeforeupdate");break;case g.Finish:c.fireEvent("onafterupdate")}}function o(b,c){ULSEWi:;if(b&&r==1)q.Hide();else if(!b){var d=c==null?SP.JsGrid.Res.loadingMsg:c;if(r==0)q.Show(d);else q.UpdateText(d)}r-=b?1:-1;a.ariaMgr!=null&&a.ariaMgr.EnableGrid(b)}};SP.JsGrid.JsGridControl.Parameters=function(){ULSEWi:;this.tableCache=null;this.name=null;this.bNotificationsEnabled=false;this.styleManager=SP.JsGrid.Style.MakeJsGridStyleManager();this.minHeaderHeight=0;this.minRowHeight=0;this.commandMgr=new SP.JsGrid.CommandManager(100);this.enabledRowHeaderAutoStates=(new SP.Utilities.Set).AddArray([SP.JsGrid.RowHeaderAutoStyleId.Error,SP.JsGrid.RowHeaderAutoStyleId.NewRow]);this.bEnableDiffTracking=false;this.isRTL=SP.JsGrid.Utility.GetDocumentDirection()=="rtl";this.tableViewParams=new SP.JsGrid.JsGridControl.TableViewParameters};SP.JsGrid.JsGridControl.TableViewParameters=function(){ULSEWi:;this.keyFieldName=null;this.columns=null;this.gridFieldMap=null;this.messageOverrides=null;this.operationalConstantsFieldKeyMap=null;this.defaultEditMode=SP.JsGrid.EditMode.ReadWriteDefer;this.allowedSelectionTypes=SP.JsGrid.SelectionTypeFlags.MultipleCellRanges|SP.JsGrid.SelectionTypeFlags.MultipleRowRanges|SP.JsGrid.SelectionTypeFlags.MultipleColRanges;this.bMovableColumns=true;this.bResizableColumns=true;this.bHidableColumns=true;this.bSortableColumns=true;this.bAutoFilterableColumns=true;this.bRowHeadersEnabled=true;this.bRecordIndicatorCheckboxesEnabled=false;this.bFillControlEnabled=true;this.checkSelectionCheckboxHiddenRecordKeys=[];this.checkSelectionCheckboxDisabledRecordKeys=[];this.checkSelectionCheckedRecordKeys=[];this.bEditingEnabled=false;this.bNewRowEnabled=false;this.splitterPos=400;this.paneLayout=SP.JsGrid.PaneLayout.GridOnly;this.ganttParams=null;this.pivotedGridParams=null;this.rowViewParams=new SP.JsGrid.JsGridControl.RowViewParameters};SP.JsGrid.JsGridControl.RowViewParameters=function(){ULSEWi:;this.view=null;this.topViewIdx=0;this.hierarchyMode=SP.JsGrid.HierarchyMode.None;this.groupingLevel=null;this.groupingRecordKeyPrefix;this.autoFilterState=null;this.unfilteredHierarchyMgr=null;this.hierarchyDelayLoadKeys=null;this.hierarchyState=null;this.sortState=null;this.filterState=null;this.autoFilterEntries=null;this.filteredDescCounts=null};SP.JsGrid.JsGridControl.PivotedGridParameters=function(){ULSEWi:;this.columns=null};SP.JsGrid.JsGridControl.GanttParameters=function(){ULSEWi:;this.dateRange=null;this.ganttBarStyles=null;this.ganttZoomLevel=3;this.fnRenderGanttRow=null;this.fnGetGanttBarDate=null;this.fnGetGanttBarStyleIds=null;this.fnGetPredecessors=null;this.workDayStart=_spRegionalSettings.workDayStart;this.workDayEnd=_spRegionalSettings.workDayEnd;this.fieldKeyRedrawFilter=null};SP.JsGrid.Internal.EntryRecordManager=function(a){ULSEWi:;var x="NewRowKey",t=this,i=new SP.Utilities.Set,b=[],c={},z=new SP.Utilities.Set,C,h=false,d=false,A=0,e=false,j=null,l=false,f=[];function v(){ULSEWi:;return x+A++}function q(e,d){ULSEWi:;var c=d==null?a.delegateMgr.Apply(SP.JsGrid.DelegateType.CreateEntryRecord):d;if(c.recordKey==null)c.recordKey=v();c.properties[a.jsGridParams.tableViewParams.keyFieldName].dataValue=c.recordKey;b.push(c);i.Add(c.key());c.bIsNewRow=true;a.paneMgr.NotifyCreateEntryRow(b.length-1,e);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordAdded,new SP.JsGrid.EventArgs.OnEntryRecordAdded(c.key()));return c}function p(c){ULSEWi:;var b=a.controller.GetEarliestChangeKeyForRecord(c);return b!=null&&a.controller.IsChangeKeyApplied(b)}function s(e,f){ULSEWi:;a.editUtil.IsNewRowEnabled()&&!f&&a.paneMgr.NotifyRemoveEntryRow(e);var g=b[e],d=g.key();b.splice(e,1);i.Remove(d);delete c[d];a.controller.ClearAllPropChangesForRecord(d);return d}function w(){ULSEWi:;var a=null;if(b.length>1)a=s(b.length-1);return a}function m(c){ULSEWi:;l=true;a.paneMgr.StopEditing(true);a.paneMgr.UnbindEditing(function(){ULSEWi:;while(b.length>0)s(0,c);l=false})}function k(b,c,d){ULSEWi:;var e=q(b,d);a.controller.AttachUndoActionToChangeKey(c,function(){ULSEWi:;var a=w()})}function n(d){ULSEWi:;t.GetLastEntryKey()==d.recordKey&&k(false,d.changeKey);if(d.validationState==SP.JsGrid.ValidationState.Valid){if(c[d.recordKey]==null)c[d.recordKey]=[];c[d.recordKey].push(d);if(d.recordKey==b[0].key()){e=true;if(j!=null){var h=a.errorMgr.ClearRowError(b[0].key(),j);j=null}}}var f=a.paneMgr.GetFocusedItemInfo();(f==null||f.recordKey!=d.recordKey)&&g()}function r(a){ULSEWi:;b.length>0&&a.oldRecordKey==b[0].key()&&g()}function y(c){ULSEWi:;a.commandMgr.Unlock();d=false;e=false;j=a.errorMgr.SetRowError(b[0].key(),c)}function u(e,c,b){ULSEWi:;a.commandMgr.Unlock();d=false;return B(e,c,b)}function B(l,p,o){ULSEWi:;var d=b[0],e=d.key(),q=s(c[e]);delete c[e];i.Remove(e);z.Add(e);if(l!=null&&l!=e){t(e,l);d.recordKey=l;d.properties[a.jsGridParams.tableViewParams.keyFieldName].dataValue=d.recordKey}b.shift();delete d.bIsNewRow;for(var f in p)!(f in q)&&d.AddFieldValue(f,{hasLocalized:true,localized:p[f]});for(var f in o)!(f in q)&&d.AddFieldValue(f,{hasData:true,data:o[f]});var j=a.controller.GetEarliestChangeKeyForRecord(d.key());b.length==0&&k(false,j);var h=a.paneMgr.GetLastRecordKey(),m=null,n=a.jsGridParams.tableViewParams.rowViewParams.unfilteredHierarchyMgr;if(n!=null){var r=n.GetLastNodeKey();if(r!=h){m=h;h=r}}a.controller.InsertRecordAfter(h,d,j,false,true,m,m!=null);a.eventMgr.FireEvent(SP.JsGrid.EventType.OnEntryRecordCommitted,new SP.JsGrid.EventArgs.OnEntryRecordCommitted(e,d.key(),j));a.paneMgr.NotifyChangedRowByKey(d.key());g();return j;function s(c){ULSEWi:;for(var d={},b=0;b<c;b++)if(a.controller.IsChangeKeyApplied(c[b].changeKey))d[c[b].fieldKey]=0;return d}function t(c,b){ULSEWi:;a.paneMgr.ChangeKeys(c,b);a.controller.ChangeKeysInVersionMgr(c,b);SP.JsGrid.AsynchronousCellUpdater.ChangeRecordKeys(c,b);a.rowHeaderStateMgr.ChangeKeys(c,b);a.errorMgr.ChangeKeys(c,b)}}this.TryCommitFirstEntryRecords=function(a){ULSEWi:;a!=null&&f.push(a);g()};function g(){ULSEWi:;var f=false;if(!d&&e&&b.length>0&&b[0].key() in c&&!l)if(p(b[0].key())){f=d=true;a.commandMgr.Lock();setTimeout(function(){ULSEWi:;a.pendingChangeMgr.WaitForPendingUpdates(g)},0)}!f&&!d&&o();function g(){ULSEWi:;if(!a.errorMgr.AnyErrorsInRow(b[0].key()))a.delegateMgr.Apply(SP.JsGrid.DelegateType.TryInsertEntryRecord,b[0],c[b[0].key()],u,y);else{d=false;e=false;a.commandMgr.Unlock();o()}}}function o(){ULSEWi:;if(f.length>0){var a=!t.AnyUncomittedEntryRecords();while(f.length>0)f.shift()(a)}}this.CreateEntryRows=function(c,b,d){ULSEWi:;for(var a=0;a<c;a++)k(!b,d)};this.AnyUncomittedEntryRecords=function(){ULSEWi:;return b.length>1||b.length==1&&p(b[0].key())};this.ClearUncommittedEntryRecords=function(){ULSEWi:;m(false)};this.EnsureLastEntryRowExists=function(){ULSEWi:;if(a.editUtil.IsNewRowEnabled()&&b.length==0){q(false);if(!h){a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,n);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,r);h=true}}};this.NotifyTableViewChangeCompleted=function(){ULSEWi:;e=false;this.EnsureLastEntryRowExists()};this.NotifyTableViewCleared=function(){ULSEWi:;if(b.length>0){m(true);if(h){a.eventMgr.DetachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,n);a.eventMgr.DetachEvent(SP.JsGrid.EventType.OnRowFocusChanged,r);h=false}}};this.GetEntryRecords=function(){ULSEWi:;return b};this.IsEntryRecordKey=function(a){ULSEWi:;return i.Contains(a)};this.GetLastEntryKey=function(){ULSEWi:;return a!=null?b[b.length-1].key():null};this.GetEntryRecordIdx=function(a){ULSEWi:;var c=SP.Internal.JS.FindInArray(b,function(b){ULSEWi:;return a==b.key()});return c};this.GetEntryRecord=function(a){ULSEWi:;return b[this.GetEntryRecordIdx(a)]}};SP.JsGrid.Internal.PaneManager=function(Y,a,P,h,fb,kb,eb){ULSEWi:;var K=SP.Internal.ScrollBar.GetMinScrollBarLength(),zb=K*2+SP.JsGrid.Internal.SplitterWidth+SP.Internal.ScrollBar.GetSystemScrollBarThickness(),yb=SP.Internal.ScrollBar.GetMinScrollBarLength()+SP.Internal.ScrollBar.GetSystemScrollBarThickness(),r,l,q,f,R,b,d=[],k=0,n,s,g,c,i,p,j,u={},t=this,jb=false,H,A,B={height:h.offsetHeight,width:h.offsetWidth},bb=true,x=a.selectionMgr=new SP.JsGrid.Internal.SelectionManager(function(a){ULSEWi:;H.OnFocusedCellChanged!=null?H.OnFocusedCellChanged(a):0}),V=new SP.JsGrid.Internal.ChangeHighlightManager,m=new SP.JsGrid.Internal.EditManager(a,function(b,d,c,a){ULSEWi:;H.OnPropertiesChanged(b,d,c,a)},O),y=a.cutcopypasteMgr=new SP.JsGrid.Internal.CutCopyPasteManager(a,P),mb=new SP.JsGrid.Internal.FillDownManager(a.intDelegateMgr,a.styleMgr),Q=true,e,Bb,z,C,G,v=new SP.JsGrid.SplitterBar(a,K,function(){ULSEWi:;return t.GetSplitterPosition()},N,function(a){ULSEWi:;return t.SetSplitterPosition(a)}),U=false,T=false,F=false,ab=a.focusMgr=new SP.JsGrid.Internal.FocusManager(Y,a,h,P,eb,ib,x,m,O,Z,I);Hb();this.SetEventSinks=function(a){ULSEWi:;H=a};this.Dispose=function(){ULSEWi:;if(g!=null){y.CancelMode();m.StopEditing(true);m.Unbind(function(){ULSEWi:;o(0,d.length,0,0,true);g.each("Dispose");b.Dispose();$removeHandler(h,"mousedown",nb);$removeHandler(window,"focus",hb);$removeHandler(window,"resize",gb);try{typeof SP.UI.Workspace.add_resized=="function"&&SP.UI.Workspace.remove_resized(L)}catch(c){}SP.Internal.DomElement.RemoveMouseWheelHandler(h,lb);if(v!=null){v.Dispose();v=null}a()})}else a();function a(){ULSEWi:;q=loadingBanner=r=l=h=f=null;m.Dispose();ab.Dispose()}};this.ClearView=function(){ULSEWi:;Q=true;a.entryRecordMgr.NotifyTableViewCleared();m.Unbind();x.Clear();y.CancelMode();this.RefreshAllRows(0);g.each("ClearView")};this.NotifyCreateEntryRow=function(f,d){ULSEWi:;if(e!=null){var c=f+e.GetViewRecordCount(),a=e.ViewIdxToRelViewIdx(c);X(1);if(b.GetItemDisplayCapacity()>a)o(0,0,a,1,true);else d&&I(c)}};this.NotifyRemoveEntryRow=function(a){ULSEWi:;e!=null&&this.NotifyDeleteRows(a+e.GetViewRecordCount(),1)};this.GetLastRecordKey=function(){ULSEWi:;return e!=null?e.GetLastRecordKey():null};this.ChangeKeys=function(a,b){ULSEWi:;g.each("ChangeKeys",a,b);if(a in u){u[b]=u[a];delete u[a]}};this.GetVirtualRowCount=function(){ULSEWi:;return c.GetGridPaneConverter().GetVirtualRowCount()};this.GetVisibleRecordCount=function(){ULSEWi:;return Math.min(k-b.GetTopItemIdx(),b.GetItemDisplayCapacity())};this.GetPartialRecordMap=function(d,f){ULSEWi:;var e=c.GetGridPaneConverter(),b;a.intDelegateMgr.Apply(SP.JsGrid.Internal.DelegateType.CallAsyncFn,function(a){ULSEWi:;return b=e.GetRecordsInvolved(d.begin,d.Size(),function(c){ULSEWi:;b=c;a()})},function(){ULSEWi:;f(b)})};this.GetRecordMap=function(d){ULSEWi:;var a=c.GetGridPaneConverter(),b=new SP.Utilities.Range(0,a.GetVirtualRowCount()-1);t.GetPartialRecordMap(b,d)};this.GetGridPaneRowRange=function(){ULSEWi:;return new SP.Utilities.Range(0,c.GetGridPaneConverter().GetVirtualRowCount()-1)};this.GetAllDataJson=function(x,m){ULSEWi:;var e=128;a.jsGridObj.Disable();var n=c.GetGridPaneConverter(),w=new SP.Utilities.Range(0,n.GetVirtualRowCount()-1),v=new SP.Utilities.Range(0,n.GetVirtualColumnCount()-1),j=i!=null?i.GetGridPaneConverter():null,d=i!=null?j.GetRowMultiple():0,u=i!=null?new SP.Utilities.Range(0,j.GetVirtualColumnCount()-1):null;function g(b){ULSEWi:;for(var c=b.GetColumnArray(true),d=[],a=0;a<c.length;++a)d.push(b.GetColumnByKey(c[a].columnKey).name);return d}var b={gridPaneData:null,gridPaneColumns:null,gridPaneStyleData:{cellStyleData:[]},pivotedGridPaneData:null,pivotedGridPaneColumns:null,pivotedGridPaneStyleData:{cellStyleData:[]}},h=[],o=0,p=0,f=[],k=0,l=0,s=c.GetAllColumns(),q=s.GetColumnArray();b.gridPaneColumns=g(s);if(i!=null)b.pivotedGridPaneColumns=g(i.GetAllColumns());function r(g){ULSEWi:;var j=g,n=null;if(g.end-g.begin+1>e){j=new SP.Utilities.Range(g.begin,g.begin+e-1);n=new SP.Utilities.Range(g.begin+e,g.end)}t.GetPartialRecordMap(j,function(g){ULSEWi:;var t=c.GetData(g,j,v);if(m!=null)for(var z in g)for(var E=a.paneMgr.RecordKeyToViewIdx(z),D=g[z],s=0;s<q.length;++s){var C=q[s].columnKey,A=m(D,C);A!=null&&b.gridPaneStyleData.cellStyleData.push({matrixRow:E,matrixColumn:s,styleText:A})}var y=Sys.Serialization.JavaScriptSerializer.serialize(t.matrix);h.push(y.substr(1,y.length-2));o+=t.height;p=t.width;var e=null;if(i!=null){var B=new SP.Utilities.Range(j.begin*d,j.end*d+d-1);e=i.GetData(g,B,u);var w=Sys.Serialization.JavaScriptSerializer.serialize(e.matrix);f.push(w.substr(1,w.length-2));k+=e.height;l=e.width}if(n!=null)setTimeout(function(){ULSEWi:;r(n)},0);else setTimeout(function(){ULSEWi:;var c=["{",'"gridPaneData":{"matrix":',"[",h.join(","),"]",',"height":',o,',"width":',p,"},",'"gridPaneColumns":',Sys.Serialization.JavaScriptSerializer.serialize(b.gridPaneColumns),",",'"gridPaneStyleData":',Sys.Serialization.JavaScriptSerializer.serialize(b.gridPaneStyleData),",",'"pivotedGridPaneData":',i!=null?['{"matrix":',"[",f.join(","),"]",',"height":',k,',"width":',l,"}"].join(""):"null",",",'"pivotedGridPaneColumns":',i!=null?Sys.Serialization.JavaScriptSerializer.serialize(b.pivotedGridPaneColumns):"null",",",'"pivotedGridPaneStyleData":',Sys.Serialization.JavaScriptSerializer.serialize(b.pivotedGridPaneStyleData),",",'"pivotedGridPaneRowMultiple":',d,"}"].join("");a.jsGridObj.Enable();setTimeout(function(){ULSEWi:;x(c)},0)},0)})}r(w)};this.SetView=function(n,Y,S,X,k,T,s,M,E,v,D,w,o,u,W,U,N,K,F){ULSEWi:;B={height:h.offsetHeight,width:h.offsetWidth};Q=false;e=n;Bb=k;z=W;G=S;C=T;A=a.editUtil.IsNewRowEnabled();e.SetPaneMgrObj(t);e.SetScrollBarObj(b);x.SetAllowedSelectionTypes(M);y.CancelMode();if(c==null){wb();sb();vb();var d=new ob(r);c=new SP.JsGrid.Internal.GridPane(r,a,I,z==SP.JsGrid.PaneLayout.GridOnly?pb:null,a.commandMgr,x,V,m,y,mb,d,O,P,Z,R);c.paneSize=d;g=[c];g.each=Fb}else f.style.display="none";if(p!=null&&z!=SP.JsGrid.PaneLayout.GridAndGantt||i!=null&&z!=SP.JsGrid.PaneLayout.GridAndPivotedGrid){tb();i=p=j=null;g.splice(1,1)}if(z!=SP.JsGrid.PaneLayout.GridOnly&&j==null){ub();var d=new ob(l);p=i=null;if(z==SP.JsGrid.PaneLayout.GridAndGantt){SP.JsGrid.Internal.GanttPane==null&&alert("Javascript support for Gantt-drawing is not enabled.");p=j=new SP.JsGrid.Internal.GanttPane(l,a,SP.Internal.DomElement.BrowserIsIE?new SP.JsGrid.Internal.VmlGanttDrawImpl(a.RTL.bEnabled):new SP.JsGrid.Internal.SvgGanttDrawImpl(a.RTL.bEnabled),d)}else i=j=new SP.JsGrid.Internal.PivotedGridPane(l,a,I,null,a.commandMgr,x,V,m,y,mb,d,O,P,Z,R);j.paneSize=d;g.push(j)}if(b==null)b=new SP.JsGrid.Internal.ScrollBar(SP.JsGrid.Internal.ScrollBar.BarType.Vertical,q,true,null,a.styleMgr.scrollBarStyle,a.RTL.bEnabled);e.SetScrollBarObj(b);b.Update({topItemIdx:0,bScrollNotifiy:false});db();J(true);c.SetView(n,k,qb(Y,K),G,s,E,v,D,w,o,u,F);p!=null&&p.SetView(n,k,U);i!=null&&i.SetView(n,k,N.columns,G,s,false,false,false,false,false,false,null);db();g.each("SetEventSinks",H);this.RefreshAllRows(X);if(!jb){b.SetOnScroll(Ab);b.SetOnVisibilityChanged(rb,true);$addHandler(h,"mousedown",nb);$addHandler(window,"focus",hb);$addHandler(window,"resize",gb);try{typeof SP.UI.Workspace.add_resized=="function"&&SP.UI.Workspace.add_resized(L)}catch(bb){}SP.Internal.DomElement.AddMouseWheelHandler(h,lb);jb=true}g.each("OnResize");ab.SetView(z,c,i,G,E,v,D,w,o,u,F);a.entryRecordMgr.NotifyTableViewChangeCompleted();f.style.display=""};this.SetFilterState=function(a){ULSEWi:;c.SetFilterState(a)};this.SetSortState=function(a){ULSEWi:;c.SetSortState(a)};this.ShowColumnConfigurationDialog=function(){ULSEWi:;c.ShowColumnConfigurationDialog()};this.RecordKeyToViewIdx=function(a){ULSEWi:;return u[a]};this.RefreshAllRows=function(a){ULSEWi:;T=true;Cb(e.GetViewRecordCount(),a);o(0,d.length,0,this.GetVisibleRecordCount(),true);T=false};this.NotifyNewRowStateChanged=function(b){ULSEWi:;y.CancelMode();var c=A;A=a.editUtil.IsNewRowEnabled();if(c!=A){a.entryRecordMgr.EnsureLastEntryRowExists();!b&&this.RefreshAllRows()}};this.NotifyChangedRowByKey=function(a){ULSEWi:;a in u&&this.NotifyChangedRows(u[a],1)};this.NotifyChangedRows=function(b,c){ULSEWi:;var a=S(b,c);if(a.clippedCount<1)return;o(a.clippedRelViewIdx,a.clippedCount,a.clippedRelViewIdx,a.clippedCount,false)};this.NotifyUpdateProperty=function(f,i,b,e,c,h){ULSEWi:;if(f!=null)g.each("NotifyUpdateProperty",f,i,b,e,c,h);else for(var a=0;a<d.length;a++){var j=d[a];j!=null&&g.each("NotifyUpdateProperty",j.recordKey,i,b,e,c,h)}};this.NotifyInsertRows=function(c,a,f,e){ULSEWi:;m.Unbind(function(){ULSEWi:;F=true;var h=b.GetTopItemIdx(),k=h+(c<h?a:0);X(a,k);F=false;var g=S(c,a);if(g.clippedCount<1){M();return}var m=g.clippedRelViewIdx,i=g.clippedCount,p=b.GetItemDisplayCapacity(),n=p-d.length,j=Math.max(i-n,0),l=d.length-j;o(l,j,m,i,true);f&&t.UpdateFocusAfterInsertOrDeleteRows(c,a-1,true);e!=null&&e()})};this.NotifyDeleteRows=function(c,a){ULSEWi:;m.Unbind(function(){ULSEWi:;var f=S(c,a);F=true;var l=b.GetTopItemIdx(),e=l+Math.max(Math.min(c-l,0),-a);X(-a,e);var g=Math.max(e-b.GetTopItemIdx(),0);e=b.GetTopItemIdx();F=false;if(f.clippedCount<1){M();return}var n=b.GetItemDisplayCapacity(),p=e+n==k+1&&b.PartialRowPresent(),q=d.length!=n,i=f.clippedRelViewIdx,r=Math.max(Math.min(i+f.clippedCount,d.length)-i,0);o(i,r,0,g,true);var m=Math.max(Math.min(f.clippedCount,k-d.length+g),0),j=Math.min(k-(e+d.length),m);o(0,0,d.length,j,true);var h=m-j-g;if(h>0&&!q&&p)h--;o(0,0,0,h,true);t.UpdateFocusAfterInsertOrDeleteRows(c,a,false)})};this.UpdateFocusAfterInsertOrDeleteRows=function(b,c,a){ULSEWi:;g.each("UpdateFocusAfterInsertOrDeleteRows",b,c,a)};this.ScrollCellIntoView=function(c,a,e){ULSEWi:;var d=this.GetPane(e);c!=null&&b.ScrollIntoView(d.GetGridPaneConverter().RowIdxToViewIdx(c));a!=null&&d.ScrollColumnIntoViewHorizontally(a)};this.IsCellEditable=function(f,c,d){ULSEWi:;var b=this.GetPane(d).GetGridPaneConverter(),e=b.GetColumnByIdx(b.FieldKeyToColIdx(c));return a.editUtil.CanEditField(f,e,c)};this.GetGanttZoomLevel=function(){ULSEWi:;return p?p.GetZoomLevel():null};this.SetGanttZoomLevel=function(a){ULSEWi:;p?p.SetZoomLevel(a):null};this.Focus=function(){ULSEWi:;ab.Focus()};this.StopEditing=function(a){ULSEWi:;m.StopEditing(a)};this.UnbindEditing=function(a){ULSEWi:;m.Unbind(a)};this.NotifyResize=function(){ULSEWi:;L()};this.ScrollGanttToDate=function(a){ULSEWi:;p!=null&&p.SetFocusDate(a)};this.GetTopRowIndex=function(a){ULSEWi:;return this.GetPane(a).BeginRowIdx()};this.GetLeftColumnIndex=function(a){ULSEWi:;return this.GetPane(a).BeginColIdx()};this.ShowColumn=function(a,b){ULSEWi:;c.ShowColumn(a,b)};this.HideColumn=function(a){ULSEWi:;c.HideColumn(a)};this.UpdateColumns=function(a){ULSEWi:;c.UpdateColumns(a)};this.GetColumns=function(a){ULSEWi:;return Db(this.GetPane(a).GetColumns(),[SP.JsGrid.RecordIndicatorCheckboxColumnKey])};this.GetRecordIndicatorCheckBoxColumnIndex=function(){ULSEWi:;var a=this.GetPane();return a&&SP.Internal.JS.FindInArray(a.GetColumns(),function(a){ULSEWi:;return a.columnKey==SP.JsGrid.RecordIndicatorCheckboxColumnKey})};this.ScrollToAndExpandNextError=function(l,i,j){ULSEWi:;var b=i==null?a.errorMgr.GetNextError(l,j):a.errorMgr.GetNextErrorForRecord(l,i,j);if(b!=null){var k=e.RecordKeyToViewIdx(b.recordKey),d;if(k!=null){for(var f=0;f<g.length&&d==null;f++){var c=g[f];if(c.Id==SP.JsGrid.PaneId.MainGrid||c.Id==SP.JsGrid.PaneId.PivotedGrid){d=b.type==SP.JsGrid.Internal.ErrorType.Row?0:c.GetGridPaneConverter().FieldKeyToColIdx(b.fieldKey);if(d==null){var h=c.FieldKeyToColumnKey(b.fieldKey);if(h!=null){c.ShowColumn(h,null);d=c.GetGridPaneConverter().FieldKeyToColIdx(b.fieldKey)}}}}t.ScrollCellIntoView(k,d,c.Id);if(b.type==SP.JsGrid.Internal.ErrorType.Cell&&d!=null){x.SetFocusByKey(c,b.recordKey,b.fieldKey);setTimeout(function(){ULSEWi:;m.ExpandWidget(SP.JsGrid.ErrorWidgetId)},0)}return b.id}}return null};function Db(a,d){ULSEWi:;for(var c=0;c<d.length;c++)for(var b=0;b<a.length;b++)if(a[b].columnKey==d[c]){a.splice(b,1);break}return a}this.ClearAllChangeIndications=function(){ULSEWi:;g.each("NotifyChangeIndicatorsClearing");V.Clear()};this.GetFocusedItemInfo=function(){ULSEWi:;var a=x.GetFocus();return a==null?null:{recordKey:a.recordKey,fieldKey:a.fieldKey,paneId:a.gridPane.Id}};this.JumpToEntryRecord=function(){ULSEWi:;if(A){var b=a.entryRecordMgr.GetLastEntryKey(),d=c.GetColumns()[0].columnKey;c.SelectByKey(b,b,d,d,false);t.ScrollCellIntoView(e.RecordKeyToViewIdx(b),0,c.Id)}};this.GetSplitterPosition=function(){ULSEWi:;return j!=null?C:0};this.SetSplitterPosition=function(a){ULSEWi:;cb(a);J()};this.Select=function(e,f,c,d,b,a){ULSEWi:;this.GetPane(a).Select(e,f,c,d,b)};this.SelectByKey=function(a,b,e,f,d,c){ULSEWi:;this.GetPane(c).SelectByKey(a,b,e,f,d)};this.GetOrderedSelections=function(b,a){ULSEWi:;return x.GetOrderedSelections(this.GetPane(b),a)};this.NotifyCanEditUpdated=function(){ULSEWi:;g.each("NotifyCanEditUpdated")};this.GetGridPane=function(){ULSEWi:;return c};this.GetPane=function(a){ULSEWi:;var b=a==SP.JsGrid.PaneId.MainGrid||a==null?c:a==SP.JsGrid.PaneId.PivotedGrid?i:a==SP.JsGrid.PaneId.Gantt?p:null;return b};function cb(a){ULSEWi:;if(j!=null)C=Math.min(Math.max(a,K),N()-SP.Internal.ScrollBar.GetSystemScrollBarThickness()-(j?K+SP.JsGrid.Internal.SplitterWidth:0))}function lb(a){ULSEWi:;b.Update({topItemIdx:b.GetTopItemIdx()+a.wheelDelta});a.stopPropagation();a.preventDefault()}function N(){ULSEWi:;return Math.max(B.width-2,zb)}function w(){ULSEWi:;return Math.max(B.height-2,yb)}function ob(c){ULSEWi:;var b,a;this.SetValues=function(d,c){ULSEWi:;b=d;a=c};this.GetHeight=function(){ULSEWi:;return w()};this.GetWidth=function(){ULSEWi:;return b};this.GetLeftOffset=function(){ULSEWi:;return a};this.Dispose=function(){ULSEWi:;c=null}}function qb(e,h){ULSEWi:;var f=e;if(h){var d=SP.JsGrid.RecordIndicatorCheckboxColumnKey,g=G[d]=new SP.JsGrid.GridField(d,false,false,null,SP.JsGrid.TextDirection.Default,SP.JsGrid.EditMode.ReadOnly),c=SP.Internal.JS.object(SP.JsGrid.Internal.Property.GetPropType("CheckBoxBoolean"));c.ID="RecordIndicatorCheckBoxBoolean";c.GetDisplayValue=function(b){ULSEWi:;return a.checkSelMgr.IsRecordIndicatorCheckboxChecked(b.key())?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType(c,"CheckBoxBoolean");g.SetSingleValuePropType(c);var b=new SP.JsGrid.ColumnInfo("",null,d,SP.JsGrid.Internal.MinColumnWidth);b.isResizable=b.isSortable=b.isHidable=b.isAutoFilterable=b.isAutoFilterable=false;b.fnGetDisplayControlName=function(){ULSEWi:;return a.gridControls[SP.JsGrid.RecordIndicatorControlId].Id};f=new SP.JsGrid.ColumnInfoCollection([b].concat(e.GetColumnArray()))}return f}function Hb(){}function I(a){ULSEWi:;return b.ScrollIntoView(a)}function Cb(d,c){ULSEWi:;k=Q?0:d+(A?a.entryRecordMgr.GetEntryRecords().length:0);b.Update({itemCount:k,topItemIdx:c});return k}function X(c,a){ULSEWi:;k+=c;b.Update({itemCount:k,topItemIdx:a});return k}function S(g,h){ULSEWi:;var d=g,f=g+h-1;d=Math.max(0,Math.min(k-1,d));f=Math.max(0,Math.min(k-1,f));var a=e.ViewIdxToRelViewIdx(d),c=e.ViewIdxToRelViewIdx(f);a=Math.max(a,0);c=Math.min(c,b.GetItemDisplayCapacity()-1);return {clippedRelViewIdx:a,clippedCount:c-a+1}}function wb(){ULSEWi:;h.style.position="relative";h.style.direction=a.RTL.ltr;f=document.createElement("div");f.style.cssText="overflow:hidden;top:"+f.style[a.RTL.left]+"1px;width:"+N()+"px;height:"+w()+"px;border:1px solid "+a.styleMgr.timescaleTierStyle.outerBorderColor+";display:none";h.appendChild(f)}function vb(){ULSEWi:;r=document.createElement("div");r.id=Y+"_leftpane";r.gridItem=true;r.style.cssText="background:"+a.styleMgr.gridPaneStyle.backgroundColor+";overflow:hidden;width:484px;float:"+a.RTL.left;f.appendChild(r);q=document.createElement("div");q.gridItem=true;q.style.cssText="float:"+a.RTL.left+";width:"+SP.Internal.ScrollBar.GetSystemScrollBarThickness()+"px;overflow:hidden;";f.appendChild(q)}function ub(){ULSEWi:;if(!v.IsInited()){var b=v.Init(f,w()+2,-1);b.gridItem=true;f.insertBefore(b,q);b=null}else v.Show();l=document.createElement("div");l.gridItem=true;l.style.cssText="overflow:hidden;float:"+a.RTL.left;l.id=Y+"_rightpane";f.insertBefore(l,q)}function sb(){ULSEWi:;var e,d={},c={},b={},g="position:absolute; visibility:hidden; top:0px; left:0px; width:0px; height:0px;";e=document.createElement("div");e.style.cssText=g;e.style.width=e.style.height="5px";a.parentNode.appendChild(e);d.Top=document.createElement("div");d.Right=document.createElement("div");d.Bottom=document.createElement("div");d.Left=document.createElement("div");for(var f in d){var k=d[f];k.style.cssText=g;a.parentNode.appendChild(k)}c.Top=document.createElement("div");c.Right=document.createElement("div");c.Bottom=document.createElement("div");c.Left=document.createElement("div");for(var f in c){var i=c[f];i.style.cssText=g;i.style["border"+f]=SP.JsGrid.Style.MakeBorderString(1,"solid",a.styleMgr.gridPaneStyle.selectionRectBorderColor);a.parentNode.appendChild(i)}b={Back:{},Fore:{}};b.Back.Top=document.createElement("div");b.Back.Right=document.createElement("div");b.Back.Bottom=document.createElement("div");b.Back.Left=document.createElement("div");b.Fore.Top=document.createElement("div");b.Fore.Right=document.createElement("div");b.Fore.Bottom=document.createElement("div");b.Fore.Left=document.createElement("div");for(var f in b){var l=f=="Back"?SP.JsGrid.Style.MakeBorderString(2,"solid",a.styleMgr.gridPaneStyle.copyRectBackBorderColor):SP.JsGrid.Style.MakeBorderString(2,"dashed",a.styleMgr.gridPaneStyle.copyRectForeBorderColor);for(var j in b[f]){var h=b[f][j];h.style.cssText=g;h.style["border"+j]=l;a.parentNode.appendChild(h)}}R={selDragHandle:e,selFrames:d,focusFrames:c,copyFrames:b}}function D(){ULSEWi:;return bb?SP.Internal.ScrollBar.GetSystemScrollBarThickness():0}function E(){ULSEWi:;return q.style.display!="none"?SP.Internal.ScrollBar.GetSystemScrollBarThickness():0}function J(o){ULSEWi:;cb(C);var e=w();f.style.height=e+"px";for(var k=0;k<f.childNodes.length;k++)if(f.childNodes[k].gridItem)f.childNodes[k].style.height=e+"px";b!=null&&b.Update({physicalViewportSize:e-n-D(),scrollbarSize:e});v.IsInited()&&v.SetHeight(e+2);var h=N();f.style.width=h+"px";if(l!=null){var d=C,i=h-(C+SP.JsGrid.Internal.SplitterWidth+E());r.style.width=d+"px";l.style.width=i+"px";if(a.RTL.bEnabled){j.paneSize.SetValues(i,E());c.paneSize.SetValues(d,h-d)}else{c.paneSize.SetValues(d,0);j.paneSize.SetValues(i,h-E()-i)}}else{var d=h-E();r.style.width=d+"px";c.paneSize.SetValues(d,a.RTL.bEnabled?E():0)}!Q&&!o&&g.each("OnResize");m.NotifyMove()}function tb(){ULSEWi:;v.Hide();SP.Internal.DomElement.GetParentElement(l).removeChild(l);l=null}function hb(){ULSEWi:;y.CheckClipboard()}function gb(){ULSEWi:;L()}function L(){ULSEWi:;f.style.display="none";if(!ib()||h.offsetHeight==B.height&&h.offsetWidth==B.width){f.style.display="";return}B={height:h.offsetHeight,width:h.offsetWidth};f.style.display="";SP.Internal.DomElement.ForceIEZoomFactorRecomputation();var d=b.GetItemDisplayCapacity(),c=b.GetTopItemIdx();U=true;J();var a=w();b.SetViewportSize(a-n-D(),true,a-D());U=false;xb(d,c)}function nb(a){ULSEWi:;if(eb()){SP.Internal.DomElement.StopEvent(a);t.Focus()}}function db(){ULSEWi:;var a=n,d=s;n=fb?fb:0;n=Math.max(n,c.GetMinHeaderHeight());if(j){n=Math.max(n,j.GetMinHeaderHeight());j.SetHeaderHeight(n)}c.SetHeaderHeight(n);s=kb?kb:0;s=Math.max(s,c.GetMinRowHeight());if(j){s=Math.max(s,j.GetMinRowHeight());j.SetRowHeight(s)}c.SetRowHeight(s);(a!=n||d!=s)&&b!=null&&b.Update({physicalViewportSize:w()-n-D(),scrollbarSize:w(),itemSize:s})}function rb(a){ULSEWi:;q.style.display=a?"":"none";J()}function pb(a){ULSEWi:;bb=a;b.Update({bOtherScrollMeets:a,physicalViewportSize:w()-n-D()})}function Ab(b,c){ULSEWi:;var a=b.topIdx-c;if(a!=0&&!U&&!T&&!F)a<0?Gb(b.topIdx,-a):Eb(b.topIdx,a)}function Eb(f,h){ULSEWi:;var a=b.GetItemDisplayCapacity(),d=f+a==k+1&&b.PartialRowPresent(),c=Math.min(h,a),g=c-(d?1:0),e=a-c;o(0,c,e,g,false)}function Gb(i,h){ULSEWi:;var a=b.GetItemDisplayCapacity(),e=d.length!=a,c=Math.min(Math.min(h,k),a),g=c-(e?1:0),f=a-c;o(f,g,0,c,false)}function xb(p,n){ULSEWi:;var i=b.GetItemDisplayCapacity(),a=i-p,m=b.GetTopItemIdx();if(a<0){var j=Math.max(d.length-i,0),l=d.length-j;o(l,j,null,0,false)}else if(a>0){var f=n-m;o(null,0,0,f,false);var c=a-f,g=d.length,h=e.RelViewIdxToViewIdx(g);c=Math.min(h+c,k)-h;o(null,0,g,c,false)}}function o(h,c,a,f,k){ULSEWi:;var j=h!=null&&c>0,b=a!=null&&f>0;if(j||b){var i=b&&f>0?e.GetViewRecords(e.RelViewIdxToViewIdx(a),f,W).records:[];j&&d.splice(h,c);b&&Array.prototype.splice.apply(d,[a,0].concat(i));M();g.each("SpliceRows",h,c,a,i,k);m.NotifyMove()}}function Z(){ULSEWi:;W(b.GetTopItemIdx(),d.length,true)}function W(h,k,i,j){ULSEWi:;if(SP.Internal.JS.FindKey(d,function(a){ULSEWi:;return a==null})===undefined)return;var c=b.GetTopItemIdx(),f={};if(!i||c==j){for(var l=new SP.Utilities.Range(h,h+k-1),a=0;a<d.length;a++)if(d[a]==null&&l.Contains(c+a))f[a]=SP.JsGrid.Internal.LoadErrorState}else{for(var m=e.GetViewRecords(c,d.length,function(a,b,d){ULSEWi:;W(a,b,d,c)}).records,a=0;a<d.length;a++)if(d[a]==null)f[a]=d[a]=m[a];d=[].concat(d);M()}g.each("RenderRows",f)}function M(){ULSEWi:;u={};for(var b=e.GetTopViewIdx(),a=0;a<d.length;a++)if(d[a]!=null)u[d[a].key()]=a+b}function Fb(c){ULSEWi:;for(var d=Array.prototype.slice.call(arguments,1),a=0;a<this.length;++a){var b=this[a][c];b&&b.apply(this[a],d)}}function O(a,b,c){ULSEWi:;var d={data:a.HasDataValue(b)?a.GetDataValue(b):SP.JsGrid.EmptyValue,localized:c.GetDisplayValue!=null?c.GetDisplayValue(a,a.HasDataValue(b)?a.GetDataValue(b):null,a.HasLocalizedValue(b)?a.GetLocalizedValue(b):null):a.HasLocalizedValue(b)?a.GetLocalizedValue(b):SP.JsGrid.EmptyValue};return d}function ib(){ULSEWi:;return h.offsetHeight>0&&h.offsetWidth>0}};SP.JsGrid.Internal.PivotedGridPane=function(c,x,g,e,u,q,j,w,m,r,v,n,s,k,f){ULSEWi:;var a=new SP.JsGrid.Internal.GridPane(c,x,h,e,u,q,j,w,m,r,v,n,s,k,f),b=1;c=null;a.Id=SP.JsGrid.PaneId.PivotedGrid;var t=a.SetView;a.SetView=function(l,j,n,k,d,i,f,h,g,c,e,m){ULSEWi:;t.call(a,l,j,n,k,d,i,f,h,g,c,e,m);b=a.GetGridPaneConverter().GetRowMultiple()};var p=a.SpliceRows;a.SpliceRows=function(h,j,i,e,g){ULSEWi:;for(var d=[],c=0;c<e.length;c++)for(var f=0;f<b;f++)d.push(e[c]);p.call(a,h*b,j*b,i*b,d,g)};var o=a.RenderRows;a.RenderRows=function(f){ULSEWi:;var d={};for(var e in f)for(var g=+e*b,c=0;c<b;c++)d[g+c]=f[e];o.call(a,d)};var d=a.UpdateFocusAfterInsertOrDeleteRows;a.UpdateFocusAfterInsertOrDeleteRows=function(e,f,c){ULSEWi:;d.call(a,e*b,f*b,c)};var i=a.GetMinRowHeight;a.GetMinRowHeight=function(){ULSEWi:;return i.call(a)*b};var l=a.SetRowHeight;a.SetRowHeight=function(c){ULSEWi:;l.call(a,c/b)};function h(b){ULSEWi:;g(a.GetGridPaneConverter().RowIdxToViewIdx(b))}return a};SP.JsGrid.Internal.PositionConverter=function(b,c){ULSEWi:;var d,a,e,f=this;this.SetHierarchyMgrObj=function(b){ULSEWi:;a=b};this.SetScrollBarObj=function(a){ULSEWi:;d=a};this.SetPaneMgrObj=function(a){ULSEWi:;e=a};this.GetTopViewIdx=function(){ULSEWi:;return d.GetTopItemIdx()};this.GetWholeRowDisplayCapacity=function(){ULSEWi:;return d.GetWholeItemDisplayCapacity()};this.RecordIdxToRecordKey=function(a){ULSEWi:;var e;if(c.editUtil.IsNewRowEnabled()&&a>=b.GetRecordCount()){var d=c.entryRecordMgr.GetEntryRecords();if(d.length>0)e=d[Math.min(a-b.GetRecordCount(),d.length-1)].key()}else e=b.RecordIdxToKey(a);return e};this.RecordIdxToViewIdx=function(b){ULSEWi:;return a?a.ConvertRecordIdxToViewIdx(b):b};this.ViewIdxToRecordIdx=function(b){ULSEWi:;return a?a.ConvertViewIdxToRecordIdx(b):b};this.ViewIdxToRelViewIdx=function(a){ULSEWi:;return a-d.GetTopItemIdx()};this.RelViewIdxToViewIdx=function(a){ULSEWi:;return a+d.GetTopItemIdx()};this.IsRecordOnScreen=function(a){ULSEWi:;return e.RecordKeyToViewIdx(a)!=null};this.GetLastRecordKey=function(){ULSEWi:;return b.RecordIdxToKey(b.GetRecordCount()-1)};this.RecordKeyToViewIdx=function(d){ULSEWi:;var f=e.RecordKeyToViewIdx(d);if(f!=null)return f;var a;if(c.entryRecordMgr.IsEntryRecordKey(d))a=c.entryRecordMgr.GetEntryRecordIdx(d)+this.GetViewRecordCount();else a=b.KeyToRecordIdx(d);return a==null?null:this.RecordIdxToViewIdx(a)};this.RecordKeyToRelViewIdx=function(b){ULSEWi:;var a=this.RecordKeyToViewIdx(b);return a!=null?this.ViewIdxToRelViewIdx(a):null};this.RecordKeyToRecordIdx=function(a){ULSEWi:;var c=e.RecordKeyToViewIdx(a);return c!=null?this.ViewIdxToRecordIdx(c):b.KeyToRecordIdx(a)};this.ViewIdxToRecordKey=function(a){ULSEWi:;return this.RecordIdxToRecordKey(this.ViewIdxToRecordIdx(a))};this.GetViewRecordCount=function(){ULSEWi:;return a?a.GetViewRecordCount():b.GetRecordCount()};this.GetViewRecords=function(f,e,j){ULSEWi:;var g=0;if(c.editUtil.IsNewRowEnabled())g=Math.min(Math.max(f+e-this.GetViewRecordCount(),0),e);e-=g;var d=e==0?null:a?a.GetViewRecords(f,e,i):b.GetRecords([{pos:f,count:e}],i);if(d==null)d={recordSetComplete:true,records:[]};else d.records=SP.Internal.JS.Flatten2LevelArray(d.records);if(g>0){var h=Math.max(f-this.GetViewRecordCount(),0);d.records=d.records.concat(c.entryRecordMgr.GetEntryRecords().slice(h,h+g))}return d;function i(b,a){ULSEWi:;j(f,e,a)}}};function AdjustPrintPreviewGridDivWidth(c,d,f,e){ULSEWi:;for(var a=0,b=0;b<c.length;++b)if(c[b].isVisible)a+=c[b].width;a+=d?SP.JsGrid.Internal.RowHeaderWidth:0;a+=f?SP.JsGrid.Internal.SplitterWidth+e:0;a+=2;$get("jsgrid_div_element").style.width=a+"px";return a}SP.JsGrid.PrintPreviewGrid=function(){ULSEWi:;var c,a,i,e,j,m=false,d=false,b=null,f,h;this.Init=function(D,p,B,G,E,s,o,y,w,r,q,F,x,z,A,u,t){ULSEWi:;d=F;b=x;f=z;h=A;i=B;function v(f,b){ULSEWi:;var e=new Array(b.length);for(var d in b){var a=f[b[d]],c=j.MakeRecord(a.data,a.localized,m);c.fieldRawDataMap=a.fieldRawDataMap;c.fieldRawLocMap=a.fieldRawLocMap;e[b[d]]=c}return e}SP.JsGrid.Internal.Property.RegisterDefaultPropTypesFromDefaultDisplayControlMap(s,o);fnInitJsGridParams=g(y,[w]);c=D;a=new SP.JsGrid.JsGridControl.Parameters;a.name=String.format(SP.JsGrid.Res.printPreviewName,c.name);a.tableViewParams=p;for(var C in a.tableViewParams.gridFieldMap){var n=a.tableViewParams.gridFieldMap[C];if(n._propType.ID in o||!n._propType.bMultiValue){if(SP.JsGrid.Internal.Property.PropTypeExists(n._propType.ID))n._propType=SP.JsGrid.Internal.Property.GetPropType(n._propType.ID)}else if(n._propType.bMultiValue)n._propType=new SP.JsGrid.PropertyType.MultiValuePropType(n._propType.singleValuePropType.ID,n._propType.separator,!SP.JsGrid.Internal.Property.PropTypeExists(n._propType.singleValuePropType.ID))}fnInitJsGridParams!=null&&typeof fnInitJsGridParams=="function"&&fnInitJsGridParams(a,c);g(r,[a.tableViewParams,q]);g(u,[a.tableViewParams,c,t]);e=new SP.JsGrid.TableCache(null,v);k(G,p.gridFieldMap,E);a.tableCache=e;l();c.Init(a);$addHandler(window.document.body,"mouseup",function(){ULSEWi:;var e=parseInt($get("jsgrid_div_element").clientWidth),g=AdjustPrintPreviewGridDivWidth(c.GetColumns(),a.tableViewParams.bRowHeadersEnabled,d,f);c.NotifyResize();if(d){var b=c.GetSplitterPosition();c.SetSplitterPosition(b+(g-e))}});setTimeout(function(){ULSEWi:;window.print()},0)};function g(d,e){ULSEWi:;if(d==null)return null;for(var b=d.split("."),c=window,a=0;a<b.length;++a)if(a==b.length-1&&b[a] in c&&typeof c[b[a]]=="function")return c[b[a]].apply(null,e);else if(b[a] in c)c=c[b[a]];else break;return null}function k(a,c,b){ULSEWi:;e.Clear();e.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(a),a);j=new SP.JsGrid.RecordFactory(c,b)}function l(){ULSEWi:;a.styleManager.groupingStyles=i;if(d){a.tableViewParams.splitterPos=parseInt($get("jsgrid_div_element").clientWidth,10)-f-SP.JsGrid.Internal.SplitterWidth;a.tableViewParams.ganttParams.ganttZoomLevel=h;if(b!=null){if(b.fnGetGanttBarDate!=null&&b.fnGetGanttBarDate in window)a.tableViewParams.ganttParams.fnGetGanttBarDate=window[b.fnGetGanttBarDate];if(b.fnGetGanttBarStyleIds!=null&&b.fnGetGanttBarStyleIds in window)a.tableViewParams.ganttParams.fnGetGanttBarStyleIds=window[b.fnGetGanttBarStyleIds];if(b.fnRenderGanttRow!=null&&b.fnRenderGanttRow in window)a.tableViewParams.ganttParams.fnRenderGanttRow=window[b.fnRenderGanttRow];if(b.fnGetPredecessors!=null&&b.fnGetPredecessors in window)a.tableViewParams.ganttParams.fnGetPredecessors=window[b.fnGetPredecessors]}}else{a.tableViewParams.ganttParams=null;a.tableViewParams.paneLayout=SP.JsGrid.PaneLayout.GridOnly}a.tableViewParams.bMovableColumns=true;a.tableViewParams.bResizableColumns=true;a.tableViewParams.bEditingEnabled=false;a.tableViewParams.allowedSelectionTypes=0;a.tableViewParams.bNewRowEnabled=false;a.tableViewParams.bSortableColumns=false;a.tableViewParams.bHidableColumns=false;a.tableViewParams.bAutoFilterableColumns=false;a.tableViewParams.bRecordIndicatorCheckboxesEnabled=false}};SP.JsGrid.CreatePrintPreviewBlobFromRecords=function(f){ULSEWi:;for(var g={},c=0;c<f.length;++c){var a=f[c],e={},d={};for(var b in a.properties){e[b]=a.properties[b].dataValue;if(a.properties[b].HasLocalizedValue())d[b]=a.properties[b].localizedValue}g[a.key()]={data:e,localized:d,fieldRawDataMap:a.fieldRawDataMap,fieldRawLocMap:a.fieldRawLocMap}}return g};SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone=function(e){ULSEWi:;var a=new SP.JsGrid.JsGridControl.TableViewParameters,b=Sys.Serialization.JavaScriptSerializer.deserialize(e);a.messageOverrides=b.simpleFields.messageOverrides;a.operationalConstantsFieldKeyMap=b.simpleFields.operationalConstantsFieldKeyMap;a.defaultEditMode=b.simpleFields.defaultEditMode;a.allowedSelectionTypes=b.simpleFields.allowedSelectionTypes;a.bMovableColumns=b.simpleFields.bMovableColumns;a.bResizableColumns=b.simpleFields.bResizableColumns;a.bHidableColumns=b.simpleFields.bHidableColumns;a.bSortableColumns=b.simpleFields.bSortableColumns;a.bAutoFilterableColumns=b.simpleFields.bAutoFilterableColumns;a.bRowHeadersEnabled=b.simpleFields.bRowHeadersEnabled;a.bRecordIndicatorCheckboxesEnabled=b.simpleFields.bRecordIndicatorCheckboxesEnabled;a.checkSelectionCheckboxHiddenRecordKeys=b.simpleFields.checkSelectionCheckboxHiddenRecordKeys;a.checkSelectionCheckboxDisabledRecordKeys=b.simpleFields.checkSelectionCheckboxDisabledRecordKeys;a.checkSelectionCheckedRecordKeys=b.simpleFields.checkSelectionCheckedRecordKeys;a.bEditingEnabled=b.simpleFields.bEditingEnabled;a.bNewRowEnabled=b.simpleFields.bNewRowEnabled;a.hierarchyKey=b.simpleFields.hierarchyKey;a.splitterPos=b.simpleFields.splitterPos;a.paneLayout=b.simpleFields.paneLayout;a.rowViewParams=b.simpleFields.rowViewParams;var c=Sys.Serialization.JavaScriptSerializer.deserialize(b.gridFieldMap);a.gridFieldMap={};for(var d in c)a.gridFieldMap[d]=SP.JsGrid.GridField.CreateFromSerializedClone(c[d]);a.columns=SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone(b.columns);if(b.pivotedGridParams_columns!=null){a.pivotedGridParams=new SP.JsGrid.JsGridControl.PivotedGridParameters;a.pivotedGridParams.columns=SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone(b.pivotedGridParams_columns)}if(b.ganttParams!=null)a.ganttParams=SP.JsGrid.JsGridControl.GanttParameters.CreateFromSerializedClone(b.ganttParams);if(b.unfilteredHierarchyMgr!=null)a.rowViewParams.unfilteredHierarchyMgr=SP.JsGrid.UnfilteredHierarchyManager.CreateFromSerializedClone(b.unfilteredHierarchyMgr);return a};SP.JsGrid.UnfilteredHierarchyManager.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({unfilteredHierMap:a.rowViewParams.unfilteredHierarchyMgr.GetUnfilteredHierarchyMap(),topNodeKey:a.rowViewParams.unfilteredHierarchyMgr.GetTopNodeKey()})};SP.JsGrid.UnfilteredHierarchyManager.CreateFromSerializedClone=function(c){ULSEWi:;var b=new SP.JsGrid.UnfilteredHierarchyManager([]),a=Sys.Serialization.JavaScriptSerializer.deserialize(c);b.Hydrate(a.unfilteredHierMap,a.topNodeKey);return b};SP.JsGrid.JsGridControl.TableViewParameters.GetSerializedClone=function(a){ULSEWi:;var b={};for(var c in a.gridFieldMap)b[c]=SP.JsGrid.GridField.GetSerializedClone(a.gridFieldMap[c]);return Sys.Serialization.JavaScriptSerializer.serialize({simpleFields:{messageOverrides:a.messageOverrides,operationalConstantsFieldKeyMap:a.operationalConstantsFieldKeyMap,defaultEditMode:a.defaultEditMode,allowedSelectionTypes:a.allowedSelectionTypes,bMovableColumns:a.bMovableColumns,bResizableColumns:a.bResizableColumns,bHidableColumns:a.bHidableColumns,bSortableColumns:a.bSortableColumns,bAutoFilterableColumns:a.bAutoFilterableColumns,bRowHeadersEnabled:a.bRowHeadersEnabled,bRecordIndicatorCheckboxesEnabled:a.bRecordIndicatorCheckboxesEnabled,checkSelectionCheckboxHiddenRecordKeys:a.checkSelectionCheckboxHiddenRecordKeys,checkSelectionCheckboxDisabledRecordKeys:a.checkSelectionCheckboxDisabledRecordKeys,checkSelectionCheckedRecordKeys:a.checkSelectionCheckedRecordKeys,bEditingEnabled:a.bEditingEnabled,bNewRowEnabled:a.bNewRowEnabled,hierarchyKey:a.hierarchyKey,splitterPos:a.splitterPos,paneLayout:a.paneLayout,rowViewParams:a.rowViewParams},gridFieldMap:Sys.Serialization.JavaScriptSerializer.serialize(b),columns:SP.JsGrid.ColumnInfoCollection.GetSerializedClone(a.columns),pivotedGridParams_columns:a.pivotedGridParams==null?null:SP.JsGrid.ColumnInfoCollection.GetSerializedClone(a.pivotedGridParams.columns),ganttParams:a.ganttParams==null?null:SP.JsGrid.JsGridControl.GanttParameters.GetSerializedClone(a.ganttParams),unfilteredHierarchyMgr:a.rowViewParams.unfilteredHierarchyMgr==null?null:SP.JsGrid.UnfilteredHierarchyManager.GetSerializedClone(a)})};SP.JsGrid.JsGridControl.GanttParameters.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({dateRange:a.dateRange,ganttBarStyles:a.ganttBarStyles,ganttZoomLevel:a.ganttZoomLevel})};SP.JsGrid.JsGridControl.GanttParameters.CreateFromSerializedClone=function(c){ULSEWi:;var a=new SP.JsGrid.JsGridControl.GanttParameters,b=Sys.Serialization.JavaScriptSerializer.deserialize(c);a.dateRange=b.dateRange;a.ganttBarStyles=b.ganttBarStyles;a.ganttZoomLevel=b.ganttZoomLevel;return a};SP.JsGrid.GridField.GetSerializedClone=function(a){ULSEWi:;return Sys.Serialization.JavaScriptSerializer.serialize({key:a.key,hasDataValue:a.hasDataValue,hasLocalizedValue:a.hasLocalizedValue,textDirection:a.textDirection,_defaultCellStyleId:a._defaultCellStyleId,_editMode:a._editMode,_propType:a._propType,_multiValue:a._multiValue})};SP.JsGrid.GridField.CreateFromSerializedClone=function(c){ULSEWi:;var a=new SP.JsGrid.GridField,b=Sys.Serialization.JavaScriptSerializer.deserialize(c);a.key=b.key;a.hasDataValue=b.hasDataValue;a.hasLocalizedValue=b.hasLocalizedValue;a.textDirection=b.textDirection;a._defaultCellStyleId=b._defaultCellStyleId;a._editMode=b._editMode;a._multiValue=b._multiValue;a._propType=b._propType;return a};SP.JsGrid.GetSerializedCloneFromColumnInfo=function(a){ULSEWi:;if(a.ColumnType()=="column")return Sys.Serialization.JavaScriptSerializer.serialize({name:a.name,imgSrc:a.imgSrc,columnKey:a.columnKey,fieldKeys:a.fieldKeys,width:a.width,isVisible:a.isVisible,isHidable:a.isHidable,isResizable:a.isResizable,isSortable:a.isSortable,isAutoFilterable:a.isAutoFilterable,pivoted:false});else if(a.ColumnType()=="pivotedColumn")return Sys.Serialization.JavaScriptSerializer.serialize({name:a.name,imgSrc:a.imgSrc,columnKey:a.columnKey,fieldKeys:a.fieldKeys,width:a.width,pivoted:true})};SP.JsGrid.CreateColumnInfoFromSerializedClone=function(c){ULSEWi:;var a=Sys.Serialization.JavaScriptSerializer.deserialize(c),b;if(a.pivoted)b=new SP.JsGrid.PivotedColumnInfo(a.name,a.imgSrc,a.columnKey,a.fieldKeys,a.width);else{b=new SP.JsGrid.ColumnInfo(a.name,a.imgSrc,a.columnKey,a.width);b.isVisible=a.isVisible;b.isHidable=a.isHidable;b.isResizable=a.isResizable;b.isSortable=a.isSortable;b.isAutoFilterable=a.isAutoFilterable}return b};SP.JsGrid.ColumnInfoCollection.GetSerializedClone=function(d){ULSEWi:;for(var c=[],b=d.GetColumnArray(),a=0;a<b.length;++a)c.push(SP.JsGrid.GetSerializedCloneFromColumnInfo(b[a]));return Sys.Serialization.JavaScriptSerializer.serialize(c)};SP.JsGrid.ColumnInfoCollection.CreateFromSerializedClone=function(d){ULSEWi:;for(var b=[],c=Sys.Serialization.JavaScriptSerializer.deserialize(d),a=0;a<c.length;++a)b.push(SP.JsGrid.CreateColumnInfoFromSerializedClone(c[a]));return new SP.JsGrid.ColumnInfoCollection(b)};SP.JsGrid.FinishLaunchPrintPreview=function(records,jsGridParams,additionalScriptFiles,beforeInitFnName,beforeInitFnArgsObj,initTableViewParamsFnName,initTableViewParamsFnArgsObj,title,bEnableGantt,optGanttDelegateNames,ganttPaneWidth,ganttZoomLevel,initGanttStylesFnName,initGanttStylesFnArgsObj){ULSEWi:;var newWin,cssLinkScripts=[],AJAXScripts=[],scripts=[],requiredScriptFiles=["scriptresx.ashx","jsgrid.js","sp.datetimeutil.js","jsgrid.gantt.js","init.js"],requiredAJAXFiles=["scriptresource.axd","webresource.axd"],requiredCssFiles=["jsgrid.css","corev4.css","cui.css"];function MatchNodeWithSourceFiles(node,requiredFilesArray,htmlElementArray,attrib){ULSEWi:;var nodeStr=(eval("node."+attrib)).toLowerCase();if(requiredFilesArray!=null)for(var idx=0;idx<requiredFilesArray.length;++idx){var fileName=requiredFilesArray[idx].toLowerCase();if(nodeStr.indexOf(fileName)!=-1||fileName.indexOf(".js")==fileName.length-3&&nodeStr.indexOf(fileName.substr(0,fileName.length-3)+".debug.js")!=-1){htmlElementArray.push(SP.Internal.DomElement.GetOuterHTML(node));return true}}}function CopyRequiredDOMElements(a){ULSEWi:;for(var b=0;b<a.childNodes.length;++b){var c=a.childNodes[b];c.nodeType==1&&CopyRequiredDOMElements(c)}if(a.nodeName=="LINK"){if(MatchNodeWithSourceFiles(a,requiredCssFiles,cssLinkScripts,"href"))return}else if(a.nodeName=="SCRIPT"){if(MatchNodeWithSourceFiles(a,requiredScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(a,additionalScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(a,requiredAJAXFiles,AJAXScripts,"src"))return}}function RenderHTMLElementArray(b){ULSEWi:;for(var a=0;a<b.length;++a)newWin.document.writeln(b[a])}function RenderPrintPreviewDocument(){ULSEWi:;newWin.document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"');newWin.document.writeln('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">');newWin.document.writeln("<html>");newWin.document.writeln("<head>");newWin.document.writeln("<title>"+title+"</title>");RenderHTMLElementArray(cssLinkScripts);RenderHTMLElementArray(AJAXScripts);newWin.document.writeln("</head>");newWin.document.writeln("<body>");newWin.document.writeln('<div id="jsgrid_outer_div_element" style="width:100%; height:100%; overflow-y:auto">');newWin.document.writeln('<div id="jsgrid_div_element" style="width:100%; height:570px" display="block"/>');newWin.document.writeln("</div>");newWin.document.writeln(String.format(["<script>","var _spRegionalSettings={0}","</script>"].join("\n"),Sys.Serialization.JavaScriptSerializer.serialize(_spRegionalSettings)));RenderHTMLElementArray(scripts);newWin.document.writeln(String.format(["<script>","Sys.Application.initialize();","var printPreviewGrid=new SP.JsGrid.PrintPreviewGrid();","Sys.Application.add_init(function()","{{",'    var jsGridDiv=$get("jsgrid_div_element");','    jsGridDiv.style.backgroundColor="white";','    var defaultDisplayControlMap=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{0}"));','    var lookupPropTypeMap=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{8}"));','    var tableViewParams=new SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone(unescape("{1}"));','    var dataBlob=Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{2}"));',"    var recordCount={3};",'    jsGridDiv.style.height=(recordCount * 21+50)+"px";',"    AdjustPrintPreviewGridDivWidth(tableViewParams.columns.GetColumnArray(), tableViewParams.bRowHeadersEnabled, {9}, {11});",'    var keyColumnName=unescape("{4}");',"    printPreviewGrid.Init(","        new SP.JsGrid.JsGridControl(jsGridDiv, false),","        tableViewParams,",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{7}")),',"        dataBlob,","        keyColumnName,","        defaultDisplayControlMap,","        lookupPropTypeMap,","        {5},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{6}")),',"        {13},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{14}")),',"        {9},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{10}")),',"        {11},","        {12},","        {16},",'        Sys.Serialization.JavaScriptSerializer.deserialize(unescape("{17}"))',"    );","}});",'Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse(unescape("{15}"));',"</script>","</body>","</html>"].join("\n"),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.Internal.Property.GetDefaultDisplayControlMap())),escape(SP.JsGrid.JsGridControl.TableViewParameters.GetSerializedClone(jsGridParams.tableViewParams)),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.CreatePrintPreviewBlobFromRecords(records))),records.length,escape(jsGridParams.tableViewParams.keyFieldName),beforeInitFnName?['"',beforeInitFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(beforeInitFnArgsObj)),escape(Sys.Serialization.JavaScriptSerializer.serialize(jsGridParams.styleManager.groupingStyles)),escape(Sys.Serialization.JavaScriptSerializer.serialize(SP.JsGrid.Internal.Property.GetLookupPropTypeMap())),bEnableGantt?"true":"false",escape(Sys.Serialization.JavaScriptSerializer.serialize(optGanttDelegateNames)),ganttPaneWidth,ganttZoomLevel,initTableViewParamsFnName?['"',initTableViewParamsFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(initTableViewParamsFnArgsObj)),escape(Sys.Serialization.JavaScriptSerializer.serialize(Sys.CultureInfo.CurrentCulture)),initGanttStylesFnName?['"',initGanttStylesFnName,'"'].join(""):"null",escape(Sys.Serialization.JavaScriptSerializer.serialize(initGanttStylesFnArgsObj))))}CopyRequiredDOMElements(document);newWin=window.open();newWin.document.clear();newWin.document.open("text/html");RenderPrintPreviewDocument();newWin.document.close()};Type.registerNamespace("SP.JsGrid.PropertyType");SP.JsGrid.PropertyType.String=function(){ULSEWi:;this.ID="String";this.BeginValidateNormalizeConvert=function(d,e,a,c,b){ULSEWi:;a=a!=null&&a.length==0?null:a;b({isValid:true,dataValue:a,normalizedLocValue:a})}};SP.JsGrid.PropertyType.LookupTable=function(a,e,c){ULSEWi:;function b(b){ULSEWi:;if(b==null)return null;return SP.Internal.JS.Find(a,function(a){ULSEWi:;return a.value==b})}function d(b){ULSEWi:;if(b==null)return null;var c=b.toLowerCase();return SP.Internal.JS.Find(a,function(a){ULSEWi:;return a.localString.toLowerCase()==c})}return {ID:e,BeginValidateNormalizeConvert:function(h,i,e,f,g){ULSEWi:;r={};var a=f?d(e):b(e);r.isValid=a!=null||!c;if(a!=null){r.normalizedLocValue=a.localString;r.dataValue=a.value}else r.normalizedLocValue=r.dataValue=e;g(r)},GetItems:function(d){ULSEWi:;for(var c=[],b=0;b<a.length;b++)c.push(SP.JsGrid.Property.MakeProperty(a[b].value,a[b].localString,true,true,this));d(c)},DataToLocalized:function(c){ULSEWi:;var a=b(c);return a?a.localString:SP.JsGrid.EmptyValue},LocalizedToData:function(b){ULSEWi:;var a=d(b);return a?a.value:SP.JsGrid.EmptyValue},GetImageSource:function(d,c){ULSEWi:;var a=b(c);return a!=null?a.imageUrl:null},GetStyleId:function(c){ULSEWi:;var a=b(c);return a!=null?a.styleId:null},GetIsLimitedToList:function(){ULSEWi:;return c},GetSerializableLookupPropType:function(){ULSEWi:;return {items:a,id:e,bLimitToList:c}}}};SP.JsGrid.PropertyType.CheckBoxBoolean=function(){ULSEWi:;this.ID="CheckBoxBoolean";this.BeginValidateNormalizeConvert=function(d,e,a,b,c){ULSEWi:;a=b?a!=""&&a!=SP.JsGrid.Res.checkboxUnchecked:!!a;c({isValid:true,dataValue:a,normalizedLocValue:this.DataToLocalized(a)})};this.DataToLocalized=function(a){ULSEWi:;return a?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};this.GetBool=function(a){ULSEWi:;return a==SP.JsGrid.EmptyValue?false:!!a}};SP.JsGrid.PropertyType.MultiValuePropType=function(d,c,g,h){ULSEWi:;var a=null;function f(){ULSEWi:;a=SP.JsGrid.Internal.Property.GetPropType(d);b.singleValuePropType=a;b.GetImageSource=a.GetImageSource&&function(c,b){ULSEWi:;return e(b,function(b){ULSEWi:;return a.GetImageSource(c,b)})};b.GetItems=a.GetItems;b.GetUpdateTrackingMode=a.GetUpdateTrackingMode;b.GetUpdateSerializeMode=a.GetUpdateSerializeMode;b.DataToLocalized=a.DataToLocalized&&function(c){ULSEWi:;return b.LocStrArrayToLocStr(e(c,function(b){ULSEWi:;return a.DataToLocalized(b)}))};b.LocalizedToData=a.LocalizedToData&&function(c){ULSEWi:;return e(b.LocStrToLocStrArray(c),function(b){ULSEWi:;return a.LocalizedToData(b)})};b.GetDisplayValue=a.GetDisplayValue&&function(h,d,g){ULSEWi:;var f=[];if(d!=null&&d!=SP.JsGrid.EmptyValue&&d!=SP.JsGrid.InvalidValue)for(var i=b.LocStrToLocStrArray(g),e=0;e<d.length;e++)f.push(a.GetDisplayValue(h,d[e],e>=i.length?null:i[e]));else f.push(a.GetDisplayValue(h,d,g));return SP.Internal.JS.JoinStrings(f,c+" ")}}this.ID=d+"_MultiValue";this.bMultiValue=true;this.separator=c;this.singleValuePropType=a;var b=this;!g&&f();this.GetSerializableMultiValuePropType=function(){ULSEWi:;return {singleValuePropTypeID:d,separatorChar:c,bDelayInit:g}};this.InitSingleValuePropType=function(){ULSEWi:;f()};this.BeginValidateNormalizeConvert=function(m,n,d,e,g,o){ULSEWi:;if(e&&d==""||!e&&(d==null||d.length==0)){g({isValid:true,dataValue:[],normalizedLocValue:""});return}if(e)d=this.LocStrToLocStrArray(d);var c,f=0;i();return;function i(){ULSEWi:;a.BeginValidateNormalizeConvert(m,n,d[f],e,l,o)}function l(a){ULSEWi:;k(a);f++;if(f<d.length)i();else g(j())}function k(a){ULSEWi:;if(f==0)c={isValid:a.isValid,dataValue:[a.dataValue],normalizedLocValue:[a.normalizedLocValue]};else{c.isValid=c.isValid&&a.isValid;c.dataValue.push(a.dataValue);c.normalizedLocValue.push(a.normalizedLocValue)}}function j(){ULSEWi:;if(c!=null)if(c.isValid){if(!h)for(var g=a.IsDataEqual,d=c.dataValue,f=0;f<d.length;f++)for(var e=0;e<d.length;e++){if(f==e)continue;(g==null?d[f]==d[e]:g(d[f],d[e]))&&d.splice(e,1)}c.normalizedLocValue=b.LocStrArrayToLocStr(c.normalizedLocValue);return c}else return {isValid:false};return {isValid:true,dataValue:null,normalizedLocValue:null}}};this.LocStrToLocStrArray=function(a){ULSEWi:;if(a&&a.constructor!=String)return [];return SP.Internal.JS.TokenizeString(a,c)};this.LocStrArrayToLocStr=function(a){ULSEWi:;return SP.Internal.JS.JoinStrings(a,c+" ")};function e(a,d){ULSEWi:;if(a==null)return null;for(var c=[],b=0;b<a.length;b++)c.push(d(a[b]));return c}};SP.JsGrid.PropertyType.Hyperlink=function(){ULSEWi:;this.ID="Hyperlink";this.bHyperlink=true;var b='"',a='", "',c=encodeURIComponent(a);this.BeginValidateNormalizeConvert=function(f,g,a,c,e){ULSEWi:;var b=c?d(a):a;e({isValid:b!=null,dataValue:b,normalizedLocValue:this.DataToLocalized(a)})};this.DataToLocalized=function(a){ULSEWi:;return a?a.display:""};this.GetAddress=function(a){ULSEWi:;return a?a.address:""};this.GetCopyValue=function(c,a){ULSEWi:;return e(a)};function e(d){ULSEWi:;var e=d.address.replace(a,c);return d?String.format("{0}{1}{2}{3}{0}",b,e,a,d.display):null}function d(d){ULSEWi:;if(d==null)return null;if(d.length==0)d="";var e=d.indexOf(a);if(e<0||!d.startsWith(b)||!d.endsWith(b))return {address:d,display:d};return {address:d.substring(1,e).replace(c,a),display:d.substring(e+a.length,d.length-1)}}};SP.JsGrid.PropertyType.RegisterNewLookupPropType=function(d,c,a,b){ULSEWi:;var e=new SP.JsGrid.PropertyType.LookupTable(c,d,b);SP.JsGrid.Internal.Property.RegisterPropType(e,a,SP.JsGrid.EditControl.Type.ComboBox,[])};SP.JsGrid.PropertyType.RegisterNewCustomPropType=function(d,b,c,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterPropType(d,b,c,a)};SP.JsGrid.PropertyType.RegisterNewDerivedCustomPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterDerivedPropType(b,a)};Type.registerNamespace("SP.JsGrid.PropertyType.Utils");SP.JsGrid.PropertyType.Utils.RegisterDisplayControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterDisplayControl(c,b,a)};SP.JsGrid.PropertyType.Utils.RegisterEditControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterEditControl(c,b,a)};SP.JsGrid.PropertyType.Utils.RegisterWidgetControl=function(c,b,a){ULSEWi:;SP.JsGrid.Internal.Property.RegisterWidgetControl(c,b,a)};SP.JsGrid.PropertyType.Utils.UpdateDisplayControlForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateDisplayControlForPropType(b,a)};SP.JsGrid.PropertyType.Utils.UpdateEditControlForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateEditControlForPropType(b,a)};SP.JsGrid.PropertyType.Utils.UpdateWidgetControlsForPropType=function(b,a){ULSEWi:;SP.JsGrid.Internal.Property.UpdateWidgetControlsForPropType(b,a)};SP.JsGrid.PropertyType.Utils.GetPropType=function(a){ULSEWi:;return SP.JsGrid.Internal.Property.GetPropType(a)};SP.JsGrid.Internal.Property=function(){ULSEWi:;var e=this,d=[[new SP.JsGrid.PropertyType.String,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[]],[new SP.JsGrid.PropertyType.CheckBoxBoolean,SP.JsGrid.DisplayControl.Type.Checkbox,SP.JsGrid.EditControl.Type.Checkbox,[]],[new SP.JsGrid.PropertyType.Hyperlink,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[SP.JsGrid.WidgetControl.Type.Hyperlink]]],b=SP.Internal.JS.ConvertTableToMap(d,"0","1"),i=[[SP.JsGrid.DisplayControl.Type.Image,SP.JsGrid.DisplayControl.ImageDisplayControl,["GetImageSource"]],[SP.JsGrid.DisplayControl.Type.ImageText,SP.JsGrid.DisplayControl.ImageTextDisplayControl,["GetImageSource"]],[SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.DisplayControl.TextDisplayControl,[]],[SP.JsGrid.DisplayControl.Type.Checkbox,SP.JsGrid.DisplayControl.CheckboxDisplayControl,["GetBool"]]],f=SP.Internal.JS.ConvertTableToMap(i,"0","1"),o=SP.Internal.JS.ConvertTableToMap(i,"0","2"),l=[[SP.JsGrid.EditControl.Type.EditBox,function(a,b){ULSEWi:;return new SP.JsGrid.EditControl.EditBoxEditControl(a,b)},[]],[SP.JsGrid.EditControl.Type.ComboBox,function(a){ULSEWi:;return new SP.JsGrid.EditControl.ComboBoxEditControl(a)},["GetItems"]],[SP.JsGrid.EditControl.Type.Checkbox,function(a){ULSEWi:;return new SP.JsGrid.EditControl.CheckboxEditControl(a)},["GetBool"]]],j=SP.Internal.JS.ConvertTableToMap(l,"0","1"),r=SP.Internal.JS.ConvertTableToMap(l,"0","2"),k=[[SP.JsGrid.WidgetControl.Type.Date,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.DateWidget(a)},[]],[SP.JsGrid.WidgetControl.Type.AddressBook,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.AddressBookWidget(a)},["GetPeoplePickerUrl"]],[SP.JsGrid.WidgetControl.Type.Hyperlink,function(a){ULSEWi:;return new SP.JsGrid.WidgetControl.HyperlinkWidget(a)},["GetAddress"]],[SP.JsGrid.ErrorWidgetId,function(a,b){ULSEWi:;return new SP.JsGrid.WidgetControl.ErrorWidget(a,b)},[]]],h=SP.Internal.JS.ConvertTableToMap(k,"0","1"),p=SP.Internal.JS.ConvertTableToMap(k,"0","2"),a={},c={};this.GetDefaultDisplayControlMap=function(){ULSEWi:;var c={};for(var b in a)c[b]=a[b].display.Id;return c};this.RegisterDefaultPropTypesFromDefaultDisplayControlMap=function(d,b){ULSEWi:;if(b==null)b={};for(var c in d)a[c]==undefined&&m(c,this.GetDisplayControl(d[c]),b)};this.GetLookupPropTypeMap=function(){ULSEWi:;var c={};for(var a in b)if(b[a].GetSerializableLookupPropType!=null)c[a]=b[a].GetSerializableLookupPropType();else if(b[a].bMultiValue&&b[a].singleValuePropType.GetSerializableLookupPropType!=null)c[a]=b[a].GetSerializableMultiValuePropType();return c};this.RegisterDisplayControl=function(a,d,b){ULSEWi:;f[a]=d;o[a]=b;c={}};this.RegisterEditControl=function(a,d,b){ULSEWi:;j[a]=d;r[a]=b;c={}};this.RegisterWidgetControl=function(a,d,b){ULSEWi:;h[a]=d;p[a]=b;c={}};this.GetPropType=function(a){ULSEWi:;return b[a]};this.PropTypeExists=function(a){ULSEWi:;return a in b};this.GetDisplayControl=function(a){ULSEWi:;return f[a]};this.GetEditControl=function(c,a){ULSEWi:;var b=j[c];return b.apply(null,a)};this.GetWidgetControl=function(c,a){ULSEWi:;var b=h[c];return b.apply(null,a)};this.GetUpdateTrackingMode=function(b,a){ULSEWi:;if(b.GetUpdateTrackingMode!=null)return b.GetUpdateTrackingMode();return a.hasDataValue?a.hasLocalizedValue?SP.JsGrid.UpdateTrackingMode.PropBoth:SP.JsGrid.UpdateTrackingMode.PropData:SP.JsGrid.UpdateTrackingMode.PropLocalized};this.GetUpdateSerializeMode=function(a,c){ULSEWi:;if(a&&a.GetUpdateSerializeMode!=null)return a.GetUpdateSerializeMode();var b=a!=null&&c!=null?this.GetUpdateTrackingMode(a,c):SP.JsGrid.UpdateSerializeMode.PropBoth;if(b==SP.JsGrid.UpdateSerializeMode.PropBoth)b=SP.JsGrid.UpdateSerializeMode.PropLocalizedOnly;return b};function m(e,g,f){ULSEWi:;if(e in f){var d=f[e];if(d.singleValuePropTypeID!=null)b[e]=new SP.JsGrid.PropertyType.MultiValuePropType(d.singleValuePropTypeID,d.separatorChar,d.bDelayInit);else b[e]=new SP.JsGrid.PropertyType.LookupTable(d.items,d.id,d.bLimitToList)}delete c[e];a[e]={display:g,editControlName:"",widgetControlNames:[]}}this.RegisterPropType=function(d,b,c,a){ULSEWi:;a=a==null?[]:a;g(d,this.GetDisplayControl(b),c,a)};this.RegisterDerivedPropType=function(d,c){ULSEWi:;var b=a[c];g(d,b.display,b.editControlName,b.widgetControlNames)};function g(d,g,f,e){ULSEWi:;b[d.ID]=d;delete c[d.ID];var h=a[d.ID]={display:g,editControlName:f,widgetControlNames:e}}this.UpdateDisplayControlForPropType=function(c,b){ULSEWi:;a[c].display=this.GetDisplayControl(b)};this.UpdateEditControlForPropType=function(c,b){ULSEWi:;a[c].editControlName=b};this.UpdateWidgetControlsForPropType=function(c,b){ULSEWi:;a[c].widgetControlNames=b};this.GetDisplayControlForProperty=function(c,b){ULSEWi:;if(b!=null)return this.GetDisplayControl(b);return a[c.ID].display};this.GetEditAndWidgetControlNamesForProperty=function(g,b,e,f){ULSEWi:;var d,c,i;if(b.fnGetEditControlName!=null&&(i=b.fnGetEditControlName(g,e))!=null)d=i;else d=a[f.ID].editControlName;var h;if(b.fnGetWidgetControlNames!=null&&(h=b.fnGetWidgetControlNames(g,e))!=null)c=h;else c=[].concat(a[f.ID].widgetControlNames);return {editControlName:d,widgetControlNames:c}};function t(){ULSEWi:;for(var b in d){var a=d[b];e.RegisterPropType(a[0],a[1],a[2],a[3])}n();q()}function s(b,a){ULSEWi:;this.ID=b;this.BeginValidateNormalizeConvert=function(g,h,c,e,f){ULSEWi:;var d={},b=e?Date.parseLocale(c)||Date.parseInvariant(c)||Date.parse(c):c.getTime!=null?c:new Date(+c);b=b!=null?new Date(b):null;d.isValid=b!=null&&!isNaN(b.getTime());d.dataValue=d.isValid?b:null;d.normalizedLocValue=d.isValid?b.localeFormat(a):null;f(d)}}function q(){ULSEWi:;e.RegisterPropType(new s("JSDateTime",Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortDatePattern),SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[SP.JsGrid.WidgetControl.Type.Date])}function n(){ULSEWi:;var c={BeginValidateNormalizeConvert:function(i,j,a,e,g){ULSEWi:;var c=this;function f(a){ULSEWi:;a=c.PreParse!=null?c.PreParse(a):a;var b=Number.parseLocale(a);return c.PostParse!=null?c.PostParse(b):b}function h(){ULSEWi:;return a.format!=null?a:Number.parseInvariant(a+"")}var b=e?f(a):h(a),d=b.localeFormat(this.FormatString);g({isValid:!isNaN(b),dataValue:this.ProcessData!=null?ProcessData(b):b,normalizedLocValue:this.ProcessLocalized!=null?this.ProcessLocalized(b,d):d})},CompareTo:function(a,b){ULSEWi:;return a-b}},b=[{ID:"JSNumber",FormatString:"D"}];for(var d in b){var a=SP.Internal.JS.object(b[d]);a.BeginValidateNormalizeConvert=c.BeginValidateNormalizeConvert;a.CompareTo=c.CompareTo;e.RegisterPropType(a,SP.JsGrid.DisplayControl.Type.Text,SP.JsGrid.EditControl.Type.EditBox,[])}}t()};SP.JsGrid.RecordFactory=function(a,d,b){ULSEWi:;this.gridFieldMap=a;this.MakeRecord=function(e,h,k){ULSEWi:;var g=new c;g.recordKey=e[d];for(var f in a){var i=a[f],j=SP.JsGrid.Property.MakePropertyFromGridField(i,e[f],h[f],b!=null&&!i.GetIsMultiValue()?b(g.recordKey,i.key,e):null);if(j!=null){g.properties[f]=j;if(!k){delete e[f];delete h[f]}}}g.fieldRawDataMap=e!=null?e:{};g.fieldRawLocMap=h!=null?h:{};return g};var c=function(){ULSEWi:;this.properties={}};c.prototype={key:function(){ULSEWi:;return this.recordKey},GetDataValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].GetData():this.fieldRawDataMap[a]},GetLocalizedValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].GetLocalized():this.fieldRawLocMap[a]},HasDataValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].HasDataValue():a in this.fieldRawDataMap},HasLocalizedValue:function(a){ULSEWi:;return a in this.properties?this.properties[a].HasLocalizedValue():a in this.fieldRawLocMap},GetProp:function(a){ULSEWi:;return this.properties[a]},SetProp:function(a,b){ULSEWi:;this.properties[a]=b},AddFieldValue:function(b,a){ULSEWi:;if(a.isProp)this.properties[b]=a.prop;else if(b in this.properties)this.properties[b].Update(a.hasData?a.data:SP.JsGrid.EmptyValue,a.hasLocalized?a.localized:SP.JsGrid.EmptyValue);else{if(a.hasLocalized)this.fieldRawLocMap[b]=a.localized;if(a.hasData)this.fieldRawDataMap[b]=a.data}},RemoveFieldValue:function(a){ULSEWi:;delete this.properties[a];delete this.fieldRawLocMap[a];delete this.fieldRawDataMap[a]}}};SP.JsGrid.Property=function(){ULSEWi:;PropertyBase=function(b,a,c){ULSEWi:;if(c!=null)this.propType=c;if(b!=null)this.dataValue=b;if(a!=null)this.localizedValue=a};LocalizedProperty=function(b,a){ULSEWi:;this.localizedValue=b;if(a!=null)this.propType=a};DataProperty=function(b,a){ULSEWi:;this.dataValue=b;if(a!=null)this.propType=a};PropertyBase.prototype={HasLocalizedValue:function(){ULSEWi:;return true},HasDataValue:function(){ULSEWi:;return true},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,true,true,this.propType)},Update:function(a,b){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.dataValue=a!=SP.JsGrid.InvalidValue?SP.Internal.JS.CloneObj(a):a;if(b!=SP.JsGrid.EmptyValue)this.localizedValue=b},GetLocalized:function(){ULSEWi:;return this.localizedValue},GetData:function(){ULSEWi:;return this.dataValue}};DataProperty.prototype={HasLocalizedValue:function(){ULSEWi:;return this.propType.DataToLocalized!=null},HasDataValue:function(){ULSEWi:;return true},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,true,false,this.propType)},Update:function(a){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.dataValue=a!=SP.JsGrid.InvalidValue?SP.Internal.JS.CloneObj(a):a},GetLocalized:function(){ULSEWi:;return this.dataValue!=SP.JsGrid.InvalidValue?this.propType.DataToLocalized(this.dataValue):""},GetData:function(){ULSEWi:;return this.dataValue}};LocalizedProperty.prototype={HasLocalizedValue:function(){ULSEWi:;return true},HasDataValue:function(){ULSEWi:;return this.propType.LocalizedToData!=null},Clone:function(){ULSEWi:;return SP.JsGrid.Property.MakeProperty(SP.Internal.JS.CloneObj(this.dataValue),this.localizedValue,false,true,this.propType)},Update:function(b,a){ULSEWi:;if(a!=SP.JsGrid.EmptyValue)this.localizedValue=a},GetLocalized:function(){ULSEWi:;return this.localizedValue},GetData:function(){ULSEWi:;return this.localizedValue!=SP.JsGrid.InvalidValue?this.propType.LocalizedToData(this.localizedValue):null}};return {MakeProperty:function(d,b,c,e,a){ULSEWi:;if(c&&e)return new PropertyBase(d,b,a);if(c)return new DataProperty(d,a);return new LocalizedProperty(b,a)},MakePropertyFromGridField:function(a,f,e,b){ULSEWi:;var d=null,c=b!=null?b:a.GetPropType();if(c!=null)d=SP.JsGrid.Property.MakeProperty(f,e,a.hasDataValue,a.hasLocalizedValue,c);return d}}}();SP.JsGrid.Internal.PropertyUpdate=function(b,a){ULSEWi:;this.data=b;this.localized=a};SP.JsGrid.Internal.PropertyUpdate.prototype={HasDataValue:function(){ULSEWi:;return this.data!=SP.JsGrid.EmptyValue},HasLocalizedValue:function(){ULSEWi:;return this.localized!=SP.JsGrid.EmptyValue}};SP.JsGrid.CreateUnvalidatedPropertyUpdate=function(b,c,d,a){ULSEWi:;return new SP.JsGrid.UnvalidatedPropertyUpdate(b,c,d,a)};SP.JsGrid.CreateValidatedPropertyUpdate=function(c,d,b,a){ULSEWi:;return new SP.JsGrid.ValidatedPropertyUpdate(c,d,b,a)};SP.JsGrid.UnvalidatedPropertyUpdate=function(b,c,d,a){ULSEWi:;this.recordKey=b;this.fieldKey=c;this.newValue=d;this.newValueIsLocalized=a};SP.JsGrid.UnvalidatedPropertyUpdate.prototype={validated:false};SP.JsGrid.ValidatedPropertyUpdate=function(c,d,b,a){ULSEWi:;this.recordKey=c;this.fieldKey=d;this.newDataValue=b;this.newLocalizedValue=a};SP.JsGrid.ValidatedPropertyUpdate.prototype={validated:true};SP.JsGrid.Internal.PropertyUpdateManager=function(a){ULSEWi:;this.ApplyPropUpdates=function(c,d){ULSEWi:;for(var a=0;a<c.length;a++)b(c[a],d)};function b(b,d){ULSEWi:;if(b.validated)c(new SP.JsGrid.Internal.PropertyUpdate(b.newDataValue,b.newLocalizedValue),SP.JsGrid.ValidationState.Valid);else{var h=a.controller.GetPropType(b.recordKey,b.fieldKey);if(b.newValueIsLocalized)b.newValue=b.newValue==null?"":b.newValue.replace(/^\s+|\s+$/g,"");var g=true,f=false;h.BeginValidateNormalizeConvert(b.recordKey,b.fieldKey,b.newValue,b.newValueIsLocalized,e,i);if(g){a.pendingChangeMgr.IncrementPendingChangeCount(d);f=true;c(b.newValueIsLocalized?new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.InvalidValue,b.newValue):new SP.JsGrid.Internal.PropertyUpdate(b.newValue,SP.JsGrid.InvalidValue),SP.JsGrid.ValidationState.Pending)}}function e(e){ULSEWi:;g=false;if(e.isValid)c(new SP.JsGrid.Internal.PropertyUpdate(e.dataValue,e.normalizedLocValue),SP.JsGrid.ValidationState.Valid);else c(b.newValueIsLocalized?new SP.JsGrid.Internal.PropertyUpdate(SP.JsGrid.InvalidValue,b.newValue):new SP.JsGrid.Internal.PropertyUpdate(b.newValue,SP.JsGrid.InvalidValue),SP.JsGrid.ValidationState.Invalid,e.errorMsg);f&&a.pendingChangeMgr.DecrementPendingChangeCount(d)}function i(){ULSEWi:;var a={isValid:false,errorMsg:SP.JsGrid.Res.vncfailed};e(a)}function c(c,e,f){ULSEWi:;if(b.fieldKey!=SP.JsGrid.RecordIndicatorCheckboxColumnKey)a.versionMgr.AddPropChange(b.recordKey,b.fieldKey,d,c,e,f);else if(c.data)a.checkSelMgr.ExternalAPI.CheckRecord(b.recordKey);else a.checkSelMgr.ExternalAPI.UncheckRecord(b.recordKey)}}};SP.JsGrid.Internal.PendingChangesManager=function(b){ULSEWi:;var i=0,g=0,d={},e=[],c=[],a={},f={};b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnChangeKeyCreated,o);b.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnChangeKeyInitialUpdateFinished,m);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordPropertyChanged,l);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordCommitted,n);b.eventMgr.AttachEvent(SP.JsGrid.EventType.OnVacateChange,p);function p(c){ULSEWi:;var b=c.changeKey.GetVersionNumber();delete d[b];delete a[b]}function l(a){ULSEWi:;var b=a.recordKey;if(!(b in f))f[b]=[];f[b].push(a.changeKey);j(a.changeKey)}function n(d){ULSEWi:;var c=d.originalRecordKey;if(c in f)for(var b=f[c],a=0;a<b.length;a++)h(b[a])}function o(b){ULSEWi:;var c=b.changeKey.GetVersionNumber();d[c]=b.changeKey;a[c]=1}function m(a){ULSEWi:;h(a.changeKey)}function h(f){ULSEWi:;var e=f.GetVersionNumber();if(--a[e]==0){delete a[e];i++;setTimeout(function(){ULSEWi:;i--;b.eventMgr.FireEvent(SP.JsGrid.EventType.OnInitialChangesForChangeKeyComplete,new SP.JsGrid.EventArgs.PendingChangeKeyInitiallyComplete(f));delete d[e];if(c.length!=0&&!k()){for(var a=0;a<c.length;a++)c[a]();c=[]}},0)}}function k(){ULSEWi:;var a=false;for(var c in d)if(b.controller.IsChangeKeyApplied(d[c])){a=true;break}return a}function j(c){ULSEWi:;var b=c.GetVersionNumber();if(b in a)a[b]++;else a[b]=1}this.WaitForPendingUpdates=function(a){ULSEWi:;if(a!=null)if(g!=0)e.push(a);else a()};this.WaitForAllChangeKeysToComplete=function(a){ULSEWi:;if(a!=null)if(i!=0||g!=0||k())c.push(a);else a()};this.IncrementPendingChangeCount=function(a){ULSEWi:;g++;j(a)};this.DecrementPendingChangeCount=function(b){ULSEWi:;g--;if(g==0&&e.length!=0){for(var a=0;a<e.length;a++)e[a]();e=[]}h(b)}};SP.JsGrid.Internal.RowHeaderStateManager=function(b){ULSEWi:;var a={};this.AddRowHeaderState=function(d,f){ULSEWi:;var e=null;if(!(d in a))a[d]=[];else e=a[d][0];var c=a[d],g=SP.Internal.JS.LowerBoundCompare(c,f.GetPriority(),function(b,a){ULSEWi:;return a>c[b].GetPriority()});c.splice(g,0,f);(e==null||c[0].GetId()!=e.GetId())&&b.FireEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,new SP.JsGrid.Internal.EventArgs.OnRowHeaderStateChanged(d,c[0]))};this.RemoveRowHeaderState=function(d,f){ULSEWi:;if(d in a){var e=a[d][0];c(a[d],f);if(a[d].length==0)delete a[d];(a[d]==null||e.GetId()!=a[d][0].GetId())&&b.FireEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,new SP.JsGrid.Internal.EventArgs.OnRowHeaderStateChanged(d,a[d]&&a[d][0]))}};this.ChangeKeys=function(b,c){ULSEWi:;if(b in a){a[c]=a[b];delete a[b]}};this.GetRowHeaderState=function(b){ULSEWi:;return b in a?a[b][0]:null};function c(b,c){ULSEWi:;for(var a=0;a<b.length;a++)if(b[a].GetId()==c){b.splice(a,1);break}}};SP.JsGrid.RowHeaderState=function(a,e,c,d,b){ULSEWi:;this.GetId=function(){ULSEWi:;return a};this.GetImg=function(){ULSEWi:;return e};this.GetPriority=function(){ULSEWi:;return c};this.GetOnClick=function(){ULSEWi:;return b};this.GetTooltip=function(){ULSEWi:;return d};this.toString=function(){ULSEWi:;return a}};SP.JsGrid.AutoRowHeaderStates=function(e,a){ULSEWi:;var d=[[SP.JsGrid.RowHeaderAutoStyleId.Dirty,function(d){ULSEWi:;a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellEditBegin,g);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellEditCompleted,e);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,f);var c,b,h=a.rowHeaderStates[SP.JsGrid.RowHeaderAutoStyleId.Dirty];function e(e){ULSEWi:;if(e.bCancelled)b--;b==0&&e.bCancelled&&e.recordKey==c&&a.jsGridObj.RemoveRowHeaderState(c,d)}function g(d){ULSEWi:;if(b==0){c=d.recordKey;a.jsGridObj.AddRowHeaderState(d.recordKey,h)}b++}function f(e){ULSEWi:;b>0&&a.jsGridObj.RemoveRowHeaderState(c,d);b=0;c=e.recordKey}}],[SP.JsGrid.RowHeaderAutoStyleId.Error,function(d){ULSEWi:;var b=document.createElement("span");b.id=d+"mainDiv";b.style.cssText="display:none; font-size:10; position:absolute; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important";document.body.appendChild(b);var f,c=null,e=null,g=d+"RowError",h=new SP.JsGrid.RowHeaderState(d,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error"),SP.JsGrid.RowHeaderStatePriorities.CellError,SP.JsGrid.Res.errorHeaderStateTooltip,function(d,b){ULSEWi:;if(e!=b)c=null;c=a.jsGridObj.ScrollToAndExpandNextErrorOnRecord(c,b);e=b}),j=new SP.JsGrid.RowHeaderState(g,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_cell-error"),SP.JsGrid.RowHeaderStatePriorities.RowError,SP.JsGrid.Res.rowErrorToolTip,function(c,d){ULSEWi:;if(b.curRecKey!=d){b.curRecKey=d;b.style.display="";SP.Internal.DomElement.SetText(b,a.jsGridObj.GetRowErrorMessage(d));var e=h(c.target);if(e!=null){var g=SP.Internal.DomElement.GetLocation(e);b.style.left=g.x+"px";b.style.top=g.y+e.offsetHeight+2+"px"}else{b.style.left=c.clientX+5+"px";b.style.top=c.clientY+5+"px"}}f!=null&&clearTimeout(f);f=setTimeout(function(){ULSEWi:;b.curRecKey=null;b.style.display="none"},2500);function h(a){ULSEWi:;while(a!=null&&a.tagName.toUpperCase()!="TD")a=a.parentNode;return a}});a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,i);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowErrorStateChanged,l);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnRowFocusChanged,k);a.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnGridDisposing,function(){ULSEWi:;b.curRecKey=null;b.innerHTML="";b=null});function i(b){ULSEWi:;if(b.bAddingError&&!b.bCellHadError)a.jsGridObj.AddRowHeaderState(b.recordKey,h);else!b.bCellCurrentlyHasError&&a.jsGridObj.RemoveRowHeaderState(b.recordKey,d)}function l(b){ULSEWi:;if(b.bAddingError&&!b.bRowHadError)a.jsGridObj.AddRowHeaderState(b.recordKey,j);else!b.bErrorCurrentlyInRow&&a.jsGridObj.RemoveRowHeaderState(b.recordKey,g)}function k(a){ULSEWi:;if(a.newRecordKey!=e)c=null}}],[SP.JsGrid.RowHeaderAutoStyleId.NewRow,function(c){ULSEWi:;var b=null,d=new SP.JsGrid.RowHeaderState(c,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_newrowheader"),SP.JsGrid.RowHeaderStatePriorities.NewRow,"",null);a.eventMgr.AttachEvent(SP.JsGrid.EventType.OnEntryRecordAdded,function(e){ULSEWi:;b!=null&&a.jsGridObj.RemoveRowHeaderState(b,c);a.jsGridObj.AddRowHeaderState(e.recordKey,d);b=e.recordKey})}]],c=SP.Internal.JS.ConvertTableToMap(d,0,1);for(var b in c)if(e.Contains(b))c[b]=new c[b](b);d=null};SP.JsGrid.RowHeaderStates=function(a){ULSEWi:;this[SP.JsGrid.RowHeaderStyleId.Transfer]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderStyleId.Transfer,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_transferheader"),SP.JsGrid.RowHeaderStatePriorities.Transfer,SP.JsGrid.Res.transferHeaderStateTooltip,null);this[SP.JsGrid.RowHeaderStyleId.Conflict]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderStyleId.Conflict,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_conflictheader"),SP.JsGrid.RowHeaderStatePriorities.Conflict,a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.ExpandConflictResolution)?SP.JsGrid.Res.conflictHeaderStateClickTooltip:SP.JsGrid.Res.conflictHeaderStateTooltip,a.delegateMgr.DelegatePresent(SP.JsGrid.DelegateType.ExpandConflictResolution)?function(b,c){ULSEWi:;a.delegateMgr.Apply(SP.JsGrid.DelegateType.ExpandConflictResolution,b,c)}:null);this[SP.JsGrid.RowHeaderAutoStyleId.Dirty]=new SP.JsGrid.RowHeaderState(SP.JsGrid.RowHeaderAutoStyleId.Dirty,new SP.JsGrid.Image("/_layouts/Images/jsgridcluster.png",true,"clip16x16","jsgridcluster_editheader"),SP.JsGrid.RowHeaderStatePriorities.Dirty,SP.JsGrid.Res.editingHeaderStateTooltip,null)};SP.JsGrid.Internal.ScrollBar=function(n,A,W,L,gb,v){ULSEWi:;var q,b=SP.Internal.ScrollBar.GetSystemScrollBarThickness(),u=b-1,e,d=[],a=new S(n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical),cb=this,z,x,i=false,M=true,J=false,N,r,p,m,eb,y=0,l=0,k,g,j,f,t,c=0,s=W;function db(){ULSEWi:;L!=null&&cb.Update(L)}function Z(c){ULSEWi:;var d=false;if(g!=null&&j!=null&&f!=null&&t!=null){var a=s?b:0;q=Math.max(t-a,SP.Internal.ScrollBar.GetMinScrollBarLength()+a);if(e==null){c=true;ab();A.appendChild(e);A.style.position="relative"}if(c){d=true;U();R();X()}}return d}function U(){ULSEWi:;a.SetLength("outerContainer",q+(s?b:0));a.SetLength("innerContainer",q-4)}function F(a){ULSEWi:;return Math.max(0,Math.min(a,m!=null?m:0))}function P(b){ULSEWi:;var a=Math.max(Math.min(b,g-1),0);return a-o(null,a).count}function O(a,f,b,e){ULSEWi:;var d=c;if(c!=a||b){c=a;w(c);z!=null&&(d!=c||b)&&!e&&z(f,d);return true}return false}function Y(a,d,c){ULSEWi:;M=false;var b=P(a);return O(b,new SP.JsGrid.Internal.ScrollBar.PosInfo(b,a,SP.JsGrid.Internal.ScrollBar.UserSetType.Bottom),d,c)}function h(c,d,b){ULSEWi:;M=true;var a=F(c);return O(a,new SP.JsGrid.Internal.ScrollBar.PosInfo(a,o(a),SP.JsGrid.Internal.ScrollBar.UserSetType.Top),d,b)}function I(b){ULSEWi:;if(b==-1){if(!i){k!=null&&k(false);a.UpdateDisplay("bgMiddleBox",false);a.UpdateDisplay("middleBoxDiv",false);y=0;l=0;h(0);i=true}}else if(b>4){if(i){k!=null&&k(true);i=false}y=b;a.UpdateDisplay("bgMiddleBox",true);a.UpdateDisplay("middleBoxDiv",true);a.UpdateMiddleScroll("middleBoxDiv",b);a.UpdateBGDiv("bgMiddleBox",b)}}function G(){ULSEWi:;return Math.max(0,E()-l-y)}function E(){ULSEWi:;return q-2*u-4}function R(){ULSEWi:;r=0;for(var a=0;a<d.length;a++)r+=Math.max(Math.min(f,d[a].size),0);r+=Math.max(g-d.length,0)*j}function o(c,i){ULSEWi:;var b=c!=null?c:i,k=c==null,h=0,e=d.length!=0?SP.Internal.JS.UpperBound(d,b,"pos")-1:-1,a;while(h<f&&b>=0&&b<g){if(a==null&&e!=-1&&e<d.length)a=d[e];h+=a!=null&&b==a.pos?a.size:j;if(a!=null&&b==a.pos){e+=k?-1:1;a=null}b+=k?-1:1}var l=h!=f;return {count:Math.max(Math.abs((c!=null?c:i)-b)-(l?1:0),0),partial:l}}function Q(){ULSEWi:;var a=o(null,g-1);J=a.partial;return Math.max(a.count,1)}function C(){ULSEWi:;return Math.ceil(f/j)}function D(){ULSEWi:;return Math.floor(f/j)}function X(){ULSEWi:;if(f<r){var a=E();p=a-Math.max(Math.ceil(f/r*a),SP.Internal.ScrollBar.GetMinBoxLength());I(a-p);B()}else{I(-1);B(0)}}function H(a){ULSEWi:;if(v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal)a=m-a;return Math.floor(p/m*a)}function T(a){ULSEWi:;if(v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal)a=p-a;return p>0?F(Math.round(a/(p/m))):0}function w(b){ULSEWi:;l=m>0?H(b):0;a.UpdateBGDiv("bgAboveBox",l+1);a.SetTop("middleBoxDiv",l+u);a.UpdateBGDiv("bgBelowBox",G()+1)}function B(a){ULSEWi:;m=a==null?g-Q():a}function K(j,g,f,h){ULSEWi:;var b,i=0,c=h,k=this;function d(){ULSEWi:;b=setTimeout(e,250-200*Math.min(1,i++/4))}function e(){ULSEWi:;g();d();f&&c!=null&&k.MouseMove(c)}this.MouseMove=function(e){ULSEWi:;var f=SP.Internal.DomElement.GetEventLocation(e),g=SP.Internal.DomElement.PointInDomElem(f.x,f.y,a.GetDomElem(j));if(g&&b==null)d();else if(!g&&b!=null){window.clearTimeout(b);b=null}c=e};this.MouseUp=function(){ULSEWi:;window.clearTimeout(b)};e()}function bb(){ULSEWi:;var d=false;$addHandler(e,"mousedown",j);$addHandler(document.body,"mousemove",b);var k={scrollUpArrowDiv:null,middleBoxDiv:null,scrollDownArrowDiv:null,bgBelowBox:null,bgAboveBox:null},l;function g(b){ULSEWi:;if(!i){d=true;a.ActivateArrowDiv("scrollUpArrowDiv","upArrowDiv",true,b);a.ActivateArrowDiv("scrollDownArrowDiv","downArrowDiv",false,b);a.ActivateDiv("middleBoxDiv",b)}}function f(){ULSEWi:;if(d){d=false;a.DeactivateArrowDiv("scrollUpArrowDiv","upArrowDiv",true);a.DeactivateArrowDiv("scrollDownArrowDiv","downArrowDiv",false);a.DeactivateDiv("middleBoxDiv")}}function b(b){ULSEWi:;var a=SP.Internal.DomElement.GetEventLocation(b);if(!SP.Internal.DomElement.PointInDomElem(a.x,a.y,e))f();else{d=false;g(a)}}function j(f){ULSEWi:;if(i)return;var g;if(f.target!=null){var l=SP.Internal.DomElement.FindFirstAncestorWithAnyPropertyValue(f.target,"elemid",k);if(l!=null){var d=SP.Internal.DomElement.GetCustomAttribute(l.elem,"elemid");if(d=="middleBoxDiv"){var j=c;a.MarkMouseDown("middleBoxDiv");a.ActivateDiv("middleBoxDiv");var p=H(c);SP.Internal.DomElement.SetCapture(f.target,function(c){ULSEWi:;var b=n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical?"clientY":"clientX",a=T(p+c[b]-f[b]);if(j!=a){w(a);j=a;x&&h(a)}},function(c){ULSEWi:;h(j);a.RemoveMouseDown("middleBoxDiv");b(c)})}else if(d=="scrollUpArrowDiv"||d=="scrollDownArrowDiv"){a.MarkMouseDown(d);var m=d=="scrollUpArrowDiv";a.ActivateArrowDiv(d,m?"upArrowDiv":"downArrowDiv",m,true);var e=d=="scrollUpArrowDiv";e=v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal?!e:e;g=new K(d,function(){ULSEWi:;h(c+(e?-1:1))});SP.Internal.DomElement.SetCapture(f.target,g.MouseMove,function(c){ULSEWi:;g.MouseUp();a.RemoveMouseDown(d);b(c)})}else{var e=d=="bgAboveBox";e=v&&n==SP.JsGrid.Internal.ScrollBar.BarType.Horizontal?!e:e;a.HighlightBGDiv(d);g=new K(d,e?function(){ULSEWi:;Y(c-(o(c).count==0?1:0))}:function(){ULSEWi:;h(c+Math.max(o(c).count,1))},true,f);SP.Internal.DomElement.SetCapture(f.target,g.MouseMove,function(c){ULSEWi:;a.RestoreBGDiv(d);g.MouseUp();b(c)})}}}}return b}this.Dispose=function(){ULSEWi:;$clearHandlers(e);$removeHandler(document.body,"mousemove",N);a.Dispose();e=null;A=null};this.SetOnVisibilityChanged=function(a,b){ULSEWi:;k=a;k!=null&&b!=!i&&k(!i)};this.Update=function(a){ULSEWi:;var e=false,i=a.itemCount!=null&&a.itemCount!=g||a.itemSize!=null&&a.itemSize!=j||a.physicalViewportSize!=null&&a.physicalViewportSize!=f||a.scrollbarSize!=null&&a.scrollbarSize!=t||a.bClearItemSizes&&d.length!=0||a.bOtherScrollMeets!=null&&a.bOtherScrollMeets!=s||a.itemSizes!=null;g=a.itemCount==null?g:a.itemCount;j=a.itemSize==null?j:a.itemSize;s=a.bOtherScrollMeets==null?s:a.bOtherScrollMeets;if(a.bClearItemSizes)d=[];d=a.itemSizes==null?d:V(a.itemSizes,a.bMergeItemSizes);f=a.physicalViewportSize==null?f:a.physicalViewportSize;t=a.scrollbarSize==null?t:a.scrollbarSize;var b=Z(i);if(a.topItemIdx!=null||b)e=h(a.topItemIdx==null?c:a.topItemIdx,b,a.bScrollNotifiy==false);x=a.bUpdateWhileDragging==null?x:a.bUpdateWhileDragging;return e};this.GetItemDisplayCapacity=function(){ULSEWi:;return C()};this.GetWholeItemDisplayCapacity=function(){ULSEWi:;return D()};this.GetTopItemIdx=function(){ULSEWi:;return c};this.Refresh=function(){ULSEWi:;w(c)};this.ScrollIntoView=function(a){ULSEWi:;a=Math.max(0,Math.min(g-1,a));var b=this.GetItemDisplayInfo(a);if(b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Before){h(a);return true}else if(b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.After||b==SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Partial){h(a+1-D());return true}return false};this.PartialRowPresent=function(){ULSEWi:;return J};this.GetVisibleItemCount=function(){};this.SetOnScroll=function(a){ULSEWi:;z=a};this.SetViewportSize=function(){};this.GetItemDisplayInfo=function(a){ULSEWi:;var b=C();return a<c?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Before:a>c+b-1?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.After:a==c+b-1?SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.Partial:SP.JsGrid.Internal.ScrollBar.RowDisplayInfo.InView};function V(e,g){ULSEWi:;if(!g)d=[];for(var f in e){var b=parseInt(f,10),c=parseInt(e[f],10);if(!isNaN(b)&&!isNaN(c)){var a=SP.Internal.JS.LowerBound(d,b,"pos");if(a<0||a>=d.length||d[a].pos!=b)d.splice(a,0,{pos:b,size:c});else d[a].size=c}}return d}function ab(){ULSEWi:;var c=['<div elemid="innerContainer" class="inner-scroll-bar" style="'+a.GetLengthAndThicknessCssString(q-4,b-4)+';">'];c.push(a.GenerateBGDivHTML(u-1,"upArrowDiv",true));c.push(a.GenerateBGDivHTML(1+Math.max(l,0),"bgAboveBox"));c.push(a.GenerateBGDivHTML(Math.max(l,0),"bgMiddleBox",false));c.push(a.GenerateBGDivHTML(G()+1,"bgBelowBox"));c.push(a.GenerateBGDivHTML(u-1,"downArrowDiv",true));e=document.createElement("div");e.innerHTML=c.join("");e.elemid="outerContainer";e.className="outer-scroll-bar";var d=n==SP.JsGrid.Internal.ScrollBar.BarType.Vertical;e.style.cssText=(d?"float:right":"")+a.GetLengthAndThicknessCssString(q,b);a.RegisterPrimitives([e].concat(SP.Internal.DomElement.FindChildrenWithProperty(e,"elemid")));a.AppendItem("upArrowDiv",a.GenerateArrowDiv("scrollUpArrowDiv",-2,true));a.AppendItem("bgMiddleBox",a.GenerateMiddleScroll("middleBoxDiv"));a.AppendItem("downArrowDiv",a.GenerateArrowDiv("scrollDownArrowDiv",0,false));N=bb()}function S(c){ULSEWi:;var e={outerBorder:{mouseDown:"#737A83",mouseOver:"#8A8D91",mouseOut:"#B7BABE"},innerBorder:{mouseDown:"#C3C6CA",mouseOver:"#DADBDD",mouseOut:"#F0F1F4"},shade:{mouseDown:"#969BA2",mouseOver:"#CACCD0",mouseOut:"#E8EBEE"},main:{mouseDown:"#868C93",mouseOver:"#B3B6BB",mouseOut:"#DFE3E8"}},a={},m=c?"width":"height",d=c?"height":"width",o=c?"vert-":"horiz-",f=c?"top":"left",h=c?"left":"top",n=c?"clip9x6":"clip6x9",j="jsgridcluster_scrollbar-mouseout-"+(c?"uparrow":"leftarrow"),i="jsgridcluster_scrollbar-mouseout-"+(c?"downarrow":"rightarrow"),l="jsgridcluster_scrollbar-mousein-"+(c?"uparrow":"leftarrow"),k="jsgridcluster_scrollbar-mousein-"+(c?"downarrow":"rightarrow"),p=c?"scrollbar-highlight-vert.png":"scrollbar-highlight-horiz.png";this.Dispose=function(){ULSEWi:;a=null};this.GetThicknessCssString=function(a){ULSEWi:;return m+":"+a+"px;"};this.GetLengthCssString=function(a){ULSEWi:;return d+":"+a+"px;"};this.GetLengthAndThicknessCssString=function(b,a){ULSEWi:;return this.GetLengthCssString(b)+this.GetThicknessCssString(a)};this.GetCssName=function(a,b){ULSEWi:;return o+a+(b?" "+a:"")};this.RegisterPrimitives=function(c){ULSEWi:;for(var b=0;b<c.length;b++){var d=SP.Internal.DomElement.GetCustomAttribute(c[b],"elemid");if(d!=null)a[d]=c[b]}};this.GetLocation=function(b){ULSEWi:;return SP.Internal.DomElement.GetLocation(a[b])};this.GetHeight=function(b){ULSEWi:;return a[b].offsetHeight};this.GetWidth=function(b){ULSEWi:;return a[b].offsetWidth};this.GetDomElem=function(b){ULSEWi:;return a[b]};this.AppendItem=function(b,c){ULSEWi:;a[b].appendChild(c);this.RegisterPrimitives(SP.Internal.DomElement.FindChildrenWithProperty(a[b],"id"))};this.GenerateBGDivHTML=function(c,a,d){ULSEWi:;return ['<div class="'+this.GetCssName("scroll-bar-bg-block")+'" style="'+(d?"position:relative;":"")+this.GetLengthCssString(c)+'" '+g("elemid",a)+">",'<div class="'+this.GetCssName("scroll-bar-background-shade",true)+'" style="'+this.GetLengthAndThicknessCssString(c,Math.ceil((b-4)/2))+'" '+g("elemid",a,"_shade")+"></div>",'<div class="'+this.GetCssName("scroll-bar-background-main",true)+'" style="'+this.GetLengthAndThicknessCssString(c,Math.floor((b-4)/2))+'" '+g("elemid",a,"_main")+"></div></div>"].join("")};function g(c,b,a){ULSEWi:;return b==null?"":c+'="'+b+(a==null?"":a)+'"'}this.GenerateMiddleScroll=function(a){ULSEWi:;var c=document.createElement("div");c.innerHTML=['<div style="position:relative;',this.GetThicknessCssString(b-6),';margin-top:1px;margin-left:1px;">','<div elemid="',a,'_shade" class="',this.GetCssName("scroll-bar-inner-box-shade",true),'" style="',this.GetThicknessCssString(Math.floor((b-6)/2)),';"></div>','<div elemid="',a,'_main" class="',this.GetCssName("scroll-bar-inner-box-main",true),'" style="',this.GetThicknessCssString(Math.ceil((b-6)/2)),';"></div>','<div elemid="',a,'_gripTop" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px"></div>','<div elemid="',a,'_gripMiddle" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px;"></div>','<div elemid="',a,'_gripBottom" class="',this.GetCssName("scroll-bar-grip",true),'" style="',h,":",Math.round((b-6-5)/2),'px"></div></div>'].join("");c.elemid=a;c.className=this.GetCssName("scroll-bar-outer-box",true);c.style.cssText=this.GetThicknessCssString(b-4);return c};this.GenerateArrowDiv=function(f,h,g){ULSEWi:;var a=document.createElement("div"),e=(b-4-(c?6:9))/2,d=(b-4-(c?9:6))/2;a.innerHTML=['<div elemid="'+f+'_inner" class="scroll-bar-inner-arrow-cell" style="'+this.GetLengthAndThicknessCssString(b-4,b-4)+'">','<div class="'+n+'" style="margin-top:'+(!c?Math.round(e):g?Math.floor(e):Math.ceil(e))+"px;margin-left:"+(c?Math.round(d):g?Math.floor(d):Math.ceil(d))+'px;"><img elemid="'+f+'_img" src="/_layouts/Images/jsgridcluster.png" class="'+this.GetCssName("scroll-bar-arrow")+" "+(g?j:i)+'"/>',"</div>","</div>"].join("");a.elemid=f;a.className=this.GetCssName("scroll-bar-arrow-cell",true);a.style.cssText=(c?"top:":"left:")+h+"px;"+this.GetLengthAndThicknessCssString(b-2,b-2);return a};this.UpdateBGDiv=function(c,b){ULSEWi:;a[c].style[d]=b+"px";a[c+"_shade"].style[d]=b+"px";a[c+"_main"].style[d]=b+"px"};this.UpdateMiddleScroll=function(b,g){ULSEWi:;a[b].style[d]=g-2+"px";var c=g-4;a[b+"_main"].style[d]=c+"px";a[b+"_shade"].style[d]=c+"px";var e=Math.round(Math.max(c-8,0)/2);a[b+"_gripTop"].style[f]=e+"px";a[b+"_gripMiddle"].style[f]=e+3+"px";a[b+"_gripBottom"].style[f]=e+6+"px"};this.UpdateDisplay=function(b,c){ULSEWi:;a[b].style.display=c?"block":"none"};this.ActivateArrowDiv=function(b,c,e,d){ULSEWi:;a[b+"_img"].className=this.GetCssName("scroll-bar-arrow")+" "+(e?l:k);this.ActivateDiv(b,d,c)};this.DeactivateArrowDiv=function(b,c,d){ULSEWi:;a[b+"_img"].className=this.GetCssName("scroll-bar-arrow")+" "+(d?j:i);this.DeactivateDiv(b,c)};this.MarkMouseDown=function(b){ULSEWi:;a[b].curStateName="mouseDownPending"};this.RemoveMouseDown=function(b){ULSEWi:;a[b].curStateName=""};this.ActivateDiv=function(d,g,f){ULSEWi:;var c=a[d];if(c.curStateName=="mouseDown")return;var b=c.curStateName=="mouseDownPending"?"mouseDown":SP.Internal.DomElement.PointInDomElem(g.x,g.y,c)?"mouseOver":"mouseOut";if(c.curStateName!=b){c.style.borderColor=e["outerBorder"][b];if(d+"_inner" in a)a[d+"_inner"].style.borderColor=e["innerBorder"][b];else a[d].style.backgroundColor=e["innerBorder"][b];a[(f!=null?f:d)+"_shade"].style.backgroundColor=e["shade"][b];a[(f!=null?f:d)+"_main"].style.backgroundColor=e["main"][b];c.curStateName=b}};this.DeactivateDiv=function(b,c){ULSEWi:;a[b].curStateName="";a[b].style.borderColor="";if(b+"_inner" in a)a[b+"_inner"].style.borderColor="";else a[b].style.backgroundColor="";a[(c!=null?c:b)+"_shade"].style.backgroundColor="";a[(c!=null?c:b)+"_main"].style.backgroundColor=""};this.HighlightBGDiv=function(b){ULSEWi:;a[b+"_main"].style.backgroundColor="#DEDFE2";a[b+"_shade"].style.backgroundColor="#DEDFE2"};this.RestoreBGDiv=function(b){ULSEWi:;a[b+"_shade"].style.backgroundColor="";a[b+"_main"].style.backgroundColor=""};this.SetTop=function(b,c){ULSEWi:;a[b].style[f]=c+"px"};this.SetLength=function(b,c){ULSEWi:;a[b].style[d]=c+"px"}}db()};SP.JsGrid.Internal.ScrollBar.PosInfo=function(c,b,a){ULSEWi:;this.topIdx=c;this.bottomIdx=b;this.userSetType=a};SP.JsGrid.Internal.ScrollBar.UserSetType={Bottom:0,Top:1};SP.JsGrid.Internal.ScrollBar.UpdateParams=function(){ULSEWi:;this.itemCount;this.itemSize;this.itemSizes={};this.physicalViewportSize;this.scrollbarSize;this.topItemIdx;this.bClearItemSizes=false;this.bMergeItemSizes=false;this.bUpdateWhileDragging=false};SP.JsGrid.Internal.ScrollBar.BarType={Horizontal:0,Vertical:1};SP.JsGrid.Internal.ScrollBar.RowDisplayInfo={Before:-1,InView:0,Partial:1,After:2};Type.registerNamespace("SP.Internal.ScrollBar");SP.Internal.ScrollBar.GetSystemScrollBarThickness=function(){ULSEWi:;var a=document.createElement("div"),c=document.createElement("div");a.style.cssText="overflow-x:scroll;position:absolute;visibility:hidden";c.style.cssText="height:50px;width:50px";a.appendChild(c);document.body.appendChild(a);var b=Math.max(a.offsetHeight-50,13);document.body.removeChild(a);SP.Internal.ScrollBar.GetSystemScrollBarThickness=function(){ULSEWi:;return b};return b};SP.Internal.ScrollBar.GetMinBoxLength=function(){ULSEWi:;return 12};SP.Internal.ScrollBar.GetMinScrollBarLength=function(){ULSEWi:;return 2*SP.Internal.ScrollBar.GetSystemScrollBarThickness()+SP.Internal.ScrollBar.GetMinBoxLength()+8+2};SP.JsGrid.Internal.SelectionManager=function(s){ULSEWi:;var e,g,c,k,h,i,d,a,m,r,n=this,j,b=SP.JsGrid.SelectionType,f=SP.JsGrid.Internal.SelectionManager.SelectOp;this.SetAllowedSelectionTypes=function(a){ULSEWi:;k=a};this.GetLastSelectionEndpoints=function(){ULSEWi:;return {rowIdx1:h.rowIdx,colIdx1:h.colIdx,rowIdx2:i.rowIdx,colIdx2:i.colIdx}};this.GetLastSelectionRangeNormalized=function(){ULSEWi:;return d==b.None?null:{rowRange:new SP.Utilities.Range(d!=b.ColumnRange?Math.min(h.rowIdx,i.rowIdx):0,d!=b.ColumnRange?Math.max(h.rowIdx,i.rowIdx):a.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1),colRange:new SP.Utilities.Range(d!=b.RowRange?Math.min(h.colIdx,i.colIdx):0,d!=b.RowRange?Math.max(h.colIdx,i.colIdx):a.gridPane.GetGridPaneConverter().GetVirtualColumnCount()-1)}};this.GetFocus=function(){ULSEWi:;return q(null)};this.GetFocusForPane=function(a){ULSEWi:;return q(a)};this.GetFocusedPane=function(){ULSEWi:;return a.gridPane};this.SetFocusByKey=function(b,c,d){ULSEWi:;var a=b.GetGridPaneConverter().KeyToIdx(c,d);a!=null&&this.SetFocusByPos(b,a.rowIdx,a.colIdx)};this.SetFocusByPos=function(c,b,a){ULSEWi:;this.SelectRange(c,b,b,a,a,f.Set,true,false)};this.IsCellSelected=function(h,f,d){ULSEWi:;if(h!=a.gridPane)return false;for(var b=0;b<e.length;b++)if(e[b].Contains(f))return true;for(b=0;b<g.length;b++)if(g[b].Contains(d))return true;for(b=0;b<c.length;b++)if(c[b].rowRange.Contains(f)&&c[b].colRange.Contains(d))return true;return false};this.IsRowSelected=function(c,d){ULSEWi:;if(c!=a.gridPane)return false;for(var b=0;b<e.length;b++)if(e[b].Contains(d))return true;return false};this.IsOneCellSelected=function(a){ULSEWi:;return a!=null&&a.rowRange.begin==a.rowRange.end&&a.colRange.begin==a.colRange.end};this.GetComponentsWithin=function(j,h,f){ULSEWi:;if(j!=a.gridPane)return new SP.Utilities.Set;var i={};function d(b,a){ULSEWi:;if(!b.IsEmpty()&&!a.IsEmpty())for(var d=b.begin;d<=b.end;d++)for(var c=a.begin;c<=a.end;c++)i[SP.JsGrid.Internal.MakeCellKey(d,c)]=1}for(var b=0;b<e.length;b++)d(e[b].Intersect(h),f);for(b=0;b<g.length;b++)d(h,g[b].Intersect(f));for(b=0;b<c.length;b++)d(c[b].rowRange.Intersect(h),c[b].colRange.Intersect(f));return new SP.Utilities.Set(i)};this.SelectRange=function(u,q,t,m,s,r,w,B){ULSEWi:;function z(){ULSEWi:;var d=k&SP.JsGrid.SelectionTypeFlags._RowMask,c=k&SP.JsGrid.SelectionTypeFlags._ColMask,e=k&SP.JsGrid.SelectionTypeFlags._CellMask;do{var a=false;switch(l(q,t,m,s)){case b.RowRange:switch(d){case SP.JsGrid.SelectionTypeFlags.SingleRow:t=q;case SP.JsGrid.SelectionTypeFlags.SingleRowRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoRows:return false}break;case b.ColumnRange:switch(c){case SP.JsGrid.SelectionTypeFlags.SingleCol:s=m;case SP.JsGrid.SelectionTypeFlags.SingleColRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoCols:return false}break;case b.CellRange:switch(e){case SP.JsGrid.SelectionTypeFlags.SingleCell:t=q;s=m;case SP.JsGrid.SelectionTypeFlags.SingleCellRange:r=r==f.Append?f.Set:r;break;case SP.JsGrid.SelectionTypeFlags.NoCells:if(d!=SP.JsGrid.SelectionTypeFlags.NoRows){m=s=null;a=true}else if(c!=SP.JsGrid.SelectionTypeFlags.NoCols){q=t=null;a=true}else return false}}}while(a);return true}function C(){ULSEWi:;if(l(q,t,m,s)==b.CellRange)if(Math.abs(m-s)+1==u.GetGridPaneConverter().GetVirtualColumnCount())m=s=null;else if(Math.abs(q-t)+1==u.GetGridPaneConverter().GetVirtualRowCount())q=t=null}function E(c,d){ULSEWi:;if(u!=a.gridPane){r=f.Set;a.gridPane=u}if(B){var e=u.GetGridPaneConverter().KeyToIdx(c.recordKey,c.fieldKey);a.rowIdx=e.rowIdx;a.colIdx=e.colIdx}else if(v!=null){a.rowIdx=v.rowIdx;a.colIdx=v.colIdx}else{a.rowIdx=d==b.ColumnRange?u.BeginRowIdx():q;a.colIdx=d==b.RowRange?u.BeginColIdx():m}}function D(a){ULSEWi:;var k=a==b.ColumnRange?null:(new SP.Utilities.Range(q,t)).Normalize(),i=a==b.RowRange?null:(new SP.Utilities.Range(m,s)).Normalize();if(r==f.Set){e=[];g=[];c=[];j=[]}else if(r==f.ReplaceLast){if(d==b.RowRange)e.pop();else if(d==b.ColumnRange)g.pop();else d==b.CellRange&&c.pop();j.pop()}var h;if(a==b.RowRange){h=k;e.push(h)}else if(a==b.ColumnRange){h=i;g.push(h)}else if(a==b.CellRange){h={rowRange:k,colRange:i};c.push(h)}j.push({type:a,range:h});d=a}var v,A=q!=null&&q==t&&m!=null&&m==s&&w&&r==f.Set;if(A)v={rowIdx:q,colIdx:m};if(!z())return false;C();h={rowIdx:q,colIdx:m};i={rowIdx:t,colIdx:s};p(a.gridPane,u);var x=n.GetFocus(),y=l(q,t,m,s);E(x,y);D(y);o(x,w);return true};this.GetRowRanges=function(b){ULSEWi:;return b==a.gridPane?e:[]};this.GetColumnRanges=function(b){ULSEWi:;return b==a.gridPane?g:[]};this.GetCellRanges=function(b){ULSEWi:;return b==a.gridPane?c:[]};this.Clear=function(f){ULSEWi:;var k;if(!f){p(a.gridPane,null);k=n.GetFocus()}e=[];g=[];c=[];j=[];a={};h=i=null;d=b.None;!f&&o(k,false)};this.GetLastSelectionType=function(){ULSEWi:;return d};this.GetOrderedSelections=function(k,h){ULSEWi:;function g(a){ULSEWi:;for(var c=new Array(a.Size()),b=a.begin;b<=a.end;b++)c[b-a.begin]=i.RowIdxToRecordKey(b);return {begin:a.begin,end:a.end,keys:c}}function f(a){ULSEWi:;for(var c=new Array(a.Size()),b=a.begin;b<=a.end;b++)c[b-a.begin]=i.ColIdxToColKey(b);return {begin:a.begin,end:a.end,keys:c}}var e=[];if(k==a.gridPane)for(var i=k.GetGridPaneConverter(),d=0;d<j.length;d++){var l=j[d].type,c=j[d].range;if(h==null||h==l)switch(l){case b.RowRange:e.push(g(c));break;case b.ColumnRange:e.push(f(c));break;case b.CellRange:e.push({rowRange:g(c.rowRange),colRange:f(c.colRange)})}}return e};function p(b,a){ULSEWi:;m=b!=null?b.NotifySelectionUpdating():null;r=a!=null?a!=b?a.NotifySelectionUpdating():m:null}function o(a,c){ULSEWi:;var b=n.GetFocus();a!=null&&a.gridPane.NotifySelectionUpdated(m,c);b!=null&&(a==null||b.gridPane!=a.gridPane)&&b.gridPane.NotifySelectionUpdated(r,c);(a==null&&b!=null||a!=null&&b==null||a!=null&&b!=null&&(a.recordKey!=b.recordKey||a.fieldKey!=b.fieldKey))&&s(new SP.JsGrid.EventArgs.CellFocusChanged(b&&b.recordKey,b&&b.fieldKey,a&&a.recordKey,a&&a.fieldKey))}function l(d,e,a,c){ULSEWi:;return d==null||e==null?b.ColumnRange:a==null||c==null?b.RowRange:b.CellRange}function q(c){ULSEWi:;if(a.gridPane==null||c!=null&&a.gridPane!=c||a.colIdx>=a.gridPane.GetGridPaneConverter().GetVirtualColumnCount())return null;var b=a.gridPane.GetGridPaneConverter().IdxToKey(a.rowIdx,a.colIdx);if(b.recordKey==null||b.fieldKey==null||b.columnKey==null)return null;return {rowIdx:a.rowIdx,colIdx:a.colIdx,recordKey:b.recordKey,fieldKey:b.fieldKey,columnKey:b.columnKey,gridPane:a.gridPane}}this.Clear(true)};SP.JsGrid.Internal.SelectionManager.SelectOp={Set:0,Append:1,ReplaceLast:2};SP.Utilities.Set=function(a){ULSEWi:;this.collection=a!=null?a:{}};SP.Utilities.Set.prototype={IsEmpty:function(){ULSEWi:;for(var a in this.collection)return false;return true},First:function(){ULSEWi:;for(var a in this.collection)return a;return null},GetCollection:function(){ULSEWi:;return this.collection},ToArray:function(){ULSEWi:;return SP.Internal.JS.ConvertSetKeysToArray(this.collection)},AddArray:function(b){ULSEWi:;for(var a=0;a<b.length;a++)this.collection[b[a]]=1;return this},Add:function(a){ULSEWi:;this.collection[a]=1;return a},Remove:function(a){ULSEWi:;var b=this.collection[a];delete this.collection[a];return b},Clear:function(){ULSEWi:;this.collection={};return this},Contains:function(a){ULSEWi:;return a in this.collection},Clone:function(){ULSEWi:;var a={};for(var b in this.collection)a[b]=1;return new SP.Utilities.Set(a)},SymmetricDifference:function(c){ULSEWi:;var b={};for(var a in this.collection)if(!(a in c.collection))b[a]=1;for(a in c.collection)if(!(a in this.collection))b[a]=1;return new SP.Utilities.Set(b)},Difference:function(c){ULSEWi:;var b={};for(var a in this.collection)if(!(a in c.collection))b[a]=1;return new SP.Utilities.Set(b)},Union:function(b){ULSEWi:;var a=this.Clone();for(var c in b.collection)a.collection[c]=1;return a},UnionWith:function(a){ULSEWi:;for(var b in a.collection)this.collection[b]=1},Intersection:function(c){ULSEWi:;var b={};for(var a in this.collection)if(a in c.collection)b[a]=1;return new SP.Utilities.Set(b)}};SP.Utilities.KeyMap=function(){ULSEWi:;this.dictionary={};this.valueKeyMap={}};SP.Utilities.KeyMap.prototype={Add:function(b,a){ULSEWi:;this.dictionary[b]=a;this.valueKeyMap[a]=b},RemoveKey:function(a){ULSEWi:;delete this.valueKeyMap[this.dictionary[a]];delete this.dictionary[a]},RemoveValue:function(a){ULSEWi:;delete this.dictionary[this.valueKeyMap[a]];delete this.valueKeyMap[a]},GetValue:function(a){ULSEWi:;return this.dictionary[a]},GetKey:function(a){ULSEWi:;return this.valueKeyMap[a]},GetDictionary:function(){ULSEWi:;return this.dictionary},Clear:function(){ULSEWi:;this.dictionary={};this.valueKeyMap={}},ContainsKey:function(a){ULSEWi:;return a in this.dictionary},ContainsValue:function(a){ULSEWi:;return a in this.valueKeyMap}};SP.Utilities.Range=function(a,b){ULSEWi:;if(a==null||b==null)this.Clear();else{this.begin=a;this.end=b}};SP.Utilities.Range.prototype={Normalize:function(){ULSEWi:;var a=Math.min(this.begin,this.end),b=Math.max(this.begin,this.end);this.begin=a;this.end=b;return this},Contains:function(a){ULSEWi:;return a>=this.begin&&a<=this.end},IsEmpty:function(){ULSEWi:;return this.begin>this.end},Clear:function(){ULSEWi:;this.begin=0;this.end=-1},Size:function(){ULSEWi:;return Math.max(0,this.end-this.begin+1)},Overlaps:function(a){ULSEWi:;return this.end>=a.begin&&a.end>=this.begin},Intersect:function(a){ULSEWi:;return new SP.Utilities.Range(Math.max(this.begin,a.begin),Math.min(this.end,a.end))}};Type.registerNamespace("SP.JsGrid.SplitterBar");SP.JsGrid.SplitterBar=function(g,m,k,i,o){ULSEWi:;var d={None:0,Hover:1,Drag:2},a,b,c=g.styleMgr.splitterStyleCollection,q,e=d.None,h,p=["<div splitId='innerContainer' style='position:absolute;top:1px;left:1px;width:2px;border:1px solid;'></div>","<div splitId='outerHandle' style='position:absolute;left:0px;height:43px;width:4px;border:1px solid;'>","<div splitId='innerHandle' style='height:41px;width:2px;position:relative;border:1px solid;'>","<div splitId='bitTop' style='position:absolute;top:17px;left:0px;height:1px;width:2px;border-top:1px solid;'></div>","<div splitId='bitMiddle' style='position:absolute;top:20px;left:0px;height:1px;width:2px;border-top:1px solid;'></div>","<div splitId='bitBottom' style='position:absolute;top:23px;left:0px;height:1px;width:2px;border-top:1px solid;'></div></div></div>"].join("");function j(){ULSEWi:;var a;a=document.createElement("div");a.innerHTML=p;a.splitId="outerContainer";a.style.cssText="width:6px;float:"+g.RTL.left+";position:relative;cursor:col-resize;";a.childObjects=SP.Internal.DomElement.GetChildrenWithCustomAttribute(a,"splitId");return a}function l(a,b){ULSEWi:;a.outerContainer.style.height=b+"px";a.innerContainer.style.height=Math.max(b-4,0)+"px";a.outerHandle.style.top=Math.round((b-45)/2)+"px"}function f(a,c,b){ULSEWi:;a.outerContainer.style.backgroundColor=c.outerBorderColor;a.innerContainer.style.borderColor=c.innerBorderColor;a.innerContainer.style.borderLeftColor=c.leftInnerBorderColor;a.innerContainer.style.backgroundColor=c.backgroundColor;a.outerHandle.style.borderColor=b.outerBorderColor;a.innerHandle.style.borderColor=b.innerBorderColor;a.innerHandle.style.borderLeftColor=b.leftInnerBorderColor;a.innerHandle.style.backgroundColor=b.backgroundColor;a.bitTop.style.borderTopColor=b.gripUpperColor;a.bitTop.style.backgroundColor=b.gripLowerColor;a.bitMiddle.style.borderTopColor=b.gripUpperColor;a.bitMiddle.style.backgroundColor=b.gripLowerColor;a.bitBottom.style.borderTopColor=b.gripUpperColor;a.bitBottom.style.backgroundColor=b.gripLowerColor}function n(){ULSEWi:;var h;$addHandler(document.body,"mousemove",j);$addHandler(a,"mousedown",p);function l(a){ULSEWi:;return SP.Internal.DomElement.AdjustCoordsForIEZoom({x:a.screenX,y:a.screenY}).x}function j(g){ULSEWi:;if(e!=d.Drag){var b=SP.Internal.DomElement.GetEventLocation(g);if(SP.Internal.DomElement.PointInDomElem(b.x,b.y,a)){if(e==d.None){f(a.childObjects,c.hover,c.hoverHandle);e=d.Hover}}else if(e==d.Hover){f(a.childObjects,c.normal,c.normalHandle);e=d.None}}}function p(g){ULSEWi:;if(g.button==Sys.UI.MouseButton.leftButton){g.preventDefault();h=l(g);SP.Internal.DomElement.SetCapture(a,n,q);b.style.display="block";e=d.Drag;f(a.childObjects,c.drag,c.dragHandle);SP.Internal.DomElement.SetOpacity(a,.4);n(g)}}function n(e){ULSEWi:;var d=(l(e)-h)*(g.RTL.bEnabled?-1:1),c=k()+d;c=Math.max(c,m);c=Math.min(c,i()-SP.Internal.ScrollBar.GetSystemScrollBarThickness()-a.offsetWidth-m);b.style.left=(g.RTL.bEnabled?i()-a.offsetWidth-c:c+1)+"px"}function q(c){ULSEWi:;b.style.display="none";var f=(l(c)-h)*(g.RTL.bEnabled?-1:1),i=k()+f;o(i);h=null;e=d.None;SP.Internal.DomElement.RemoveOpacity(a);j(c)}return function(){ULSEWi:;$removeHandler(document.body,"mousemove",j);$removeHandler(a,"mousedown",p)}}this.Init=function(g,e,d){ULSEWi:;a=j();a.style.marginTop=d+"px";h=n();b=j();b.style.display="none";b.style.position="absolute";b.style.top=d+1+"px";b.style.zIndex=1;this.SetHeight(e);f(a.childObjects,c.normal,c.normalHandle);f(b.childObjects,c.drag,c.dragHandle);g.appendChild(b);return a};this.Hide=function(){ULSEWi:;a.style.display="none"};this.Show=function(){ULSEWi:;a.style.display="block"};this.IsInited=function(){ULSEWi:;return a!=null};this.Dispose=function(){ULSEWi:;h!=null&&h();if(a!=null)a=a.childObjects=null;if(b!=null)b=b.childObjects=null};this.SetHeight=function(c){ULSEWi:;l(a.childObjects,c);l(b.childObjects,c)}};SP.JsGrid.StaticDataSource=function(c,f){ULSEWi:;var a=this,b,d=false;this.tableCache;this.styleMgr;this.recordFactory;this.bHollowOutBlobs;this.LoadSerializedData=function(h){ULSEWi:;b=new SP.JsGrid.Deserializer(h,SP.JsGrid.DeserializationMode.Full);var g=b.view.length,c=g<750,e=!c&&g>300?300:null;d=e!=null;a.tableCache.Clear();a.tableCache.SetMaxRecordCount(e);a.tableCache.SetConvertAllBlobsToRecords(c);a.tableCache.SetKeepDataInBlobCache(!d);a.tableCache.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(b.data),b.data);a.recordFactory=new SP.JsGrid.RecordFactory(b.gridFieldMap,b.keyColumnName,f);b.InitCellStyles(a.styleMgr)};this.InitJsGridParams=function(c){ULSEWi:;var a=b.InitJsGridParams(c);a.tableCache=this.tableCache;a.styleManager=this.styleMgr;return a};this.InitJsGridTableViewParams=function(a){ULSEWi:;return b.InitJsGridTableViewParams(a)};this.InitJsGridRowViewParams=function(a){ULSEWi:;return b.InitJsGridRowViewParams(a)};this.GetAdditionalParams=function(){ULSEWi:;return b.additionalParams};this.AddColumn=function(a,c){ULSEWi:;this.recordFactory.gridFieldMap[a.key]=a;var d={};for(var b in c){var e=this.recordFactory.MakePropForRecord(a,c[b].data,c[b].localized);if(e!=null)d[b]={isProp:true,prop:e};else d[b]={hasLocalized:a.hasLocalizedValue,hasData:a.hasDataValue,data:c[b].data,localized:c[b].localized}}this.tableCache.AddColumn(a.key,d)};this.RemoveColumn=function(a){ULSEWi:;delete this.recordFactory.gridFieldMap[a];this.tableCache.RemoveColumn(a)};function e(h,b){ULSEWi:;var f=new Array(b.length),g=a.bHollowOutBlobs!=null?!a.bHollowOutBlobs:!d;for(var e in b){var c=h[b[e]];f[b[e]]=a.recordFactory.MakeRecord(c.data,c.localized,g)}return f}function g(){ULSEWi:;a.tableCache=new SP.JsGrid.TableCache(null,e);a.styleMgr=SP.JsGrid.Style.MakeJsGridStyleManager();if(c!=null){a.LoadSerializedData(c);c=null}}g()};SP.JsGrid.Style=function(){ULSEWi:;var i="#FFFFFF",e,d,c={Normal:0,PartSelected:1,AllSelected:2,NormalHover:3,PartSelectedHover:4,AllSelectedHover:5},a={Splitter:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{}},SplitterHandle:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{},gripUpperColor:{jsId:"color",defaultValue:"#A7AAAF"},gripLowerColor:{jsId:"borderRightColor",defaultValue:"#FEFEFE"}},GridPane:{verticalBorderColor:{jsId:"borderRightColor",defaultValue:"#DADCDD"},verticalBorderStyle:{jsId:"borderRightStyle",defaultValue:"solid"},horizontalBorderColor:{jsId:"borderBottomColor",defaultValue:"#DADCDD"},horizontalBorderStyle:{jsId:"borderBottomStyle",defaultValue:"solid"},backgroundColor:{jsId:"backgroundColor",defaultValue:"#F6F6F6"},linkColor:{classId:"link",jsId:"color",defaultValue:"#003399"},visitedLinkColor:{classId:"link",jsId:"backgroundColor",defaultValue:"#003399"},copyRectForeBorderColor:{classId:"selection",jsId:"borderLeftColor",defaultValue:"#333333"},copyRectBackBorderColor:{classId:"selection",jsId:"borderRightColor",defaultValue:"#FFFFFF"},focusRectBorderColor:{classId:"selection",jsId:"borderTopColor",defaultValue:"#333333"},selectionRectBorderColor:{classId:"selection",jsId:"borderBottomColor",defaultValue:"#333333"},selectedCellBgColor:{classId:"selection",jsId:"color",classId:"selection",defaultValue:SP.JsGrid.Internal.Color.MakeAlphaColor(.4,.8,.8,.8),fromCss:j},changeHighlightCellBgColor:{classId:"edit",jsId:"backgroundColor",defaultValue:SP.JsGrid.Internal.Color.MakeAlphaColor(.4,198/255,223/255,255/255),fromCss:j},fillRectBorderColor:{classId:"edit",jsId:"borderColor",defaultValue:"#FFDCA0"},errorRectBorderColor:{classId:"edit",jsId:"borderTopColor",defaultValue:"#FF0000"},columnDropIndicatorColor:{jsId:"borderLeftColor",defaultValue:"#DC9A06"}},Header:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#363636"},backgroundColor:{},outerBorderColor:{jsId:"borderBottomColor"},eyeBrowBorderColor:{jsId:"borderRightColor"},menuColor:{classId:"menuBaseControl",jsId:"borderLeftColor"},eyeBrowColor:{classId:"menuBaseControl",jsId:"borderTopColor"},resizeColor:{classId:"menuBaseControl",jsId:"borderRightColor"},menuBorderColor:{classId:"menuBorderControl",jsId:"borderLeftColor"},eyeBrowBorderColor:{classId:"menuBorderControl",jsId:"borderTopColor"},resizeBorderColor:{classId:"menuBorderControl",jsId:"borderRightColor"},menuHoverColor:{classId:"menuHoverControl",jsId:"borderLeftColor"},eyeBrowHoverColor:{classId:"menuHoverControl",jsId:"borderTopColor"},resizeHoverColor:{classId:"menuHoverControl",jsId:"borderRightColor"},menuHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderLeftColor"},eyeBrowHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderTopColor"},resizeHoverBorderColor:{classId:"menuHoverBorderControl",jsId:"borderRightColor"},elementClickColor:{classId:"menuClickControl",jsId:"backgroundColor"},elementClickBorderColor:{classId:"menuClickControl",jsId:"borderColor"}},TimescaleTier:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#363636"},backgroundColor:{defaultValue:"#DFE3E8"},verticalBorderColor:{jsId:"borderRightColor",defaultValue:"#C8CCD0"},verticalBorderStyle:{jsId:"borderRightStyle",defaultValue:"solid"},horizontalBorderColor:{jsId:"borderBottomColor",defaultValue:"#C8CCD0"},horizontalBorderStyle:{jsId:"borderBottomStyle",defaultValue:"solid"},outerBorderColor:{jsId:"borderLeftColor",defaultValue:"#B1B5BA"},todayLineColor:{jsId:"borderRightColor",defaultValue:"#F59D56"}},Cell:{font:{jsId:"fontFamily"},fontSize:{defaultValue:"1em"},fontWeight:{defaultValue:"normal"},fontStyle:{defaultValue:"normal"},textColor:{jsId:"color",defaultValue:"#131519"},backgroundColor:{defaultValue:i},textAlign:{defaultValue:SP.JsGrid.Utility.GetDocumentDirection()=="rtl"?"right":"left"}}};for(var n in a)for(var l in a[n]){var f=a[n][l],h=f.jsId==null?l:f.jsId;if(h!=""&&(f.cssId==null||f.cssId=="")){f.cssId=SP.Internal.DomElement.DashNameFromCamelName(h);f.jsId=h}}$addHandler(window,"unload",m);function m(){ULSEWi:;$removeHandler(window,"unload",m);e=d=null}function j(b){ULSEWi:;var a=SP.JsGrid.Internal.Color.HexStringToColor(b);if(a!=null)a=new SP.JsGrid.Internal.Color.MakeAlphaColor(.2,a.r,a.g,a.b);return a}function b(a){ULSEWi:;var c={};for(var b in a)c[b]=a[b].defaultValue;return c}function q(){ULSEWi:;return {textColor:"#6C6F72"}}function k(){ULSEWi:;function e(d){ULSEWi:;var c=b(a.Header);c.type=d;return c}var d={normal:e(c.Normal),normalHover:e(c.NormalHover),partSelected:e(c.PartSelected),partSelectedHover:e(c.PartSelectedHover),allSelected:e(c.AllSelected),allSelectedHover:e(c.AllSelectedHover)};d.normal.backgroundColor="#DFE3E8";d.normal.outerBorderColor="#B1B5BA";d.normal.eyeBrowColor="#DFE3E8";d.normal.eyeBrowBorderColor="#C8CCD0";d.normal.resizeColor="#EAEFF3";d.normal.resizeBorderColor="#C5C9CE";d.normal.resizeHoverColor="#FEFEFE";d.normal.resizeHoverBorderColor="#6E7B8A";d.normal.elementClickColor="#FFDC61";d.normal.elementClickBorderColor="#C28A30";d.partSelected.backgroundColor="#FFDC61";d.partSelected.outerBorderColor="#C28A30";d.partSelected.eyeBrowColor="#FFDC61";d.partSelected.eyeBrowBorderColor="#F3AA07";d.partSelected.resizeColor="#FFDC63";d.partSelected.resizeBorderColor="#F3AA07";d.partSelected.resizeHoverColor="#FFE9A3";d.partSelected.resizeHoverBorderColor="#BC8205";d.partSelected.elementClickColor="#FCAF00";d.partSelected.elementClickBorderColor="#CB8C00";d.allSelected.backgroundColor="#CACFD6";d.allSelected.outerBorderColor="#75777A";d.allSelected.eyeBrowColor="#CACFD6";d.allSelected.eyeBrowBorderColor="#8C949D";d.allSelected.resizeColor="#EAEFF3";d.allSelected.resizeBorderColor="#C5C9CE";d.allSelected.resizeHoverColor="#FEFEFE";d.allSelected.resizeHoverBorderColor="#6E7B8A";d.allSelected.elementClickColor="#FFDC61";d.allSelected.elementClickBorderColor="#C28A30";d.normalHover.backgroundColor="#FFEB91";d.normalHover.outerBorderColor="#C28A30";d.normalHover.eyeBrowColor="#FFEB91";d.normalHover.menuColor="#FFEB91";d.normalHover.eyeBrowBorderColor="#F3AA07";d.normalHover.menuBorderColor="#FFD359";d.normalHover.resizeBorderColor="#F3AA07";d.normalHover.eyeBrowHoverColor="#FFF5c8";d.normalHover.resizeColor=d.normalHover.menuHoverColor="#FFF5C8";d.normalHover.eyeBrowHoverBorderColor=d.normalHover.menuHoverBorderColor="#F3AA07";d.normalHover.elementClickColor="#FFDC61";d.normalHover.elementClickBorderColor="#C28A30";d.partSelectedHover=SP.Internal.JS.CloneObj(d.normalHover);d.allSelectedHover=SP.Internal.JS.CloneObj(d.normalHover);return d}function o(){ULSEWi:;var c={normal:b(a.Splitter),normalHandle:b(a.SplitterHandle),hover:b(a.Splitter),hoverHandle:b(a.SplitterHandle),drag:b(a.Splitter),dragHandle:b(a.SplitterHandle)};c.normal.outerBorderColor="#B1B5BA";c.normal.leftInnerBorderColor="#E9EBED";c.normal.innerBorderColor="#E9EBED";c.normal.backgroundColor="#DFE3E8";c.normalHandle.outerBorderColor="#A7AAAF";c.normalHandle.leftInnerBorderColor="#E5E7EB";c.normalHandle.innerBorderColor="#E3E6E8";c.normalHandle.backgroundColor="#DCE0E6";c.normalHandle.gripUpperColor="#A7AAAF";c.normalHandle.gripLowerColor="#FEFEFE";c.hover.outerBorderColor="#B8BCC0";c.hover.leftInnerBorderColor="#F4F5F6";c.hover.innerBorderColor="#EDEFF0";c.hover.backgroundColor="#E8EBEC";c.hoverHandle.outerBorderColor="#8A8D91";c.hoverHandle.leftInnerBorderColor="#C3C6C9";c.hoverHandle.innerBorderColor="#C1C5C8";c.hoverHandle.backgroundColor="#B1B5B9";c.hoverHandle.gripUpperColor="#A7AAAF";c.hoverHandle.gripLowerColor="#FEFEFE";c.drag.outerBorderColor="#797B7F";c.drag.leftInnerBorderColor="#E6E6E8";c.drag.innerBorderColor="#DCDDDF";c.drag.backgroundColor="#D3D4D6";c.dragHandle.outerBorderColor="#5F6164";c.dragHandle.leftInnerBorderColor="#A4A7AA";c.dragHandle.innerBorderColor="#A4A7AA";c.dragHandle.backgroundColor="#8C8F93";c.dragHandle.gripUpperColor="#A7AAAF";c.dragHandle.gripLowerColor="#FEFEFE";return c}function p(a){ULSEWi:;var c={};for(var b in a){var d=a[b].classId==null?"base":a[b].classId;if(!(d in c))c[d]={};c[d][b]=a[b]}return c}function g(d,c,b){ULSEWi:;for(var a in c)b[a]!=null&&SP.JsGrid.Style.CreateStyleFromCss(c[a],b[a],d)}return {Type:a,SetRTL:function(a){ULSEWi:;_rtl=a},MakeJsGridStyleManager:function(){ULSEWi:;var c={};function d(b){ULSEWi:;for(var e=[[b.gridPaneStyle,function(c,a){ULSEWi:;b.UpdateGridPaneStyleFromCss(a)},null,{base:"ms-grid",link:"ms-grid-link",selection:"ms-grid-selection",edit:"ms-grid-edit"}],[b.columnHeaderStyleCollection,b.UpdateHeaderStyleFromCss,null,{normal:{base:"ms-grid-col-header-normal",menuControl:"ms-grid-col-header-normal-control"},normalHover:{base:"ms-grid-col-header-normal-hover",menuControl:"ms-grid-col-header-normal-hover-control"},partSelected:{base:"ms-grid-col-header-part-selected",menuControl:"ms-grid-col-header-part-selected-control"},partSelectedHover:{base:"ms-grid-col-header-part-selected-hover",menuControl:"ms-grid-col-header-part-selected-hover-control"},allSelected:{base:"ms-grid-col-header-all-selected",menuControl:"ms-grid-col-header-all-selected-control"},allSelectedHover:{base:"ms-grid-col-header-all-selected-hover",menuControl:"ms-grid-col-header-all-selected-hover"}}],[b.rowHeaderStyleCollection,b.UpdateHeaderStyleFromCss,null,{normal:{base:"ms-grid-row-header-normal",menuControl:"ms-grid-row-header-normal-control"},normalHover:{base:"ms-grid-row-header-normal-hover",menuControl:"ms-grid-row-header-normal-hover-control"},partSelected:{base:"ms-grid-row-header-part-selected",menuControl:"ms-grid-row-header-part-selected-control"},partSelectedHover:{base:"ms-grid-row-header-part-selected-hover",menuControl:"ms-grid-row-header-part-selected-hover-control"},allSelected:{base:"ms-grid-row-header-all-selected",menuControl:"ms-grid-row-header-all-selected-control"},allSelectedHover:{base:"ms-grid-row-header-all-selected-hover",menuControl:"ms-grid-row-header-all-selected-hover"}}],[b.splitterStyleCollection,b.UpdateSplitterStyleFromCss,null,{normal:{base:"ms-grid-splitter"},normalHandle:{base:"ms-grid-splitter-handle"},hover:{base:"ms-grid-splitter-hover"},hoverHandle:{base:"ms-grid-splitter-handle-hover"},drag:{base:"ms-grid-splitter-drag"},dragHandle:{base:"ms-grid-splitter-handle-drag"}}],[b.defaultCellStyle,a.Cell,"ms-grid-cell"],[b.readOnlyCellStyle,a.Cell,"ms-grid-cell-readonly"],[b.timescaleTierStyle,a.TimescaleTier,"ms-grid-timescale"],[b.groupingStyles,function(c,a){ULSEWi:;b.UpdateGroupStylesFromCss(a)},null,"ms-grid-group"]],d=0;d<e.length;d++){var c=e[d];if(c[2]!=null)SP.JsGrid.Style.CreateStyleFromCss(c[1],c[2],c[0]);else c[1].apply(b,[c[0],c[3]])}return b}return d({gridPaneStyle:b(a.GridPane),columnHeaderStyleCollection:k(),rowHeaderStyleCollection:k(),splitterStyleCollection:o(),defaultCellStyle:b(a.Cell),readOnlyCellStyle:q(),timescaleTierStyle:b(a.TimescaleTier),groupingStyles:[{backgroundColor:"#FFF6C1"},{backgroundColor:"#00ADEE"},{backgroundColor:"#81DEFF"},{backgroundColor:"#ECECEC"},{backgroundColor:"#BFBFBF"},{backgroundColor:"#EC008C"},{backgroundColor:"#FF89CF"},{backgroundColor:"#62CE33"},{backgroundColor:"#ACCC6C"}],RegisterCellStyle:function(b,a){ULSEWi:;c[b]=a},GetCellStyle:function(a){ULSEWi:;return c[a]},UpdateSplitterStyleFromCss:function(c,b){ULSEWi:;g(c,b,a.Splitter)},UpdateHeaderStyleFromCss:function(c,b){ULSEWi:;g(c,b,a.Header)},UpdateGridPaneStyleFromCss:function(b){ULSEWi:;g(this.gridPaneStyle,p(a.GridPane),b)},UpdateGroupStylesFromCss:function(d){ULSEWi:;var b=[],c={},e=1;while(true){c=SP.JsGrid.Style.CreateStyleFromCss(a.Cell,d+e++);if(!SP.Internal.JS.IsAssocArrayEmpty(c))b.push(c);else break}if(b.length>0)this.groupingStyles=b}})},CreateStyleFromCss:function(a,j,g){ULSEWi:;var i=g==null?{}:g;if(d==null){d=document.createElement("div");document.body.appendChild(d);d.style.display="none";e=document.createElement("div");document.body.appendChild(e);e.style.display="none"}e.className=j;for(var b in a){var f=a[b].jsId;if(f!=""){var c=SP.Internal.DomElement.GetComputedStyle(e,f,a[b].cssId);if(c!=SP.Internal.DomElement.GetComputedStyle(d,f,a[b].cssId)){var h=a[b].fromCss!=null?a[b].fromCss(c):c;if(h!=null)i[b]=h}}}return i},CreateStyle:function(d,b){ULSEWi:;var c={};for(var a in d)if(b[a]!=null)c[a]=b[a];return c},MergeCellStyles:function(c,e){ULSEWi:;var d={};for(var b in a.Cell)d[b]=c!=null&&c[b]!=null?c[b]:e[b];return d},ApplyCellStyle:function(c,a){ULSEWi:;var b=c.style;if(a.textColor!=null)b.color=a.textColor;if(a.backgroundColor!=null)b.backgroundColor=a.backgroundColor;if(a.font!=null)b.fontFamily=a.font;if(a.fontSize!=null)b.fontSize=a.fontSize;if(a.fontWeight!=null)b.fontWeight=a.fontWeight;if(a.fontStyle!=null)b.fontStyle=a.fontStyle;if(a.textAlign!=null)b.textAlign=a.textAlign},ApplyRowHeaderStyle:function(a,d,c){ULSEWi:;var b=a.style;if(a.headerStyleType!=d.type){a.headerStyleType=d.type;b.backgroundColor=d.backgroundColor;a.headerStyleBorderString=b.borderBottom=b["border"+_rtl.Right]="1px solid "+d.outerBorderColor;b.borderTop="0px"}var e=c&&c(a,true);if(e!=null){var h=f(e,a);e.style.borderBottom=h.headerStyleBorderString}var g=c&&c(a,false),h=g!=null?f(g,a):a;b.borderBottom=h.headerStyleBorderString;function f(a,b){ULSEWi:;return a.headerStyleType==null?b:b.headerStyleType==null?a:a.headerStyleType>b.headerStyleType?a:b}},ApplyCornerHeaderBorderStyle:function(b,a){ULSEWi:;this.ApplyRowHeaderStyle(b,a,function(){ULSEWi:;return null})},ApplyHeaderInnerBorderStyle:function(c,a,b){ULSEWi:;c.style[a?"borderTop":"border"+_rtl.Left]=b.headerStyleInnerBorderString},ApplyColumnContextMenuStyle:function(a,b){ULSEWi:;a.style.border=SP.JsGrid.Style.MakeBorderString(1,"solid",b.borderColor);a.style.backgroundColor=b.backgroundColor},ApplySplitterStyle:function(a,b){ULSEWi:;a.style.borderLeft=a.style.borderRight=SP.JsGrid.Style.MakeBorderString(1,"solid",b.outerColor);a.style.backgroundColor=b.innerColor},MakeBorderString:function(c,b,a){ULSEWi:;return [c,"px ",b," ",a].join("")},GetCellStyleDefaultBackgroundColor:function(){ULSEWi:;return i}}}();SP.JsGrid.TableCache=function(E,p){ULSEWi:;this.fnApplyUpdatesToNewRecord;var j=300,g=null,n=false,q=false,o=10,t=0,a,c,d,f=[],e,b,r=0,A,h,l=this;v();this.SetDataPageSize=function(a){ULSEWi:;j=a};this.GetDataPageSize=function(){ULSEWi:;return j};this.SetMaxRecordCount=function(a){ULSEWi:;g=a;u(false)};this.GetMaxRecordCount=function(){ULSEWi:;return g};this.SetConvertAllBlobsToRecords=function(a){ULSEWi:;n=a};this.GetConvertAllBlobsToRecords=function(){ULSEWi:;return n};this.SetBackgroundConversionSize=function(a){ULSEWi:;o=a};this.GetBackgroundConversionSize=function(){ULSEWi:;return o};this.SetKeepDataInBlobCache=function(a){ULSEWi:;q=a};this.GetKeepDataInBlobCache=function(){ULSEWi:;return q};function H(b,a){ULSEWi:;return {pos:b,count:a}}this.GetCachedRecord=function(b){ULSEWi:;b in c&&!(b in a)&&this.AddRecordsToCache(p(c[b],[b]));return a[b]};this.GetRecordsByKey=function(a,e){ULSEWi:;var f=c();if(f==null)return false;d(f);return true;function c(){ULSEWi:;for(var d=new Array(a.length),c=0;c<a.length;c++){var e=b.GetPosFromKey(a[c]);if(e==null)return null;d[c]={pos:e,count:1}}return d}function d(d){ULSEWi:;var b=l.GetRecords(d,g);if(b.recordSetComplete){var c=SP.Internal.JS.Flatten2LevelArray(b.records);setTimeout(function(){ULSEWi:;e(a,c,true)},0)}}function g(b,f){ULSEWi:;var b=c();if(f&&b!=null)d(b);else e(a,null,false)}};this.GetRecords=function(e,l){ULSEWi:;var f=[],a=[],h=[];for(var i in e)f[i]=C(e[i],h,a);G(h);if(a.length>0){var m,b,d=true;function j(a){ULSEWi:;d=d&&a;b--;b==0&&setTimeout(function(){ULSEWi:;l(e,d)},0)}var g=x(a,j);b=g.rangesToFillRequest;var c=g.totalRanges;if(c.length>0){var k=r;E(c,function(a){ULSEWi:;y(c,a,k)})}}return {recordSetComplete:a.length==0,records:f}};this.AddRecordsToCache=function(f){ULSEWi:;for(var b in f){var e=f[b];a[b]=e;h!=null&&h.AddRecord(b);t++;this.fnApplyUpdatesToNewRecord!=null&&this.fnApplyUpdatesToNewRecord(e);if((g==null||!q)&&b in c){delete c[b];if(b in d){for(var i in d[b])e.AddFieldKey(fieldKeycolumnCache[b][i]);delete d[b]}}}};this.AddColumn=function(f,e){ULSEWi:;m();for(var b in a)e[b]!=null&&a[b].AddFieldValue(f,e[b]);for(var b in c)if(e[b]!=null){if(d[b]==null)d[b]={};d[b][f]=e[b]}};this.RemoveColumn=function(c){ULSEWi:;m();for(var b in a)a[b].RemoveFieldValue(c);for(var b in d){delete d[b][c];if(SP.Internal.JS.IsAssocArrayEmpty(d[b]))delete d[b]}};this.ClearRecords=function(d){ULSEWi:;for(var b=0;b<d.length;b++){delete a[d[b]];delete c[d[b]]}};this.SetView=function(a){ULSEWi:;k();b.SetViewMap(a)};this.GetView=function(){ULSEWi:;return b.GetKeys(0,b.GetRecordCount())};this.RecordIdxToKey=function(a){ULSEWi:;return b.GetKeyFromPos(a)};this.KeyToRecordIdx=function(a){ULSEWi:;return b.GetPosFromKey(a)};this.UpdateProperty=function(b,a,c){ULSEWi:;b.SetProp(a,c)};this.SeedInsertedRecord=function(b){ULSEWi:;if(!(b.key() in a)){a[b.key()]=b;t++}this.fnApplyUpdatesToNewRecord!=null&&this.fnApplyUpdatesToNewRecord(b)};this.InsertRecord=function(c,a){ULSEWi:;k();b.InsertRecord(c,a)};this.DeleteRecord=function(a){ULSEWi:;k();b.DeleteRecord(a)};this.GetRecordCount=function(){ULSEWi:;return b.GetRecordCount()};this.IsKeyInView=function(a){ULSEWi:;return b.IsKeyPresent(a)};this.AddRawDataToCache=function(b,g){ULSEWi:;var d=false;for(var e in b)if(!(b[e] in a)){c[b[e]]=g;d=true}if(n&&d){f.push(b);A=SP.JsGrid.AsynchronousTaskManager.RegisterTask(w)}};this.Clear=function(){ULSEWi:;v()};var i=0;function w(){ULSEWi:;if(f.length>0){for(var a=[];i<f[0].length&&a.length<o;i++)f[0][i] in c&&a.push(f[0][i]);if(i==f[0].length){i=0;f.shift()}a.length>0&&l.AddRecordsToCache(p(c[a[0]],a))}return f.length>0}function m(){ULSEWi:;k();r++}function k(){ULSEWi:;if(e!=null)for(var b=e.GetAllCallbacks(),a=0;a<b.length;a++)b[a](false);e=new D}function v(){ULSEWi:;a={};c={};d={};m();b=new I;u(true)}function u(a){ULSEWi:;if(h!=null&&g!=null&&!a)h.SetMaxSize(g);else h=g!=null?new B(20,g):null}function C(i,m,n){ULSEWi:;for(var k=i.pos,g=i.count,o=b.GetKeys(k,g),f=new Array(g),d=0;d<g;d++){var e=o[d],l=a[e];h!=null&&h.TouchRecord(e);if(l!=null)f[d]=l;else{f[d]=null;var j=c[e];if(j!=null)m.push({key:e,blob:j,destArray:f,destIdx:d});else n.push({pos:k+d,key:e})}}return f}function G(d){ULSEWi:;var c=[],b;for(var f in d){b=d[f];var e=SP.Internal.JS.Find(c,function(a){ULSEWi:;return a.blob==b.blob});if(e==null){e={blob:b.blob,keys:[]};c.push(e)}e.keys.push(b.key)}for(var f in c)l.AddRecordsToCache(p(c[f].blob,c[f].keys));for(var f in d){b=d[f];b.destArray[b.destIdx]=a[b.key]}}function y(d,b,f){ULSEWi:;if(f==r){if(b!=null)for(var a=0;a<b.length;a++)l.AddRawDataToCache(b[a].keys,b[a].data);for(var a=0;a<d.length;a++){var c=e.FindRangeObject(d[a].pos);if(c!=null){for(var g in c.callbacks)c.callbacks[g](b!=null);e.RemoveRangeObject(c)}}}}function x(d,i){ULSEWi:;for(var h=0,f=[],a=null,c,b=0;b<d.length;b++){c=d[b].pos;a=e.FindRangeObject(c);if(a==null){var g=F(c,.75);for(var b in g)e.AppendRangeObject(g[b]);f=f.concat(g)}}a=null;for(var b=0;b<d.length;b++){c=d[b].pos;if(a==null||!e.IsPosInRange(c,a)){a=e.FindRangeObject(c);h++;if(a.callbacks==null)a.callbacks=[i];else a.callbacks.push(i)}}return {rangesToFillRequest:h,totalRanges:f}}function B(l,m){ULSEWi:;var f,e=[],c={},b=[],d={},r=0,n=10,p=0,g;function o(j){ULSEWi:;var m=0,i,h,f=0,g=0;this.AddToDeleteCount=function(a){ULSEWi:;if(!SP.JsGrid.AsynchronousTaskManager.TaskRegistered(i))i=SP.JsGrid.AsynchronousTaskManager.RegisterTask(l);m=k(f+a)};this.TotalRemaingToDelete=function(){ULSEWi:;return f};this.NotifyGenUpdated=function(){ULSEWi:;ComputePagesToDelete(f)};function k(c){ULSEWi:;h={};f=0;for(var a=0;a<b.length-3&&f<c;a++){f+=d[b[a]];h[b[a]]=null}}function l(){ULSEWi:;for(var k=0;k<n;k++)if(c[e[g]] in h){var b=e[g],i=c[b];delete a[b];if(d[i]==1)delete h[i];j(b);delete c[b];e.splice(g,1);f--}else g=(g+1)%(e.length-1);return f!=0}}function q(){ULSEWi:;function a(){ULSEWi:;var a=h();b.push(a);d[a]=0}g=new o(j);a();a();f=0}function h(){ULSEWi:;return p++}function i(c){ULSEWi:;var b=g.TotalRemaingToDelete(),a=e.length-m-b;a>0&&g.AddToDeleteCount(a+l);e.push(c)}this.AddRecord=function(a){ULSEWi:;if(c[a]==null){f=k(a,f,Math.ceil((b.length-1)/2));i(a)}};this.SetMaxSize=function(a){ULSEWi:;m=a};this.TouchRecord=function(a){ULSEWi:;if(c[a]!=b[b.length-1]){if(c[a]!=null)j(a);else i(a);k(a,b.length-1)}};function k(g,a,e){ULSEWi:;if(d[b[a]]==l){var f=h();a=e!=null?e:a+1;b.splice(a,0,f);d[f]=0}d[b[a]]++;c[g]=b[a];return a}function j(f){ULSEWi:;var a=c[f],g=d[a];if(g==1){for(var e=0;e<b.length;e++)if(b[e]==a)break;delete d[a];b.splice(e,1);c[f]=-1}else d[a]--}q()}function I(){ULSEWi:;var b,a,d=this;this.SetViewMap=function(c){ULSEWi:;b=c;a=null};this.GetKeys=function(d,b){ULSEWi:;for(var c=new Array(b),a=0;a<b;a++)c[a]=this.GetKeyFromPos(d+a);return c};this.InsertRecord=function(d,c){ULSEWi:;b.splice(d,0,c);a=null};this.DeleteRecord=function(c){ULSEWi:;b.splice(c,1);a=null};this.GetRecordCount=function(){ULSEWi:;return b!=null?b.length:0};this.IsKeyPresent=function(b){ULSEWi:;a==null&&c();return b in a};this.GetKeyFromPos=function(a){ULSEWi:;return b[a]};this.GetPosFromKey=function(b){ULSEWi:;a==null&&c();if(b in a)return a[b];return null};function c(){ULSEWi:;a={};for(var c=b.length-1;c>=0;c--)a[b[c]]=c}}function F(m,n){ULSEWi:;var k=500,f=k*.5,e=k*.5,l=m-1,i=m,b=[],d=j*(1-n),h=true,g=true,a,c=true;while(c&&b.length<j){c=false;if(h&&f>0){a=s(l,d,f,-1);f-=a.scanned;l-=a.scanned+1;h=a.shouldContinue;b=b.concat(a.positions);d=j-b.length;c=true}if(g&&e>0){a=s(i,d,e,1);e-=a.scanned;i+=a.scanned+1;g=a.shouldContinue;b=b.concat(a.positions);d=j-b.length;c=true}}return z(b)}function z(a){ULSEWi:;var e=[];a.sort(function(a,b){ULSEWi:;return a-b});for(var f=a.length,d=Number.NEGATIVE_INFINITY,c=null,b=0;b<f;b++){if(a[b]!=d+1){c=H(a[b],1);e.push(c)}else c.count++;d=a[b]}return e}function s(l,h,m,j){ULSEWi:;for(var g={positions:[],shouldContinue:true,scanned:0},d,n=false,k=b.GetRecordCount(),f=0;f<m;f++){d=l+f*j;if(d<0||d>k){g.shouldContinue=false;break}var i=b.GetKeyFromPos(d);if(!(i in a||i in c||e.FindRangeObject(d)!=null)){g.positions.push(d);h--;if(h<=0)break}}g.scanned=f;return g}function D(){ULSEWi:;var a=[];this.FindRangeObject=function(d){ULSEWi:;var e=null,c=b(d);if(c<a.length&&this.IsPosInRange(d,a[c]))e=a[c];return e};this.AppendRangeObject=function(c){ULSEWi:;var d=b(c.pos);a.splice(d,0,c)};this.RemoveRangeObject=function(c){ULSEWi:;var d=b(c.pos);a.splice(d,1)};this.IsPosInRange=function(b,a){ULSEWi:;return c(b,a)==0};this.IsEmpty=function(){ULSEWi:;return a.length==0};this.GetAllCallbacks=function(){ULSEWi:;for(var b=[],c=0;c<a.length;c++)if(a.callbacks!=null)b=b.concat(a.callbacks);return b};function b(b){ULSEWi:;return SP.Internal.JS.LowerBoundCompare(a,b,function(b,d){ULSEWi:;return c(d,a[b])})}function c(b,a){ULSEWi:;return b<a.pos?1:a.pos+a.count<=b?-1:0}}};SP.JsGrid.Internal.TableManager=function(o,hb,P,G,f,fb,Y,ab,U,Z,F,bb,db){ULSEWi:;var l=0,O,k=[],e=[],s,z,i,c,a,g=0,n=[],b={},m={},d=new SP.JsGrid.Internal.GridPaneConverter(f),p=f.ariaMgr,j=this,v=null,y,cb=SP.JsGrid.AsynchronousCellUpdater.RegisterJob(q);this.CellType={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3};this.GetGridPaneConverter=function(){ULSEWi:;return d};this.Dispose=function(){ULSEWi:;I();a=o=null};this.SetPosConverterObj=function(a){ULSEWi:;O=a;d.SetPosConverterObj(a)};this.GetHeaderHeight=function(){ULSEWi:;return a.rows[0].offsetHeight};this.SetHeaderHeight=function(b){ULSEWi:;s=b;if(a.rows.length>0){a.rows[0].style.height=s-1+"px";Z(s)}};this.SetRowHeight=function(a){ULSEWi:;z=SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7?a-1:a};this.InitTable=function(j){ULSEWi:;this.ClearTable();g=0;c=j;i=c?1:0;var f=a.insertRow(-1);f.recordKey="__colheaders";p.OnInsertTableRow(f,null,-1);var d;if(c){var b=document.createElement("th"),e=document.createElement("div");b.style.width=e.style.width=SP.JsGrid.Internal.RowHeaderWidth-1+"px";b.style.padding="0px";b.appendChild(e);a.rows[0].appendChild(b);g++;d=new h(0,0);p.OnInsertRowHeaderCell(b)}this.SetHeaderHeight(s);return d};this.SetColumns=function(a,b){ULSEWi:;if(k.length){u(i,r());l=0}k=a;if(b)d.SetView(k);else d.NotifyColumnsChanged(k);this.OptimizeTableColumns()};this.ClearTable=function(){ULSEWi:;e.length>0&&this.SpliceRows(0,e.length,null,0,null);u(i,r());l=0;a.rows.length>0&&a.deleteRow(0)};this.SpliceRows=function(f,g,c,i){ULSEWi:;var h=i.length,d=h>1;d&&o.removeChild(a);if(f!=null&&g!=0){e.splice(f,g);for(var b=g-1;b>=0;b--)L(f+b)}if(c!=null&&h!=0){Array.prototype.splice.apply(e,[c,0].concat(i));for(var b=0;b<h;b++)M(c+b,e[c+b],d)}d&&o.appendChild(a);B()};this.RenderRows=function(b){ULSEWi:;for(var a in b){var c=b[a];a=+a;L(a);e[a]=c;M(a,c)}if(!SP.Internal.JS.IsAssocArrayEmpty(b))e=[].concat(e);B()};this.InsertColumns=function(c,b){ULSEWi:;var a=t(c);Array.prototype.splice.apply(k,[c,0].concat(b));d.NotifyColumnsChanged(k);a>=i&&a<=g&&D(a,b.length);this.OptimizeTableColumns()};this.RefreshCell=function(a){ULSEWi:;var c=a.GetRecordKey(),b=a.GetFieldKey();E(c,b);var d=a.GetTd();d.innerHTML="";F(a);f.errorMgr.CellHasError(c,b)&&q(c,b)};this.RemoveColumns=function(e,b){ULSEWi:;var a=t(e);if(a>=i&&a<g){var c=b;if(a+b>g)c-=a+b-g;u(a,c)}k.splice(e,b);d.NotifyColumnsChanged(k);this.OptimizeTableColumns()};this.ScrollColumns=function(a){ULSEWi:;var c=H(a),d=r(),b=l;if(a>b){u(i,Math.min(d,a-b));l=a}else if(a<b){l=a;D(i,Math.min(c,b-a))}this.OptimizeTableColumns()};this.ChangeKeys=function(c,f){ULSEWi:;if(d.IsRecordOnScreen(c))for(var e=a.rows.length-1;e>=0;e--)if(a.rows[e].recordKey==c){a.rows[e].recordKey=f;break}if(c in b){b[f]=b[c];delete b[c]}if(c in m){m[f]=m[c];delete m[c]}};this.OptimizeTableColumns=function(){ULSEWi:;var c=H(l),b=r(),a=b-c;if(a<0)D(g,-a);else a>0&&u(g-a,a);B()};this.UpdateErrorFrames=function(){ULSEWi:;for(var a in b)for(var c in b[a])q(a,c,true)};this.GetAllDataCells=function(){ULSEWi:;for(var d=[],b=1;b<a.rows.length;b++)for(var c=i;c<g;c++)d.push(new h(b,c));return d};this.GetSelectAllSquare=function(){ULSEWi:;return c?new h(0,0):null};this.GetRowHeaderByKey=function(a){ULSEWi:;var b;if(c&&d.IsRecordOnScreen(a))b=new h(C(d.GetTopRowIdxForKey(a)),0);return b};this.GetRowHeader=function(b){ULSEWi:;if(c){var a=new h(C(b),0,true,false);return a.bIsInvalid?null:a}return null};this.GetRowHeaders=function(){ULSEWi:;var d=[];if(c)for(var b=1;b<a.rows.length;b++)d.push(new h(b,0));return d};this.GetColumnHeader=function(b){ULSEWi:;var a=new h(0,t(b),true,false);return a.bIsInvalid||a.GetColIdx()==null?null:a};this.GetColumnHeaders=function(){ULSEWi:;for(var b=[],a=i;a<g;a++)b.push(new h(0,a));return b};this.GetColumnHeaderTr=function(){ULSEWi:;return a.rows[0]};this.GetRowHeaderWidth=function(){ULSEWi:;return c?SP.JsGrid.Internal.RowHeaderWidth:0};this.GetRowIdxColIdxFromCoord=function(k){ULSEWi:;for(var f=SP.Internal.DomElement.GetEventLocation(k),m,l,e={},j=a.rows,d=1;d<j.length;d++){var h=j[d],b=SP.Internal.DomElement.GetLocation(h);if(f.y>=b.y&&f.y<b.y+h.offsetHeight){e.rowIdx=x(d);e.top=b.y;e.bottom=b.y+h.offsetHeight;break}}for(var i=a.rows[0].cells,d=c?1:0;d<i.length;d++){var g=i[d],b=SP.Internal.DomElement.GetLocation(g);if(f.x>=b.x&&f.x<b.x+g.offsetWidth){e.colIdx=w(d);e.left=b.x;e.right=b.x+g.offsetWidth;break}}return e};this.GetTdCoords=function(c){ULSEWi:;var b={};if(f.RTL.bEnabled){b.left=a.offsetLeft+c.offsetLeft;b.right=a.offsetLeft+c.offsetLeft+c.offsetWidth+1}else{b.left=a.offsetLeft+c.offsetLeft-1;b.right=a.offsetLeft+c.offsetLeft+c.offsetWidth}if(c.previousSibling!=null){if(v==null){var e=a.rows[0].cells,d=e[f.RTL.bEnabled?0:e.length-1],g=d.offsetWidth-(SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7&&!f.RTL.bEnabled?1:0);v=a.offsetWidth-(d.offsetLeft+g)}b.left+=v;b.right+=v}b.top=a.offsetTop+c.offsetTop-1;b.bottom=a.offsetTop+c.offsetTop+c.offsetHeight;b.width=b.right-b.left;b.height=b.bottom-b.top;return b};this.GetCellByKey=function(b,c){ULSEWi:;if(!O.IsRecordOnScreen(b))return null;var a=d.KeyToIdx(b,c);return a&&this.GetCellByIdx(a.rowIdx,a.colIdx)};this.GetCellByIdx=function(c,b){ULSEWi:;var a=new h(C(c),t(b),true,true);return a.bIsInvalid?null:a};this.GetCellByChildElement=function(i){ULSEWi:;function g(a,b){ULSEWi:;return SP.Internal.JS.FindInArray(a.rows,function(a){ULSEWi:;return a==b})}function f(b,d){ULSEWi:;for(var c=null,a=b.cells.length-1;a>=0;a--)if(b.cells[a]==d){c=a;break}return c}var b=SP.Internal.DomElement.FindAncestorWithProperty(i,"recordKey");if(b==null)return null;var e=b.elem,j=b.child,d=g(a,e),c=f(e,j);return d!=null&&c!=null?new h(d,c):null};this.GetRowCount=function(){ULSEWi:;return e.length()};this.GetColumnCount=function(){ULSEWi:;return r()};this.BeginRowIdx=function(){ULSEWi:;return d.RelRowIdxToRowIdx(0)};this.EndRowIdx=function(){ULSEWi:;return this.BeginRowIdx()+e.length};this.BeginColIdx=function(){ULSEWi:;return l};this.EndColIdx=function(){ULSEWi:;return l+r()};this.GetColumnAutoResizeWidth=function(f){ULSEWi:;for(var e=t(f),d=a.rows,b=0,c=0;c<d.length;c++)b=Math.max(b,d[c].cells[e].scrollWidth);return b};function eb(c){ULSEWi:;var a=c.defaultCellStyle,b=c.gridPaneStyle;y=";vertical-align:middle;white-space:nowrap;overflow:hidden;border-"+f.RTL.right+":"+SP.JsGrid.Style.MakeBorderString(1,b.verticalBorderStyle,b.verticalBorderColor)+";border-bottom:"+SP.JsGrid.Style.MakeBorderString(1,b.horizontalBorderStyle,b.horizontalBorderColor)+";color:"+a.textColor+(a.font!=null?";font-family:"+a.font:"")+";font-size:"+a.fontSize+";font-weight:"+a.fontWeight+";font-style:"+a.fontStyle+";text-align:"+a.textAlign}function ib(){ULSEWi:;f.eventMgr.AttachEvent(SP.JsGrid.EventType.OnCellErrorStateChanged,X);f.intEventMgr.AttachEvent(SP.JsGrid.Internal.EventType.OnRowHeaderStateChanged,S);eb(f.styleMgr);a=document.createElement("table");a.cellPadding=a.cellSpacing=0;a.style.cssText="table-layout:fixed;width:0px;border-collapse:collapse;background-color:"+f.styleMgr.defaultCellStyle.backgroundColor;a.id=hb+"_mainTable";o.appendChild(a)}function X(a){ULSEWi:;if(d.IsRecordOnScreen(a.recordKey))if(a.bCellCurrentlyHasError&&!(a.recordKey in b&&a.fieldKey in b[a.recordKey]))q(a.recordKey,a.fieldKey);else!a.bCellCurrentlyHasError&&E(a.recordKey,a.fieldKey)}function q(a,c,f){ULSEWi:;var d=j.GetCellByKey(a,c);if(d!=null){var e=d.GetTd();if(!(a in b))b[a]={};if(b[a][c]==null)b[a][c]=f?null:T(e);b[a][c]!=null&&R(e,b[a][c])}}function T(e){ULSEWi:;var d="position:absolute; top:0px; left:0px; width:0px; height:0px;",a={};a.Top=document.createElement("div");a.Right=document.createElement("div");a.Bottom=document.createElement("div");a.Left=document.createElement("div");for(var c in a){var b=a[c];b.style.cssText=d;b.style["border"+c]=SP.JsGrid.Style.MakeBorderString(1,"solid",f.styleMgr.gridPaneStyle.errorRectBorderColor);e.appendChild(b)}return a}function R(f,d){ULSEWi:;var a=j.GetTdCoords(f),c={Top:{left:a.left+1,top:a.top+1,width:a.width-2},Right:{left:a.right-2,top:a.top+1,height:a.height-2},Bottom:{left:a.left+1,top:a.bottom-2,width:a.width-2},Left:{left:a.left+1,top:a.top+1,height:a.height-2}};for(var b in d){var g=d[b];for(var e in c[b])g.style[e]=c[b][e]+"px"}}function Q(a){ULSEWi:;var c=b[a];if(c!=null){for(var d in c)K(a,d,false);delete b[a]}}function E(a,c){ULSEWi:;a in b&&c in b[a]&&K(a,c,true)}function K(a,c,f){ULSEWi:;for(var d in b[a][c])if(d!=null){var e=SP.Internal.DomElement.GetParentElement(b[a][c][d]);e!=null&&e.removeChild(b[a][c][d])}delete b[a][c];if(f)if(SP.Internal.JS.IsAssocArrayEmpty(b[a]))delete b[a]}function S(a){ULSEWi:;if(c&&d.IsRecordOnScreen(a.recordKey))if(a.rowHeaderState!=null)J(a.recordKey,a.rowHeaderState);else A(a.recordKey)}function J(a,b){ULSEWi:;m[a]!=null&&A(a);var f=j.GetRowHeaderByKey(a),e=f.GetTd(),d=b.GetOnClick(),c=b.GetImg().Render(b.GetTooltip(),d!=null?function(b){ULSEWi:;d(b,a);b.stopPropagation();b.preventDefault()}:null);e.innerHTML="";e.appendChild(c);m[a]=c}function A(a,b){ULSEWi:;if(a in m){var d=j.GetRowHeaderByKey(a),c=b==null?d.GetTd():b;N(c);c.removeChild(m[a]);delete m[a]}}function r(){ULSEWi:;return g-i}function x(a){ULSEWi:;return d.RelRowIdxToRowIdx(a-1)}function C(a){ULSEWi:;return d.RowIdxToRelRowIdx(a)+1}function w(a){ULSEWi:;return l+a-i}function t(a){ULSEWi:;return a-l+i}function M(v,m,u){ULSEWi:;var t,e=[],k=v+1,j=a.insertRow(k);j.style.height=z+"px";var r=m!=null&&m!=SP.JsGrid.Internal.LoadErrorState,d=r?m.key():null;j.recordKey=r?d.toString():null;p.OnInsertTableRow(j,m,x(k));if(c){var n=j.insertCell(-1);n.style.cssText=y+";padding-"+f.RTL.left+":4px";t=new h(k,0);p.OnInsertRowHeaderCell(n)}for(var b=i;b<g;b++){var n=j.insertCell(-1);n.style.cssText=y;e.push(new h(k,b));p.OnInsertGridCell(n)}fb(t,e);for(var o=false,b=0;b<e.length;b++){o=F(e[b])||o;if(d!=null)if(f.errorMgr.CellHasError(d,e[b].GetFieldKey())){q(d,e[b].GetFieldKey(),u);u&&SP.JsGrid.AsynchronousCellUpdater.RegisterCell(cb,d,e[b].GetFieldKey())}}var s;c&&(s=f.rowHeaderStateMgr.GetRowHeaderState(d))!=null&&J(d,s);if(!o&&SP.Internal.DomElement.BrowserIsIEAndRenderingModeIs7){var l=j.cells.length>0?j.cells[0]:null;if(l!=null&&l.innerHTML!=null&&l.innerHTML.length==0)l.innerHTML="&nbsp;"}}function N(c){ULSEWi:;$clearHandlers(c);for(var b=c.childNodes,a=0;a<b.length;a++)N(b[a])}function L(b){ULSEWi:;var d=a.rows[b+1].recordKey;c&&m[d]!=null&&A(d,a.rows[b+1].cells[0]);Q(d);var e=a.rows[b+1];db(e.recordKey);e.recordKey=null;a.deleteRow(b+1)}function H(b){ULSEWi:;for(var e=P.GetWidth(),c=j.GetRowHeaderWidth(),a=b;a<d.GetVirtualColumnCount()&&c<e;a++)c+=k[a].width;return a-b}function gb(){ULSEWi:;for(var b=j.GetRowHeaderWidth(),a=j.BeginColIdx();a<j.EndColIdx();a++)b+=k[a].width;return b}function D(d,m){ULSEWi:;for(var l=[],c=[],j=a.rows[0],b=0;b<m;b++){var i=document.createElement("th");d==j.cells.length?j.appendChild(i):j.insertBefore(i,j.cells[d]);g++;l.push(new h(0,d+b));p.OnInsertColHeaderCell(i);for(var k=0;k<e.length;k++){var n=a.rows[k+1].insertCell(d+b);n.style.cssText=y;c.push(new h(k+1,d+b));p.OnInsertGridCell(i)}}Y(l,c,s);for(var b=0;b<c.length;b++){F(c[b]);f.errorMgr.CellHasError(c[b].GetRecordKey(),c[b].GetFieldKey())&&q(c[b].GetRecordKey(),c[b].GetFieldKey())}}function u(i,m){ULSEWi:;var f=w(i);while(m-->0){for(var j=k[f].fieldKeys,d=e.length;d>=0;d--){var c=a.rows[d],l=c.cells[i];if(c.recordKey in b)for(var h=0;h<j.length;h++)E(c.recordKey,j[h]);d==0&&U(l,f);c.removeChild(l)}f++;g--}ab()}function B(){ULSEWi:;I();for(var d=null,g=[],l=-1,c=0;c<e.length;c++){var h=e[c]==null?1:e[c]==SP.JsGrid.Internal.LoadErrorState?2:0;if(h!=0)if(h!=l){d={type:h,startIdx:c,count:1};g.push(d)}else d.count++;l=h}if(g.length)for(var p=j.GetRowHeaderWidth(),t=f.RTL.bEnabled?Math.max(0,a.offsetLeft+1):p,r=Math.min(gb()-1,P.GetWidth())-p,k='<table cellpadding="0" cellspacing="0" style="height:100%;width:100%"><tr><td style="border:0px;text-align:center">',i="</td></tr></table>",q=k+G("LoadingMsg")+i,u=k+'<a href="#" tabIndex="-1" title="'+G("RecordFetchError")+'">'+G("RecordFetchError")+"</a>"+i,c=0;c<g.length;c++){var d=g[c],b=document.createElement("div");SP.Internal.DomElement.SetOpacity(b,.75);b.style.position="absolute";b.style.top=z*d.startIdx+s+2-o.offsetTop+"px";b.style.left=t+"px";b.style.width=r+"px";b.style.height=z*d.count-1+"px";b.style.zIndex=100;if(d.type==1){b.innerHTML=q;n.push({div:b})}else{b.innerHTML=u;var m=b.firstChild.firstChild.firstChild.firstChild.firstChild;$addHandler(m,"click",function(){ULSEWi:;bb();return false});n.push({div:b,anchor:m})}o.appendChild(b)}}function I(){ULSEWi:;for(var a=0;a<n.length;a++){n[a].anchor&&$clearHandlers(n[a].anchor);o.removeChild(n[a].div)}n=[]}function W(b,c){ULSEWi:;return b>=(c?1:0)&&b<a.rows.length}function V(a,b){ULSEWi:;return a>=(b&&c?1:0)&&a<g}function h(b,a,d,c){ULSEWi:;if(!d||W(b,c)&&V(a,c)){this.tableRowIdx=b;this.tableColIdx=a}else this.bIsInvalid=true}h.prototype={fieldKey:null,GetTr:function(){ULSEWi:;return a.rows[this.tableRowIdx]},GetTd:function(){ULSEWi:;return a.rows[this.tableRowIdx].cells[this.tableColIdx]},GetRecordKey:function(){ULSEWi:;if(this.tableRowIdx==0)return null;var a=e[this.tableRowIdx-1];return a!=null&&a.recordKey!=null?a.recordKey:this.GetTr().recordKey},GetRecord:function(){ULSEWi:;var a=this.tableRowIdx==0?null:e[this.tableRowIdx-1];return a==SP.JsGrid.Internal.LoadErrorState?null:a},GetFieldKey:function(){ULSEWi:;if(this.tableColIdx==0&&c||this.tableRowIdx==0)return null;if(!this.fieldKey)this.fieldKey=d.IdxToFieldKey(x(this.tableRowIdx),w(this.tableColIdx));return this.fieldKey},GetColumn:function(){ULSEWi:;return this.tableColIdx==0&&c?null:k[this.GetColIdx()]},GetColIdx:function(){ULSEWi:;return this.tableColIdx==0&&c?null:w(this.tableColIdx)},GetRowIdx:function(){ULSEWi:;return this.tableRowIdx==0?null:x(this.tableRowIdx)},Equals:function(a){ULSEWi:;return this.tableRowIdx==a.tableRowIdx&&this.tableColIdx==a.tableColIdx},GetCellType:function(){ULSEWi:;return this.tableColIdx==0&&c?this.tableRowIdx==0?j.CellType.SelectAllSquare:j.CellType.RowHeader:this.tableRowIdx==0?j.CellType.ColumnHeader:j.CellType.Cell}};ib()};SP.JsGrid.Internal.VersionManager=function(k,i,t,s,l,y){ULSEWi:;var b=[],c=[{key:new q(0),version:0}],a=0,f=0,x=1,e=new w,d=new v,g=new u;this.ChangeKeysOnPropUpdates=function(b,a){ULSEWi:;d.ChangeKeys(b,a)};this.GetEarliestPropChangeKeyForRecord=function(b){ULSEWi:;var a=d.GetEarliestChangeKeyForRecord(b);if(a!=null)a=this.GetChangeKeyForVersion(a);return a};this.AddPropChange=function(f,g,a,e,b,c){ULSEWi:;h(a,true)&&d.AddPropChange(f,g,a,e,b,c)};this.MarkPropUpdateInvalid=function(e,f,a,c){ULSEWi:;var b=false;if(h(a,true))b=d.MarkPropUpdateInvalid(e,f,a,c);return b};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;d.ClearAllPropChangesForRecord(a)};this.AddRowInsertChange=function(b,a){ULSEWi:;h(a,true)&&e.AddInsertChange(b,a)};this.AddRowDeleteChange=function(b,a){ULSEWi:;h(a,true)&&e.AddDeleteChange(b,a)};this.AddIndentLevelChange=function(d,c,b,a){ULSEWi:;h(a,true)&&g.AddLevelChange(d,c,b,a)};this.ApplyChangesToRecord=function(a){ULSEWi:;d.ApplyChangesToRecord(a)};this.ApplyChangeKey=function(b){ULSEWi:;this.OnSynchronizeChange!=null&&this.OnSynchronizeChange(b);e.ApplyAllRowInsertChanges(b);g.ApplyAllLevelChanges(b);d.SynchronizeToChange(b);e.ApplyAllRowDeleteChanges(b);a=b.GetVersionNumber()};this.UndoChangeKey=function(b){ULSEWi:;this.OnRollbackChange!=null&&this.OnRollbackChange(b);var c=r(b.GetVersionNumber());a=c.GetVersionNumber();e.UndoAllRowDeleteChanges(b);g.UndoAllLevelChanges(b);d.RollBackChange(b);e.UndoAllRowInsertChanges(b)};this.TryReadPropForChangeKey=function(b,c,a){ULSEWi:;return d.TryReadPropForVersion(b,c,a.GetVersionNumber())};this.OnSynchronizeChange;this.OnRollbackChange;this.OnVacateChange;this.GetChange=function(j,a,b,h){ULSEWi:;var c=j.GetVersionNumber(),k=e.GetChange(c,a,b,h),l=g.GetChange(c,a,b),f=k.concat(l);if(!h)f=f.concat(d.GetChange(c,a,b));return f.sort(i);function i(a,b){ULSEWi:;return a.type-b.type}};this.GetCurrentVersion=function(){ULSEWi:;return a};this.GetCurrentChangeKey=function(){ULSEWi:;return o(a)};this.IsChangeKeyApplied=function(b){ULSEWi:;return b!=null&&b.GetVersionNumber()<=a};this.GetNextVersionKey=function(){ULSEWi:;var a=new q(x++);c.push({key:a,version:a.GetVersionNumber()});a.Reserve();return a};this.ForceReleaseChanges=function(d,e){ULSEWi:;var a,c=0;j(d.GetVersionNumber()+1,e.GetVersionNumber(),b,function(d,b){ULSEWi:;a=a==null?b:a;c++});b.splice(a,c);m()};this.GetChangeKeyForVersion=function(b){ULSEWi:;var a=o(b);return a!=null&&h(a,true)?a:null};this.Clear=function(){ULSEWi:;b=[];e.Clear();g.Clear();d.Clear()};this.ReleaseChanges=function(a,b){ULSEWi:;j(a.GetVersionNumber()+1,b.GetVersionNumber(),c,function(a){ULSEWi:;a.key.Release()});m()};this.ReserveChanges=function(a,b){ULSEWi:;j(a.GetVersionNumber()+1,b.GetVersionNumber(),c,function(a){ULSEWi:;a.key.Reserve()})};this.VacateChange=function(b){ULSEWi:;var a=b.GetVersionNumber();k.eventMgr.FireEvent(SP.JsGrid.EventType.OnVacateChange,new SP.JsGrid.EventArgs.VacateChange(b));this.OnVacateChange!=null&&this.OnVacateChange(b);d.VacateChange(a);e.VacateChange(a);g.VacateChange(a);n.VacateChange(a);p(a,a)};function p(d,e){ULSEWi:;var b=0,a;j(d,e,c,function(d,c){ULSEWi:;a=a==null?c:a;b++});c.splice(a,b)}function j(c,d,b,g){ULSEWi:;for(var e=c==null?0:SP.Internal.JS.LowerBound(b,c,"version"),f=d==null?b.length-1:SP.Internal.JS.LowerBound(b,d,"version"),a=e;a<=f;a++)b[a]!=null&&g(b[a],a)}function h(a){ULSEWi:;var b=a.GetVersionNumber();return !n.ChangeIsVacated(b)}var n=function(){ULSEWi:;var a=[];function b(c){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c),d=a[b]!=null&&a[b]==c?a[b]:null;return {idx:b,item:d}}return {VacateChange:function(c){ULSEWi:;var d=b(c);a.splice(d.idx,0,c)},AdvanceBaseline:function(d){ULSEWi:;var c=b(d);a.splice(0,c.idx+(c.item!=null?1:0))},ChangeIsVacated:function(c){ULSEWi:;var a=b(c);return a.item!=null}}}();function q(a){ULSEWi:;this.Reserve=function(){ULSEWi:;var c=SP.Internal.JS.LowerBound(b,a,"version");if(b[c]==null||b[c].version!=a)b.splice(c,0,{version:a,count:1});else b[c].count++};this.Release=function(){ULSEWi:;var c=SP.Internal.JS.LowerBound(b,a,"version");if(b[c].count==1){b.splice(c,1);m()}else b[c].count--};this.GetVersionNumber=function(){ULSEWi:;return a};this.CompareTo=function(b){ULSEWi:;return a-b.GetVersionNumber()}}function r(d){ULSEWi:;for(var b=null,a=0;a<c.length&&c[a].version<d;a++)b=c[a];return b&&b.key}function o(a){ULSEWi:;var b=SP.Internal.JS.BinarySearch(c,a,"version");return c[b].key}function m(){ULSEWi:;var c=b.length>0?b[0]-1:a-1;if(c>f){d.AdvanceBaseline(c);e.AdvanceBaseline(c);g.AdvanceBaseline(c);n.AdvanceBaseline(c);p(f,c-1);f=c}}function u(){ULSEWi:;var b;this.Clear=function(){ULSEWi:;d()};this.AddLevelChange=function(h,f,e,g){ULSEWi:;var c=g.GetVersionNumber(),d=b[c];if(d==null)d=b[c]=[];d.push({recordKey:h,levelDelta:f,adoptedChildrenKeys:e});a>=c&&l(h,f,e,g)};this.ApplyAllLevelChanges=function(a){ULSEWi:;c(a,false)};this.UndoAllLevelChanges=function(a){ULSEWi:;c(a,true)};this.GetChange=function(i,e,g){ULSEWi:;var d;if(e!=null){d=new SP.Utilities.Set;d.AddArray(e)}var f=[],a=b[i];if(a!=null)for(var h=SP.JsGrid.Internal.VersionManager.ChangeType.Level,c=0;c<a.length;c++)if(d==null||d.Contains(a[c].recordKey)){var j=a[c].levelDelta*(g?-1:1);f.push({type:h,recordKey:a[c].recordKey,levelDelta:j,adoptedChildrenKeys:a[c].adoptedChildrenKeys})}return f};this.VacateChange=function(a){ULSEWi:;delete b[a]};this.AdvanceBaseline=function(b){ULSEWi:;for(var a=f;a<b;a++)this.VacateChange(a)};function d(){ULSEWi:;b={}}function c(d,e){ULSEWi:;var c=b[d.GetVersionNumber()];if(c!=null)if(e)for(var a=c.length-1;a>=0;a--)l(c[a].recordKey,-c[a].levelDelta,c[a].adoptedChildrenKeys,d);else for(var a=0;a<c.length;a++)l(c[a].recordKey,c[a].levelDelta,null,d)}d()}function w(){ULSEWi:;var c,b;this.Clear=function(){ULSEWi:;l()};this.AddInsertChange=function(b,a){ULSEWi:;g(b,a)};this.AddDeleteChange=function(b,a){ULSEWi:;f(b,a)};this.ApplyAllRowInsertChanges=function(a){ULSEWi:;d(g,c,a,false,false,true)};this.ApplyAllRowDeleteChanges=function(a){ULSEWi:;d(f,b,a,false,false,false)};this.UndoAllRowInsertChanges=function(a){ULSEWi:;d(f,c,a,true,true,false)};this.UndoAllRowDeleteChanges=function(a){ULSEWi:;d(g,b,a,true,true,true)};this.VacateChange=function(d){ULSEWi:;var a=SP.Internal.JS.BinarySearch(c,d,"version");a!=null&&c.splice(a,1);var a=SP.Internal.JS.BinarySearch(b,d,"version");a!=null&&b.splice(a,1)};this.AdvanceBaseline=function(){};this.GetChange=function(h,e,d,i){ULSEWi:;var a;if(e!=null){a=new SP.Utilities.Set;a.AddArray(e)}var g=k(c,h,a,d?SP.JsGrid.Internal.VersionManager.ChangeType.Delete:SP.JsGrid.Internal.VersionManager.ChangeType.Insert,i),f=k(b,h,a,d?SP.JsGrid.Internal.VersionManager.ChangeType.Insert:SP.JsGrid.Internal.VersionManager.ChangeType.Delete);return d?f.concat(g):g.concat(f)};function l(){ULSEWi:;c=[];b=[]}function k(c,j,g,f,i){ULSEWi:;var h=[],d=SP.Internal.JS.BinarySearch(c,j,"version");if(d!=null)for(var e=0;e<c[d].changes.length;e++){var a=c[d].changes[e];if(g==null||g.Contains(a.recordKey)){var b={type:f,recordKey:a.recordKey};if(f==SP.JsGrid.Internal.VersionManager.ChangeType.Insert){b.afterRecordKey=a.afterRecordKey;b.newOutlineLevel=a.newOutlineLevel}if(i)b.visualAfterRecordKey=a.visualAfterRecordKey==null?a.afterRecordKey:a.visualAfterRecordKey;h.push(b)}}return h}function d(m,b,j,g,i,k){ULSEWi:;var d=SP.Internal.JS.BinarySearch(b,j.GetVersionNumber(),"version");if(d!=null){var c=b[d].changes;if(!i)b[d]=new h(b[d].version);for(var f={},e=[],a=0;a<c.length;a++){f[c[a].recordKey]=c[a];e.push(c[a])}while(e.length>0)m(l(f,e),j,true,i,f)}function l(d,a){ULSEWi:;var b;if(k){b=g?a[a.length-1]:a[0];while(b.afterRecordKey in d)b=d[b.afterRecordKey];delete d[b.recordKey];for(var c=0;c<a.length;c++)if(b==a[c]){a.splice(c,1);break}}else b=g?a.pop():a.shift();return b}}function g(h,g,f,d,k){ULSEWi:;var b=g.GetVersionNumber();if(a>=b||f){var i=t(h,g,function(c){ULSEWi:;return j(c,f&&a<b?b:a)==1},k);i!=null&&!d&&e(c,b,i)}else!d&&e(c,b,h)}function f(h,m,l,k){ULSEWi:;var g=m.GetVersionNumber();if(a>=g||l){var d=s(h,m,function(b){ULSEWi:;return j(b,l&&a<g?g:a)==-1});if(d!=null){for(var f=new SP.Utilities.Set,c=0;c<d;c++)d[c].isbIsInView&&f.Add(d[c].recordKey);!f.IsEmpty()&&i(function(d,a){ULSEWi:;if(d)for(var c in a.recordKeys)f.Contains(c)&&f.Remove(c);if(f.IsEmpty())return false;for(var b=0;b<a.changes.length;b++)if(f.Contains(a.changes[b].afterRecordKey))a.changes[b].afterRecordKey=h.afterRecordKey;return true},g,false,true);if(!k)for(var c=0;c<d.length;c++)e(b,g,d[c])}}else!k&&e(b,g,h)}function j(c,b){ULSEWi:;var a=0;i(function(b,d){ULSEWi:;a=c in d.recordKeys?b?1:-1:a;return true},b,true,false);return a}function i(g,d,e,f){ULSEWi:;for(var a=0;a<b.length&&(f||b[a].version<=d)||a<c.length&&(f&&c[a].version<=d);a++){if(a<c.length&&(e||c[a].version>d))if(!g(true,c[a]))break;if(a<b.length&&(e||b[a].version>d))if(!g(false,b[a]))break}}function e(a,c,d){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c,"version");(b==a.length||a[b].version!=c)&&a.splice(b,0,h(c));var e=a[b];e.changes.push(d);e.recordKeys[d.recordKey]=null}function h(a){ULSEWi:;return {version:a,changes:[],recordKeys:{}}}l()}function v(){ULSEWi:;var b;this.Clear=function(){ULSEWi:;j()};this.GetChange=function(g,a,f){ULSEWi:;var e=[],c=a!=null?a:SP.Internal.JS.ConvertSetKeysToArray(b);for(var h in c){recordKey=c[h];d(recordKey,g,function(c,a){ULSEWi:;if(a.item!=null){var b=f?a.prevItem:a.item;e.push({type:SP.JsGrid.Internal.VersionManager.ChangeType.Prop,recordKey:recordKey,fieldKey:c,propUpdate:b.value,validationState:b.validationState==null?SP.JsGrid.ValidationState.Valid:b.validationState})}},true)}return e};this.TryReadPropForVersion=function(c,d,g){ULSEWi:;if(c in b&&d in b[c]){var a=e(b[c][d],g),f=a.item==null?a.prevItem:a.item;return f!=null?f.value:null}return null};this.ChangeKeys=function(a,c){ULSEWi:;b[c]=b[a];delete b[a]};this.GetEarliestChangeKeyForRecord=function(g){ULSEWi:;var a,c=b[g];if(c!=null)for(var h in c){var d=c[h],e=d[0].version!=f?d[0].version:d[1].version;a=a==null||e<a?e:a}return a};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;delete b[a]};this.MarkPropUpdateInvalid=function(h,j,f,c){ULSEWi:;var k=false,l=f.GetVersionNumber(),d=b[h][j];if(d!=null){var a=e(d,l);if(a.item!=null){if(a.item.validationState!=SP.JsGrid.ValidationState.Invalid){a.item.validationState=SP.JsGrid.ValidationState.Invalid;if(c!=null)a.item.optErrorMsg=c;i(h,j,a.item.value,f,SP.JsGrid.ValidationState.Invalid,false,null,c,g(d,a.idx,false))}k=true}}return k};this.AddPropChange=function(c,d,t,q,j,r){ULSEWi:;var p=t.GetVersionNumber(),w=p==f,k=null,h=null;if(!w){if(b[c]==null)b[c]={};var n=b[c][d];if(n==null){var v=y(c),u=null;if(v!=null)u=l(v,d);n=b[c][d]=[{version:f,value:u}]}var o=e(n,p);h=o.idx;if(o.item==null){m(c,d,q);var s={version:p,value:q};if(j!=SP.JsGrid.ValidationState.Valid)s.validationState=j;if(r!=null)s.optErrorMsg=r;n.splice(h,0,s)}else k=o.item}else{var o=b[c]!=null&&b[c][d]!=null?e(b[c][d],p):null;if(o!=null){k=o.item;h=o.idx}}if(k!=null){k.value=q;if(j!=k.validationState)if(j==null||j==SP.JsGrid.ValidationState.Valid)delete k.validationState;else k.validationState=j}var n=h==null?null:b[c][d];a>=p&&(h==null||h==n.length-1||n[h+1].version>a)&&i(c,d,q,t,j,false,null,r,g(n,h,false))};function g(b,c,e){ULSEWi:;var d,a=e?c+1:c-1;if(a>=0&&a<b.length)d=b[a].value;return d}function l(b,a){ULSEWi:;var d=k.controller.GetPropType(b.key(),a),c=d&&SP.JsGrid.Internal.Property.GetUpdateTrackingMode(d,k.jsGridParams.tableViewParams.gridFieldMap[a]),f=b.HasDataValue(a)&&c!=SP.JsGrid.UpdateTrackingMode.PropLocalized?b.GetDataValue(a):SP.JsGrid.EmptyValue,e=b.HasLocalizedValue(a)&&c!=SP.JsGrid.UpdateTrackingMode.PropData?b.GetLocalizedValue(a):SP.JsGrid.EmptyValue;return new SP.JsGrid.Internal.PropertyUpdate(f,e)}function m(d,e,b){ULSEWi:;var a=k.controller.GetPropType(d,e),c=a&&a.GetUpdateTrackingMode&&a.GetUpdateTrackingMode();if(a!=null&&c!=null)if(c==SP.JsGrid.UpdateTrackingMode.PropLocalized&&b.data!=SP.JsGrid.EmptyValue)b.data=SP.JsGrid.EmptyValue;else if(c==SP.JsGrid.UpdateTrackingMode.PropData&&b.localized!=SP.JsGrid.EmptyValue)b.localized=SP.JsGrid.EmptyValue}this.ApplyChangesToRecord=function(e){ULSEWi:;e.key() in b&&d(e.key(),a,function(f,d){ULSEWi:;var j=b[e.key()][f],a=d.item==null?d.prevItem:d.item;if(a!=null&&e.GetProp(f)!=null){var h=SP.Internal.JS.LowerBound(c,d.version,"version");i(e.key(),f,a.value,c[h].key,a.validationState==null?SP.JsGrid.ValidationState.Valid:a.validationState,true,e,a.optErrorMsg,g(j,h,false))}},true)};this.VacateChange=function(c){ULSEWi:;for(var a in b)d(a,c,function(c,e){ULSEWi:;var d=b[a][c];if(d.length==2)h(a,c);else d.splice(e.idx,1)})};this.SynchronizeToChange=function(f,e){ULSEWi:;var j=f.GetVersionNumber(),h=e!=null?e:SP.Internal.JS.ConvertSetKeysToArray(b);for(var k in h){var c=h[k];d(c,j,function(h,e){ULSEWi:;var d=e.item==null?e.prevItem:e.item;d!=null&&d.version>a&&i(c,h,d.value,f,d.validationState==null?SP.JsGrid.ValidationState.Valid:d.validationState,false,null,d.optErrorMsg,g(b[c][h],e.idx,false))},true)}};this.RollBackChange=function(f,a){ULSEWi:;var h=f.GetVersionNumber(),e=a!=null?a:SP.Internal.JS.ConvertSetKeysToArray(b);for(var j in e){recordKey=e[j];d(recordKey,h,function(d,e){ULSEWi:;var a=b[recordKey][d][e.idx-1],f=SP.Internal.JS.LowerBound(c,a.version,"version"),h=c[f].key;i(recordKey,d,a.value,h,a.validationState==null?SP.JsGrid.ValidationState.Valid:a.validationState,false,null,a.optErrorMsg,g(b[recordKey][d],e.idx-1,true))})}};this.AdvanceBaseline=function(d){ULSEWi:;for(var c in b)for(var e in b[c]){for(var a=b[c][e],g=SP.Internal.JS.LowerBound(a,d,"version"),f=1;f<g;f++)a.shift();if(a.length==1)h(c,e);else a[0].version=d}};function j(){ULSEWi:;b={}}function h(a,c){ULSEWi:;delete b[a][c];if(SP.Internal.JS.IsAssocArrayEmpty(b[a]))delete b[a]}function d(h,i,g,f){ULSEWi:;var a=b[h];if(a!=null)for(var d in a){var c=e(a[d],i);(c.item!=null||f)&&g(d,c)}}function e(b,c){ULSEWi:;var a=SP.Internal.JS.LowerBound(b,c,"version"),e=b[a]!=null&&b[a].version==c?b[a]:null,d=a>0&&a<=b.length?b[a-1]:null;return {idx:a,item:e,prevItem:d}}j()}};SP.JsGrid.Internal.VersionManager.ChangeType={Insert:0,Level:1,Prop:2,Delete:3};SP.JsGrid.WebMethodDataSource=function(m,o,g,p,i,n){ULSEWi:;var a=this,d=null,s,r,b,f,c=null;this.recordFactory;this.tableCache;this.populatingWebMethod=m;this.initWebMethod=o;this.RefreshTableView=function(i,d,k){ULSEWi:;var f=new SP.JsGrid.JsGridControl.TableViewParameters,h=SP.JsGrid.DeserializationMode.TableView;return g[this.initWebMethod.name](e(this.initWebMethod,h),function(g){ULSEWi:;var e=new SP.JsGrid.Deserializer(g,h,b);c=e.recordKeyHash;if(!i){p.ClearTableView();a.tableCache.Clear()}j(e,f,true);d!=null&&d(f,e.additionalParams)},k)};this.RefreshRowView=function(i,d,j){ULSEWi:;var f=SP.JsGrid.DeserializationMode.RowView;return g[this.populatingWebMethod.name](e(this.populatingWebMethod,f),function(j){ULSEWi:;var e=new SP.JsGrid.Deserializer(j,f,b);c=e.recordKeyHash;var g=e.InitJsGridRowViewParams();!i&&a.tableCache.Clear();h(e,g);d!=null&&d(g,e.additionalParams)},j)};this.GetAutoFilterEntries=function(f,d,c){ULSEWi:;var a=SP.JsGrid.DeserializationMode.AutoFilter;return g[this.populatingWebMethod.name](e(this.populatingWebMethod,a,f),function(e){ULSEWi:;var c=new SP.JsGrid.Deserializer(e,a,b);d(c.autoFilterEntries)},c)};this.BeginFullLoad=function(i,h,l){ULSEWi:;var d=SP.JsGrid.DeserializationMode.Full;return g[this.initWebMethod.name](e(this.initWebMethod,d),function(g){ULSEWi:;var e=new SP.JsGrid.Deserializer(g,d);c=e.recordKeyHash;b=e.keyColumnName;f=e.InitJsGridParams(l);f.tableCache=a.tableCache=new SP.JsGrid.TableCache(q,k);a.tableCache.SetConvertAllBlobsToRecords(true);a.tableCache.SetKeepDataInBlobCache(false);a.tableCache.SetMaxRecordCount(1e3);j(e,f.tableViewParams,false);i(f,e.additionalParams)},h)};function j(c,d,e){ULSEWi:;e&&c.InitJsGridTableViewParams(d);if(b!=c.keyColumnName)b=c.keyColumnName;a.recordFactory=new SP.JsGrid.RecordFactory(c.gridFieldMap,b,n);h(c,d.rowViewParams)}function h(b){ULSEWi:;d!=null&&a.tableCache.ClearRecords(d);a.tableCache.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(b.data),b.data);d=b.viewDependentKeys;b.InitCellStyles(f.styleManager)}function e(h,e,d,f){ULSEWi:;var b=h.fnGenerateArgs(e),a=b.gridSerializerArgs==null?{}:b.gridSerializerArgs;if(a.PagingInfo==null)a.PagingInfo=GenerateXMLArray(f!=null?l(f):["FirstVisible:100"],"string");a.RequestType=e;if(c!=null)a.RememberedRecordKeyHash=c;if(d!=null)a.AutoFilterColumnKeys=GenerateXMLArray(d,"string");b.gridSerializerArgs=g(a);return b;function g(b){ULSEWi:;var c=[];for(var a in b)c.push("<",a,">",b[a],"</",a,">");return c.join("")}}function k(e,b){ULSEWi:;var f={};for(var c in b)if(b[c] in e){var d=e[b[c]];f[b[c]]=a.recordFactory.MakeRecord(d.data,d.localized)}return f}function q(k,f){ULSEWi:;function j(g){ULSEWi:;var a=new SP.JsGrid.Deserializer(g,SP.JsGrid.DeserializationMode.Slice,b);c=a.recordKeyHash;if(a.recordKeyOrderChanged){a=new SP.JsGrid.Deserializer(g,SP.JsGrid.DeserializationMode.RowView,b);var e=a.InitJsGridRowViewParams();h(a,e);i!=null&&i(e,a.additionalParams)}else if(a.viewDependentKeys!=null)d=d==null?a.viewDependentKeys:d.concat(a.viewDependentKeys);f([{data:a.data,keys:SP.Internal.JS.ConvertSetKeysToArray(a.data)}])}return g[a.populatingWebMethod.name](e(a.populatingWebMethod,SP.JsGrid.DeserializationMode.Slice,null,k),j,function(){ULSEWi:;f(null)})}function l(b){ULSEWi:;for(var c=[],a=0;a<b.length;a++)c.push(b[a].pos+","+b[a].count);return c}};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("jsgrid.js")(b,d,"version");a!=null&&b.splice(a,1)};this.AdvanceBaseline=function(){};this.GetChange=function(h,e,d,i){ULSEWi:;var a;if(e!=null){a=new SP.Utilities.Set;a.AddArray(e)}var g=k(c,h,a,d?SP.JsGrid.Internal.VersionManager.ChangeType.Delete:SP.JsGrid.Internal.VersionManager.ChangeType.Insert,i),f=k(b,h,a,d?SP.JsGrid.Internal.VersionManager.ChangeType.Insert:SP.JsGrid.Internal.VersionManager.ChangeType.Delete);return d?f.concat(g):g.concat(f)};function l(){ULSEWi:;c=[];b=[]}function k(c,j,g,f,i){ULSEWi:;var h=[],d=SP.Internal.JS.BinarySearch(c,j,"version");if(d!=null)for(var e=0;e<c[d].changes.length;e++){var a=c[d].changes[e];if(g==null||g.Contains(a.recordKey)){var b={type:f,recordKey:a.recordKey};if(f==SP.JsGrid.Internal.VersionManager.ChangeType.Insert){b.afterRecordKey=a.afterRecordKey;b.newOutlineLevel=a.newOutlineLevel}if(i)b.visualAfterRecordKey=a.visualAfterRecordKey==null?a.afterRecordKey:a.visualAfterRecordKey;h.push(b)}}return h}function d(m,b,j,g,i,k){ULSEWi:;var d=SP.Internal.JS.BinarySearch(b,j.GetVersionNumber(),"version");if(d!=null){var c=b[d].changes;if(!i)b[d]=new h(b[d].version);for(var f={},e=[],a=0;a<c.length;a++){f[c[a].recordKey]=c[a];e.push(c[a])}while(e.length>0)m(l(f,e),j,true,i,f)}function l(d,a){ULSEWi:;var b;if(k){b=g?a[a.length-1]:a[0];while(b.afterRecordKey in d)b=d[b.afterRecordKey];delete d[b.recordKey];for(var c=0;c<a.length;c++)if(b==a[c]){a.splice(c,1);break}}else b=g?a.pop():a.shift();return b}}function g(h,g,f,d,k){ULSEWi:;var b=g.GetVersionNumber();if(a>=b||f){var i=t(h,g,function(c){ULSEWi:;return j(c,f&&a<b?b:a)==1},k);i!=null&&!d&&e(c,b,i)}else!d&&e(c,b,h)}function f(h,m,l,k){ULSEWi:;var g=m.GetVersionNumber();if(a>=g||l){var d=s(h,m,function(b){ULSEWi:;return j(b,l&&a<g?g:a)==-1});if(d!=null){for(var f=new SP.Utilities.Set,c=0;c<d;c++)d[c].isbIsInView&&f.Add(d[c].recordKey);!f.IsEmpty()&&i(function(d,a){ULSEWi:;if(d)for(var c in a.recordKeys)f.Contains(c)&&f.Remove(c);if(f.IsEmpty())return false;for(var b=0;b<a.changes.length;b++)if(f.Contains(a.changes[b].afterRecordKey))a.changes[b].afterRecordKey=h.afterRecordKey;return true},g,false,true);if(!k)for(var c=0;c<d.length;c++)e(b,g,d[c])}}else!k&&e(b,g,h)}function j(c,b){ULSEWi:;var a=0;i(function(b,d){ULSEWi:;a=c in d.recordKeys?b?1:-1:a;return true},b,true,false);return a}function i(g,d,e,f){ULSEWi:;for(var a=0;a<b.length&&(f||b[a].version<=d)||a<c.length&&(f&&c[a].version<=d);a++){if(a<c.length&&(e||c[a].version>d))if(!g(true,c[a]))break;if(a<b.length&&(e||b[a].version>d))if(!g(false,b[a]))break}}function e(a,c,d){ULSEWi:;var b=SP.Internal.JS.LowerBound(a,c,"version");(b==a.length||a[b].version!=c)&&a.splice(b,0,h(c));var e=a[b];e.changes.push(d);e.recordKeys[d.recordKey]=null}function h(a){ULSEWi:;return {version:a,changes:[],recordKeys:{}}}l()}function v(){ULSEWi:;var b;this.Clear=function(){ULSEWi:;j()};this.GetChange=function(g,a,f){ULSEWi:;var e=[],c=a!=null?a:SP.Internal.JS.ConvertSetKeysToArray(b);for(var h in c){recordKey=c[h];d(recordKey,g,function(c,a){ULSEWi:;if(a.item!=null){var b=f?a.prevItem:a.item;e.push({type:SP.JsGrid.Internal.VersionManager.ChangeType.Prop,recordKey:recordKey,fieldKey:c,propUpdate:b.value,validationState:b.validationState==null?SP.JsGrid.ValidationState.Valid:b.validationState})}},true)}return e};this.TryReadPropForVersion=function(c,d,g){ULSEWi:;if(c in b&&d in b[c]){var a=e(b[c][d],g),f=a.item==null?a.prevItem:a.item;return f!=null?f.value:null}return null};this.ChangeKeys=function(a,c){ULSEWi:;b[c]=b[a];delete b[a]};this.GetEarliestChangeKeyForRecord=function(g){ULSEWi:;var a,c=b[g];if(c!=null)for(var h in c){var d=c[h],e=d[0].version!=f?d[0].version:d[1].version;a=a==null||e<a?e:a}return a};this.ClearAllPropChangesForRecord=function(a){ULSEWi:;delete b[a]};this.MarkPropUpdateInvalid=function(h,j,f,c){ULSEWi:;var k=false,l=f.GetVersionNumber(),d=b[h][j];if(d!=null){var a=e(d,l);if(a.item!=null){if(a.item.validationState!=SP.JsGrid.ValidationState.Invalid){a.item.validationState=SP.JsGrid.ValidationState.Invalid;if(c!=null)a.item.optErrorMsg=c;i(h,j,a.item.value,f,SP.JsGrid.ValidationState.Invalid,false,null,c,g(d,a.idx,false))}k=true}}return k};this.AddPropChange=function(c,d,t,q,j,r){ULSEWi:;var p=t.GetVersionNumber(),w=p==f,k=null,h=null;if(!w){if(b[c]==null)b[c]={};var n=b[c][d];if(n==null){var v=y(c),u=null;if(v!=null)u=l(v,d);n=b[c][d]=[{version:f,value:u}]}var o=e(n,p);h=o.idx;if(o.item==null){m(c,d,q);var s={version:p,value:q};if(j!=SP.JsGrid.ValidationState.Valid)s.validationState=j;if(r!=null)s.optErrorMsg=r;n.splice(h,0,s)}else k=o.item}else{var o=b[c]!=null&&b[c][d]!=null?e(b[c][d],p):null;if(o!=null){k=o.item;h=o.idx}}if(k!=null){k.value=q;if(j!=k.validationState)if(j==null||j==SP.JsGrid.ValidationState.Valid)delete k.validationState;else k.validationState=j}var n=h==null?null:b[c][d];a>=p&&(h==null||h==n.length-1||n[h+1].version>a)&&i(c,d,q,t,j,false,null,r,g(n,h,false))};function g(b,c,e){ULSEWi:;var d,a=e?c+1:c-1;if(a>=0&&a<b.length)d=b[a].value;return d}function l(b,a){ULSEWi:;var d=k.controller.GetPropType(b.key(),a),c=d&&SP.JsGrid.Internal.Property.GetUpdateTrackingMode(d,k.jsGridParams.tableViewParams.gridFieldMap[a]),f=b.HasDataValue(a)&&c!=SP.JsGrid.UpdateTrackingMode.PropLocalized?b.GetDataValue(a):SP.JsGrid.EmptyValue,e=b.HasLocalizedValue(a)&&c!=SP.JsGrid.UpdateTrackingMode.PropData?b.GetLocalizedValue(a):SP.JsGrid.EmptyValue;return new SP.JsGrid.Internal.PropertyUpdate(f,e)}function m(d,e,b){ULSEWi:;var a=k.controller.GetPropType(d,e),c=a&&a.GetUpdateTrackingMode&&a.GetUpdateTrackingMode();if(a!=null&&c!=null)if(c==SP.JsGrid.UpdateTrackingMode.PropLocalized&&b.data!=SP.JsGrid.EmptyValue)b.data=SP.JsGrid.EmptyValue;else if(c==SP.JsGrid.UpdateTrackingMode.PropData&&b.localized!=SP.JsGrid.EmptyValue)b.localized=SP.JsGrid.EmptyValue}this.ApplyChangesToRecord=function(e){ULSEWi:;e.key() in b&&d(e.key(),a,function(f,d){ULSEWi:;var j=b[e.key()][f],a=d.item==null?d.prevItem:d.item;if(a!=null&&e.GetProp(f)!=null){var h=SP.Internal.JS.LowerBound(c,d.version,"version");i(e.key(),f,a.value,c[h].key,a.validationState==null?SP.JsGrid.ValidationState.Valid:a.validationState,true,e,a.optErrorMsg,g(j,h,false))}},true)};this.VacateChange=function(c){ULSEWi:;for(var a in b)d(a,c,function(c,e){ULSEWi:;var d=b[a][c];if(d.length==2)h(a,c);else d.splice(e.idx,1)})};this.SynchronizeToChange=function(f,e){ULSEWi:;var j=f.GetVersionNumber(),h=e!=null?e:SP.Internal.JS.ConvertSetKeysToArray(b);for(var k in h){var c=h[k];d(c,j,function(h,e){ULSEWi:;var d=e.item==null?e.prevItem:e.item;d!=null&&d.version>a&&i(c,h,d.value,f,d.validationState==null?SP.JsGrid.ValidationState.Valid:d.validationState,false,null,d.optErrorMsg,g(b[c][h],e.idx,false))},true)}};this.RollBackChange=function(f,a){ULSEWi:;var h=f.GetVersionNumber(),e=a!=null?a:SP.Internal.JS.ConvertSetKeysToArray(b);for(var j in e){recordKey=e[j];d(recordKey,h,function(d,e){ULSEWi:;var a=b[recordKey][d][e.idx-1],f=SP.Internal.JS.LowerBound(c,a.version,"version"),h=c[f].key;i(recordKey,d,a.value,h,a.validationState==null?SP.JsGrid.ValidationState.Valid:a.validationState,false,null,a.optErrorMsg,g(b[recordKey][d],e.idx-1,true))})}};this.AdvanceBaseline=function(d){ULSEWi:;for(var c in b)for(var e in b[c]){for(var a=b[c][e],g=SP.Internal.JS.LowerBound(a,d,"version"),f=1;f<g;f++)a.shift();if(a.length==1)h(c,e);else a[0].version=d}};function j(){ULSEWi:;b={}}function h(a,c){ULSEWi:;delete b[a][c];if(SP.Internal.JS.IsAssocArrayEmpty(b[a]))delete b[a]}function d(h,i,g,f){ULSEWi:;var a=b[h];if(a!=null)for(var d in a){var c=e(a[d],i);(c.item!=null||f)&&g(d,c)}}function e(b,c){ULSEWi:;var a=SP.Internal.JS.LowerBound(b,c,"version"),e=b[a]!=null&&b[a].version==c?b[a]:null,d=a>0&&a<=b.length?b[a-1]:null;return {idx:a,item:e,prevItem:d}}j()}};SP.JsGrid.Internal.VersionManager.ChangeType={Insert:0,Level:1,Prop:2,Delete:3};SP.JsGrid.WebMethodDataSource=function(m,o,g,p,i,n){ULSEWi:;var a=this,d=null,s,r,b,f,c=null;this.recordFactory;this.tableCache;this.populatingWebMethod=m;this.initWebMethod=o;this.RefreshTableView=function(i,d,k){ULSEWi:;var f=new SP.JsGrid.JsGridControl.TableViewParameters,h=SP.JsGrid.DeserializationMode.TableView;return g[this.initWebMethod.name](e(this.initWebMethod,h),function(g){ULSEWi:;var e=new SP.JsGrid.Deserializer(g,h,b);c=e.recordKeyHash;if(!i){p.ClearTableView();a.tableCache.Clear()}j(e,f,true);d!=null&&d(f,e.additionalParams)},k)};this.RefreshRowView=function(i,d,j){ULSEWi:;var f=SP.JsGrid.DeserializationMode.RowView;return g[this.populatingWebMethod.name](e(this.populatingWebMethod,f),function(j){ULSEWi:;var e=new SP.JsGrid.Deserializer(j,f,b);c=e.recordKeyHash;var g=e.InitJsGridRowViewParams();!i&&a.tableCache.Clear();h(e,g);d!=null&&d(g,e.additionalParams)},j)};this.GetAutoFilterEntries=function(f,d,c){ULSEWi:;var a=SP.JsGrid.DeserializationMode.AutoFilter;return g[this.populatingWebMethod.name](e(this.populatingWebMethod,a,f),function(e){ULSEWi:;var c=new SP.JsGrid.Deserializer(e,a,b);d(c.autoFilterEntries)},c)};this.BeginFullLoad=function(i,h,l){ULSEWi:;var d=SP.JsGrid.DeserializationMode.Full;return g[this.initWebMethod.name](e(this.initWebMethod,d),function(g){ULSEWi:;var e=new SP.JsGrid.Deserializer(g,d);c=e.recordKeyHash;b=e.keyColumnName;f=e.InitJsGridParams(l);f.tableCache=a.tableCache=new SP.JsGrid.TableCache(q,k);a.tableCache.SetConvertAllBlobsToRecords(true);a.tableCache.SetKeepDataInBlobCache(false);a.tableCache.SetMaxRecordCount(1e3);j(e,f.tableViewParams,false);i(f,e.additionalParams)},h)};function j(c,d,e){ULSEWi:;e&&c.InitJsGridTableViewParams(d);if(b!=c.keyColumnName)b=c.keyColumnName;a.recordFactory=new SP.JsGrid.RecordFactory(c.gridFieldMap,b,n);h(c,d.rowViewParams)}function h(b){ULSEWi:;d!=null&&a.tableCache.ClearRecords(d);a.tableCache.AddRawDataToCache(SP.Internal.JS.ConvertSetKeysToArray(b.data),b.data);d=b.viewDependentKeys;b.InitCellStyles(f.styleManager)}function e(h,e,d,f){ULSEWi:;var b=h.fnGenerateArgs(e),a=b.gridSerializerArgs==null?{}:b.gridSerializerArgs;if(a.PagingInfo==null)a.PagingInfo=GenerateXMLArray(f!=null?l(f):["FirstVisible:100"],"string");a.RequestType=e;if(c!=null)a.RememberedRecordKeyHash=c;if(d!=null)a.AutoFilterColumnKeys=GenerateXMLArray(d,"string");b.gridSerializerArgs=g(a);return b;function g(b){ULSEWi:;var c=[];for(var a in b)c.push("<",a,">",b[a],"</",a,">");return c.join("")}}function k(e,b){ULSEWi:;var f={};for(var c in b)if(b[c] in e){var d=e[b[c]];f[b[c]]=a.recordFactory.MakeRecord(d.data,d.localized)}return f}function q(k,f){ULSEWi:;function j(g){ULSEWi:;var a=new SP.JsGrid.Deserializer(g,SP.JsGrid.DeserializationMode.Slice,b);c=a.recordKeyHash;if(a.recordKeyOrderChanged){a=new SP.JsGrid.Deserializer(g,SP.JsGrid.DeserializationMode.RowView,b);var e=a.InitJsGridRowViewParams();h(a,e);i!=null&&i(e,a.additionalParams)}else if(a.viewDependentKeys!=null)d=d==null?a.viewDependentKeys:d.concat(a.viewDependentKeys);f([{data:a.data,keys:SP.Internal.JS.ConvertSetKeysToArray(a.data)}])}return g[a.populatingWebMethod.name](e(a.populatingWebMethod,SP.JsGrid.DeserializationMode.Slice,null,k),j,function(){ULSEWi:;f(null)})}function l(b){ULSEWi:;for(var c=[],a=0;a<b.length;a++)c.push(b[a].pos+","+b[a].count);return c}};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("jsgrid.js")